{"version":3,"file":"static/js/map.ab909ded.js","mappings":"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","sources":["webpack://front-end/./src/map/ktmap-all-desktop.js","webpack://front-end/./src/views/MapAnalysisView.vue?2e7e","webpack://front-end/./src/components/maps/KtMap.vue?1c19","webpack://front-end/src/components/maps/KtMap.vue","webpack://front-end/./src/components/maps/KtMap.vue?b89c","webpack://front-end/./src/components/maps/KtMap.vue","webpack://front-end/src/views/MapAnalysisView.vue","webpack://front-end/./src/views/MapAnalysisView.vue?676a","webpack://front-end/./src/views/MapAnalysisView.vue"],"sourcesContent":["/*\n * KT Map JavaScript API v3.0.44\n * \n * Copyright (c) 2013-2018 kt corp. All rights reserved.\n * \n * This is a proprietary software of kt corp, and you may not use this software\n * except in compliance with license agreement with kt corp. Any redistribution\n * or use of this software, with or without modification shall be strictly\n * prohibited without prior written approval of kt corp, and the copyright\n * notice above does not evidence any actual or intended publication of such\n * software.\n */\ndocument.write('<style type=\"text/css\">.ollehmap *,.ollehmap :after,.ollehmap :before{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.ollehmap{position:relative;overflow:hidden;padding:0;margin:0;border:none;background-color:#EEE;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ollehmap-noevent{pointer-events:none!important}.ollehmap-event{pointer-events:auto}.ollehmap-drag .ollehmap-info,.ollehmap-drag .ollehmap-info-shadow{opacity:.3}.ollehmap-dragging{z-index:357913941!important}.ollehmap-vector{pointer-events:visiblePainted}.ollehmap-info{position:absolute}.ollehmap-info-defaultStyle{font-family:Dotum,Baekmuk Dotum,Undotum,Apple Gothic,Latin font,sans-serif;font-size:12px;font-weight:400;line-height:normal;font-style:normal}.ollehmap-info-area{cursor:default;position:relative;left:0;top:0;background-color:#fff;border:2px solid #474747}.ollehmap-info-content{cursor:auto;position:absolute;min-height:60px;min-width:300px;max-height:500px;z-index:9999;-webkit-user-select:text;-khtml-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ollehmap-info-content-overflow{overflow:auto;-webkit-overflow-scrolling:auto}.ollehmap-info-tip{width:16px;height:26px;overflow:hidden;z-index:1;position:absolute}.ollehmap-info-tip-img{position:absolute;border:0;padding:0;margin:0;top:-348px;left:0;z-index:auto}.ollehmap-info-bottom{position:absolute;left:0;top:0;border:2px solid #474747}.ollehmap-info-shadow{position:absolute}.ollehmap-info-shadow>div{overflow:hidden;position:absolute;z-index:1;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ollehmap-info-shadow img{position:absolute;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:0;padding:0;margin:0}.ollehmap-info-shadow-topleft,.ollehmap-info-shadow-topright{top:0;width:70px;height:10px}.ollehmap-info-shadow-topleft>img{left:-296px;top:0}.ollehmap-info-shadow-topright>img{left:-1036px;top:0}.ollehmap-info-shadow-bottomleft,.ollehmap-info-shadow-bottomright{width:70px;height:30px}.ollehmap-info-shadow-bottomleft>img{left:12px;top:-315px}.ollehmap-info-shadow-bottomright>img{left:-716px;top:-315px}.ollehmap-info-shadow-bottomtip{width:40px;height:30px}.ollehmap-info-shadow-bottomtip>img{left:-356px;top:-315px}.ollehmap-info-shadow-topcenter{height:10px}.ollehmap-info-shadow-topcenter>img{left:-366px;top:0}.ollehmap-info-shadow-centerleft>img{top:-10px}.ollehmap-info-shadow-centerright>img{top:-10px}.ollehmap-info-shadow-bottomleftoftip,.ollehmap-info-shadow-bottomrightoftip{height:30px}.ollehmap-info-shadow-bottomleftoftip>img,.ollehmap-info-shadow-bottomrightoftip>img{left:-396px;top:-315px}.ollehmap-info-shadow-center>img{left:-366px;top:-10px}.ollehmap-info-tooltip-area{position:relative;background-color:#fff;left:0;top:0;border:1px solid #555;border-radius:2px}.ollehmap-info-tooltip-data{font-family:Dotum,Baekmuk Dotum,Undotum,Apple Gothic,Latin font,sans-serif;font-size:13px;font-weight:700;line-height:normal;font-style:normal}.ollehmap-corner-container{position:relative}.ollehmap-corner-container-horizontal{display:inline-block}.ollehmap-corner{position:absolute;z-index:1}.ollehmap-corner-area{position:relative;display:inline-block}.ollehmap-control-rightAlign{margin-left:auto;margin-right:0}.ollehmap-copyright-control{color:#000;font:700 12px/1.5 Dotum,Arial,Helvetica,sans-serif;text-shadow:-1px 0 white,0 1px white,1px 0 white,0 -1px #fff;display:inline}.ollehmap-logo-control,.ollehmap-logo-control.imagery{background-position:-78px -316px;width:22px;height:22px;margin:0 8px 12px 2px}.ollehmap-logo-control.imagery{background-position:-100px -316px}.ollehmap-maptype-control-expandtype{padding:6px;margin:6px;box-shadow:0 1px 7px #999;border:1px solid #000;background-color:#fff;border-radius:8px;-moz-border-radius:8px;font:12px/1.5 \"Helvetica Neue\",Arial,Helvetica,sans-serif;color:#000;opacity:.8}.ollehmap-maptype-control-expandtype:hover{opacity:1}.ollehmap-maptype-control-expandtype .ollehmap-maptype-control-toggle{display:block;width:27px;height:27px}.ollehmap-maptype-control-expanded .ollehmap-maptype-control-toggle,.ollehmap-maptype-control-expandtype .ollehmap-maptype-control-list{display:none}.ollehmap-maptype-control-expanded .ollehmap-maptype-control-list{display:block}.ollehmap-maptype-control-expanded .ollehmap-maptype-control-separator{height:0;border-top:1px solid #000;margin:5px -6px}.ollehmap-scale-control{background-repeat:no-repeat;background-position:bottom;color:#000;font:11px Dotum,Arial,Helvetica,sans-serif;font-weight:700;text-shadow:-1px 0 white,0 1px white,1px 0 white,0 -1px #fff;text-align:center;margin-bottom:12px}.ollehmap-scale-image{width:46px;height:8px;border:2px solid #000;border-top:none;margin-top:-4px}.ollehmap-scale-image.imagery{border-color:#fff}.ollehmap-zoom-control{position:relative;width:26px}.ollehmap-zoom-control .highlighted{border:1px dashed red}.ollehmap-hidden{display:none!important}.ollehmap-traffic-control{opacity:.8;padding:6px;margin:6px;box-shadow:gray 0 1px 7px;background-color:#fff;border-radius:8px;font-size:11px;font-family:Dotum,sans-serif;letter-spacing:-1px;text-align:left}.ollehmap-traffic-control .imgDiv{height:26px}.ollehmap-traffic-control:hover{opacity:1}.ollehmap-traffic-control .tooltip{position:absolute;top:50px;width:142px}.ollehmap-traffic-control h1{color:#1065ac;font-size:11px;margin:6px}.ollehmap-traffic-control ul{padding:5px;margin:5px 0;list-style-position:inside}.ollehmap-traffic-control li{line-height:15px}.ollehmap-traffic-control .trafficbar{width:55px;height:8px;display:inline-block;padding:1px 0}.ollehmap-traffic-control .trafficbar:hover{padding:0;width:53px;border:1px solid #444}.control-zoombar-active{background-position:0 0;width:26px;height:180px}.control-zoombar-deactive{background-position:-26px 0;width:26px;height:180px}.control-traffic-info{background-position:0 -180px;width:142px;height:63px}.control-pan{background-position:-52px 0;width:60px;height:63px}.control-zoomout{background-position:-112px 0;width:26px;height:26px}.control-zoomin{background-position:-112px -26px;width:26px;height:26px}.control-distance-selected{background-position:-112px -52px;width:26px;height:25px}.control-distance-out{background-position:-52px -63px;width:26px;height:25px}.control-shape-out{background-position:-78px -63px;width:26px;height:25px}.control-shape-selected{background-position:-104px -77px;width:26px;height:25px}.control-change:hover{background-position:-52px -88px;width:26px;height:24px}.control-change{background-position:-78px -88px;width:26px;height:24px}.control-roadmap-out{background-position:-52px -112px;width:55px;height:22px}.control-roadmap-selected{background-position:-52px -156px;width:55px;height:22px}.control-hybrid-out{background-position:0 -265px;width:75px;height:22px}.control-hybrid-selected{background-position:-52px -134px;width:75px;height:22px}.control-satellite-out{background-position:0 -243px;width:55px;height:22px}.control-satellite-selected{background-position:-55px -243px;width:55px;height:22px}.control-engmap-out{background-position:0 -335px;width:55px;height:22px}.control-engmap-selected{background-position:-55px -335px;width:55px;height:22px}.control-measure-distance-start{background-position:-75px -265px;width:37px;height:21px}.control-measure-area-delete{background-position:-107px -112px;width:18px;height:17px}.control-measure-distance-delete{background-position:-107px -156px;width:18px;height:17px}.control-measure-redmouse{background-position:-112px -254px;width:11px;height:16px}.control-measure-bluemouse{background-position:-124px -254px;width:11px;height:16px}.control-level1{background-position:-75px -286px;width:39px;height:15px}.control-level5{background-position:0 -287px;width:39px;height:15px}.control-level3{background-position:-39px -301px;width:39px;height:15px}.control-level13{background-position:-78px -301px;width:39px;height:15px}.control-level11{background-position:0 -302px;width:39px;height:15px}.control-level8{background-position:-39px -316px;width:39px;height:15px}.control-panleft{background-position:-104px -63px;width:8px;height:13px}.control-panright{background-position:-130px -77px;width:8px;height:13px}.control-panleft:hover{background-position:-130px -90px;width:8px;height:13px}.control-panright:hover{background-position:-125px -112px;width:9px;height:12px}.control-area-icon{background-position:-127px -134px;width:11px;height:11px}.control-distance-icon{background-position:-127px -145px;width:11px;height:11px}.control-zoomslider{background-position:-110px -243px;width:20px;height:11px}.control-scale{background-position:-78px -332px;width:54px;height:10px}.control-panup:hover{background-position:-125px -156px;width:12px;height:10px}.control-panup{background-position:-125px -166px;width:12px;height:10px}.control-pandown:hover{background-position:-125px -124px;width:12px;height:9px}.control-pandown{background-position:-130px -243px;width:12px;height:9px}.control-traffic-bullet{background-position:-138px 0;width:4px;height:1px}.control-gauge{background-position:-130px -103px;width:8px;height:1px}.infowin-shadow{background-position:0 0;width:1068px;height:347px}.infowin-tip{background-position:0 -347px;width:18px;height:25px}.infowin-close{background-position:-18px -347px;width:13px;height:13px}.olleh-maps-inline{display:inline-block;margin-left:3px}.ollehmap-measure{background:#fff;white-space:nowrap;width:auto;border:1px solid;position:absolute;font-family:dotum}.ollehmap-measure strong{color:#df2428;font-weight:700}.ollehmap-measure-areaInfo{padding:8px;font-size:11px;border:1px solid #555;background:#F7F7F7;color:#333;white-space:normal;width:110px;margin-top:-63px;margin-left:30px}.ollehmap-measure-finalAreaInfo{padding:10px;font-size:12px;font-weight:700;border:1px solid;color:#333;margin-top:-49px;margin-left:30px}.ollehmap-measure-pointStart{border:1px solid #BC1437;color:#fff;background:#E02428;font-size:12px;font-weight:700;padding:5px}.ollehmap-measure-pointInfo{border:1px solid #DF2428;color:#333;background:#F9F9F9;font-size:12px;font-weight:400;padding:5px}.ollehmap-measure-pointDetail{font-size:12px;border:1px solid #555;padding:10px 10px 55px;color:#333;width:130px;margin-top:-135px;margin-left:30px}.ollehmap-measure-pointDetail1{float:left;clear:left;width:60px;font-weight:700}.ollehmap-measure-pointDetail2{float:left;width:70px;font-weight:700}.ollehmap-measure-finish{padding:8px 19px;background:#F7F7F7;border-top:1px solid #DBDBDB;position:absolute;left:0;bottom:0;right:0;font-size:11px;white-space:normal}</style><style type=\"text/css\">.ollehmap{cursor:default}.ollehmap-boxzoom{position:absolute;background-color:#fff;opacity:.5;border:2px dotted red;width:0;height:0}.ollehmap-transparent{background-color:#fff;opacity:0}.ollehmap-control-clickable{cursor:pointer}.ollehmap-info-close{position:absolute;width:14px;height:14px;overflow:hidden;right:18px;top:13px;z-index:10000;cursor:pointer}.ollehmap-info-close-img{position:absolute;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:0;padding:0;margin:0;top:-346px;left:-51px}</style><!--[if lte IE 8]><style type=\"text/css\">.ollehmap-vml{behavior:url(#default#VML);position:absolute}.ollehmap-boxzoom{-ms-filter:\"alpha(Opacity=50)\";filter:alpha(opacity=50)}.ollehmap-transparent{-ms-filter:\"alpha(Opacity=0)\";filter:alpha(opacity=0)}.ollehmap-corner-area{margin:1px}.ollehmap-maptype-control-expandtype>form{height:100%;padding:0;margin:0}.ollehmap-measure-pointDetail{width:135px}.ollehmap-measure-areaInfo{width:120px}</style><![endif]-->');\n!function (GLOBAL) {\r\n  if (!Date.now) {\r\n    Date.now = function () {\r\n      return +(new Date);\r\n    };\r\n  }\r\n  \r\n  if (!Function.prototype.bind) {\r\n    Function.prototype.bind = function (oThis) {\r\n      if (typeof this !== 'function') {\r\n        throw new TypeError('Bind must be called on a function');\r\n      }\r\n      \r\n      var aArgs = Array.prototype.slice.call(arguments, 1);\r\n      var fToBind = this;\r\n      var fNOP = function () {};\r\n      var fBound = function () {\r\n        return fToBind.apply(this instanceof fNOP && oThis ? this : oThis, \r\n            aArgs.concat(Array.prototype.slice.call(arguments)));\r\n      };\r\n      fNOP.prototype = this.prototype;\r\n      fBound.prototype = new fNOP();\r\n      return fBound;\r\n    };\r\n  }\r\n  \r\n  if (!GLOBAL.requestAnimationFrame) {\r\n    GLOBAL.requestAnimationFrame = GLOBAL.webkitRequestAnimationFrame\r\n      || GLOBAL.mozRequestAnimationFrame\r\n      || GLOBAL.msRequestAnimationFrame\r\n      || GLOBAL.oRequestAnimationFrame;\r\n  }\r\n\r\n  if (!GLOBAL.cancelAnimationFrame) {\r\n    GLOBAL.cancelAnimationFrame = GLOBAL.cancelRequestAnimationFrame\r\n      || GLOBAL.webkitCancelAnimationFrame\r\n      || GLOBAL.webkitCancelRequestAnimationFrame\r\n      || GLOBAL.mozCancelAnimationFrame\r\n      || GLOBAL.mozCancelRequestAnimationFrame\r\n      || GLOBAL.msCancelAnimationFrame\r\n      || GLOBAL.msCancelRequestAnimationFrame\r\n      || GLOBAL.oCancelAnimationFrame\r\n      || GLOBAL.oCancelRequestAnimationFrame;\r\n  }\r\n  \r\n  if (!GLOBAL.requestAnimationFrame || !GLOBAL.cancelAnimationFrame) {\r\n    GLOBAL.requestAnimationFrame = function (callback) {\r\n      return GLOBAL.setTimeout(callback.bind(undefined, +Date.now()), 17);\r\n    };\r\n    GLOBAL.cancelAnimationFrame = function (requestid) {\r\n      window.clearTimeout(requestid);\r\n    };\r\n  }\r\n\r\n} (window);/**\r\n * @name olleh Maps\r\n * @version 3\r\n * @author KT\r\n * @copyright (c) 2013 KT Corp.\r\n * @fileoverview\r\n */\r\n!function (GLOBAL) {\r\n  \r\n  var indexOf = [].indexOf || function(elem) { // ie 9 support .\r\n    for (var i = 0, len = this.length ; i < len; i++ ) {\r\n      if ( this[i] === elem ) return i;\r\n    }\r\n    return -1;\r\n  };\r\n  \r\n  // Mapping of normalized type names for olleh.maps.typeOf()\r\n  var _OBJ2TYPE = {\r\n    '[object Boolean]'  : 'boolean',\r\n    '[object Number]'   : 'number',\r\n    '[object String]'   : 'string',\r\n    '[object Function]' : 'function',\r\n    '[object Object]'   : 'object',\r\n    '[object Array]'    : 'array',\r\n    '[object Date]'     : 'date',\r\n    '[object RegExp]'   : 'regexp',\r\n    '[object Error]'    : 'error'\r\n  };\r\n  \r\n  if (!GLOBAL.olleh) {\r\n    GLOBAL.olleh = {};\r\n  }\r\n  \r\n  /**\r\n   *  .       .\r\n   * @name olleh.maps\r\n   * @namespace \r\n   */\r\n  \r\n  /**\r\n   * @lends olleh.maps\r\n   */\r\n  GLOBAL.olleh.maps = {\r\n    \r\n    /**\r\n     * Normalize typeof        \r\n     *  .( ,   null JavaScript \r\n     * typeof  'object'  olleh.maps.typeOf \r\n     * 'null' )\r\n     * <p/>\r\n     * Normalize JavaScript   \r\n     * <pre>\r\n     *   ARRAY:       'array'\r\n     *   BOOLEAN:     'boolean'\r\n     *   DATE:        'date'\r\n     *   ERROR:       'error'\r\n     *   FUNCTION:    'function'\r\n     *   NUMBER:      'number'\r\n     *   NULL:        'null'\r\n     *   OBJECT:      'object'\r\n     *   REGEXP:      'regexp'\r\n     *   STRING:      'string'\r\n     *   UNDEFINED:   'undefined'\r\n     * </pre>\r\n     * @example\r\n     * olleh.maps.typeOf('foo'); // 'string'\r\n     * olleh.maps.typeOf(123); // 'number'\r\n     * olleh.maps.typeOf([]); // 'array'\r\n     * olleh.maps.typeOf({}); // 'object'\r\n     * olleh.maps.typeOf(null); 'null'\r\n     * olleh.maps.typeOf(new Date); // 'date'\r\n     * olleh.maps.typeOf(true); // 'boolean'\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {String} Normalize JavaScript ()\r\n     */\r\n    typeOf: function (obj) {\r\n      return _OBJ2TYPE[Object.prototype.toString.call(obj)]\r\n          || (obj ? 'object' : obj === null ? 'null' : 'undefined');\r\n    },\r\n    \r\n    /**\r\n     *       true/false .\r\n     * @example\r\n     * olleh.maps.isArray([]); // true\r\n     * olleh.maps.isArray({}); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @param {Boolean} relaxed      \r\n     * (,  )\r\n     * @returns {Boolean}    true  \r\n     *   false .\r\n     */\r\n    isArray: function (obj, relaxed) {\r\n      if (!relaxed) {\r\n        return Array.isArray && (Array.isArray(obj)) || this.typeOf(obj) === 'array';\r\n      } else {\r\n        // Handles arrays inheritance and arrays from external frame/window\r\n        return obj && (typeof obj === 'object'\r\n            && typeof obj.length === 'number'\r\n            && typeof obj.splice === 'function'\r\n            && !obj.propertyIsEnumerable('length')) || (obj instanceof Array);\r\n      }\r\n    },\r\n    \r\n    /**\r\n     *   Boolean     true/false .\r\n     * @example\r\n     * olleh.maps.isBoolean(true); // true\r\n     * olleh.maps.isBoolean(false); // true\r\n     * olleh.maps.isBoolean({}); // false\r\n     * olleh.maps.isBoolean([]); // false\r\n     * olleh.maps.isBoolean(1); // false\r\n     * olleh.maps.isBoolean(0); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}    boolean true \r\n     *  false .\r\n     */\r\n    isBoolean: function (obj) {\r\n      return typeof obj === 'boolean';\r\n    },\r\n    \r\n    /**\r\n     *   Date    true/false .\r\n     * @example\r\n     * olleh.maps.isDate(new Date()); // true\r\n     * olleh.maps.isDate({}); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   Date true\r\n     *   false .\r\n     */\r\n    isDate: function (obj) {\r\n      return this.typeOf(obj) === 'date';\r\n    },\r\n    \r\n    /**\r\n     *   RegExp    true/false .\r\n     * @example\r\n     * olleh.maps.isDate(new RegExp()); // true\r\n     * olleh.maps.isDate(/abc/); // true\r\n     * olleh.maps.isDate({}); // false\r\n     * \r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   RegExp true\r\n     *   false .\r\n     */\r\n    isRegExp: function (obj) {\r\n      return this.typeOf(obj) === 'regexp';\r\n    },\r\n\r\n    /**\r\n     *   HTML DOM     true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isElement(document.createElement('div')); // true\r\n     * olleh.maps.isElement(document.createTextNode('foo')); // false\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @returns {Boolean}   DOM  \r\n     * true   false .\r\n     */\r\n    isElement: function (obj) {\r\n      return !!(obj && obj.nodeType === 1);\r\n    },\r\n    \r\n    /**\r\n     *   HTML DOM Fragment    true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isFragment(document.createElement('div')); // false\r\n     * olleh.maps.isFragment(document.createDocumentFragment()); // true\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @returns {Boolean}   DOM Fragment\r\n     * true   false .\r\n     */\r\n    isFragment: function (obj) {\r\n      return !!(obj && obj.nodeType === 11);\r\n    },\r\n    \r\n    /**\r\n     *   function  class    true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isFunction(123); // false\r\n     * olleh.maps.isFunction(new Function()); // true\r\n     * olleh.maps.isFunction(olleh.maps.isString); // true\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @returns {Boolean}   function true  \r\n     * false .\r\n     */\r\n    isFunction: function (obj) {\r\n      return this.typeOf(obj) === 'function';\r\n    },\r\n    \r\n    /**\r\n     *        true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isNamespace('foo'); // true\r\n     * olleh.maps.isNamespace('foo.bar'); // true\r\n     * olleh.maps.isNamespace('foo,bar'); // false\r\n     * olleh.maps.isNamespace('foo-bar'); // false\r\n     *\r\n     * @param {String} ns  \r\n     * @returns {Boolean}      \r\n     * true    false .\r\n     */\r\n    isNamespace: function (ns) {\r\n      return this.isString(ns) && /^[\\w]+(\\.[\\w]+)*$/.test(ns);\r\n    },\r\n    \r\n    /**\r\n     *      \r\n     * Boolean .\r\n     * @example\r\n     * olleh.maps.isNumber(0); // true\r\n     * olleh.maps.isNumber(2.3); // true\r\n     * olleh.maps.isNumber('foo'); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   true  \r\n     * false .\r\n     */\r\n    isNumber: function (obj) {\r\n      return typeof obj === 'number' && isFinite(obj);\r\n    },\r\n    \r\n    /**\r\n     *      \r\n     * true/false .   \r\n     * function    isFunction \r\n     *  true  .\r\n     * @example\r\n     * olleh.maps.isObject({}); // true\r\n     * olleh.maps.isObject([]); // true\r\n     * olleh.maps.isObject(new Function()); // false\r\n     * olleh.maps.isObject(new Function(), true); // true\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @param {Boolean} isFunction true  function\r\n     * true .\r\n     * @returns {Boolean}   Object  function true\r\n     *    false .\r\n     */\r\n    isObject: function (obj, isFunction) {\r\n      return obj && ((typeof obj === 'object') \r\n          || (isFunction && this.isFunction(obj))) || false;\r\n    },\r\n\r\n    /**\r\n     *   String   \r\n     * true/false .\r\n     * @example\r\n     * olleh.maps.isString(123); // false\r\n     * olleh.maps.isString('foo'); // true\r\n     * olleh.maps.isString(''); // true\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}    String true  \r\n     * false .\r\n     */\r\n    isString: function (obj) {\r\n      return typeof obj === 'string';\r\n    },\r\n    \r\n    /**\r\n     *  (obj) 'undefined'   \r\n     *  Boolean .\r\n     * @example\r\n     * olleh.maps.isUndefined(undefined); // true\r\n     * olleh.maps.isUndefined(); // true\r\n     * olleh.maps.isUndefined(null); // false\r\n     * olleh.maps.isUndefined(0); // false\r\n     * olleh.maps.isUndefined(''); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}  undefined true \r\n     *  false .\r\n     */\r\n    isUndefined: function (obj) {\r\n      return typeof obj === 'undefined';\r\n    },\r\n\r\n    /**\r\n     *        \r\n     * true/false .   undefined/null/NaN/\"\"\r\n     *   true .\r\n     * @example\r\n     * olleh.maps.isValue({}); // true\r\n     * olleh.maps.isValue([]); // true\r\n     * olleh.maps.isValue(null); // false\r\n     * olleh.maps.isValue(undefined); // false\r\n     * olleh.maps.isValue(''); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   undefined, null, NaN, \"\"  \r\n     * true    false .\r\n     */\r\n    isValue: function (obj) {\r\n      var t = this.typeOf(obj);\r\n      switch (t) {\r\n      case 'undefined':\r\n      case 'null':\r\n        return false;\r\n      case 'number':\r\n        return isFinite(obj);\r\n      case 'string':\r\n        return '' !== obj;\r\n      }\r\n      return !!(t);\r\n    },\r\n\r\n    /**\r\n     *  function   function \r\n     *       \r\n     * .     \r\n     * .\r\n     * <p/>\r\n     * @example\r\n     * function showArguments() {\r\n     *   alert(Array.prototype.join.call.join(arguments, ', '));\r\n     * }\r\n     * showArguments(1, 2, 3);\r\n     * // -> alerts \"1, 2, 3\"\r\n     * var f = olleh.maps.curry(showArguments, this, 1, 2, 3);\r\n     * f('a', 'b');\r\n     * // -> alerts \"a, b, 1, 2, 3\"\r\n     *\r\n     * @param {Function} fn   function\r\n     * @param {Object} ctx context \r\n     * @param {Arguments} [args]    \r\n     */\r\n    curry: function (fn, ctx, args) {\r\n      if (!arguments.length) {\r\n        throw new SyntaxError('method reference to curry is missing!');\r\n      }\r\n      if (arguments.length === 1) return arguments[0];\r\n      var _fn = fn, _args = Array.prototype.slice.call(arguments, 2);\r\n      return function () {\r\n        var arr = Array.prototype,\r\n            a = arr.concat.call(arr.slice.call(arguments), _args);\r\n        return _fn.apply(ctx, a);\r\n      };\r\n    },\r\n    \r\n    /**\r\n     * (src)   (dest) \r\n     *  .\r\n     * <p/>\r\n     *   (  )  \r\n     *  .\r\n     *\r\n     * @example\r\n     * var src = {\r\n     *   level: 'low',\r\n     *   opts: {one: 1, two: 2},\r\n     *   add: function (a, b) {\r\n     *     return a + b;\r\n     *   }\r\n     * };\r\n     *\r\n     * var dest = {\r\n     *   level: 'high',\r\n     *   opts: {three: 3, four: 4},\r\n     *   multiply: function (a, b) {\r\n     *     return a * b;\r\n     *   }\r\n     * }\r\n     * var d = olleh.maps.mixin(dest, src); // mixin\r\n     * d.multiply(2, 3); // 6\r\n     * d.add(2, 3); // 5 (mixed in)\r\n     * d.level; // 'high'\r\n     *\r\n     * d = olleh.maps.mixin(dest, src, true); // override\r\n     * d.level; // 'low' (overridden)\r\n     * d.opts; // {one: 1, two: 2}\r\n     *\r\n     * d = olleh.maps.mixin(dest, src, 'remix'); // 'remix'\r\n     * d.opts; // {one: 1, two: 2, three: 3, four: 4}\r\n     *\r\n     * d = olleh.maps.mixin(dest, src, true, ['level', 'add']); // 'filter'\r\n     * d.add(2, 3); // 5\r\n     * d.level; // 'low'\r\n     * d.opts; // {three: 3, four: 4}\r\n     *\r\n     * @param {Object} dest      \r\n     * @param {Object} src       \r\n     * @param {Boolean|String} [override] Override  'remix' (recursive mix)\r\n     * @param {Array} [filter]     .\r\n     * @returns {Object}      \r\n     */\r\n    mixin: function (dest, src, override, filter) {\r\n      dest = dest || {};\r\n      if (src !== dest) {\r\n        // Copy properties on override or if it doesn't already exist\r\n        for (var p in src) {\r\n          // Copy owned/filtered src properties to undefined/overriden dest\r\n          if (src.hasOwnProperty(p) && (override || dest[p] === undefined)\r\n              && (!filter || indexOf.call(filter, p) > -1)) {\r\n            // Recursively mix or overwrite to dest property\r\n            if (override === 'remix' && this.isObject(dest[p])) {\r\n              dest[p] = this.mixin(dest[p], src[p], override, filter);\r\n            } else {\r\n              dest[p] = src[p];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return dest;\r\n    },\r\n    \r\n    /**\r\n     * JavaScript  .\r\n     * <p/>\r\n     *     \r\n     *     \r\n     *      .\r\n     * <p/>\r\n     *      \r\n     *    Error .\r\n     * @example\r\n     * olleh.maps.namespace('foo.bar'); // creates namespace 'foo.bar'\r\n     * olleh.maps.namespace('foo.bar', {name: 'mobell'});\r\n     * foo.bar.name; // 'mobell'\r\n     *\r\n     * olleh.maps.namespace('foo.bar.baz', function () { return 'mobello';});\r\n     * foo.bar.baz(); // 'mobello'\r\n     *\r\n     * @param {String} ns   \r\n     * @param {Object|Function} [attach]   \r\n     *   Function\r\n     * @param {Boolean} [overwrite] true   .\r\n     * @returns {Boolean}    \r\n     * true .\r\n     * @throws {Error}      \r\n     *     \r\n     */\r\n    namespace: function (ns, attach, overwrite) {\r\n      if (!this.isNamespace(ns)) {\r\n        throw new SyntaxError('olleh.maps.namespace: invalid namespace, ' + ns);\r\n      }\r\n      \r\n      var i, len; \r\n      var parent = window;\r\n      var modified = false;\r\n      var parts = ns.split('.'); \r\n      var isFn = this.isFunction(attach);\r\n\r\n      // Validate each namespace parts (create one if it doesn't exist)\r\n      for (i = 0, len = isFn ? parts.length - 1 : parts.length; i < len; i++) {\r\n        if (typeof parent[parts[i]] === 'undefined') {\r\n          parent[parts[i]] = {};\r\n          modified = true;\r\n        } else if (!overwrite && this.isFunction(parent[parts[i]]) && i < len - 1) {\r\n          // Any parent part in the namespace must not be a function\r\n          throw new Error('olleh.maps.namespace: \\\"' + parts.slice(0, i + 1)\r\n              .join('.') + '\\\" function was previously defined in hierarchy');\r\n        }\r\n        parent = parent[parts[i]];\r\n      }\r\n      \r\n      if (isFn) {\r\n        // Function assignment for the last portion of namespace\r\n        if (overwrite || typeof parent[parts[i]] === 'undefined') {\r\n          parent[parts[i]] = attach;\r\n          modified = true;\r\n        } else {\r\n          throw new Error('olleh.maps.namespace: \\\"' + ns + '\\\" definition ' + ' already exists, cannot be overridden');\r\n        }\r\n      } else {\r\n        // Attach properties to the final namespace part; does not overwrite\r\n        for (i in attach) {\r\n          if (typeof parent[i] === 'undefined' && attach.hasOwnProperty(i)) {\r\n            parent[i] = attach[i];\r\n            modified = true;\r\n          }\r\n        }\r\n      }\r\n      \r\n      return modified;\r\n    },\r\n    \r\n    /**\r\n     * @name olleh.maps.TObject \r\n     * @class\r\n     * $class()    KT   .\r\n     *    instanceof  KT    .\r\n     * @example\r\n     * var foo = // KT   \r\n     * if (foo instanceof olleh.maps.TObject) {} // true\r\n     * @see $class\r\n     * @private\r\n     */\r\n    TObject: (function () {\r\n      var obj = function TObject() {};\r\n      \r\n      /**\r\n       *     .\r\n       * KT        .\r\n       * @example\r\n       * $class('com.mycompany.MySuper').define({\r\n       *   foo: function () { // override\r\n       *     return 'MySuper';\r\n       *   }\r\n       * });\r\n       *\r\n       * $class('com.mycompany.MyClass').extend(com.mycompany.MySuper).define({\r\n       *   foo: function () { // override\r\n       *     var msg = com.mycompany.MyClass.$super.foo.apply(this, arguments);\r\n       *     return msg + ' and MyClass';\r\n       *   }\r\n       * });\r\n       * \r\n       * @example\r\n       * var my = new com.mycompany.MyClass();\r\n       * my.foo(); // prints 'MySuper and MyClass'\r\n       *\r\n       * @name olleh.maps.TObject.$super\r\n       */\r\n      obj.$super = null;\r\n      \r\n      /**\r\n       *    .\r\n       * @example\r\n       * $class('foo.Bar').define({\r\n       *   ...\r\n       * });\r\n       * \r\n       * @example\r\n       * var bar = new foo.Bar();\r\n       * bar.$classname // 'foo.Bar'\r\n       *\r\n       * @name $classname\r\n       * @field\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @constant\r\n       * @type String\r\n       */\r\n      obj.prototype.$classname = 'olleh.maps.TObject';\r\n      \r\n      /**\r\n       *     . \r\n       * KT  foo.Bar  \r\n       *  \"[object foo.Bar]\" .\r\n       * @example\r\n       * var v = new foo.Bar();\r\n       * v.toString(); // '[object foo.Bar]'\r\n       * @name toString\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @returns {String}   \r\n       */\r\n      obj.prototype.toString = function () {\r\n        return '[object '.concat(this.$classname, ']');\r\n      };\r\n      \r\n      /**\r\n       *  callstack  .  \r\n       *       \r\n       *    .\r\n       * @example\r\n       * var aa = ...\r\n       * aa.currentStack().toString();\r\n       * // prints callstack as a String\r\n       *\r\n       * @name currentStack\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @returns {Object}  callstack  \r\n       * \r\n       */\r\n      obj.prototype.currentStack = function  () {\r\n        var that = this, current = arguments.callee.caller;\r\n        return  {\r\n          toString: function () {\r\n            var cs = ' @'.concat(that.$classname);\r\n            for(var name in that) {\r\n              if (that[name] === current) {\r\n                return cs.concat('.', name, '();');\r\n              }\r\n            }\r\n            return cs;\r\n          }\r\n        };\r\n      };\r\n\r\n      /**\r\n       *     mixin \r\n       *   true/false .\r\n       * @example\r\n       * $class('foo.Bar').mixin(foo.Baz).define({\r\n       *   ...\r\n       * });\r\n       *\r\n       * @example\r\n       * var bar = new foo.Bar();\r\n       * bar.isMixinOf(foo.Baz); // true\r\n       *\r\n       * @name isMixinOf\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @param {Object} target   mixin \r\n       *   \r\n       * @returns {Boolean}    \r\n       * mixin true   false\r\n       * .\r\n       */\r\n      obj.prototype.isMixinOf = function (target) {\r\n        var cls = this.constructor;\r\n        for (var i = 0; cls.mixins && i < cls.mixins.length; i++) {\r\n          if (cls.mixins[i] === target.prototype.$classname) {\r\n            return true;\r\n          }\r\n        }\r\n        return cls.$super ? cls.$super.isMixinOf(target) : false;\r\n      };\r\n\r\n      /**\r\n       *   Class .\r\n       * @example\r\n       * var bar = new foo.Bar();\r\n       * var clazz = bar.getClass();\r\n       * // clazz is foo.Bar\r\n       * \r\n       * @name getClass\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @returns {olleh.maps.TObject} \r\n       */\r\n      obj.prototype.getClass = function () {\r\n        return this.constructor;\r\n      };\r\n      \r\n      return obj;\r\n    })()\r\n  };\r\n  \r\n  GLOBAL.$class = (function () {\r\n    var maps = olleh.maps;\r\n    var dontEnumProperties;\r\n    var dontEnumBug = !{toString:'foo'}.propertyIsEnumerable('toString');\r\n    \r\n    // ie8  DontEnum bug\r\n    // https://developer.mozilla.org/en-US/docs/ECMAScript_DontEnum_attribute#section_2\r\n    if (dontEnumBug) {\r\n      dontEnumProperties = function (src, desc) {\r\n        if (!src || !desc) return;\r\n        \r\n        var dontEnumProps = ['toLocaleString', 'toString', 'valueOf', 'equals'];\r\n        var i = dontEnumProps.length;\r\n        var p;\r\n        \r\n        while(i--) {\r\n          p = dontEnumProps[i];\r\n          if (src.hasOwnProperty(p)) {\r\n            desc[p] = src[p];\r\n          }\r\n        }\r\n      };\r\n    }\r\n    \r\n    /**\r\n     * KT     .\r\n     * $class('foo.Bar').define({ ... }); \r\n     *        \r\n     *      \r\n     *  .     \r\n     *   .\r\n     * <p/>\r\n     * KT       \r\n     *  , , , ()  \r\n     *       .\r\n     * <ul>\r\n     *   <li>extend:  .</li> \r\n     *   <li>mixin:    \r\n     *         . </li>\r\n     *   <li>define:    .</li>\r\n     * </ul>\r\n     * :      \r\n     *     .\r\n     * @name $class\r\n     * @class\r\n     * @example\r\n     * $class('foo.Bar').extend(foo.Baz).define({\r\n     *   Bar: function () { // Constructor\r\n     *     // ...\r\n     *   },\r\n     *\r\n     *   say: function () { // Member function\r\n     *     // ...\r\n     *   }\r\n     * });\r\n     */\r\n    function $class (name) {\r\n      return {\r\n        name: name,\r\n        extend: extend,\r\n        mixin: mixin,\r\n        define: define\r\n      };\r\n    }\r\n    \r\n    /**\r\n     *    (). \r\n     *       \r\n     *        \r\n     * .     \r\n     *    .\r\n     * @example\r\n     * $class('com.mycompany.MySuper').define({\r\n     *   $static: {                     // Static variables\r\n     *     MAX_SIZE: 1000\r\n     *   },\r\n     *\r\n     *   MySuper: function (a, b) { // Class constructor\r\n     *     this._a = a;\r\n     *     this._b = b;\r\n     *   },\r\n     *\r\n     *   foo: function () { // Class member\r\n     *     return this._a + this._b;\r\n     *   },\r\n     *\r\n     *   getMax: function () {\r\n     *     return com.mycompany.MySuper.MAX_SIZE;\r\n     *   },\r\n     *   \r\n     *   $afterDefine: function () { // class define callbackFn\r\n     *     var clazz = this;\r\n     *   }\r\n     * });\r\n     *\r\n     * $class('com.mycompany.MyClass').extend(com.mycompany.MySuper).define({\r\n     *   foo: function () { // override\r\n     *     return this._a * this._b;\r\n     *   },\r\n     *\r\n     *   bar: function () { // add new function\r\n     *     return this._a - this._b;\r\n     *   }\r\n     * });\r\n     *\r\n     * @name extend\r\n     * @function\r\n     * @memberof $class\r\n     * @param {Function} superclass   .\r\n     * @returns {$class}      \r\n     * @throws {Error} superclass   \r\n     */\r\n    function extend(superclass) {\r\n      if (!olleh.maps.isFunction(superclass)) {\r\n        throw new Error('$class.extend: '+ this.name \r\n            + ' cannot extend undefined class, \\\"' + superclass + '\\\"');\r\n      }\r\n      this.sup = superclass;\r\n      delete this.extend;\r\n      return this;\r\n    }\r\n    \r\n    /**\r\n     *      \r\n     * .     \r\n     *  .\r\n     * @example\r\n     * $class('com.mycompany.MySuper').mixin(com.mycompany.Util).define({\r\n     *   ...\r\n     * });\r\n     *\r\n     * @example\r\n     * $class('com.mycompany.MySuper').mixin( // more than one class\r\n     *     com.mycompany.Util, com.mycompany.Common).define({ //\r\n     *   ...\r\n     * });\r\n     *\r\n     * @name mixin\r\n     * @function\r\n     * @memberof $class\r\n     * @param {Object} args mixin ,     .\r\n     * @returns {$class}      \r\n     */\r\n    function mixin() {\r\n      this.mixins = arguments;\r\n      delete this.mixin;\r\n      return this;\r\n    }\r\n    \r\n    /**\r\n     *   .\r\n     * <p/>\r\n     *       \r\n     *     .\r\n     * @example\r\n     * $class('com.mycompany.MySuper').define({\r\n     *   MySuper: function () { // constructor\r\n     *\r\n     *   },\r\n     *\r\n     *   foo: function (a, b) { // member function\r\n     *\r\n     *   }\r\n     * });\r\n     * <p/>\r\n     *\r\n     * @name define\r\n     * @function\r\n     * @memberof $class\r\n     * @param {Object} m    \r\n     * @throws {Error}       \r\n     */\r\n    function define(m) {\r\n      var p, len, mm;\r\n      var sup = this.sup || maps.TObject;\r\n      var name = this.name, mixins = this.mixins;\r\n      var shortname = name.substring(name.lastIndexOf('.') + 1);\r\n      \r\n      var cls = function () {\r\n        var ctor, stack = [], current = this;\r\n        \r\n        do {\r\n          stack.push(current);\r\n          current = current.constructor.$super;\r\n        } while (current);\r\n\r\n        while (current = stack.pop()) {\r\n          if (ctor = current.$constructor) {\r\n            ctor.apply(this, arguments);\r\n          }\r\n        }\r\n      };\r\n      \r\n      if (!maps.namespace(name, cls)) {\r\n        throw new Error('$class.define: \\\"' + name +'\\\" already defined');\r\n      }\r\n      \r\n      var parent = function () {};\r\n      parent.prototype = sup.prototype;\r\n      \r\n      cls.$super = sup.prototype;\r\n      cls.prototype = new parent();\r\n      cls.prototype.constructor = cls;\r\n      cls.prototype.$constructor = null;\r\n      cls.prototype.$classname = name;\r\n\r\n      var afterDefine = [];\r\n      var supCls = cls.$super;\r\n      var supClsProto;\r\n\r\n      while(supCls && supCls !== maps.TObject) {\r\n        supClsProto = supCls.constructor; \r\n        for (p = 0, len = supClsProto.mixins ? supClsProto.mixins.length : 0; p < len; p++) {\r\n          mm = supClsProto.mixins[p].prototype;\r\n          if (mm && mm.$afterDefine) {\r\n            afterDefine.push(mm.$afterDefine);\r\n          }\r\n        }\r\n        supCls = supCls.$super;\r\n      }\r\n      \r\n      // Apply mixin properties \r\n      for (p = 0, len = mixins ? mixins.length : 0; p < len; p++) {\r\n        //olleh.maps.mixin(cls.prototype, this.mixins[p]);\r\n        //tweaked for efficiency by genie\r\n        if (p === 0) {\r\n          cls.mixins = [];\r\n        }\r\n        mm = mixins[p].prototype;\r\n        if (mm) {\r\n          cls.mixins.push(mm.$classname);\r\n          if (mm.$afterDefine) {\r\n            afterDefine.push(mm.$afterDefine);\r\n          }\r\n        } else {\r\n          mm = mixins[p];\r\n        }\r\n        maps.mixin(cls.prototype, mm);\r\n      }\r\n\r\n      if (m.$afterDefine) {\r\n        afterDefine.push(m.$afterDefine);\r\n      } else if (cls.prototype.$afterDefine) {\r\n        afterDefine.push(cls.prototype.$afterDefine);\r\n      }\r\n\r\n      // Define static properties/methods\r\n      for (p in m.$static) {\r\n        if (m.$static.hasOwnProperty(p)) {\r\n          cls[p] = m.$static[p];\r\n        }\r\n      }\r\n\r\n      // Define prototype properties/methods\r\n      for (p in m) {\r\n        if (p !== '$static' && m.hasOwnProperty(p)) {\r\n          if (shortname == p) {\r\n            cls.prototype.$constructor = m[p];\r\n          }\r\n          cls.prototype[p] = m[p];\r\n        }\r\n      }\r\n      \r\n      // ie8  DontEnum bug\r\n      if (dontEnumBug) {\r\n        dontEnumProperties(m.$static, cls);\r\n        dontEnumProperties(m, cls.prototype);\r\n      }\r\n      \r\n      for (var i = 0; i < afterDefine.length; i++) {\r\n        afterDefine[i].apply(cls);\r\n      }\r\n    }\r\n    \r\n    return $class;\r\n  })();\r\n} (window);\r\n\r\n\r\nolleh.maps.namespace('olleh.maps', {\r\n  $skeleton: []\r\n});\r\n/**\r\n *    \r\n * @example\r\n * olleh.maps.env = {\r\n *   RESOURCE_URL: '../resources'\r\n * };\r\n */\r\n(function (GLOBAL) {\r\n\r\n  var PROTOCOL = location.protocol == 'https:' ? 'https:' : 'http:';\r\n  var PORT = PROTOCOL == 'https:' ? '10083' : '10080';\r\n  var VERSION = \"v=yyyymmdd\";\r\n  olleh.maps.namespace('olleh.maps.env', {\r\n    PROTOCOL: PROTOCOL,\r\n    RESOURCE_URL: PROTOCOL + '//api.ktgis.com:' + PORT + '/ollehmap/resource/v3/',\r\n    TILE_URL: {\r\n      // BASE: PROTOCOL + '//map.ktgis.com/BaseMap/olleh7.10.1_1027/layers/_alllayers/l#{z}/r#{y}/c#{x}.png',\r\n      // AIR: PROTOCOL + '//map.ktgis.com/ServiceAir/version20110705/l#{z}/r#{y}/c#{x}.jpg',\r\n      // HYBRID: PROTOCOL + '//map.ktgis.com/HybridMap/olleh6.03.1_0405_hyb/layers/_alllayers/l#{z}/r#{y}/c#{x}.png',\r\n      BASE: PROTOCOL + '//tile.gis.kt.com/current/base.default/#{z}/#{y}/#{x}.png?' + VERSION,\r\n      AIR: PROTOCOL + '//tile.gis.kt.com/current/base.satellite/#{z}/#{y}/#{x}.jpg?' + VERSION,\r\n      HYBRID: PROTOCOL + '//tile.gis.kt.com/current/overlay.hybrid/#{z}/#{y}/#{x}.png?' + VERSION,\r\n      ENG: PROTOCOL + '//tile.gis.kt.com/current/base.english/#{z}/#{y}/#{x}.png?' + VERSION,\r\n      TRAFFIC: PROTOCOL + '//roadtiledmz.ktgis.com/NTraffic/TTileServlet/256/L#{z}/R#{y}/C#{x}.png',\r\n      HD_BASE: PROTOCOL + '//map.ktgis.com/BaseMaphd/olleh5.04.1_0511_hd/layers/_alllayers/l#{z}/r#{y}/c#{x}.png',\r\n      HD_HYBRID: PROTOCOL + '//map.ktgis.com/HybridMaphd/olleh5.04.1_0511_hyb_hd/layers/_alllayers/l#{z}/r#{y}/c#{x}.png'\r\n    },\r\n    TILE_COPYRIGHT: {\r\n      BASE: ' KT corp.',\r\n      AIR: ' KT corp.',\r\n      HD_BASE: ' KT corp.'\r\n    },\r\n    LANG: GLOBAL.$LANG || 'ko',\r\n    LOG_LEVEL: 3 // 1(DEBUG), 2(INFO), 3(WARN), 4(ERROR), 5(FATAL), 6(NONE)\r\n  });\r\n})(window);\r\n!function (GLOBAL) {\r\n\r\n  var MSG = {\r\n    'en': {\r\n      '': 'roadmap',\r\n      '': 'satellite',\r\n      ' ': 'hybrid label',\r\n      ' ': 'real-time traffic',\r\n      '': 'vector',\r\n      ' ': 'Real-Time Traffic Legend',\r\n      '': 'fast',\r\n      '': 'slow',\r\n      ',': 'National Highway',\r\n      '': 'Urban Expressway',\r\n      '': 'highway',\r\n      '    ,    ': 'Clicking on the above line speed information, check detailed information available',\r\n      '         ': 'In the city roads may differ from the actual speed signal stops , etc.'\r\n    }\r\n  };\r\n\r\n  olleh.maps.namespace('olleh.maps', {\r\n\r\n    msg: function (key, lang) {\r\n      var l, m;\r\n      var lang = lang === undefined ? olleh.maps.env.LANG : lang;\r\n\r\n      if (lang === 'ko') {\r\n        return key;\r\n      }\r\n      l = MSG[lang];\r\n      if (!l) {\r\n        console.warn('unsupported language: ' + lang);\r\n        return key;\r\n      }\r\n      m = l[key];\r\n      if (!m) {\r\n        console.warn('unsupported key: ' + key);\r\n        return key;\r\n      }\r\n      return m;\r\n    }\r\n  });\r\n\r\n  olleh.maps.namespace('olleh.maps.msg', {\r\n  // TODO\r\n  });\r\n}(window);/**\r\n * browser  \r\n */\r\nolleh.maps.namespace('olleh.maps.browser', {\r\n  /**\r\n   * \r\n   * @enum {String}\r\n   */\r\n  BROWSER_NAME: {\r\n    ie: 'IE',\r\n    firefox: 'FireFox',\r\n    safari: 'Safari',\r\n    chrome: 'Chrome',\r\n    opera: 'Opera',\r\n    /**\r\n     * @ignore\r\n     */\r\n    chromeMobile: 'Chrome',\r\n    /**\r\n     * @ignore\r\n     */\r\n    chromeForAndroid: 'Chrome',\r\n    /**\r\n     * @ignore\r\n     */\r\n    chromeForIos: 'Chrome',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   *  \r\n   * @enum {String}\r\n   */\r\n  ENGINE_NAME: {\r\n    webkit: 'WebKit',\r\n    gecko: 'Gecko',\r\n    presto: 'Presto',\r\n    trident: 'Trident',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   * OS \r\n   * @enum {String}\r\n   */\r\n  OS_NAME: {\r\n    ios: 'iOS',\r\n    android: 'Android',\r\n    mac: 'Mac',\r\n    win: 'Windows',\r\n    linux: 'Linux',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   *   CSS dath(-) prefix\r\n   * @enum {String}\r\n   */\r\n  STYLE_DASH_PREFIX: {\r\n    webkit: '-webkit-',\r\n    gecko: '-moz-',\r\n    trident: '-ms-',\r\n    presto: '-o-',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   *   CSS prefix\r\n   * @enum {String}\r\n   */\r\n  STYLE_PREFIX: {\r\n    webkit: 'webkit',\r\n    gecko: 'moz',\r\n    trident: 'ms',\r\n    presto: 'o',\r\n    other: ''\r\n  },\r\n  \r\n  /**\r\n   *  \r\n   * @type olleh.maps.browser.BROWSER_NAME\r\n   */\r\n  browserName: '', // BROWSER_NAME['other']\r\n  /**\r\n   *   \r\n   * @example\r\n   * olleh.maps.browser.browserVer; // 5\r\n   * @type String\r\n   */\r\n  browserVer: '',\r\n  /**\r\n   *   \r\n   * @type olleh.maps.browser.ENGINE_NAME\r\n   */\r\n  engineName: '', // ENGINE_NAME['other']\r\n  /**\r\n   *    \r\n   * @type String\r\n   */\r\n  engineVer: '',\r\n  /**\r\n   * cross-browser     \r\n   * @type Object\r\n   * @property {String} transitionend \r\n   */\r\n  event: {}, \r\n  \r\n  /** \r\n   *    orientationchange \r\n   * .\r\n   * @type Boolean\r\n   */\r\n  hasOrientationChange: ('onorientationchange' in window),\r\n  \r\n  /** \r\n   *    touch   .\r\n   * @type Boolean\r\n   */\r\n  hasTouch: ('ontouchstart' in window) && !/chrome/i.test(window.navigator.userAgent),\r\n\r\n  /** \r\n   *    3D  .\r\n   * @type Boolean\r\n   */\r\n  has3D: false,\r\n  /**\r\n   * canvas \r\n   * @type Boolean\r\n   */\r\n  hasCanvas: !!document.createElement(\"canvas\").getContext,\r\n  /**\r\n   * HTML element pointer-events css \r\n   * @type Boolean\r\n   */\r\n  hasPointerEvents: false,\r\n  /**\r\n   * svg \r\n   * @type Boolean\r\n   */\r\n  hasSVG: document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1'),\r\n  /**\r\n   * vml \r\n   * @type Boolean\r\n   */\r\n  hasVML: (function () {\r\n    if (!document.namespaces) return false;\r\n    \r\n    var div = document.createElement('div');\r\n    div.innerHTML = '<!--[if vml]><br><![endif]-->';\r\n    return div.childNodes.length == 1;\r\n  })(),\r\n  /**\r\n   *   \r\n   * @type Boolean\r\n   */\r\n  isMobile: false,\r\n  /**\r\n   *   \r\n   * @type Boolean\r\n   */\r\n  isTablet: false,  \r\n  /**\r\n   *  OS \r\n   * @type olleh.maps.browser.OS_NAME\r\n   */\r\n  osName: '', // OS_NAME['other']\r\n  /**\r\n   *  OS \r\n   * @example\r\n   * olleh.maps.browser.osVer; // 2.3\r\n   * @type String\r\n   */\r\n  osVer: '',\r\n  /**\r\n   * cross-browser     \r\n   * @param {String} transition\r\n   */\r\n  style: {},\r\n  /**\r\n   *    dash(-) CSS prefix\r\n   * @type olleh.maps.browser.STYLE_DASH_PREFIX\r\n   */\r\n  styleDashPrefix: '', // STYLE_DASH_PREFIX['other']\r\n  /**\r\n   *    CSS prefix\r\n   * @type olleh.maps.browser.STYLE_PREFIX\r\n   */\r\n  stylePrefix: '', //STYLE_PREFIX['other']\r\n  /**\r\n   * translate template\r\n   * <pre>\r\n   *   translate3d(#{x}px,#{y}px,0) \r\n   *   translate(#{x}px,#{y}px)\r\n   * </pre>\r\n   * @type String\r\n   */\r\n  styleTranslateTmpl: '',\r\n  /**\r\n   *   vector (SVG, Canvas, VML)\r\n   * @type String\r\n   */\r\n  vector: '',\r\n\r\n  /**\r\n   *   .\r\n   * @param {String} name   \r\n   * @returns {Boolean}\r\n   * @static\r\n   */\r\n  isStyleSupported: function (name) {\r\n    var browser = olleh.maps.browser;\r\n    var bodyStyle = document.body.style;\r\n\r\n    return (name in bodyStyle) || \r\n    (browser.stylePrefix !== '' && \r\n        (browser.stylePrefix + capitalize(name) in bodyStyle));\r\n  }\r\n});\r\n\r\n\r\n!function (GLOBAL) {\r\n  var prop, browsers, engine, os;\r\n  var browser = olleh.maps.browser;\r\n  var body = document.body || document.documentElement;\r\n  var bodyStyle = body.style;\r\n  var BROWSER_NAME = browser.BROWSER_NAME;\r\n  var ENGINE_NAME = browser.ENGINE_NAME;\r\n  var OS_NAME = browser.OS_NAME;\r\n  var STYLE_DASH_PREFIX = browser.STYLE_DASH_PREFIX;\r\n  var STYLE_PREFIX = browser.STYLE_PREFIX;\r\n  var userAgent = GLOBAL.navigator.userAgent;\r\n  var enginePrefix = {\r\n    webkit: 'AppleWebKit/',\r\n    gecko: 'Gecko/',\r\n    presto: 'Presto/',\r\n    trident: 'Trident/'\r\n  };\r\n  var browserPrefix = {\r\n    ie: 'MSIE ',\r\n    firefox: 'Firefox/',\r\n    chromeMobile: 'CrMo', //  CrMo -> Chrome .    \r\n    chromeForAndroid: 'Android[\\\\W|\\\\w]*Chrome\\/',\r\n    chromeForIos: 'CriOS/',\r\n    chrome: 'Chrome/',\r\n    safari: 'Version/',\r\n    opera: 'Opera/'\r\n  };\r\n  var osPrefix = {\r\n    ios: 'i(?:Pad|Phone|Pod)(?:.*)CPU(?: iPhone)? OS ',\r\n    android: '(Android |HTC_|Silk/)', // Some HTC devices ship with an OSX userAgent by default,\r\n    // so we need to add a direct check for HTC_,\r\n    mac: 'Macintosh; Intel Mac OS X ',\r\n    win: 'Windows NT ',\r\n    linux: 'Linux; '\r\n  };\r\n  var mobile = {\r\n    other: /Mobile/,\r\n    android_tablet: /Android/,\r\n    ipad: /ipad/\r\n  };\r\n  var ics3DWhiteList = /SHW-|SHV-|GT-|SCH-|SGH-|SPH-|LG-F160|LG-F100|LG-F180|LG-F200|EK-|IM-A|LG-F240|LG-F260/;\r\n  var ics3DBlackList = /SHW-M250|SHW-M420|SHW-M200|GT-S7562/;\r\n  \r\n  var capitalize = function (str) {\r\n    return str ? str.charAt(0).toUpperCase() + str.substr(1) : '';\r\n  };\r\n  var testStyle = function (name) {\r\n    if (name in bodyStyle) {\r\n      return name;\r\n    }\r\n    return null;\r\n  };\r\n  var testPrefixedStyle = function (name) {\r\n    name = browser.stylePrefix + capitalize(name);\r\n    if (name in bodyStyle) {\r\n      return name;\r\n    }\r\n    return null;\r\n  };\r\n  \r\n  // browser, \r\n  for (prop in browserPrefix) {\r\n    browsers = userAgent.match(new RegExp(browserPrefix[prop] + '([0-9]{1,}[\\.0-9]{0,})'));\r\n\r\n    if (browsers) {\r\n      browser.browserName = BROWSER_NAME[prop];\r\n      browser.browserVer = browsers[1];\r\n      break;\r\n    }\r\n  }\r\n\r\n  // browser  , \r\n  for (prop in enginePrefix) {\r\n    engine = userAgent.match(new RegExp(enginePrefix[prop] + '([0-9]{1,}[\\.0-9]{0,})'));\r\n\r\n    if (engine) {\r\n      browser.engineName = ENGINE_NAME[prop];\r\n      browser.engineVer = engine[1];\r\n      browser.styleDashPrefix = STYLE_DASH_PREFIX[prop] || '';\r\n      browser.stylePrefix = STYLE_PREFIX[prop] || '';\r\n      break;\r\n    }\r\n  }\r\n\r\n  // OS , \r\n  for (prop in osPrefix) {\r\n    os = userAgent.match(new RegExp(osPrefix[prop] + '([0-9]{1,}[\\.0-9]{0,})'));\r\n\r\n    if (os) {\r\n      browser.osName = OS_NAME[prop];\r\n      browser.osVer = os[2] || os[1];\r\n      break;\r\n    }\r\n  }\r\n\r\n  //  \r\n  if (mobile.other.test(userAgent)) {\r\n    browser.isMobile = true;\r\n\r\n    if (mobile.ipad.test(userAgent))\r\n      browser.isTablet = true;\r\n\r\n  } else if (mobile.android_tablet.test(userAgent)) {\r\n    browser.isMobile = true;\r\n    browser.isTablet = true;\r\n  }\r\n  browser.style = {\r\n    transition: testPrefixedStyle('transition') || testStyle('transition'),\r\n    transform:\r\n      // #3764 Windows Safari tranform  object tag     \r\n      browser.osName == 'Windows' && browser.browserName == 'Safari' ? null :\r\n        testStyle('transform') || testPrefixedStyle('transform'),\r\n    transformOrigin: testStyle('transformOrigin') || testPrefixedStyle('transformOrigin'),\r\n    backgroundSize:\r\n      // #3728:   3d transform  sprited image    repaint    \r\n      //        backgroundSize   false  SpritedImage  background image   img  \r\n      browser.osName == 'Windows' && browser.browserName == 'Chrome' ? null :  \r\n        testStyle('backgroundSize'),\r\n    opacity: (browser.osName == 'Android' && browser.osVer >= '4.2.2' && browser.osVer < '4.3') ? null : testStyle('opacity'), // #1285\r\n    userSelect: testStyle('userSelect') || testPrefixedStyle('userSelect') || {\r\n      get: function (elem) {\r\n        return elem.getAttribute('unselectable') == 'on' ? 'none' : 'auto';\r\n      },\r\n      set: function (elem, value) {\r\n        if (value === 'none') {\r\n          elem.setAttribute('unselectable', 'on');\r\n        } else {\r\n          elem.removeAttribute('unselectable');\r\n        }\r\n      }\r\n    }\r\n  };\r\n  \r\n  browser.event = {\r\n    transitionend: (function () {\r\n      var transition = browser.style.transition;\r\n      if (transition) {\r\n        if (transition == 'transition' || transition == 'msTransition') {\r\n          return 'transitionend';\r\n        }\r\n        if (transition == 'oTransition' && parseFloat(browser.browserVer) >= 12) {\r\n          return 'otransitionend';\r\n        }\r\n        return transition + 'End';\r\n      }\r\n      return null;\r\n    })()\r\n  };\r\n  \r\n  browser.isHD = false;//window.devicePixelRatio > 1;\r\n  browser.isHDTile = (function() {\r\n    if(!browser.isHD)\r\n      return false;\r\n    if(browser.osName == 'Android')\r\n      return browser.osVer >= '4.3';\r\n    return true;\r\n  })();\r\n\r\n  browser.has3D = (function () {\r\n    if (!browser.style.transform) {\r\n      return false;\r\n    }\r\n    if (!testStyle('perspective') && !testPrefixedStyle('perspective')) {\r\n      return false;\r\n    }\r\n    //   \r\n    if (browser.osName == 'Android') {\r\n      // ICS    \r\n      if (browser.osVer < '4.0.3') {\r\n        return false;\r\n      }\r\n      // ICS  whiteList  blackList    ,   \r\n      if (browser.osVer < '4.1.0') {\r\n        if (!ics3DWhiteList.test(userAgent) || ics3DBlackList.test(userAgent)) {\r\n          return false;\r\n        }\r\n      }\r\n      // 4.2.2 3D       (#1285)\r\n      // -G 4.1.2  3D    (2013/07/01)\r\n      if (browser.osVer < '4.1.0' && browser.browserName === 'Chrome') {\r\n        return false;\r\n      }\r\n      //    \r\n    }\r\n    return true;\r\n  })();\r\n  \r\n  browser.usePulseForZoom = !browser.isMobile;\r\n  \r\n  browser.use3DRootPane = (function () {\r\n    if (!browser.has3D) {\r\n      return false;\r\n    }\r\n    if (browser.osName == 'Android') {\r\n      return false;\r\n    }\r\n    // #2945, #3528\r\n    if (browser.osName != 'iOS' && browser.browserName == 'Safari') {\r\n      return false;\r\n    } \r\n    return true;\r\n  })();\r\n\r\n  browser.hotfixAndroid = (function () {\r\n    if (browser.osName !== 'Android') {\r\n      return false;\r\n    }\r\n    // android    \r\n    var ver = browser.browserVer;\r\n    if (ver) {\r\n      var majorVers = ver.split('.');\r\n      var majorVer = majorVers.length > 0 ? majorVers[0] : 0;\r\n      if (majorVer < 43) { // Lollipop \r\n        return true;\r\n      }\r\n    }\r\n    return false; \r\n  })();\r\n\r\n  browser.hasPointerEvents = ('pointer-events' in bodyStyle) && browser.browserName !== browser.BROWSER_NAME.ie;\r\n  \r\n  browser.vector = browser.hasSVG ? 'SVG' : browser.hasCanvas ? 'Canvas' : browser.hasVML ? 'VML' : '';\r\n  \r\n  browser.styleTranslateTmpl = browser.has3D ? 'translate3d(#{x}px,#{y}px,0)' : 'translate(#{x}px,#{y}px)';\r\n  \r\n  browser.styleScaleTmpl = browser.has3D ? 'scale3d(#{scale}, #{scale}, 1)' : 'scale(#{scale}, #{scale})';\r\n\r\n}(window);\r\nolleh.maps.namespace('olleh.maps', {\r\n  /**\r\n   *   .\r\n   * <pre>\r\n   *  Log levels (tau.log.*):\r\n   *   DEBUG  : 1 (default)\r\n   *   INFO   : 2\r\n   *   WARN   : 3 \r\n   *   ERROR  : 4\r\n   *   FATAL  : 5\r\n   *   NONE   : 6\r\n   * </pre>\r\n   * @example\r\n   * olleh.maps.log('olleh.maps'); // \"olleh.maps\"\r\n   * olleh.maps.log('olleh.maps', 1); // \"[614] olleh.maps\" (614 is milliseconds)\r\n   * olleh.maps.log('olleh.maps', 3, 'debug'); // \"[debug] olleh.maps\"\r\n   * olleh.maps.log('olleh.maps', 3, this, {$tag: 'event'}); // \"@event:[olleh.maps.XXX] olleh.maps\"\r\n   * @param {String} msg   \r\n   * @param {Number} [level=1] : 1(debug) - 6(none),  1(debug)\r\n   * @param {String|Class} [src]    \r\n   * @param {Object} [opts] \r\n   * @param {String} [opts.$tag]  .\r\n   * @returns {String}   \r\n   */\r\n  log: function (msg, level, src, opts) {\r\n    if (olleh.maps.isUndefined(window.console))\r\n      return msg;\r\n    var config = this.log.config, _level = this.log.LEVEL, _class, _package, _tag;\r\n    if (config) {\r\n      _tag = config.$tag;\r\n      // config  tag      .\r\n      if (_tag && _tag.length && olleh.maps.util.indexOf(_tag, opts.$tag) == -1)\r\n        return;\r\n\r\n      if (src && (_class = src.$classname)) {\r\n        _package = _class.substring(0, _class.lastIndexOf('.'));\r\n      }\r\n\r\n      if (_class && _class !== '' && config[_class]) {\r\n        _level = config[_class];\r\n      } else if (_package && _package !== '') {\r\n        while (_package !== '' && !(_level = config[_package])) {\r\n          _package = _package.substring(0, _package.lastIndexOf('.'));\r\n        }\r\n      }\r\n      _level = _level || this.log.LEVEL;\r\n    }\r\n    if (_level <= (olleh.maps.isUndefined(level) ? olleh.maps.log.DEBUG : level)) {\r\n      // Prepends class/context from which the logging is done\r\n      if (level == this.log.DEBUG) {\r\n        msg = '[' + new Date().getMilliseconds() + '] ' + msg;\r\n      }\r\n      if (this.isString(src)) {\r\n        msg = '[' + src + '] ' + msg;\r\n      } else if (this.isObject(src) && src.$classname) {\r\n        msg = '[' + src.$classname + '] ' + msg;\r\n      }\r\n      console.log(msg);\r\n    }\r\n    return msg;\r\n  }\r\n});\r\n\r\n/** \r\n * log\r\n * @example\r\n * olleh.maps.log.LEVEL = olleh.maps.log.DEBUG;\r\n * olleh.maps.log.config = {\r\n *   tag: ['event', 'test1'],\r\n *   'olleh.maps': olleh.maps.log.DEBUG,\r\n *   'olleh.maps.Marker': olleh.maps.log.DEBUG\r\n * };\r\n * \r\n * olleh.maps.log.debug('message....', olleh.maps.log.DEBUG, {tag: 'test1'});\r\n */\r\nolleh.maps.namespace('olleh.maps.log', {\r\n\r\n  LEVEL: olleh.maps.env.LOG_LEVEL !== undefined ? olleh.maps.env.LOG_LEVEL : 3, // Logging level \r\n  DEBUG: 1,\r\n  INFO: 2,\r\n  WARN: 3,\r\n  ERROR: 4,\r\n  FATAL: 5,\r\n  NONE: 6,\r\n\r\n  /**\r\n   * log   config\r\n   * @example\r\n   * olleh.maps.log.config.$tag = ['event', 'test1', 'test2']; //\r\n   * olleh.maps.log.config['com.Test'] = olleh.maps.log.DEBUG; //   .\r\n   * olleh.maps.log.config['com.test'] = olleh.maps.log.DEBUG; //   .\r\n   * @type {Object} \r\n   */\r\n  config: {},\r\n\r\n  /** Checks if the current logging level */\r\n  isLevel: function (level) {\r\n    return this.LEVEL <= level;\r\n  },\r\n  /** Debug logging */\r\n  debug: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.DEBUG, src, opts);\r\n  },\r\n  /** Information logging */\r\n  info: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.INFO, src, opts);\r\n  },\r\n  /** Warning logging */\r\n  warn: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.WARN, src, opts);\r\n  },\r\n  /** Error logging */\r\n  error: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.ERROR, src, opts);\r\n  },\r\n  /** Fatal logging */\r\n  fatal: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.FATAL, src, opts);\r\n  }\r\n});\r\n/**\r\n * Map Utility .\r\n */\r\nolleh.maps.namespace('olleh.maps.util', {\r\n\r\n  /**\r\n   * The number of significant digits to retain to avoid floating point\r\n   * precision errors.\r\n   *\r\n   * We use 14 as a \"safe\" default because, although IEEE 754 double floats\r\n   * (standard on most modern operating systems) support up to about 16\r\n   * significant digits, 14 significant digits are sufficient to represent\r\n   * sub-millimeter accuracy in any coordinate system that anyone is likely to\r\n   * use with OpenLayers.\r\n   *\r\n   * If DEFAULT_PRECISION is set to 0, the original non-truncating behavior\r\n   * of OpenLayers <2.8 is preserved. Be aware that this will cause problems\r\n   * with certain projections, e.g. spherical Mercator.\r\n   * @type {Number}\r\n   */\r\n  DEFAULT_PRECISION: 14,\r\n\r\n  /**\r\n   *       .\r\n   *   .\r\n   * <pre>\r\n   *   inches :       U.S. Surveyor's Inch\r\n   *   ft:\r\n   *   mi:\r\n   *   m:\r\n   *   km:\r\n   *   dd:\r\n   *   yd:\r\n   *   in:            inches \r\n   *   degrees:       dd \r\n   *   nmi:           International Nautical Mile\r\n   *   Inch:          inches \r\n   *   Meter:         EPSG:9001\r\n   *   Foot:          EPSG:9003\r\n   *   IFoot:         EPSG:9002\r\n   *   ClarkeFoot:    EPSG:9005\r\n   *   SearsFoot:     EPSG:9041\r\n   *   GoldCoastFoot: EPSG:9094\r\n   *   IInch:\r\n   *   MicroInch:\r\n   *   Mil:\r\n   *   Centimeter:\r\n   *   Kilometer:     EPSG:9036\r\n   *   Yard:          U.S. Surveyor's Yard\r\n   *   SearsYard:     EPSG:9040\r\n   *   IndianYard:    EPSG:9084\r\n   *   IndianYd37:    EPSG:9085\r\n   *   IndianYd62:    EPSG:9086\r\n   *   IndianYd75:    EPSG:9087\r\n   *   IndianFoot:    EPSG:9080\r\n   *   IndianFt37:    EPSG:9081\r\n   *   IndianFt62:    EPSG:9082\r\n   *   IndianFt75:    EPSG:9083\r\n   *   Mile:          U.S. Surveyor's Statute Mile\r\n   *   IYard:         EPSG:9096\r\n   *   IMile:         EPSG:9093\r\n   *   NautM:         EPSG:9030\r\n   *   Lat-66:\r\n   *   Lat-83:\r\n   *   Decimeter:\r\n   *   Millimeter:\r\n   *   Dekameter:\r\n   *   Decameter:\r\n   *   Hectometer:\r\n   *   GermanMeter:   EPSG:9031\r\n   *   CaGrid:\r\n   *   ClarkeChain:   EPSG:9038\r\n   *   GunterChain:   EPSG:9033\r\n   *   BenoitChain:   EPSG:9062\r\n   *   SearsChain:    EPSG:9042\r\n   *   ClarkeLink:    EPSG:9039\r\n   *   GunterLink:    EPSG:9034\r\n   *   BenoitLink:    EPSG:9063\r\n   *   SearsLink:     EPSG:9043\r\n   *   Rod:\r\n   *   IntnlChain:    EPSG:9097\r\n   *   IntnlLink:     EPSG:9098\r\n   *   Perch:\r\n   *   Pole:\r\n   *   Furlong:\r\n   *   Rood:\r\n   *   CapeFoot:\r\n   *   Brealey:\r\n   *   ModAmFt:\r\n   *   Fathom:        International Fathom\r\n   *   NautM-UK:\r\n   *   50kilometers:\r\n   *   150kilometers:\r\n   *   \r\n   *   mm:            Milimeter \r\n   *   cm:            Centimeter \r\n   *   dm:            \r\n   *   km:            Kilometer \r\n   *   kmi:           nmi \r\n   *   fath:          Fathom \r\n   *   ch:            IntnlChain \r\n   *   lnk:           IntnlLink \r\n   *   us-in:         inches \r\n   *   us-ft:         Foot \r\n   *   us-yd:         Yard \r\n   *   us-ch:         GunterChain \r\n   *   us-mi::        Mile \r\n   *   ind-yd:        IndianYd37 \r\n   *   ind-ft:        IndianFt37 \r\n   *   ind-ch:        Indian Chain\r\n   * </pre>\r\n   * @type {Object}\r\n   */\r\n  INCHES_PER_UNIT: (function () {\r\n    var meters_per_inch = .02540005080010160020;\r\n    var inches_per_unit = {\r\n      'inches': 1.0,\r\n      'ft': 12.0,\r\n      'mi': 63360.0,\r\n      'm': 39.3701,\r\n      'km': 39370.1,\r\n      'dd': 4374754,\r\n      'yd': 36,\r\n      \"nmi\": 1852 * 39.3701,\r\n      \"in\": 1.0, // inches\r\n      \"degrees\": 4374754 // dd\r\n    };\r\n\r\n    olleh.maps.mixin(inches_per_unit, { // Units from CS-Map\r\n      \"Inch\": 1.0,\r\n      \"Meter\": 1.0 / meters_per_inch, //EPSG:9001\r\n      \"Foot\": .30480060960121920243 / meters_per_inch, //EPSG:9003\r\n      \"IFoot\": .30480000000000000000 / meters_per_inch, //EPSG:9002\r\n      \"ClarkeFoot\": .3047972651151 / meters_per_inch, //EPSG:9005\r\n      \"SearsFoot\": .30479947153867624624 / meters_per_inch, //EPSG:9041\r\n      \"GoldCoastFoot\": .30479971018150881758 / meters_per_inch, //EPSG:9094\r\n      \"IInch\": .02540000000000000000 / meters_per_inch,\r\n      \"MicroInch\": .00002540000000000000 / meters_per_inch,\r\n      \"Mil\": .00000002540000000000 / meters_per_inch,\r\n      \"Centimeter\": .01000000000000000000 / meters_per_inch,\r\n      \"Kilometer\": 1000.00000000000000000000 / meters_per_inch, //EPSG:9036\r\n      \"Yard\": .91440182880365760731 / meters_per_inch,\r\n      \"SearsYard\": .914398414616029 / meters_per_inch, //EPSG:9040\r\n      \"IndianYard\": .91439853074444079983 / meters_per_inch, //EPSG:9084\r\n      \"IndianYd37\": .91439523 / meters_per_inch, //EPSG:9085\r\n      \"IndianYd62\": .9143988 / meters_per_inch, //EPSG:9086\r\n      \"IndianYd75\": .9143985 / meters_per_inch, //EPSG:9087\r\n      \"IndianFoot\": .30479951 / meters_per_inch, //EPSG:9080\r\n      \"IndianFt37\": .30479841 / meters_per_inch, //EPSG:9081\r\n      \"IndianFt62\": .3047996 / meters_per_inch, //EPSG:9082\r\n      \"IndianFt75\": .3047995 / meters_per_inch, //EPSG:9083\r\n      \"Mile\": 1609.34721869443738887477 / meters_per_inch,\r\n      \"IYard\": .91440000000000000000 / meters_per_inch, //EPSG:9096\r\n      \"IMile\": 1609.34400000000000000000 / meters_per_inch, //EPSG:9093\r\n      \"NautM\": 1852.00000000000000000000 / meters_per_inch, //EPSG:9030\r\n      \"Lat-66\": 110943.316488932731 / meters_per_inch,\r\n      \"Lat-83\": 110946.25736872234125 / meters_per_inch,\r\n      \"Decimeter\": .10000000000000000000 / meters_per_inch,\r\n      \"Millimeter\": .00100000000000000000 / meters_per_inch,\r\n      \"Dekameter\": 10.00000000000000000000 / meters_per_inch,\r\n      \"Decameter\": 10.00000000000000000000 / meters_per_inch,\r\n      \"Hectometer\": 100.00000000000000000000 / meters_per_inch,\r\n      \"GermanMeter\": 1.0000135965 / meters_per_inch, //EPSG:9031\r\n      \"CaGrid\": .999738 / meters_per_inch,\r\n      \"ClarkeChain\": 20.1166194976 / meters_per_inch, //EPSG:9038\r\n      \"GunterChain\": 20.11684023368047 / meters_per_inch, //EPSG:9033\r\n      \"BenoitChain\": 20.116782494375872 / meters_per_inch, //EPSG:9062\r\n      \"SearsChain\": 20.11676512155 / meters_per_inch, //EPSG:9042\r\n      \"ClarkeLink\": .201166194976 / meters_per_inch, //EPSG:9039\r\n      \"GunterLink\": .2011684023368047 / meters_per_inch, //EPSG:9034\r\n      \"BenoitLink\": .20116782494375872 / meters_per_inch, //EPSG:9063\r\n      \"SearsLink\": .2011676512155 / meters_per_inch, //EPSG:9043\r\n      \"Rod\": 5.02921005842012 / meters_per_inch,\r\n      \"IntnlChain\": 20.1168 / meters_per_inch, //EPSG:9097\r\n      \"IntnlLink\": .201168 / meters_per_inch, //EPSG:9098\r\n      \"Perch\": 5.02921005842012 / meters_per_inch,\r\n      \"Pole\": 5.02921005842012 / meters_per_inch,\r\n      \"Furlong\": 201.1684023368046 / meters_per_inch,\r\n      \"Rood\": 3.778266898 / meters_per_inch,\r\n      \"CapeFoot\": .3047972615 / meters_per_inch,\r\n      \"Brealey\": 375.00000000000000000000 / meters_per_inch,\r\n      \"ModAmFt\": .304812252984505969011938 / meters_per_inch,\r\n      \"Fathom\": 1.8288 / meters_per_inch,\r\n      \"NautM-UK\": 1853.184 / meters_per_inch,\r\n      \"50kilometers\": 50000.0 / meters_per_inch,\r\n      \"150kilometers\": 150000.0 / meters_per_inch\r\n    });\r\n\r\n    olleh.maps.mixin(inches_per_unit, { //unit abbreviations supported by PROJ.4\r\n      \"mm\": inches_per_unit[\"Meter\"] / 1000.0,\r\n      \"cm\": inches_per_unit[\"Meter\"] / 100.0,\r\n      \"dm\": inches_per_unit[\"Meter\"] * 100.0,\r\n      \"km\": inches_per_unit[\"Meter\"] * 1000.0,\r\n      \"kmi\": inches_per_unit[\"nmi\"], //International Nautical Mile\r\n      \"fath\": inches_per_unit[\"Fathom\"], //International Fathom\r\n      \"ch\": inches_per_unit[\"IntnlChain\"], //International Chain\r\n      \"link\": inches_per_unit[\"IntnlLink\"], //International Link\r\n      \"us-in\": inches_per_unit[\"inches\"], //U.S. Surveyor's Inch\r\n      \"us-ft\": inches_per_unit[\"Foot\"], //U.S. Surveyor's Foot\r\n      \"us-yd\": inches_per_unit[\"Yard\"], //U.S. Surveyor's Yard\r\n      \"us-ch\": inches_per_unit[\"GunterChain\"], //U.S. Surveyor's Chain\r\n      \"us-mi\": inches_per_unit[\"Mile\"], //U.S. Surveyor's Statute Mile\r\n      \"ind-yd\": inches_per_unit[\"IndianYd37\"], //Indian Yard\r\n      \"ind-ft\": inches_per_unit[\"IndianFt37\"], //Indian Foot\r\n      \"ind-ch\": 20.11669506 / meters_per_inch //Indian Chain\r\n    });\r\n    \r\n    return inches_per_unit;\r\n  })(),\r\n\r\n  /**\r\n   * dot  \r\n   * @type Number\r\n   */\r\n  DOTS_PER_INCH: 72,\r\n\r\n  /**\r\n   * Unique id seed (incremented as new IDs are created)\r\n   * @type {Number}\r\n   */\r\n  _ID_SEED: new Date().getTime(),\r\n\r\n  /**\r\n   *     .\r\n   * <p/>\r\n   *  <code>null</code>  <code>''</code>\r\n   *  prefix     id\r\n   *  .\r\n   * @example\r\n   * olleh.maps.util.genId(); // \"ollehmap1339376987400\"\r\n   * olleh.maps.util.getId(null); // 1339376987401\r\n   * olleh.maps.util.genId(''); // \"1339376987402\"\r\n   * olleh.maps.util.genId('olleh'); // \"olleh1339376987403\"\r\n   *\r\n   * @param {String} [prefix]  id  prefix (default: 'ollehmap') \r\n   * @returns {String}   id\r\n   */\r\n  genId: function (prefix) {\r\n    return (olleh.maps.isUndefined(prefix) ? 'ollehmap' : (prefix || '')) + (++olleh.maps.util._ID_SEED);\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @example\r\n   * olleh.maps.util.radToDeg(1.5707963267948966); // 90.0000000000002\r\n   * @param {Float} degree \r\n   * @returns {Float}\r\n   */\r\n  radToDeg: function (radian) {\r\n    return radian * 180 / Math.PI;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @example\r\n   * olleh.maps.util.degToRad(90); //  90  . 1.5707963267948966\r\n   * @param {Float} degree \r\n   * @returns {Float}\r\n   */\r\n  degToRad: function (degree) {\r\n    return degree * Math.PI / 180; //  Math.PI / 180 : 1 \r\n  },\r\n\r\n  /**\r\n   * Convenience method to cast an object to a Number, rounded to the\r\n   * desired floating point precision.\r\n   * @param {Number|String} num Number   Number .\r\n   * @param {Number} [precision=olleh.maps.util.DEFAULT_PRECISION] An integer suitable for use with\r\n   *      Number.toPrecision(). If set to 0, no rounding is performed. \r\n   * @returns {Number} The cast, rounded number\r\n   * @throws {TypeError} num Number type ,       .\r\n   */\r\n  toFloat: function (num, precision) {\r\n    olleh.maps.isString(num) && (num = parseFloat(num));\r\n\r\n    if (!olleh.maps.isNumber(num))\r\n      throw new TypeError('Specified num is not Number type: ' + num);\r\n\r\n    precision = precision || olleh.maps.util.DEFAULT_PRECISION;\r\n\r\n    return precision === 0 ? num : parseFloat(num.toPrecision(precision));\r\n  },\r\n\r\n  /**\r\n   * (scale) ('km', 'cm'...)  resolution .\r\n   * @example\r\n   * olleh.maps.util.getResolutionFromScale(25000);\r\n   * olleh.maps.util.getResolutionFromScale(1/25000);\r\n   * @param {Number} scale\r\n   * @param {String} [units='Meter'] {@link olleh.maps.util.INCHES_PER_UNIT}   .\r\n   * @returns {Number}\r\n   * @throws {TypeError} scale Number     .\r\n   */\r\n  getResolutionFromScale: function (scale, units) {\r\n    if (!olleh.maps.isNumber(scale))\r\n      throw new TypeError('Specified scale is not Number type: ' + scale);\r\n\r\n    var resolution;\r\n    if (scale) {\r\n      units = units || \"Meter\"; // olleh map  Meter?\r\n      var normScale = (scale > 1.0) ? (1.0 / scale) : scale;\r\n      resolution = 1 / (normScale * this.INCHES_PER_UNIT[units] * this.DOTS_PER_INCH);\r\n    }\r\n    return resolution;\r\n  },\r\n\r\n  /**\r\n   * resolution ('km', 'cm'...)  (scale) .\r\n   * @example\r\n   * olleh.maps.util.getScaleFromResolution(1024);\r\n   * olleh.maps.util.getScaleFromResolution(2048);\r\n   * @param {Number} resolution\r\n   * @param {String} [units='Meter'] {@link olleh.maps.util.INCHES_PER_UNIT}   .\r\n   * @returns {Number}\r\n   * @throws {TypeError} resolution Number     .\r\n   */\r\n  getScaleFromResolution: function (resolution, units) {\r\n    if (!olleh.maps.isNumber(resolution))\r\n      throw new TypeError('Specified resolution is not Number type: ' + resolution);\r\n\r\n    return resolution * this.INCHES_PER_UNIT[units || \"Meter\"] * this.DOTS_PER_INCH;\r\n  },\r\n\r\n  /**\r\n   *   place holder    .\r\n   *  Place Holder  data property   \r\n   * '#{'  '}' .\r\n   * @example\r\n   * var tmpl = '<h2>#{title}</h2><p>#{content}</p>';\r\n   * var data = {title: 'Some title', content: 'Some cool content coming...'};\r\n   * var result = olleh.maps.util.applyTemplate(tmpl, data);\r\n   * // result value is '<h2>Some title</h2><p>Some cool content coming...</p>'\r\n   * @param {String} tmpl  \r\n   * @param {Object} data      JSON\r\n   */\r\n  applyTemplate: function (tmpl, data) {\r\n    var item, to, regexp = /#\\{(\\w+)\\}/g;\r\n    while (item = regexp.exec(tmpl)) {\r\n      to = data[item[1]];\r\n      if (to !== undefined && to !== null) {\r\n        tmpl = tmpl.replace(new RegExp(item[0], 'g'), to);\r\n        regexp.lastIndex = item.index;\r\n      }\r\n    }\r\n    return tmpl;\r\n  },\r\n\r\n  /**\r\n   *   elem    .\r\n   * @param {Array} arr\r\n   * @param {Object} elem   element\r\n   * @param {Number} fromIndex   \r\n   * @returns {Number}\r\n   * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.14\r\n   */\r\n  indexOf: function (arr, elem, fromIndex) {\r\n    var indexOf = arr.indexOf;\r\n\r\n    if (indexOf) {\r\n      return indexOf.call(arr, elem, fromIndex);\r\n    }\r\n\r\n    if (!olleh.maps.isArray(arr)) {\r\n      throw new TypeError();\r\n    }\r\n    var len = arr.length;\r\n    if (len === 0) {\r\n      return -1;\r\n    }\r\n    var n = 0;\r\n    if (arguments.length > 2) {\r\n      n = Number(fromIndex);\r\n      if (n != n) {\r\n        n = 0;\r\n      } else if (n != 0 && n != Infinity && n != -Infinity) {\r\n        n = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n      }\r\n    }\r\n    if (n >= len) {\r\n      return -1;\r\n    }\r\n    var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\r\n    for (; k < len; k++) {\r\n      if (arr[k] === elem) {\r\n        return k;\r\n      }\r\n    }\r\n    return -1;\r\n  },\r\n\r\n  /**\r\n   *   elem    .\r\n   * @param {Array} arr\r\n   * @param {Object} elem   element\r\n   * @param {Number} fromIndex   \r\n   * @returns {Number}\r\n   * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.15\r\n   */\r\n  lastIndexOf: function (arr, elem, fromIndex) {\r\n    var lastIndexOf = arr.lastIndexOf;\r\n\r\n    if (lastIndexOf) {\r\n      return lastIndexOf.call(arr, elem, olleh.maps.isNumber(fromIndex) ? fromIndex : -1);\r\n    }\r\n\r\n    if (!olleh.maps.isArray(arr)) {\r\n      throw new TypeError();\r\n    }\r\n    var len = arr.length;\r\n    if (len === 0) {\r\n      return -1;\r\n    }\r\n    var n = len;\r\n    if (arguments.length > 2) {\r\n      n = Number(fromIndex);\r\n      if (n != n) {\r\n        n = 0;\r\n      } else if (n != 0 && n != Infinity && n != -Infinity) {\r\n        n = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n      }\r\n    }\r\n\r\n    var k = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);\r\n    for (; k >= 0; k--) {\r\n      if (arr[k] === elem) {\r\n        return k;\r\n      }\r\n    }\r\n    return -1;\r\n  },\r\n\r\n  /**\r\n   * Array    .\r\n   * @param {Array} arr\r\n   * @param {Object} toRemove\r\n   * @returns {Number}      index,    -1\r\n   */\r\n  removeFromArray: function (arr, toRemove) {\r\n    var index = olleh.maps.util.indexOf(arr, toRemove);\r\n    if (index > -1) {\r\n      arr.splice(index, 1);\r\n    }\r\n    return index;\r\n  },\r\n\r\n  /**\r\n   *  \r\n   * @param {String} string\r\n   * @returns {String}\r\n   */\r\n  trim: function (string) {\r\n    var trim = string.trim;\r\n\r\n    if (trim) {\r\n      return trim.call(string);\r\n    }\r\n\r\n    var str = string.replace(/^\\s+/, \"\");\r\n    var end = str.length - 1;\r\n    var ws = /\\s/;\r\n\r\n    while (ws.test(str.charAt(end))) {\r\n      end--;\r\n    }\r\n\r\n    return str.slice(0, end + 1);\r\n  },\r\n\r\n  /**\r\n   * src   dest   .\r\n   * @param {Object} dest  \r\n   * @param {Object} src  \r\n   * @param {Array} excludes     \r\n   */\r\n  copyOpts: function (dest, src, excludes) {\r\n    var p;\r\n    for (p in src) {\r\n      if (src.hasOwnProperty(p) && (!excludes || olleh.maps.util.indexOf(excludes, p) === -1)) {\r\n        dest[p] = src[p];\r\n      }\r\n    }\r\n    return dest;\r\n  },\r\n\r\n  /**\r\n   * @param {Object} object\r\n   * @returns {Object}\r\n   */\r\n  clone: function (object) {\r\n    var i, clone;\r\n    if (object == null) {\r\n      clone = null;\r\n    } else if (olleh.maps.isObject(object)) {\r\n      if (olleh.maps.isArray(object)) {\r\n        clone = [];\r\n        for(i = 0; i < object.length ; i++) {\r\n          clone[i] = olleh.maps.util.clone(object[i]);\r\n        }\r\n      } else if (olleh.maps.isDate(object)) {\r\n        clone = new Date(object.getTime());\r\n      } else if (olleh.maps.isRegExp(object)) {\r\n        clone = new RegExp(object.source);\r\n      } else if (object.clone) {\r\n        clone = object.clone();\r\n      } else {\r\n        clone = {};\r\n        for (i in object) {\r\n          if (object.hasOwnProperty(i)) {\r\n            clone[i] = object[i];\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      clone = object;\r\n    }\r\n    return clone;\r\n  },\r\n  \r\n  /**\r\n   * string  prefix    .\r\n   * @returns {Boolean} string  prefix   true\r\n   */\r\n  startsWith: function(str, prefix) {\r\n    return str.slice(0, prefix.length) === prefix;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * @param {Function} fn  \r\n   * @param {Number} milis  \r\n   * @param {Object} [ctx] context \r\n   * @param {Any} [args...]   \r\n   */\r\n  delay: function (fn, milis, ctx, args) {\r\n    args = Array.prototype.slice.call(arguments, 3);\r\n    var curried = Function.prototype.bind.apply(fn, [ctx].concat(args));\r\n    return window.setTimeout(curried, milis);\r\n  },\r\n  \r\n  /**\r\n   *       .\r\n   * @param {Function} fn  \r\n   * @param {Object} [ctx] context \r\n   * @param {Any} [args...]   \r\n   */\r\n  defer: function (fn, ctx, args) {\r\n    args = Array.prototype.slice.call(arguments, 2);\r\n    return olleh.maps.util.delay.apply(this, [fn, 1, ctx].concat(args));\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * @param {Function} fn  \r\n   * @param {Object} [ctx] context \r\n   * @param {Any} [args...]   \r\n   */\r\n  deferAF: function (fn, ctx, args) {\r\n    args = Array.prototype.slice.call(arguments, 2);\r\n    //var curried = Function.prototype.bind.apply(fn, [ctx].concat(args)); \r\n    //bind  requestAnimationFrame    timeStamp   \r\n    var curried = olleh.maps.curry.apply(this, [fn, ctx].concat(args));\r\n    return window.requestAnimationFrame(curried);\r\n  }\r\n  \r\n});\r\n/**\r\n * DOM    .\r\n * <h3>DOM Element   </h3>\r\n * <ul>\r\n *   <li>{@link olleh.maps.util.dom.getStyle}</li>\r\n *   <li>{@link olleh.maps.util.dom.getComputedStyle}</li>\r\n *   <li>{@link olleh.maps.util.dom.setStyle}</li>\r\n *   <li>{@link olleh.maps.util.dom.setStyles}</li>\r\n *   <li>{@link olleh.maps.util.dom.addClass}</li>\r\n *   <li>{@link olleh.maps.util.dom.hasClass}</li>\r\n *   <li>{@link olleh.maps.util.dom.removeClass}</li>\r\n *   <li>{@link olleh.maps.util.dom.toggleClass}</li>\r\n * </ul>\r\n * <h3>DOM Element  </h3>\r\n * <ul>\r\n *   <li>{@link olleh.maps.util.dom.elementOf}</li>\r\n *   <li>{@link olleh.maps.util.dom.pushElement}</li>\r\n *   <li>{@link olleh.maps.util.dom.popElement}</li>\r\n *   <li>{@link olleh.maps.util.dom.removeElements}</li>\r\n * </ul>\r\n * <h3>DOM Element </h3>\r\n * <ul>\r\n *   <li>{@link olleh.maps.util.dom.getXY}</li>\r\n * </ul>\r\n */\r\nolleh.maps.namespace('olleh.maps.util.dom', {\r\n  \r\n  /**\r\n   * CSS UNIT\r\n   * @private\r\n   */\r\n  CSS_UNITS: ['in', 'cm', 'mm', 'em', 'ex', 'pt', 'pc', 'px'],\r\n  \r\n  /**\r\n   * DOM element        .\r\n   * @example\r\n   * \r\n   * var elem = document.getElementById('div1');\r\n   * elem.style['background'] = 'red';\r\n   * var value = olleh.maps.util.dom.getStyle(elem, 'background');  // red\r\n   * \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} style  . Camel Notation .background-image -> backgroundImage\r\n   * @returns {String} DOM Element   \r\n   */\r\n  getStyle: function (elem, style) {\r\n    if (!olleh.maps.isElement(elem)) {\r\n      olleh.maps.log.error('Specified elem is not HTML Element: ' + elem);\r\n      return;\r\n    }\r\n\r\n    style = olleh.maps.browser.style[style] || style;\r\n    if (style.get) {\r\n      return style.get(elem);\r\n    }\r\n    return elem.style[style];\r\n  },\r\n\r\n  /**\r\n   * DOM Element    .\r\n   * @example\r\n   * \r\n   * var elem = document.getElementById('div1');\r\n   * ...\r\n   * \r\n   * var value = olleh.maps.util.dom.getComputedStyle(elem, 'width');\r\n   *  \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} style  . Camel Notation .background-image -> backgroundImage\r\n   * @returns {String}   DOM Element  \r\n   */\r\n  getComputedStyle: function (elem, style) {\r\n    var ns = olleh.maps.util.dom;\r\n    var n, t = null;\r\n\r\n    var browserStyle = olleh.maps.browser.style;\r\n    if (browserStyle[style]) {\r\n      style = browserStyle[style];\r\n      if (style.get) {\r\n        return style.get(elem);\r\n      }\r\n    }\r\n    \r\n    if (elem.currentStyle) {\r\n      t = elem.currentStyle[style];\r\n      if (t == 'auto') {\r\n        n = ns.hyphenToCamelCase('offset-' + style);\r\n        if (n in elem) {\r\n          t = elem[n];\r\n        } else {\r\n          t = '0';\r\n        }\r\n      }\r\n    } else if (window.getComputedStyle) {\r\n      t = document.defaultView.getComputedStyle(elem, null).getPropertyValue(\r\n          ns.camelCaseToHyphen(style));\r\n    }\r\n\r\n    if (t == 'none') {\r\n      if (style == 'transform') {\r\n        t = 'matrix(1,0,0,1,0,0)';\r\n      }\r\n    }\r\n    \r\n    return t || ns.getStyle(elem, style);\r\n  },\r\n  \r\n  /**\r\n   * DOM Element   .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.setStyle(elem, 'width', '100px');\r\n   * olleh.maps.util.dom.setStyle(elem, 'paddingLeft', '10px');\r\n   * var value = olleh.maps.util.dom.getStyle(elem, 'width'); // 100px\r\n   * @param {HTMLElement} elem HTML \r\n   * @param {String} style  . Camel Notation .background-image -> backgroundImage \r\n   * @param {String} value  \r\n   * @see olleh.maps.util.dom.getStyle\r\n   */\r\n  setStyle: function (elem, style, value) {\r\n    if (!olleh.maps.isElement(elem)) {\r\n      olleh.maps.log.error('Specified elem is not HTML Element: ' + elem);\r\n      return;\r\n    }\r\n    \r\n    var browserStyle = olleh.maps.browser.style;\r\n    \r\n    if (browserStyle[style]) {\r\n      style = browserStyle[style];\r\n      if (style.set) {\r\n        style.set(elem, value);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    elem.style[style] = value;\r\n  },\r\n\r\n  /**\r\n   * DOM Element  json    .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.setStlyes(elem, {\r\n   *   'width': '100px',\r\n   *   'height': '200px',\r\n   *   'backgroundColor': 'red'\r\n   * });\r\n   * @param {HTMLElement} elem HTML element\r\n   * @param {Object} styles style name  value   Object Literals\r\n   * @param {String} styles.style  . Camel Notation .background-image -> backgroundImage\r\n   * @param {String} styles.value  \r\n   * @see olleh.maps.util.dom.setStyle \r\n   */\r\n  setStyles: function (elem, styles) {\r\n    var setStyle = olleh.maps.util.dom.setStyle;\r\n    for (var k in styles) {\r\n      setStyle(elem, k, styles[k]);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  DOM Element className .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo1');\r\n   * olleh.maps.util.dom.addClass(elem, 'foo2');\r\n   * \r\n   * @param {HTMLElement} elem HTML DOM Element\r\n   * @param {String} className CSS  \r\n   * @returns {Boolean}  CSS class  <code>true</code> .\r\n   */\r\n  addClass: function (elem, className) {\r\n    if (!elem || !className) {\r\n      return false;\r\n    }\r\n    var classList = elem.classList;\r\n    if (classList) {\r\n      classList.add(className);\r\n      return true;\r\n    } else if (olleh.maps.isString(elem.className)){\r\n      if (!olleh.maps.util.dom.hasClass(elem, className)) {\r\n        elem.className += (elem.className ? ' ' : '') + className;\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  DOM Element CSS className  \r\n   *   .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo')); // true\r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} className CSS \r\n   * @returns {Boolean}  className   <code>true</code> .\r\n   */\r\n  hasClass: function (elem, className) {\r\n    if (elem) {\r\n      var classList = elem.classList;\r\n      if (classList) {\r\n        return classList.contains(className);\r\n      } else {\r\n        var elemClassName = elem.className;\r\n        return (olleh.maps.isString(elemClassName) && \r\n            elemClassName.length > 0 && (elemClassName == className || \r\n            new RegExp('\\\\b' + className + '\\\\b').test(elemClassName)));\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  HTML DOM className .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo')); // true\r\n   * olleh.maps.util.dom.removeClass(elem, 'foo');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo')); // false \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} className css  \r\n   * @returns {Boolean}  CSS class  <code>true</code> .\r\n   */\r\n  removeClass: function (elem, className) {\r\n    if (elem && className) {\r\n      var classList = elem.classList;\r\n      if (classList) {\r\n        classList.remove(className);\r\n      } else {\r\n        if (olleh.maps.isString(elem.className)) {\r\n          elem.className = elem.className.replace(new RegExp(\"(^|\\\\s+)\" + \r\n              className + \"(\\\\s+|$)\"), ' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  DOM Element oldClassName   newClassName   .<p/>\r\n   *  oldClassName    newClassName  .\r\n   * @exmple\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo1');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // true\r\n   * olleh.maps.util.dom.replaceClass(elem, 'foo2');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // false \r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo2')); // true \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} oldC    \r\n   * @param {String} newC    \r\n   * @returns {Boolean}     <code>true</code> .\r\n   */\r\n  replaceClass: function (elem, oldC, newC) {\r\n    if (elem) {\r\n      var classList = elem.classList;\r\n      if (classList) {\r\n        if (oldC) {\r\n          classList.remove(oldC);\r\n        }\r\n        classList.add(newC);\r\n      } else {\r\n        var ns = olleh.maps.util.dom;\r\n        if (ns.hasClass(elem, oldC)) {\r\n          elem.className = elem.className.replace(new RegExp(\"(^|\\\\s+)\" + \r\n              oldC + \"(\\\\s+|$)\"), ' ' + newC).replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n        } else {\r\n          ns.addClass(elem, newC);\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  DOM Element oldClassName   newClassName   .<p/>\r\n   *  oldClassName    newClassName  .\r\n   * @exmple\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo1');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // true\r\n   * olleh.maps.util.dom.toggleClass(elem, 'foo1');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // false\r\n   * olleh.maps.util.dom.toggleClass(elem, 'foo1'); \r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // true\r\n   * @param {HTMLElement} dom HTML DOM Element\r\n   * @param {String} oldClassName    \r\n   * @param {String} newClassName    \r\n   * @returns {Boolean}     true .\r\n   */\r\n  toggleClass: function (elem, name) {\r\n    var ns = olleh.maps.util.dom;\r\n    return ns.hasClass(elem, name) ? ns.removeClass(elem, name) : ns.addClass(elem, name);\r\n  },\r\n\r\n  /**\r\n   *  id   HTML  \r\n   * .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * var div1 = olleh.maps.util.dom.elementOf('div1');\r\n   * \r\n   * olleh.maps.log.info(elem === div1);  // true\r\n \r\n   * @param {String|Object} id  id  HTMLElement id\r\n   *  element DOM element  \r\n   * @return {HTMLElement} DOM element specified by the id\r\n   */\r\n  elementOf: function (id) {\r\n    return id ? document.getElementById(id) : null;\r\n  },\r\n\r\n  /**\r\n   *  HTML (elem) parent  \r\n   * child .\r\n   * @param {HTMLElement} parent  DOM Element\r\n   * @param {HTMLElement} elem  DOM Element\r\n   * @returns {Boolean}  (elm)  \r\n   * true .\r\n   */\r\n  pushElement: function (parent, elem) {\r\n    if (parent.children && parent.children[0]) {\r\n      return parent.insertBefore(elem, parent.children[0]) !== null;\r\n    } else {\r\n      return parent.appendChild(elem) !== null;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * parent  Child   child\r\n   *    .\r\n   * @param {HTMLElement} parent  DOM Element\r\n   * @param {HTMLElement} elem  DOM Element\r\n   */\r\n  popElement: function (parent, elem) {\r\n    if (!parent) {\r\n      parent = elem.parent;\r\n    }\r\n    if (parent && elem && parent.removeChild(elem)) {\r\n      return elem;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  /** \r\n   *  HTML     .\r\n   *   comma(,)   \r\n   *  .\r\n   * @example\r\n   * olleh.maps.util.dom.removeElements(div1);\r\n   * olleh.maps.util.dom.removeElements(div1, div2, div3);\r\n   * olleh.maps.util.dom.removeElements([div1, div2, div3]);\r\n   * \r\n   * @param {...HTMLElement|Array.<HTMLElement>} elem  DOM Element. DOM Element   1  DOM Element  .\r\n   * @returns {Array.<HTMLElement>}  HTML DOM Element \r\n   */\r\n  removeElements: function (elem) {\r\n    var i, e, r, elems, removed;\r\n    var ns = olleh.maps.util.dom;\r\n    if (arguments.length === 1 && elem.parentNode) {\r\n      return elem.parentNode.removeChild(elem); // Remove a single DOM element\r\n    } else if (arguments.length > 1) {\r\n      elems = arguments; // Multiple parameters\r\n    } else if (!olleh.maps.isString(elem) && elem.length) {\r\n      elems = elem; // Single array parameter\r\n    }\r\n\r\n    // Handles Paramter/Element list removal\r\n    removed = [];\r\n    if (elems) {\r\n      i = elems.length;\r\n      while(i--) {\r\n        e = elems[i];\r\n        r = null;\r\n        if (e.length) {\r\n          r = ns.removeElements(e); // Recursively remove a list\r\n        } else if (e.parentNode) {\r\n          r = e.parentNode.removeChild(e); // Remove single DOM directly\r\n        }\r\n\r\n        // Update removed DOM list\r\n        if (olleh.maps.isArray(r)) {\r\n          removed.unshift.apply(removed, r);\r\n        } else if (r) {\r\n          removed.unshift(r);\r\n        }\r\n      }\r\n    }\r\n    return removed;\r\n  },\r\n\r\n  /** \r\n   * CSS      .\r\n   * @example\r\n   * olleh.maps.util.extractValueFromStyle('200px') == 200.0 // true\r\n   * @TODO olleh.maps.util  \r\n   * @param {String} str CSS  \r\n   * @returns {Number} CSS  \r\n   */\r\n  extractValueFromStyle: function (str) {\r\n    try {\r\n      var result = parseFloat(str);\r\n      if (isNaN(result)) {\r\n        return 0;\r\n      }\r\n      return result;\r\n    } catch (e) {\r\n      return 0;\r\n    }\r\n  },\r\n\r\n  /** \r\n   * CSS   .\r\n   * @example\r\n   * olleh.maps.util.extractValueFromStyle('200px') == 'px' // true\r\n   * @TODO olleh.maps.util  \r\n   * @param {String} str CSS  \r\n   * @returns {String} CSS  \r\n   */\r\n  extractUnitFromStyle: function (str) {\r\n    if (str === \"\") {\r\n      return \"\";\r\n    }\r\n    var value = olleh.maps.util.dom.extractValueFromStyle(str);\r\n    var unit = str.replace(value, \"\");\r\n    return unit;\r\n  },\r\n\r\n  /**\r\n   *         translate3d .\r\n   *    translate .\r\n   * @example\r\n   * var str = olleh.maps.util.getTranslateString(100px, 100px); // translate3d(100px,100px,0)  translate(100px,100px)\r\n   * @TODO olleh.maps.util  \r\n   * @param {Number} x x offset\r\n   * @param {Number} y y offset\r\n   * @param {Boolean} use3D <code>false</code> 3D   3D  .\r\n   * @returns {String}\r\n   */\r\n  getTranslateString: function (x, y, use3D) {\r\n    var tmpl = olleh.maps.browser.has3D && use3D !== false ? 'translate3d(#{x}px, #{y}px, 0px)' : 'translate(#{x}px, #{y}px)';\r\n    return olleh.maps.util.applyTemplate(tmpl, {\r\n      x: x,\r\n      y: y\r\n    });\r\n  },\r\n\r\n  /**\r\n   *         scale3d .\r\n   *    scale .\r\n   * @example\r\n   * var str = olleh.maps.util.getScaleString(100px, 100px); // scale3d(2,2,1)  scale(2,2)\r\n   * @TODO olleh.maps.util  \r\n   * @param {Number} scale scale\r\n   * @param {Boolean} use3D <code>false</code> 3D   3D  .\r\n   * @returns {String}\r\n   */\r\n  getScaleString: function (scale, use3D) {\r\n    var tmpl = olleh.maps.browser.has3D && use3D !== false ? 'scale3d(#{scale}, #{scale}, 1)' : 'scale(#{scale}, #{scale})';\r\n    return olleh.maps.util.applyTemplate(tmpl, {\r\n      scale: scale\r\n    });\r\n  },\r\n  \r\n\r\n  /**\r\n   * Position   left, top     json  .\r\n   * transform     \r\n   *   left/top   .\r\n   * @example\r\n   * olleh.maps.util.getPositionStyles(100, 100); // {left: 100px, top: 100px}\r\n   * olleh.maps.util.getPositionStyles(100, 100, true); // translate3d(100px,100px,0)  translate(100px,100px)\r\n   * @TODO olleh.maps.util  \r\n   * @param {Number} x x offset\r\n   * @param {Number} y y offset\r\n   * @param {Boolean} useTransform <code>false</code> transform   transform  .\r\n   * @param {Boolean} use3D <code>false</code> 3D   3D  . \r\n   * @returns {{transform: String} | {left: String, top: String}}\r\n   */\r\n  getPositionStyles: function (x, y, useTransform, use3D) {\r\n    if (useTransform !== false && olleh.maps.browser.style.transform) {\r\n      return {\r\n        transform: olleh.maps.util.dom.getTranslateString(x, y, use3D)\r\n      };\r\n    }\r\n    return {\r\n      left: x + 'px',\r\n      top: y + 'px'\r\n    };\r\n  },\r\n\r\n  /**\r\n   * json       .\r\n   * <p/>\r\n   *  animation      DOM Element     .\r\n   * @example\r\n   * olleh.maps.util.getPointFromStyle({left: 100px, top: 100px, background: red});\r\n   * olleh.maps.util.getPointFromStyle({translate(100px, 200px), background: red});\r\n   * olleh.maps.util.getPointFromStyle({translate3d(100px, 200px, 0), background: red});\r\n   * @TODO olleh.maps.util  \r\n   * @param {Object} styles\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  getPointFromStyle: function (style) {\r\n    var x = 0, y = 0;\r\n    if (style.transform) {\r\n      var parsed = olleh.maps.util.dom.parseStyleValue(style.transform);\r\n      loop: for (var i = 0; i < parsed.length; i++) {\r\n        var params = parsed[i].params;\r\n        switch (parsed[i].name) {\r\n        case 'translate': // translate(tx,ty)\r\n        case 'translate3d': // translate3d(tx,ty,tz)\r\n          x = params[0].value;\r\n          y = params[1].value;\r\n          break loop;\r\n        case 'matrix': // matrix(1,0,0,1,tx,ty)\r\n          x = params[4].value;\r\n          y = params[5].value;\r\n          break loop;\r\n        case 'matrix3d': // matrix3d(1,0,0,0, 0,1,0,0, 0,0,1,0, tx,ty,tz,1)\r\n          x = params[12].value;\r\n          y = params[13].value;\r\n          break loop;\r\n        }\r\n      }\r\n    } else {\r\n      style.left && (x = style.left);\r\n      style.top && (y = style.top);\r\n    }\r\n    return new olleh.maps.Point(parseFloat(x), parseFloat(y));\r\n  },\r\n\r\n  /**\r\n   * viewport(body)  DOM element x,y  .\r\n   * @param {HTMLElement} elem DOM element\r\n   * @return {olleh.maps.Point} viewport(body)  element x,y  . {x: 10, y:20} \r\n   */\r\n  getXY: function (elem) {\r\n    var webkitConvert = window.webkitConvertPointFromNodeToPage;\r\n    if (webkitConvert) {\r\n      var point = webkitConvert(elem, new WebKitPoint(0, 0));\r\n      return new olleh.maps.Point(point.x, point.y);\r\n    }\r\n    var rect = elem.getBoundingClientRect();\r\n    var pageXOffset = 0, pageYOffset = 0; \r\n    if (olleh.maps.isNumber(window.pageXOffset) && olleh.maps.isNumber(window.pageYOffset)) {\r\n      pageXOffset = window.pageXOffset;\r\n      pageYOffset = window.pageYOffset;\r\n    } else {\r\n      var body = document.body;\r\n      var browser = olleh.maps.browser;\r\n      var ie8 = (browser.browserName === browser.BROWSER_NAME.ie) &&(browser.browserVer < 9);\r\n\r\n      pageXOffset = body.scrollLeft;\r\n      pageYOffset = body.scrollTop +  ie8 ? document.documentElement.scrollTop : 0;\r\n    }\r\n    \r\n    return new olleh.maps.Point(rect.left + pageXOffset, rect.top + pageYOffset)._round();\r\n  },\r\n  \r\n  /**\r\n   *   CSS  camelCase .\r\n   * @example\r\n   * olleh.maps.util.hyphenToCamelCase('margin-top') === 'marginTop';\r\n   * olleh.maps.util.hyphenToCamelCase('-webkit-transition') === 'webkitTransition'\r\n   * @TODO olleh.maps.util  \r\n   * @params {String}   CSS \r\n   * @returns {String} camelCase  CSS \r\n   */\r\n  hyphenToCamelCase: function (str) {\r\n    if(str.lastIndexOf('-', 0) === 0)\r\n      str = str.substr(1);\r\n    return str.replace(/-([a-z])/g, olleh.maps.util.dom._cbHyphenToCamelCase);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cbHyphenToCamelCase: function (_, c) {\r\n    return c.toUpperCase();\r\n  },\r\n\r\n  /**\r\n   * camelCase  CSS   .\r\n   * @example\r\n   * olleh.maps.util.hyphenToCamelCase('marginTop') === 'margin-top';\r\n   * olleh.maps.util.hyphenToCamelCase('webkitTransition') === '-webkit-transition'\r\n   * @TODO olleh.maps.util  \r\n   * @params {String} camelCase  CSS \r\n   * @returns {String}   CSS \r\n   */\r\n  camelCaseToHyphen: function (str) {\r\n    var result = str.replace(/([A-Z])/g, olleh.maps.util.dom._cbCamelCaseToHyphen);\r\n    if(result.lastIndexOf('webkit-', 0) === 0 || result.lastIndexOf('moz-', 0) === 0\r\n        || result.lastIndexOf('ms-', 0) === 0 || result.lastIndexOf('o-', 0) === 0) {\r\n      result = '-' + result;\r\n    }\r\n    return result;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cbCamelCaseToHyphen: function (_, c) {\r\n    return '-' + c.toLowerCase();\r\n  },\r\n  \r\n  /**\r\n   * @param {Array} value \r\n   * @TODO olleh.maps.util  \r\n   * @returns {Array}\r\n   */\r\n  parseStyleValue: function (value) {\r\n    var trim = olleh.maps.util.trim; \r\n    var uv = olleh.maps.util.dom.getUnitAndValue;\r\n    var i, c, stack = [], opts = [], methodParams = [], methodName = null;\r\n    \r\n    if (!value) return opts;\r\n    value = '' + value;\r\n    \r\n    for (i = 0; i < value.length; i++) {\r\n      c = value.charAt(i);\r\n      if (c == '(') {\r\n        methodName = trim(stack.join(''));\r\n        stack.length = 0;\r\n        continue;\r\n      } else if (c == ')') {\r\n        if (stack.length > 0) {\r\n          methodParams.push(uv(trim(stack.join(''))));\r\n          stack = [];\r\n        }\r\n        opts.push({\r\n          name: methodName,\r\n          params: methodParams\r\n        });\r\n        methodName = null;\r\n        methodParams = [];\r\n        continue;\r\n      } else if (c == ',' && methodName) {\r\n        if (stack.length > 0) {\r\n          methodParams.push(uv(trim(stack.join(''))));\r\n          stack = [];\r\n        }\r\n      } else if(c == ' ' && !methodName) {\r\n        if(stack.length > 0) {\r\n          opts.push(uv(stack.join('')));\r\n          stack = [];\r\n        }\r\n      } else {\r\n        stack.push(c);\r\n      }\r\n    }\r\n    if (stack.length > 0) {\r\n      opts.push(uv(stack.join('')));\r\n    }\r\n    return opts;\r\n  },\r\n  \r\n  /**\r\n   * @param {Array} parsedStyle\r\n   * @TODO olleh.maps.util   \r\n   * @returns {String}\r\n   */\r\n  parsedStyleToString: function (parsedStyle) {\r\n    var i, j, s, methodResult, result = [];\r\n    \r\n    if (!parsedStyle) return '';\r\n    \r\n    for (i = 0; i < parsedStyle.length; i++) {\r\n      s = parsedStyle[i];\r\n      if (s.name) {\r\n        methodResult = [];\r\n        for (j = 0; j < s.params.length; j++) {\r\n          methodResult.push(s.params[j].value + s.params[j].unit);\r\n        }\r\n        result.push(s.name + '(' + methodResult.join(', ') + ')');\r\n      } else {\r\n        result.push(s.value + s.unit);\r\n      }\r\n    }\r\n    return result.join(' ');\r\n  },\r\n  \r\n  /** \r\n   * CSS      .\r\n   * px, em, %  , rgb(), url()    .\r\n   *       .\r\n   *        .\r\n   *          split   .\r\n   *  \r\n   * @example \r\n   * olleh.maps.util.extractValueFromStyle('200px') === [200, 'px'];\r\n   * olleh.maps.util.extractValueFromStyle('0') === [0, ''];\r\n   * olleh.maps.util.extractValueFromStyle('blue') === ['blue', ''];\r\n   * olleh.maps.util.extractValueFromStyle('rgb(10,20,30)') === ['rgb(10,20,30)', ''];\r\n   * olleh.maps.util.extractValueFromStyle('200px 100px') === ['200px 100px', ''];\r\n   * @TODO olleh.maps.util  \r\n   * @param {String} str CSS  \r\n   * @returns {Array} 0: CSS  , 1: CSS  \r\n   */\r\n  getUnitAndValue: function (str) {\r\n    var i, unit, value, floatValue;\r\n    var CSS_UNITS = olleh.maps.util.dom.CSS_UNITS;\r\n          \r\n    if (str == '') {\r\n      return { unit: '', value: '' };\r\n    }\r\n    \r\n    if (str.slice(-1) == '%') {\r\n      unit = '%';\r\n      value = str.slice(0, -1);\r\n    } else {\r\n      i = olleh.maps.util.indexOf(CSS_UNITS, str.slice(-2));\r\n      if (i == -1) {\r\n        unit = '';\r\n        value = str;\r\n      } else {\r\n        unit = CSS_UNITS[i];\r\n        value = str.slice(0, -2);\r\n      }\r\n    }\r\n    \r\n    floatValue = parseFloat(value);\r\n    \r\n    if (floatValue != value) {\r\n      return { unit: '', value: value + unit };\r\n    } \r\n    return { unit: unit, value: floatValue };\r\n  }\r\n});\n/**\r\n *         .\r\n * KT      /    Adaptable  \r\n *  . Adpatable      \r\n * setMap(map)    setMap(null)   .\r\n * Adaptable  mixin    extend   mixin   .\r\n * @group Base \r\n */\r\n$class('olleh.maps.Adaptable').define({\r\n  \r\n  /**\r\n   *  \r\n   * @name map\r\n   * @field\r\n   * @memberof olleh.maps.Adaptable.prototype\r\n   * @type olleh.maps.Map\r\n   */\r\n  /**\r\n   * Service Id. Service Id      \r\n   * {@link olleh.maps.Map#services}    serviceId  key \r\n   *     .\r\n   * @name serviceId\r\n   * @field\r\n   * @memberof olleh.maps.Adaptable.prototype \r\n   * @type String\r\n   */\r\n  \r\n  /**\r\n   *     .\r\n   * @return {boolean}    <code>true</code>,    <code>false</code>\r\n   */\r\n  isAttached: function () {\r\n    return !!this.map;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @return {olleh.maps.Map}     {@link olleh.maps.Map} ,    <code>null</code>. \r\n   */\r\n  getMap: function () {\r\n    return this.map;\r\n  },\r\n  \r\n  /**\r\n   *  Adaptable   .\r\n   * @param {olleh.maps.Map|null} map Adaptable   . <code>null</code>     . \r\n   */\r\n  setMap: function (map) {\r\n    if (this.map != map) {\r\n      if (this.map) {\r\n        this._unregisterService();\r\n        this.detach();\r\n      }\r\n      this.map = map;\r\n      if (this.map) {\r\n        this._registerService();\r\n        this.attach();\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  map service registry  \r\n   * @private\r\n   */\r\n  _unregisterService: function() {\r\n    if(this.serviceId) {\r\n      this.map.services[this.serviceId] === this && delete this.map.services[this.serviceId];\r\n    }\r\n  },\r\n\r\n  /**\r\n   * service id    map service registry  \r\n   * @private\r\n   */\r\n  _registerService: function() {\r\n    if(this.serviceId) {\r\n      if(this.map.services[this.serviceId])\r\n        olleh.maps.log('[Warning] Duplicate service id: ' + this.serviceId);\r\n      else\r\n        this.map.services[this.serviceId] = this;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     . {@link olleh.maps.Adaptable} \r\n   *          .\r\n   *     {@link olleh.maps.Adaptable#map}   Adaptable   {@link olleh.maps.Map}  .\r\n   */\r\n  attach: function () {\r\n  },\r\n\r\n  /**\r\n   *     . {@link olleh.maps.Adaptable} \r\n   *          .\r\n   *     {@link olleh.maps.Adaptable#map}  Adaptable   {@link olleh.maps.Map}  .\r\n   */\r\n  detach: function () {\r\n  }\r\n});\r\n/**\n * PluginInfo  Plugin    . \n * @typedef olleh.maps.PluginInfo \n * @property {String} [label] PluginControl    \n * @property {String} [group] group   PluginControl   .\n * @property {Boolean} [autoActivate=false] true  plugin      activate()  . \n * @property {boolean} [drawingTool=false] Drawing tool  . Drawing tool   plugin    plugin  active \r\n *  drawing tool plugin   deactivate .  \r\n */\n\n/**\n * Plugin   /      interface . \n */\n$class('olleh.maps.Plugin').mixin(olleh.maps.Adaptable).define({\n\n  /**\n   * Plugin     .\n   * @name olleh.maps.Plugin#pluginInfo\n   * @type olleh.maps.PluginInfo\n   */\n  /**\n   * pluginInfo    .  pluginInfo    \n   *   .\n   * @param {olleh.maps.PluginInfo} \n   */\n  setPluginInfo: function(pluginInfo) {\n    var current = olleh.maps.util.clone(this.pluginInfo);\n    this.pluginInfo = olleh.maps.mixin(current, pluginInfo, true);\n  },\n\n  /**\n   *  Plugin   .    .\n   * @param {olleh.maps.Map|null} map Plugin   . <code>null</code>     . \n   */\n  setMap: function (map) {\n    if (this.map != map) {\n      if (this.map) {\n        this._unregisterService();\n        this.map.pluginRegistry.remove(this);\n        this.deactivate();\n        this.detach();\n      }\n      this.map = map;\n      if (map) {\n        this._registerService();\n        this.map.pluginRegistry.add(this);\n        this.attach();\n        if(this.pluginInfo && this.pluginInfo.autoActivate) {\n          if(map.isStarted()) {\n            this.activate();\n          } else {\n            var callActivate = function() {\n              this.activate();\n              this.map.unsubscribeEvent(callActivate);\n            };\n            map.onEvent('started', callActivate, this);\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Plugin   .    .\n   * @returns {Boolean}\n   */\n  isActive: function () {\n    return !!this._active;\n  },\n\n  /**\n   * Plugin  .   .\n   */\n  activate: function () {\n    if (!this.isAttached() || this.isActive())\n      return;\n    if(this.map && this.pluginInfo && this.pluginInfo.drawingTool) {\n      this.map.pluginRegistry.drawingToolActivate(this);\n    }\n    this.doActivate();\n    this.setActive(true);\n  },\n\n  /**\n   *  activate  deactive   \n   * @name plugin_state_changed\n   * @event\n   * @memberOf olleh.maps.PluginRegistry.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   * active    fire .\n   * doActivate()          activate()   . \n   * @param active\n   * @private \n   */\n  setActive: function(active) {\n    this._active = active;\n    if(this.map) {\n      this.map.pluginRegistry.fireEvent('plugin_state_changed', {\n        plugin: this,\r\n        active: active\r\n      });\n    }\n  },\n\n  /**\n   * Plugin  .    .\n   */\n  deactivate: function () {\n    if (!this.isAttached() || !this.isActive())\n      return;\n    this.doDeactivate();\n    this.setActive(false);\n  },\n\n  /**\n   * Plugin     . Plugin        .\n   * @private \n   */\n  doActivate: function () {\n    // Clients should implments this\n  },\n\n  /**\n   * Plugin     . Plugin        .\n   * @private\n   */\n  doDeactivate: function () {\r\n    // Clients should implments this\n  }\n\n});\n/**\r\n *             \r\n *     .\r\n * \r\n *             \r\n *             .\r\n *             \r\n *           .<p/>\r\n * \r\n * ,              \r\n *            .<p/>\r\n * \r\n * {@link olleh.maps.Initializable}        \r\n *    {@link olleh.maps.Initializable#init}  \r\n *       callback  .  {@link olleh.maps.Initializable#init} \r\n *              .<p/>\r\n\r\n *   olleh.maps.Initializable      setMap \r\n *  foo.Bar  foo.Baz  opts property \r\n * setMap           . <p/>\r\n *        init    \r\n *      . \r\n * @example\r\n * $('foo.Bar').extend(olleh.maps.Initializable).define({\r\n *   Bar: function (opts) {\r\n *     this.opts = opts;\r\n *     //this.setMap(opts.map); <-- erroneous use\r\n *   },\r\n *   \r\n *   init: function () { // called back after instance construction\r\n *     this.setMap(this.opts.map);\r\n *   },\r\n *   \r\n *   setMap: function (map) {\r\n *     ...\r\n *   },\r\n *   \r\n *   ...\r\n * });\r\n * \r\n * $('foo.Baz').extend(foo.Bar).define({\r\n *   Baz: function (opts) {\r\n *     // tweak opts properties\r\n *     this.opts.xxx = ...\r\n *   }\r\n * });\r\n */\r\n$class('olleh.maps.Initializable').define({\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  Initializable: function () {\r\n    var $constructor = this.$constructor;\r\n    if ($constructor) {\r\n      // wrap origin constructor and do indirect call\r\n      this.$constructor = function () {\r\n        $constructor.apply(this, arguments);\r\n        this.init();\r\n      };\r\n    } else {\r\n      this.$constructor = this.init;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *         callback . Initializable \r\n   *   init         . \r\n   */\r\n  init: function () {\r\n    // do nothing\r\n  }\r\n});/*\nAuthor:       Mike Adair madairATdmsolutions.ca\n              Richard Greenwood rich@greenwoodmap.com\nLicense:      LGPL as per: http://www.gnu.org/copyleft/lesser.html\n\n$Id: Proj.js 2956 2007-07-09 12:17:52Z steven $\n*/\n\n/**\n * Namespace: Proj4js\n *\n * Proj4js is a JavaScript library to transform point coordinates from one \n * coordinate system to another, including datum transformations.\n *\n * This library is a port of both the Proj.4 and GCTCP C libraries to JavaScript. \n * Enabling these transformations in the browser allows geographic data stored \n * in different projections to be combined in browser-based web mapping \n * applications.\n * \n * Proj4js must have access to coordinate system initialization strings (which\n * are the same as for PROJ.4 command line).  Thes can be included in your \n * application using a <script> tag or Proj4js can load CS initialization \n * strings from a local directory or a web service such as spatialreference.org.\n *\n * Similarly, Proj4js must have access to projection transform code.  These can\n * be included individually using a <script> tag in your page, built into a \n * custom build of Proj4js or loaded dynamically at run-time.  Using the\n * -combined and -compressed versions of Proj4js includes all projection class\n * code by default.\n *\n * Note that dynamic loading of defs and code happens ascynchrously, check the\n * Proj.readyToUse flag before using the Proj object.  If the defs and code\n * required by your application are loaded through script tags, dynamic loading\n * is not required and the Proj object will be readyToUse on return from the \n * constructor.\n * \n * All coordinates are handled as points which have a .x and a .y property\n * which will be modified in place.\n *\n * Override Proj4js.reportError for output of alerts and warnings.\n *\n * See http://trac.osgeo.org/proj4js/wiki/UserGuide for full details.\n*/\n\n/**\n * Global namespace object for Proj4js library\n */\nvar Proj4js = {\n\n    /**\n     * Property: defaultDatum\n     * The datum to use when no others a specified\n     */\n    defaultDatum: 'WGS84',                  //default datum\n\n    /** \n    * Method: transform(source, dest, point)\n    * Transform a point coordinate from one map projection to another.  This is\n    * really the only public method you should need to use.\n    *\n    * Parameters:\n    * source - {Proj4js.Proj} source map projection for the transformation\n    * dest - {Proj4js.Proj} destination map projection for the transformation\n    * point - {Object} point to transform, may be geodetic (long, lat) or\n    *     projected Cartesian (x,y), but should always have x,y properties.\n    */\n    transform: function(source, dest, point) {\n        if (!source.readyToUse) {\n            this.reportError(\"Proj4js initialization for:\"+source.srsCode+\" not yet complete\");\n            return point;\n        }\n        if (!dest.readyToUse) {\n            this.reportError(\"Proj4js initialization for:\"+dest.srsCode+\" not yet complete\");\n            return point;\n        }\n        \n        // Workaround for datum shifts towgs84, if either source or destination projection is not wgs84\n        if (source.datum && dest.datum && (\n            ((source.datum.datum_type == Proj4js.common.PJD_3PARAM || source.datum.datum_type == Proj4js.common.PJD_7PARAM) && dest.datumCode != \"WGS84\") ||\n            ((dest.datum.datum_type == Proj4js.common.PJD_3PARAM || dest.datum.datum_type == Proj4js.common.PJD_7PARAM) && source.datumCode != \"WGS84\"))) {\n            var wgs84 = Proj4js.WGS84;\n            this.transform(source, wgs84, point);\n            source = wgs84;\n        }\n\n        // DGR, 2010/11/12\n        if (source.axis!=\"enu\") {\n            this.adjust_axis(source,false,point);\n        }\n\n        // Transform source points to long/lat, if they aren't already.\n        if ( source.projName==\"longlat\") {\n            point.x *= Proj4js.common.D2R;  // convert degrees to radians\n            point.y *= Proj4js.common.D2R;\n        } else {\n            if (source.to_meter) {\n                point.x *= source.to_meter;\n                point.y *= source.to_meter;\n            }\n            source.inverse(point); // Convert Cartesian to longlat\n        }\n\n        // Adjust for the prime meridian if necessary\n        if (source.from_greenwich) { \n            point.x += source.from_greenwich; \n        }\n\n        // Convert datums if needed, and if possible.\n        point = this.datum_transform( source.datum, dest.datum, point );\n\n        // Adjust for the prime meridian if necessary\n        if (dest.from_greenwich) {\n            point.x -= dest.from_greenwich;\n        }\n\n        if( dest.projName==\"longlat\" ) {             \n            // convert radians to decimal degrees\n            point.x *= Proj4js.common.R2D;\n            point.y *= Proj4js.common.R2D;\n        } else  {               // else project\n            dest.forward(point);\n            if (dest.to_meter) {\n                point.x /= dest.to_meter;\n                point.y /= dest.to_meter;\n            }\n        }\n\n        // DGR, 2010/11/12\n        if (dest.axis!=\"enu\") {\n            this.adjust_axis(dest,true,point);\n        }\n\n        return point;\n    }, // transform()\n\n    /** datum_transform()\n      source coordinate system definition,\n      destination coordinate system definition,\n      point to transform in geodetic coordinates (long, lat, height)\n    */\n    datum_transform : function( source, dest, point ) {\n\n      // Short cut if the datums are identical.\n      if( source.compare_datums( dest ) ) {\n          return point; // in this case, zero is sucess,\n                    // whereas cs_compare_datums returns 1 to indicate TRUE\n                    // confusing, should fix this\n      }\n\n      // Explicitly skip datum transform by setting 'datum=none' as parameter for either source or dest\n      if( source.datum_type == Proj4js.common.PJD_NODATUM\n          || dest.datum_type == Proj4js.common.PJD_NODATUM) {\n          return point;\n      }\n\n      // Do we need to go through geocentric coordinates?\n      if( source.es != dest.es || source.a != dest.a\n          || source.datum_type == Proj4js.common.PJD_3PARAM\n          || source.datum_type == Proj4js.common.PJD_7PARAM\n          || dest.datum_type == Proj4js.common.PJD_3PARAM\n          || dest.datum_type == Proj4js.common.PJD_7PARAM)\n      {\n\n        // Convert to geocentric coordinates.\n        source.geodetic_to_geocentric( point );\n        // CHECK_RETURN;\n\n        // Convert between datums\n        if( source.datum_type == Proj4js.common.PJD_3PARAM || source.datum_type == Proj4js.common.PJD_7PARAM ) {\n          source.geocentric_to_wgs84(point);\n          // CHECK_RETURN;\n        }\n\n        if( dest.datum_type == Proj4js.common.PJD_3PARAM || dest.datum_type == Proj4js.common.PJD_7PARAM ) {\n          dest.geocentric_from_wgs84(point);\n          // CHECK_RETURN;\n        }\n\n        // Convert back to geodetic coordinates\n        dest.geocentric_to_geodetic( point );\n          // CHECK_RETURN;\n      }\n\n      return point;\n    }, // cs_datum_transform\n\n    /**\n     * Function: adjust_axis\n     * Normalize or de-normalized the x/y/z axes.  The normal form is \"enu\"\n     * (easting, northing, up).\n     * Parameters:\n     * crs {Proj4js.Proj} the coordinate reference system\n     * denorm {Boolean} when false, normalize\n     * point {Object} the coordinates to adjust\n     */\n    adjust_axis: function(crs, denorm, point) {\n        var xin= point.x, yin= point.y, zin= point.z || 0.0;\n        var v, t;\n        for (var i= 0; i<3; i++) {\n            if (denorm && i==2 && point.z===undefined) { continue; }\n                 if (i==0) { v= xin; t= 'x'; }\n            else if (i==1) { v= yin; t= 'y'; }\n            else           { v= zin; t= 'z'; }\n            switch(crs.axis[i]) {\n            case 'e':\n                point[t]= v;\n                break;\n            case 'w':\n                point[t]= -v;\n                break;\n            case 'n':\n                point[t]= v;\n                break;\n            case 's':\n                point[t]= -v;\n                break;\n            case 'u':\n                if (point[t]!==undefined) { point.z= v; }\n                break;\n            case 'd':\n                if (point[t]!==undefined) { point.z= -v; }\n                break;\n            default :\n                alert(\"ERROR: unknow axis (\"+crs.axis[i]+\") - check definition of \"+crs.projName);\n                return null;\n            }\n        }\n        return point;\n    },\n\n    /**\n     * Function: reportError\n     * An internal method to report errors back to user. \n     * Override this in applications to report error messages or throw exceptions.\n     */\n    reportError: function(msg) {\n      //console.log(msg);\n    },\n\n/**\n *\n * Title: Private Methods\n * The following properties and methods are intended for internal use only.\n *\n * This is a minimal implementation of JavaScript inheritance methods so that \n * Proj4js can be used as a stand-alone library.\n * These are copies of the equivalent OpenLayers methods at v2.7\n */\n \n/**\n * Function: extend\n * Copy all properties of a source object to a destination object.  Modifies\n *     the passed in destination object.  Any properties on the source object\n *     that are set to undefined will not be (re)set on the destination object.\n *\n * Parameters:\n * destination - {Object} The object that will be modified\n * source - {Object} The object with properties to be set on the destination\n *\n * Returns:\n * {Object} The destination object.\n */\n    extend: function(destination, source) {\n      destination = destination || {};\n      if(source) {\n          for(var property in source) {\n              var value = source[property];\n              if(value !== undefined) {\n                  destination[property] = value;\n              }\n          }\n      }\n      return destination;\n    },\n\n/**\n * Constructor: Class\n * Base class used to construct all other classes. Includes support for \n *     multiple inheritance. \n *  \n */\n    Class: function() {\n      var Class = function() {\n          this.initialize.apply(this, arguments);\n      };\n  \n      var extended = {};\n      var parent;\n      for(var i=0; i<arguments.length; ++i) {\n          if(typeof arguments[i] == \"function\") {\n              // get the prototype of the superclass\n              parent = arguments[i].prototype;\n          } else {\n              // in this case we're extending with the prototype\n              parent = arguments[i];\n          }\n          Proj4js.extend(extended, parent);\n      }\n      Class.prototype = extended;\n      \n      return Class;\n    },\n\n    /**\n     * Function: bind\n     * Bind a function to an object.  Method to easily create closures with\n     *     'this' altered.\n     * \n     * Parameters:\n     * func - {Function} Input function.\n     * object - {Object} The object to bind to the input function (as this).\n     * \n     * Returns:\n     * {Function} A closure with 'this' set to the passed in object.\n     */\n    bind: function(func, object) {\n        // create a reference to all arguments past the second one\n        var args = Array.prototype.slice.apply(arguments, [2]);\n        return function() {\n            // Push on any additional arguments from the actual function call.\n            // These will come after those sent to the bind call.\n            var newArgs = args.concat(\n                Array.prototype.slice.apply(arguments, [0])\n            );\n            return func.apply(object, newArgs);\n        };\n    },\n    \n/**\n * The following properties and methods handle dynamic loading of JSON objects.\n */\n \n    /**\n     * Property: scriptName\n     * {String} The filename of this script without any path.\n     */\n    scriptName: \"proj4js.js\",\n\n    /**\n     * Property: defsLookupService\n     * AJAX service to retreive projection definition parameters from\n     */\n    defsLookupService: 'http://spatialreference.org/ref',\n\n    /**\n     * Property: libPath\n     * internal: http server path to library code.\n     */\n    libPath: null,\n\n    /**\n     * Function: getScriptLocation\n     * Return the path to this script.\n     *\n     * Returns:\n     * Path to this script\n     */\n    getScriptLocation: function () {\n        if (this.libPath) return this.libPath;\n        var scriptName = this.scriptName;\n        var scriptNameLen = scriptName.length;\n\n        var scripts = document.getElementsByTagName('script');\n        for (var i = 0; i < scripts.length; i++) {\n            var src = scripts[i].getAttribute('src');\n            if (src) {\n                var index = src.lastIndexOf(scriptName);\n                // is it found, at the end of the URL?\n                if ((index > -1) && (index + scriptNameLen == src.length)) {\n                    this.libPath = src.slice(0, -scriptNameLen);\n                    break;\n                }\n            }\n        }\n        return this.libPath||\"\";\n    },\n\n    /**\n     * Function: loadScript\n     * Load a JS file from a URL into a <script> tag in the page.\n     * \n     * Parameters:\n     * url - {String} The URL containing the script to load\n     * onload - {Function} A method to be executed when the script loads successfully\n     * onfail - {Function} A method to be executed when there is an error loading the script\n     * loadCheck - {Function} A boolean method that checks to see if the script \n     *            has loaded.  Typically this just checks for the existance of\n     *            an object in the file just loaded.\n     */\n    loadScript: function(url, onload, onfail, loadCheck) {\n      var script = document.createElement('script');\n      script.defer = false;\n      script.type = \"text/javascript\";\n      script.id = url;\n      script.src = url;\n      script.onload = onload;\n      script.onerror = onfail;\n      script.loadCheck = loadCheck;\n      if (/MSIE/.test(navigator.userAgent)) {\n        script.onreadystatechange = this.checkReadyState;\n      }\n      document.getElementsByTagName('head')[0].appendChild(script);\n    },\n    \n    /**\n     * Function: checkReadyState\n     * IE workaround since there is no onerror handler.  Calls the user defined \n     * loadCheck method to determine if the script is loaded.\n     * \n     */\n    checkReadyState: function() {\n      if (this.readyState == 'loaded') {\n        if (!this.loadCheck()) {\n          this.onerror();\n        } else {\n          this.onload();\n        }\n      }\n    }\n};\n\n/**\n * Class: Proj4js.Proj\n *\n * Proj objects provide transformation methods for point coordinates\n * between geodetic latitude/longitude and a projected coordinate system. \n * once they have been initialized with a projection code.\n *\n * Initialization of Proj objects is with a projection code, usually EPSG codes,\n * which is the key that will be used with the Proj4js.defs array.\n * \n * The code passed in will be stripped of colons and converted to uppercase\n * to locate projection definition files.\n *\n * A projection object has properties for units and title strings.\n */\nProj4js.Proj = Proj4js.Class({\n\n  /**\n   * Property: readyToUse\n   * Flag to indicate if initialization is complete for this Proj object\n   */\n  readyToUse: false,   \n  \n  /**\n   * Property: title\n   * The title to describe the projection\n   */\n  title: null,  \n  \n  /**\n   * Property: projName\n   * The projection class for this projection, e.g. lcc (lambert conformal conic,\n   * or merc for mercator).  These are exactly equivalent to their Proj4 \n   * counterparts.\n   */\n  projName: null,\n  /**\n   * Property: units\n   * The units of the projection.  Values include 'm' and 'degrees'\n   */\n  units: null,\n  /**\n   * Property: datum\n   * The datum specified for the projection\n   */\n  datum: null,\n  /**\n   * Property: x0\n   * The x coordinate origin\n   */\n  x0: 0,\n  /**\n   * Property: y0\n   * The y coordinate origin\n   */\n  y0: 0,\n  /**\n   * Property: localCS\n   * Flag to indicate if the projection is a local one in which no transforms\n   * are required.\n   */\n  localCS: false,\n\n  /**\n  * Property: queue\n  * Buffer (FIFO) to hold callbacks waiting to be called when projection loaded.\n  */\n  queue: null,\n\n  /**\n  * Constructor: initialize\n  * Constructor for Proj4js.Proj objects\n  *\n  * Parameters:\n  * srsCode - a code for map projection definition parameters.  These are usually\n  * (but not always) EPSG codes.\n  */\n  initialize: function(srsCode, callback) {\n      this.srsCodeInput = srsCode;\n      \n      //Register callbacks prior to attempting to process definition\n      this.queue = [];\n      if( callback ){\n           this.queue.push( callback );\n      }\n      \n      //check to see if this is a WKT string\n      if ((srsCode.indexOf('GEOGCS') >= 0) ||\n          (srsCode.indexOf('GEOCCS') >= 0) ||\n          (srsCode.indexOf('PROJCS') >= 0) ||\n          (srsCode.indexOf('LOCAL_CS') >= 0)) {\n            this.parseWKT(srsCode);\n            this.deriveConstants();\n            this.loadProjCode(this.projName);\n            return;\n      }\n      \n      // DGR 2008-08-03 : support urn and url\n      if (srsCode.indexOf('urn:') == 0) {\n          //urn:ORIGINATOR:def:crs:CODESPACE:VERSION:ID\n          var urn = srsCode.split(':');\n          if ((urn[1] == 'ogc' || urn[1] =='x-ogc') &&\n              (urn[2] =='def') &&\n              (urn[3] =='crs')) {\n              srsCode = urn[4]+':'+urn[urn.length-1];\n          }\n      } else if (srsCode.indexOf('http://') == 0) {\n          //url#ID\n          var url = srsCode.split('#');\n          if (url[0].match(/epsg.org/)) {\n            // http://www.epsg.org/#\n            srsCode = 'EPSG:'+url[1];\n          } else if (url[0].match(/RIG.xml/)) {\n            //http://librairies.ign.fr/geoportail/resources/RIG.xml#\n            //http://interop.ign.fr/registers/ign/RIG.xml#\n            srsCode = 'IGNF:'+url[1];\n          }\n      }\n      this.srsCode = srsCode.toUpperCase();\n      if (this.srsCode.indexOf(\"EPSG\") == 0) {\n          this.srsCode = this.srsCode;\n          this.srsAuth = 'epsg';\n          this.srsProjNumber = this.srsCode.substring(5);\n      // DGR 2007-11-20 : authority IGNF\n      } else if (this.srsCode.indexOf(\"IGNF\") == 0) {\n          this.srsCode = this.srsCode;\n          this.srsAuth = 'IGNF';\n          this.srsProjNumber = this.srsCode.substring(5);\n      // DGR 2008-06-19 : pseudo-authority CRS for WMS\n      } else if (this.srsCode.indexOf(\"CRS\") == 0) {\n          this.srsCode = this.srsCode;\n          this.srsAuth = 'CRS';\n          this.srsProjNumber = this.srsCode.substring(4);\n      } else {\n          this.srsAuth = '';\n          this.srsProjNumber = this.srsCode;\n      }\n      \n      this.loadProjDefinition();\n  },\n  \n/**\n * Function: loadProjDefinition\n *    Loads the coordinate system initialization string if required.\n *    Note that dynamic loading happens asynchronously so an application must \n *    wait for the readyToUse property is set to true.\n *    To prevent dynamic loading, include the defs through a script tag in\n *    your application.\n *\n */\n    loadProjDefinition: function() {\n      //check in memory\n      if (Proj4js.defs[this.srsCode]) {\n        this.defsLoaded();\n        return;\n      }\n\n      //else check for def on the server\n      var url = Proj4js.getScriptLocation() + 'defs/' + this.srsAuth.toUpperCase() + this.srsProjNumber + '.js';\n      Proj4js.loadScript(url, \n                Proj4js.bind(this.defsLoaded, this),\n                Proj4js.bind(this.loadFromService, this),\n                Proj4js.bind(this.checkDefsLoaded, this) );\n    },\n\n/**\n * Function: loadFromService\n *    Creates the REST URL for loading the definition from a web service and \n *    loads it.\n *\n */\n    loadFromService: function() {\n      //else load from web service\n      var url = Proj4js.defsLookupService +'/' + this.srsAuth +'/'+ this.srsProjNumber + '/proj4js/';\n      Proj4js.loadScript(url, \n            Proj4js.bind(this.defsLoaded, this),\n            Proj4js.bind(this.defsFailed, this),\n            Proj4js.bind(this.checkDefsLoaded, this) );\n    },\n\n/**\n * Function: defsLoaded\n * Continues the Proj object initilization once the def file is loaded\n *\n */\n    defsLoaded: function() {\n      this.parseDefs();\n      this.loadProjCode(this.projName);\n    },\n    \n/**\n * Function: checkDefsLoaded\n *    This is the loadCheck method to see if the def object exists\n *\n */\n    checkDefsLoaded: function() {\n      if (Proj4js.defs[this.srsCode]) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n /**\n * Function: defsFailed\n *    Report an error in loading the defs file, but continue on using WGS84\n *\n */\n   defsFailed: function() {\n      Proj4js.reportError('failed to load projection definition for: '+this.srsCode);\n      Proj4js.defs[this.srsCode] = Proj4js.defs['WGS84'];  //set it to something so it can at least continue\n      this.defsLoaded();\n    },\n\n/**\n * Function: loadProjCode\n *    Loads projection class code dynamically if required.\n *     Projection code may be included either through a script tag or in\n *     a built version of proj4js\n *\n */\n    loadProjCode: function(projName) {\n      if (Proj4js.Proj[projName]) {\n        this.initTransforms();\n        return;\n      }\n\n      //the URL for the projection code\n      var url = Proj4js.getScriptLocation() + 'projCode/' + projName + '.js';\n      Proj4js.loadScript(url, \n              Proj4js.bind(this.loadProjCodeSuccess, this, projName),\n              Proj4js.bind(this.loadProjCodeFailure, this, projName), \n              Proj4js.bind(this.checkCodeLoaded, this, projName) );\n    },\n\n /**\n * Function: loadProjCodeSuccess\n *    Loads any proj dependencies or continue on to final initialization.\n *\n */\n    loadProjCodeSuccess: function(projName) {\n      if (Proj4js.Proj[projName].dependsOn){\n        this.loadProjCode(Proj4js.Proj[projName].dependsOn);\n      } else {\n        this.initTransforms();\n      }\n    },\n\n /**\n * Function: defsFailed\n *    Report an error in loading the proj file.  Initialization of the Proj\n *    object has failed and the readyToUse flag will never be set.\n *\n */\n    loadProjCodeFailure: function(projName) {\n      Proj4js.reportError(\"failed to find projection file for: \" + projName);\n      //TBD initialize with identity transforms so proj will still work?\n    },\n    \n/**\n * Function: checkCodeLoaded\n *    This is the loadCheck method to see if the projection code is loaded\n *\n */\n    checkCodeLoaded: function(projName) {\n      if (Proj4js.Proj[projName]) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n/**\n * Function: initTransforms\n *    Finalize the initialization of the Proj object\n *\n */\n    initTransforms: function() {\n      Proj4js.extend(this, Proj4js.Proj[this.projName]);\n      this.init();\n      this.readyToUse = true;\n      if( this.queue ) {\n        var item;\n        while( (item = this.queue.shift()) ) {\n          item.call( this, this );\n        }\n      }\n  },\n\n/**\n * Function: parseWKT\n * Parses a WKT string to get initialization parameters\n *\n */\n wktRE: /^(\\w+)\\[(.*)\\]$/,\n parseWKT: function(wkt) {\n    var wktMatch = wkt.match(this.wktRE);\n    if (!wktMatch) return;\n    var wktObject = wktMatch[1];\n    var wktContent = wktMatch[2];\n    var wktTemp = wktContent.split(\",\");\n    var wktName;\n    if (wktObject.toUpperCase() == \"TOWGS84\") {\n      wktName = wktObject;  //no name supplied for the TOWGS84 array\n    } else {\n      wktName = wktTemp.shift();\n    }\n    wktName = wktName.replace(/^\\\"/,\"\");\n    wktName = wktName.replace(/\\\"$/,\"\");\n    \n    /*\n    wktContent = wktTemp.join(\",\");\n    var wktArray = wktContent.split(\"],\");\n    for (var i=0; i<wktArray.length-1; ++i) {\n      wktArray[i] += \"]\";\n    }\n    */\n    \n    var wktArray = new Array();\n    var bkCount = 0;\n    var obj = \"\";\n    for (var i=0; i<wktTemp.length; ++i) {\n      var token = wktTemp[i];\n      for (var j=0; j<token.length; ++j) {\n        if (token.charAt(j) == \"[\") ++bkCount;\n        if (token.charAt(j) == \"]\") --bkCount;\n      }\n      obj += token;\n      if (bkCount === 0) {\n        wktArray.push(obj);\n        obj = \"\";\n      } else {\n        obj += \",\";\n      }\n    }\n    \n    //do something based on the type of the wktObject being parsed\n    //add in variations in the spelling as required\n    switch (wktObject) {\n      case 'LOCAL_CS':\n        this.projName = 'identity';\n        this.localCS = true;\n        this.srsCode = wktName;\n        break;\n      case 'GEOGCS':\n        this.projName = 'longlat';\n        this.geocsCode = wktName;\n        if (!this.srsCode) this.srsCode = wktName;\n        break;\n      case 'PROJCS':\n        this.srsCode = wktName;\n        break;\n      case 'GEOCCS':\n        break;\n      case 'PROJECTION':\n        this.projName = Proj4js.wktProjections[wktName];\n        break;\n      case 'DATUM':\n        this.datumName = wktName;\n        break;\n      case 'LOCAL_DATUM':\n        this.datumCode = 'none';\n        break;\n      case 'SPHEROID':\n        this.ellps = wktName;\n        this.a = parseFloat(wktArray.shift());\n        this.rf = parseFloat(wktArray.shift());\n        break;\n      case 'PRIMEM':\n        this.from_greenwich = parseFloat(wktArray.shift()); //to radians?\n        break;\n      case 'UNIT':\n        this.units = wktName;\n        this.unitsPerMeter = parseFloat(wktArray.shift());\n        break;\n      case 'PARAMETER':\n        var name = wktName.toLowerCase();\n        var value = parseFloat(wktArray.shift());\n        //there may be many variations on the wktName values, add in case\n        //statements as required\n        switch (name) {\n          case 'false_easting':\n            this.x0 = value;\n            break;\n          case 'false_northing':\n            this.y0 = value;\n            break;\n          case 'scale_factor':\n            this.k0 = value;\n            break;\n          case 'central_meridian':\n            this.long0 = value*Proj4js.common.D2R;\n            break;\n          case 'latitude_of_origin':\n            this.lat0 = value*Proj4js.common.D2R;\n            break;\n          case 'more_here':\n            break;\n          default:\n            break;\n        }\n        break;\n      case 'TOWGS84':\n        this.datum_params = wktArray;\n        break;\n      //DGR 2010-11-12: AXIS\n      case 'AXIS':\n        var name= wktName.toLowerCase();\n        var value= wktArray.shift();\n        switch (value) {\n          case 'EAST' : value= 'e'; break;\n          case 'WEST' : value= 'w'; break;\n          case 'NORTH': value= 'n'; break;\n          case 'SOUTH': value= 's'; break;\n          case 'UP'   : value= 'u'; break;\n          case 'DOWN' : value= 'd'; break;\n          case 'OTHER':\n          default     : value= ' '; break;//FIXME\n        }\n        if (!this.axis) { this.axis= \"enu\"; }\n        switch(name) {\n          case 'x': this.axis=                         value + this.axis.substr(1,2); break;\n          case 'y': this.axis= this.axis.substr(0,1) + value + this.axis.substr(2,1); break;\n          case 'z': this.axis= this.axis.substr(0,2) + value                        ; break;\n          default : break;\n        }\n      case 'MORE_HERE':\n        break;\n      default:\n        break;\n    }\n    for (var i=0; i<wktArray.length; ++i) {\n      this.parseWKT(wktArray[i]);\n    }\n },\n\n/**\n * Function: parseDefs\n * Parses the PROJ.4 initialization string and sets the associated properties.\n *\n */\n  parseDefs: function() {\n      this.defData = Proj4js.defs[this.srsCode];\n      var paramName, paramVal;\n      if (!this.defData) {\n        return;\n      }\n      var paramArray=this.defData.split(\"+\");\n\n      for (var prop=0; prop<paramArray.length; prop++) {\n          var property = paramArray[prop].split(\"=\");\n          paramName = property[0].toLowerCase();\n          paramVal = property[1];\n\n          switch (paramName.replace(/\\s/gi,\"\")) {  // trim out spaces\n              case \"\": break;   // throw away nameless parameter\n              case \"title\":  this.title = paramVal; break;\n              case \"proj\":   this.projName =  paramVal.replace(/\\s/gi,\"\"); break;\n              case \"units\":  this.units = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"datum\":  this.datumCode = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"nadgrids\": this.nagrids = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"ellps\":  this.ellps = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"a\":      this.a =  parseFloat(paramVal); break;  // semi-major radius\n              case \"b\":      this.b =  parseFloat(paramVal); break;  // semi-minor radius\n              // DGR 2007-11-20\n              case \"rf\":     this.rf = parseFloat(paramVal); break; // inverse flattening rf= a/(a-b)\n              case \"lat_0\":  this.lat0 = paramVal*Proj4js.common.D2R; break;        // phi0, central latitude\n              case \"lat_1\":  this.lat1 = paramVal*Proj4js.common.D2R; break;        //standard parallel 1\n              case \"lat_2\":  this.lat2 = paramVal*Proj4js.common.D2R; break;        //standard parallel 2\n              case \"lat_ts\": this.lat_ts = paramVal*Proj4js.common.D2R; break;      // used in merc and eqc\n              case \"lon_0\":  this.long0 = paramVal*Proj4js.common.D2R; break;       // lam0, central longitude\n              case \"alpha\":  this.alpha =  parseFloat(paramVal)*Proj4js.common.D2R; break;  //for somerc projection\n              case \"lonc\":   this.longc = paramVal*Proj4js.common.D2R; break;       //for somerc projection\n              case \"x_0\":    this.x0 = parseFloat(paramVal); break;  // false easting\n              case \"y_0\":    this.y0 = parseFloat(paramVal); break;  // false northing\n              case \"k_0\":    this.k0 = parseFloat(paramVal); break;  // projection scale factor\n              case \"k\":      this.k0 = parseFloat(paramVal); break;  // both forms returned\n              case \"r_a\":    this.R_A = true; break;                 // sphere--area of ellipsoid\n              case \"zone\":   this.zone = parseInt(paramVal,10); break;  // UTM Zone\n              case \"south\":   this.utmSouth = true; break;  // UTM north/south\n              case \"towgs84\":this.datum_params = paramVal.split(\",\"); break;\n              case \"to_meter\": this.to_meter = parseFloat(paramVal); break; // cartesian scaling\n              case \"from_greenwich\": this.from_greenwich = paramVal*Proj4js.common.D2R; break;\n              // DGR 2008-07-09 : if pm is not a well-known prime meridian take\n              // the value instead of 0.0, then convert to radians\n              case \"pm\":     paramVal = paramVal.replace(/\\s/gi,\"\");\n                             this.from_greenwich = Proj4js.PrimeMeridian[paramVal] ?\n                                Proj4js.PrimeMeridian[paramVal] : parseFloat(paramVal);\n                             this.from_greenwich *= Proj4js.common.D2R; \n                             break;\n              // DGR 2010-11-12: axis\n              case \"axis\":   paramVal = paramVal.replace(/\\s/gi,\"\");\n                             var legalAxis= \"ewnsud\";\n                             if (paramVal.length==3 &&\n                                 legalAxis.indexOf(paramVal.substr(0,1))!=-1 &&\n                                 legalAxis.indexOf(paramVal.substr(1,1))!=-1 &&\n                                 legalAxis.indexOf(paramVal.substr(2,1))!=-1) {\n                                this.axis= paramVal;\n                             } //FIXME: be silent ?\n                             break;\n              case \"no_defs\": break; \n              default: //alert(\"Unrecognized parameter: \" + paramName);\n          } // switch()\n      } // for paramArray\n      this.deriveConstants();\n  },\n\n/**\n * Function: deriveConstants\n * Sets several derived constant values and initialization of datum and ellipse\n *     parameters.\n *\n */\n  deriveConstants: function() {\n      if (this.nagrids == '@null') this.datumCode = 'none';\n      if (this.datumCode && this.datumCode != 'none') {\n        var datumDef = Proj4js.Datum[this.datumCode];\n        if (datumDef) {\n          this.datum_params = datumDef.towgs84 ? datumDef.towgs84.split(',') : null;\n          this.ellps = datumDef.ellipse;\n          this.datumName = datumDef.datumName ? datumDef.datumName : this.datumCode;\n        }\n      }\n      if (!this.a) {    // do we have an ellipsoid?\n          var ellipse = Proj4js.Ellipsoid[this.ellps] ? Proj4js.Ellipsoid[this.ellps] : Proj4js.Ellipsoid['WGS84'];\n          Proj4js.extend(this, ellipse);\n      }\n      if (this.rf && !this.b) this.b = (1.0 - 1.0/this.rf) * this.a;\n      if (this.rf === 0 || Math.abs(this.a - this.b)<Proj4js.common.EPSLN) {\n        this.sphere = true;\n        this.b= this.a;\n      }\n      this.a2 = this.a * this.a;          // used in geocentric\n      this.b2 = this.b * this.b;          // used in geocentric\n      this.es = (this.a2-this.b2)/this.a2;  // e ^ 2\n      this.e = Math.sqrt(this.es);        // eccentricity\n      if (this.R_A) {\n        this.a *= 1. - this.es * (Proj4js.common.SIXTH + this.es * (Proj4js.common.RA4 + this.es * Proj4js.common.RA6));\n        this.a2 = this.a * this.a;\n        this.b2 = this.b * this.b;\n        this.es = 0.;\n      }\n      this.ep2=(this.a2-this.b2)/this.b2; // used in geocentric\n      if (!this.k0) this.k0 = 1.0;    //default value\n      //DGR 2010-11-12: axis\n      if (!this.axis) { this.axis= \"enu\"; }\n\n      this.datum = new Proj4js.datum(this);\n  }\n});\n\nProj4js.Proj.longlat = {\n  init: function() {\n    //no-op for longlat\n  },\n  forward: function(pt) {\n    //identity transform\n    return pt;\n  },\n  inverse: function(pt) {\n    //identity transform\n    return pt;\n  }\n};\nProj4js.Proj.identity = Proj4js.Proj.longlat;\n\n/**\n  Proj4js.defs is a collection of coordinate system definition objects in the \n  PROJ.4 command line format.\n  Generally a def is added by means of a separate .js file for example:\n\n    <SCRIPT type=\"text/javascript\" src=\"defs/EPSG26912.js\"></SCRIPT>\n\n  def is a CS definition in PROJ.4 WKT format, for example:\n    +proj=\"tmerc\"   //longlat, etc.\n    +a=majorRadius\n    +b=minorRadius\n    +lat0=somenumber\n    +long=somenumber\n*/\nProj4js.defs = {\n  // These are so widely used, we'll go ahead and throw them in\n  // without requiring a separate .js file\n  'WGS84': \"+title=long/lat:WGS84 +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees\",\n  'EPSG:4326': \"+title=long/lat:WGS84 +proj=longlat +a=6378137.0 +b=6356752.31424518 +ellps=WGS84 +datum=WGS84 +units=degrees\",\n  'EPSG:4269': \"+title=long/lat:NAD83 +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees\",\n  'EPSG:3875': \"+title= Google Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs\"\n};\nProj4js.defs['EPSG:3785'] = Proj4js.defs['EPSG:3875'];  //maintain backward compat, official code is 3875\nProj4js.defs['GOOGLE'] = Proj4js.defs['EPSG:3875'];\nProj4js.defs['EPSG:900913'] = Proj4js.defs['EPSG:3875'];\nProj4js.defs['EPSG:102113'] = Proj4js.defs['EPSG:3875'];\n\nProj4js.common = {\n  PI : 3.141592653589793238, //Math.PI,\n  HALF_PI : 1.570796326794896619, //Math.PI*0.5,\n  TWO_PI : 6.283185307179586477, //Math.PI*2,\n  FORTPI : 0.78539816339744833,\n  R2D : 57.29577951308232088,\n  D2R : 0.01745329251994329577,\n  SEC_TO_RAD : 4.84813681109535993589914102357e-6, /* SEC_TO_RAD = Pi/180/3600 */\n  EPSLN : 1.0e-10,\n  MAX_ITER : 20,\n  // following constants from geocent.c\n  COS_67P5 : 0.38268343236508977,  /* cosine of 67.5 degrees */\n  AD_C : 1.0026000,                /* Toms region 1 constant */\n\n  /* datum_type values */\n  PJD_UNKNOWN  : 0,\n  PJD_3PARAM   : 1,\n  PJD_7PARAM   : 2,\n  PJD_GRIDSHIFT: 3,\n  PJD_WGS84    : 4,   // WGS84 or equivalent\n  PJD_NODATUM  : 5,   // WGS84 or equivalent\n  SRS_WGS84_SEMIMAJOR : 6378137.0,  // only used in grid shift transforms\n\n  // ellipoid pj_set_ell.c\n  SIXTH : .1666666666666666667, /* 1/6 */\n  RA4   : .04722222222222222222, /* 17/360 */\n  RA6   : .02215608465608465608, /* 67/3024 */\n  RV4   : .06944444444444444444, /* 5/72 */\n  RV6   : .04243827160493827160, /* 55/1296 */\n\n// Function to compute the constant small m which is the radius of\n//   a parallel of latitude, phi, divided by the semimajor axis.\n// -----------------------------------------------------------------\n  msfnz : function(eccent, sinphi, cosphi) {\n      var con = eccent * sinphi;\n      return cosphi/(Math.sqrt(1.0 - con * con));\n  },\n\n// Function to compute the constant small t for use in the forward\n//   computations in the Lambert Conformal Conic and the Polar\n//   Stereographic projections.\n// -----------------------------------------------------------------\n  tsfnz : function(eccent, phi, sinphi) {\n    var con = eccent * sinphi;\n    var com = .5 * eccent;\n    con = Math.pow(((1.0 - con) / (1.0 + con)), com);\n    return (Math.tan(.5 * (this.HALF_PI - phi))/con);\n  },\n\n// Function to compute the latitude angle, phi2, for the inverse of the\n//   Lambert Conformal Conic and Polar Stereographic projections.\n// ----------------------------------------------------------------\n  phi2z : function(eccent, ts) {\n    var eccnth = .5 * eccent;\n    var con, dphi;\n    var phi = this.HALF_PI - 2 * Math.atan(ts);\n    for (var i = 0; i <= 15; i++) {\n      con = eccent * Math.sin(phi);\n      dphi = this.HALF_PI - 2 * Math.atan(ts *(Math.pow(((1.0 - con)/(1.0 + con)),eccnth))) - phi;\n      phi += dphi;\n      if (Math.abs(dphi) <= .0000000001) return phi;\n    }\n    alert(\"phi2z has NoConvergence\");\n    return (-9999);\n  },\n\n/* Function to compute constant small q which is the radius of a \n   parallel of latitude, phi, divided by the semimajor axis. \n------------------------------------------------------------*/\n  qsfnz : function(eccent,sinphi) {\n    var con;\n    if (eccent > 1.0e-7) {\n      con = eccent * sinphi;\n      return (( 1.0- eccent * eccent) * (sinphi /(1.0 - con * con) - (.5/eccent)*Math.log((1.0 - con)/(1.0 + con))));\n    } else {\n      return(2.0 * sinphi);\n    }\n  },\n\n/* Function to eliminate roundoff errors in asin\n----------------------------------------------*/\n  asinz : function(x) {\n    if (Math.abs(x)>1.0) {\n      x=(x>1.0)?1.0:-1.0;\n    }\n    return Math.asin(x);\n  },\n\n// following functions from gctpc cproj.c for transverse mercator projections\n  e0fn : function(x) {return(1.0-0.25*x*(1.0+x/16.0*(3.0+1.25*x)));},\n  e1fn : function(x) {return(0.375*x*(1.0+0.25*x*(1.0+0.46875*x)));},\n  e2fn : function(x) {return(0.05859375*x*x*(1.0+0.75*x));},\n  e3fn : function(x) {return(x*x*x*(35.0/3072.0));},\n  mlfn : function(e0,e1,e2,e3,phi) {return(e0*phi-e1*Math.sin(2.0*phi)+e2*Math.sin(4.0*phi)-e3*Math.sin(6.0*phi));},\n\n  srat : function(esinp, exp) {\n    return(Math.pow((1.0-esinp)/(1.0+esinp), exp));\n  },\n\n// Function to return the sign of an argument\n  sign : function(x) { if (x < 0.0) return(-1); else return(1);},\n\n// Function to adjust longitude to -180 to 180; input in radians\n  adjust_lon : function(x) {\n    x = (Math.abs(x) < this.PI) ? x: (x - (this.sign(x)*this.TWO_PI) );\n    return x;\n  },\n\n// IGNF - DGR : algorithms used by IGN France\n\n// Function to adjust latitude to -90 to 90; input in radians\n  adjust_lat : function(x) {\n    x= (Math.abs(x) < this.HALF_PI) ? x: (x - (this.sign(x)*this.PI) );\n    return x;\n  },\n\n// Latitude Isometrique - close to tsfnz ...\n  latiso : function(eccent, phi, sinphi) {\n    if (Math.abs(phi) > this.HALF_PI) return +Number.NaN;\n    if (phi==this.HALF_PI) return Number.POSITIVE_INFINITY;\n    if (phi==-1.0*this.HALF_PI) return -1.0*Number.POSITIVE_INFINITY;\n\n    var con= eccent*sinphi;\n    return Math.log(Math.tan((this.HALF_PI+phi)/2.0))+eccent*Math.log((1.0-con)/(1.0+con))/2.0;\n  },\n\n  fL : function(x,L) {\n    return 2.0*Math.atan(x*Math.exp(L)) - this.HALF_PI;\n  },\n\n// Inverse Latitude Isometrique - close to ph2z\n  invlatiso : function(eccent, ts) {\n    var phi= this.fL(1.0,ts);\n    var Iphi= 0.0;\n    var con= 0.0;\n    do {\n      Iphi= phi;\n      con= eccent*Math.sin(Iphi);\n      phi= this.fL(Math.exp(eccent*Math.log((1.0+con)/(1.0-con))/2.0),ts);\n    } while (Math.abs(phi-Iphi)>1.0e-12);\n    return phi;\n  },\n\n// Needed for Gauss Schreiber\n// Original:  Denis Makarov (info@binarythings.com)\n// Web Site:  http://www.binarythings.com\n  sinh : function(x)\n  {\n    var r= Math.exp(x);\n    r= (r-1.0/r)/2.0;\n    return r;\n  },\n\n  cosh : function(x)\n  {\n    var r= Math.exp(x);\n    r= (r+1.0/r)/2.0;\n    return r;\n  },\n\n  tanh : function(x)\n  {\n    var r= Math.exp(x);\n    r= (r-1.0/r)/(r+1.0/r);\n    return r;\n  },\n\n  asinh : function(x)\n  {\n    var s= (x>= 0? 1.0:-1.0);\n    return s*(Math.log( Math.abs(x) + Math.sqrt(x*x+1.0) ));\n  },\n\n  acosh : function(x)\n  {\n    return 2.0*Math.log(Math.sqrt((x+1.0)/2.0) + Math.sqrt((x-1.0)/2.0));\n  },\n\n  atanh : function(x)\n  {\n    return Math.log((x-1.0)/(x+1.0))/2.0;\n  },\n\n// Grande Normale\n  gN : function(a,e,sinphi)\n  {\n    var temp= e*sinphi;\n    return a/Math.sqrt(1.0 - temp*temp);\n  },\n  \n  //code from the PROJ.4 pj_mlfn.c file;  this may be useful for other projections\n  pj_enfn: function(es) {\n    var en = new Array();\n    en[0] = this.C00 - es * (this.C02 + es * (this.C04 + es * (this.C06 + es * this.C08)));\n    en[1] = es * (this.C22 - es * (this.C04 + es * (this.C06 + es * this.C08)));\n    var t = es * es;\n    en[2] = t * (this.C44 - es * (this.C46 + es * this.C48));\n    t *= es;\n    en[3] = t * (this.C66 - es * this.C68);\n    en[4] = t * es * this.C88;\n    return en;\n  },\n  \n  pj_mlfn: function(phi, sphi, cphi, en) {\n    cphi *= sphi;\n    sphi *= sphi;\n    return(en[0] * phi - cphi * (en[1] + sphi*(en[2]+ sphi*(en[3] + sphi*en[4]))));\n  },\n  \n  pj_inv_mlfn: function(arg, es, en) {\n    var k = 1./(1.-es);\n    var phi = arg;\n    for (var i = Proj4js.common.MAX_ITER; i ; --i) { /* rarely goes over 2 iterations */\n      var s = Math.sin(phi);\n      var t = 1. - es * s * s;\n      //t = this.pj_mlfn(phi, s, Math.cos(phi), en) - arg;\n      //phi -= t * (t * Math.sqrt(t)) * k;\n      t = (this.pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;\n      phi -= t;\n      if (Math.abs(t) < Proj4js.common.EPSLN)\n        return phi;\n    }\n    Proj4js.reportError(\"cass:pj_inv_mlfn: Convergence error\");\n    return phi;\n  },\n\n/* meridinal distance for ellipsoid and inverse\n**\t8th degree - accurate to < 1e-5 meters when used in conjuction\n**\t\twith typical major axis values.\n**\tInverse determines phi to EPS (1e-11) radians, about 1e-6 seconds.\n*/\n  C00: 1.0,\n  C02: .25,\n  C04: .046875,\n  C06: .01953125,\n  C08: .01068115234375,\n  C22: .75,\n  C44: .46875,\n  C46: .01302083333333333333,\n  C48: .00712076822916666666,\n  C66: .36458333333333333333,\n  C68: .00569661458333333333,\n  C88: .3076171875  \n\n};\n\n/** datum object\n*/\nProj4js.datum = Proj4js.Class({\n\n  initialize : function(proj) {\n    this.datum_type = Proj4js.common.PJD_WGS84;   //default setting\n    if (proj.datumCode && proj.datumCode == 'none') {\n      this.datum_type = Proj4js.common.PJD_NODATUM;\n    }\n    if (proj && proj.datum_params) {\n      for (var i=0; i<proj.datum_params.length; i++) {\n        proj.datum_params[i]=parseFloat(proj.datum_params[i]);\n      }\n      if (proj.datum_params[0] != 0 || proj.datum_params[1] != 0 || proj.datum_params[2] != 0 ) {\n        this.datum_type = Proj4js.common.PJD_3PARAM;\n      }\n      if (proj.datum_params.length > 3) {\n        if (proj.datum_params[3] != 0 || proj.datum_params[4] != 0 ||\n            proj.datum_params[5] != 0 || proj.datum_params[6] != 0 ) {\n          this.datum_type = Proj4js.common.PJD_7PARAM;\n          proj.datum_params[3] *= Proj4js.common.SEC_TO_RAD;\n          proj.datum_params[4] *= Proj4js.common.SEC_TO_RAD;\n          proj.datum_params[5] *= Proj4js.common.SEC_TO_RAD;\n          proj.datum_params[6] = (proj.datum_params[6]/1000000.0) + 1.0;\n        }\n      }\n    }\n    if (proj) {\n      this.a = proj.a;    //datum object also uses these values\n      this.b = proj.b;\n      this.es = proj.es;\n      this.ep2 = proj.ep2;\n      this.datum_params = proj.datum_params;\n    }\n  },\n\n  /****************************************************************/\n  // cs_compare_datums()\n  //   Returns TRUE if the two datums match, otherwise FALSE.\n  compare_datums : function( dest ) {\n    if( this.datum_type != dest.datum_type ) {\n      return false; // false, datums are not equal\n    } else if( this.a != dest.a || Math.abs(this.es-dest.es) > 0.000000000050 ) {\n      // the tolerence for es is to ensure that GRS80 and WGS84\n      // are considered identical\n      return false;\n    } else if( this.datum_type == Proj4js.common.PJD_3PARAM ) {\n      return (this.datum_params[0] == dest.datum_params[0]\n              && this.datum_params[1] == dest.datum_params[1]\n              && this.datum_params[2] == dest.datum_params[2]);\n    } else if( this.datum_type == Proj4js.common.PJD_7PARAM ) {\n      return (this.datum_params[0] == dest.datum_params[0]\n              && this.datum_params[1] == dest.datum_params[1]\n              && this.datum_params[2] == dest.datum_params[2]\n              && this.datum_params[3] == dest.datum_params[3]\n              && this.datum_params[4] == dest.datum_params[4]\n              && this.datum_params[5] == dest.datum_params[5]\n              && this.datum_params[6] == dest.datum_params[6]);\n    } else if ( this.datum_type == Proj4js.common.PJD_GRIDSHIFT ||\n                dest.datum_type == Proj4js.common.PJD_GRIDSHIFT ) {\n      alert(\"ERROR: Grid shift transformations are not implemented.\");\n      return false;\n    } else {\n      return true; // datums are equal\n    }\n  }, // cs_compare_datums()\n\n  /*\n   * The function Convert_Geodetic_To_Geocentric converts geodetic coordinates\n   * (latitude, longitude, and height) to geocentric coordinates (X, Y, Z),\n   * according to the current ellipsoid parameters.\n   *\n   *    Latitude  : Geodetic latitude in radians                     (input)\n   *    Longitude : Geodetic longitude in radians                    (input)\n   *    Height    : Geodetic height, in meters                       (input)\n   *    X         : Calculated Geocentric X coordinate, in meters    (output)\n   *    Y         : Calculated Geocentric Y coordinate, in meters    (output)\n   *    Z         : Calculated Geocentric Z coordinate, in meters    (output)\n   *\n   */\n  geodetic_to_geocentric : function(p) {\n    var Longitude = p.x;\n    var Latitude = p.y;\n    var Height = p.z ? p.z : 0;   //Z value not always supplied\n    var X;  // output\n    var Y;\n    var Z;\n\n    var Error_Code=0;  //  GEOCENT_NO_ERROR;\n    var Rn;            /*  Earth radius at location  */\n    var Sin_Lat;       /*  Math.sin(Latitude)  */\n    var Sin2_Lat;      /*  Square of Math.sin(Latitude)  */\n    var Cos_Lat;       /*  Math.cos(Latitude)  */\n\n    /*\n    ** Don't blow up if Latitude is just a little out of the value\n    ** range as it may just be a rounding issue.  Also removed longitude\n    ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.\n    */\n    if( Latitude < -Proj4js.common.HALF_PI && Latitude > -1.001 * Proj4js.common.HALF_PI ) {\n        Latitude = -Proj4js.common.HALF_PI;\n    } else if( Latitude > Proj4js.common.HALF_PI && Latitude < 1.001 * Proj4js.common.HALF_PI ) {\n        Latitude = Proj4js.common.HALF_PI;\n    } else if ((Latitude < -Proj4js.common.HALF_PI) || (Latitude > Proj4js.common.HALF_PI)) {\n      /* Latitude out of range */\n      Proj4js.reportError('geocent:lat out of range:'+Latitude);\n      return null;\n    }\n\n    if (Longitude > Proj4js.common.PI) Longitude -= (2*Proj4js.common.PI);\n    Sin_Lat = Math.sin(Latitude);\n    Cos_Lat = Math.cos(Latitude);\n    Sin2_Lat = Sin_Lat * Sin_Lat;\n    Rn = this.a / (Math.sqrt(1.0e0 - this.es * Sin2_Lat));\n    X = (Rn + Height) * Cos_Lat * Math.cos(Longitude);\n    Y = (Rn + Height) * Cos_Lat * Math.sin(Longitude);\n    Z = ((Rn * (1 - this.es)) + Height) * Sin_Lat;\n\n    p.x = X;\n    p.y = Y;\n    p.z = Z;\n    return Error_Code;\n  }, // cs_geodetic_to_geocentric()\n\n\n  geocentric_to_geodetic : function (p) {\n/* local defintions and variables */\n/* end-criterium of loop, accuracy of sin(Latitude) */\nvar genau = 1.E-12;\nvar genau2 = (genau*genau);\nvar maxiter = 30;\n\n    var P;        /* distance between semi-minor axis and location */\n    var RR;       /* distance between center and location */\n    var CT;       /* sin of geocentric latitude */\n    var ST;       /* cos of geocentric latitude */\n    var RX;\n    var RK;\n    var RN;       /* Earth radius at location */\n    var CPHI0;    /* cos of start or old geodetic latitude in iterations */\n    var SPHI0;    /* sin of start or old geodetic latitude in iterations */\n    var CPHI;     /* cos of searched geodetic latitude */\n    var SPHI;     /* sin of searched geodetic latitude */\n    var SDPHI;    /* end-criterium: addition-theorem of sin(Latitude(iter)-Latitude(iter-1)) */\n    var At_Pole;     /* indicates location is in polar region */\n    var iter;        /* # of continous iteration, max. 30 is always enough (s.a.) */\n\n    var X = p.x;\n    var Y = p.y;\n    var Z = p.z ? p.z : 0.0;   //Z value not always supplied\n    var Longitude;\n    var Latitude;\n    var Height;\n\n    At_Pole = false;\n    P = Math.sqrt(X*X+Y*Y);\n    RR = Math.sqrt(X*X+Y*Y+Z*Z);\n\n/*      special cases for latitude and longitude */\n    if (P/this.a < genau) {\n\n/*  special case, if P=0. (X=0., Y=0.) */\n        At_Pole = true;\n        Longitude = 0.0;\n\n/*  if (X,Y,Z)=(0.,0.,0.) then Height becomes semi-minor axis\n *  of ellipsoid (=center of mass), Latitude becomes PI/2 */\n        if (RR/this.a < genau) {\n            Latitude = Proj4js.common.HALF_PI;\n            Height   = -this.b;\n            return;\n        }\n    } else {\n/*  ellipsoidal (geodetic) longitude\n *  interval: -PI < Longitude <= +PI */\n        Longitude=Math.atan2(Y,X);\n    }\n\n/* --------------------------------------------------------------\n * Following iterative algorithm was developped by\n * \"Institut fr Erdmessung\", University of Hannover, July 1988.\n * Internet: www.ife.uni-hannover.de\n * Iterative computation of CPHI,SPHI and Height.\n * Iteration of CPHI and SPHI to 10**-12 radian resp.\n * 2*10**-7 arcsec.\n * --------------------------------------------------------------\n */\n    CT = Z/RR;\n    ST = P/RR;\n    RX = 1.0/Math.sqrt(1.0-this.es*(2.0-this.es)*ST*ST);\n    CPHI0 = ST*(1.0-this.es)*RX;\n    SPHI0 = CT*RX;\n    iter = 0;\n\n/* loop to find sin(Latitude) resp. Latitude\n * until |sin(Latitude(iter)-Latitude(iter-1))| < genau */\n    do\n    {\n        iter++;\n        RN = this.a/Math.sqrt(1.0-this.es*SPHI0*SPHI0);\n\n/*  ellipsoidal (geodetic) height */\n        Height = P*CPHI0+Z*SPHI0-RN*(1.0-this.es*SPHI0*SPHI0);\n\n        RK = this.es*RN/(RN+Height);\n        RX = 1.0/Math.sqrt(1.0-RK*(2.0-RK)*ST*ST);\n        CPHI = ST*(1.0-RK)*RX;\n        SPHI = CT*RX;\n        SDPHI = SPHI*CPHI0-CPHI*SPHI0;\n        CPHI0 = CPHI;\n        SPHI0 = SPHI;\n    }\n    while (SDPHI*SDPHI > genau2 && iter < maxiter);\n\n/*      ellipsoidal (geodetic) latitude */\n    Latitude=Math.atan(SPHI/Math.abs(CPHI));\n\n    p.x = Longitude;\n    p.y = Latitude;\n    p.z = Height;\n    return p;\n  }, // cs_geocentric_to_geodetic()\n\n  /** Convert_Geocentric_To_Geodetic\n   * The method used here is derived from 'An Improved Algorithm for\n   * Geocentric to Geodetic Coordinate Conversion', by Ralph Toms, Feb 1996\n   */\n  geocentric_to_geodetic_noniter : function (p) {\n    var X = p.x;\n    var Y = p.y;\n    var Z = p.z ? p.z : 0;   //Z value not always supplied\n    var Longitude;\n    var Latitude;\n    var Height;\n\n    var W;        /* distance from Z axis */\n    var W2;       /* square of distance from Z axis */\n    var T0;       /* initial estimate of vertical component */\n    var T1;       /* corrected estimate of vertical component */\n    var S0;       /* initial estimate of horizontal component */\n    var S1;       /* corrected estimate of horizontal component */\n    var Sin_B0;   /* Math.sin(B0), B0 is estimate of Bowring aux variable */\n    var Sin3_B0;  /* cube of Math.sin(B0) */\n    var Cos_B0;   /* Math.cos(B0) */\n    var Sin_p1;   /* Math.sin(phi1), phi1 is estimated latitude */\n    var Cos_p1;   /* Math.cos(phi1) */\n    var Rn;       /* Earth radius at location */\n    var Sum;      /* numerator of Math.cos(phi1) */\n    var At_Pole;  /* indicates location is in polar region */\n\n    X = parseFloat(X);  // cast from string to float\n    Y = parseFloat(Y);\n    Z = parseFloat(Z);\n\n    At_Pole = false;\n    if (X != 0.0)\n    {\n        Longitude = Math.atan2(Y,X);\n    }\n    else\n    {\n        if (Y > 0)\n        {\n            Longitude = Proj4js.common.HALF_PI;\n        }\n        else if (Y < 0)\n        {\n            Longitude = -Proj4js.common.HALF_PI;\n        }\n        else\n        {\n            At_Pole = true;\n            Longitude = 0.0;\n            if (Z > 0.0)\n            {  /* north pole */\n                Latitude = Proj4js.common.HALF_PI;\n            }\n            else if (Z < 0.0)\n            {  /* south pole */\n                Latitude = -Proj4js.common.HALF_PI;\n            }\n            else\n            {  /* center of earth */\n                Latitude = Proj4js.common.HALF_PI;\n                Height = -this.b;\n                return;\n            }\n        }\n    }\n    W2 = X*X + Y*Y;\n    W = Math.sqrt(W2);\n    T0 = Z * Proj4js.common.AD_C;\n    S0 = Math.sqrt(T0 * T0 + W2);\n    Sin_B0 = T0 / S0;\n    Cos_B0 = W / S0;\n    Sin3_B0 = Sin_B0 * Sin_B0 * Sin_B0;\n    T1 = Z + this.b * this.ep2 * Sin3_B0;\n    Sum = W - this.a * this.es * Cos_B0 * Cos_B0 * Cos_B0;\n    S1 = Math.sqrt(T1*T1 + Sum * Sum);\n    Sin_p1 = T1 / S1;\n    Cos_p1 = Sum / S1;\n    Rn = this.a / Math.sqrt(1.0 - this.es * Sin_p1 * Sin_p1);\n    if (Cos_p1 >= Proj4js.common.COS_67P5)\n    {\n        Height = W / Cos_p1 - Rn;\n    }\n    else if (Cos_p1 <= -Proj4js.common.COS_67P5)\n    {\n        Height = W / -Cos_p1 - Rn;\n    }\n    else\n    {\n        Height = Z / Sin_p1 + Rn * (this.es - 1.0);\n    }\n    if (At_Pole == false)\n    {\n        Latitude = Math.atan(Sin_p1 / Cos_p1);\n    }\n\n    p.x = Longitude;\n    p.y = Latitude;\n    p.z = Height;\n    return p;\n  }, // geocentric_to_geodetic_noniter()\n\n  /****************************************************************/\n  // pj_geocentic_to_wgs84( p )\n  //  p = point to transform in geocentric coordinates (x,y,z)\n  geocentric_to_wgs84 : function ( p ) {\n\n    if( this.datum_type == Proj4js.common.PJD_3PARAM )\n    {\n      // if( x[io] == HUGE_VAL )\n      //    continue;\n      p.x += this.datum_params[0];\n      p.y += this.datum_params[1];\n      p.z += this.datum_params[2];\n\n    }\n    else if (this.datum_type == Proj4js.common.PJD_7PARAM)\n    {\n      var Dx_BF =this.datum_params[0];\n      var Dy_BF =this.datum_params[1];\n      var Dz_BF =this.datum_params[2];\n      var Rx_BF =this.datum_params[3];\n      var Ry_BF =this.datum_params[4];\n      var Rz_BF =this.datum_params[5];\n      var M_BF  =this.datum_params[6];\n      // if( x[io] == HUGE_VAL )\n      //    continue;\n      var x_out = M_BF*(       p.x - Rz_BF*p.y + Ry_BF*p.z) + Dx_BF;\n      var y_out = M_BF*( Rz_BF*p.x +       p.y - Rx_BF*p.z) + Dy_BF;\n      var z_out = M_BF*(-Ry_BF*p.x + Rx_BF*p.y +       p.z) + Dz_BF;\n      p.x = x_out;\n      p.y = y_out;\n      p.z = z_out;\n    }\n  }, // cs_geocentric_to_wgs84\n\n  /****************************************************************/\n  // pj_geocentic_from_wgs84()\n  //  coordinate system definition,\n  //  point to transform in geocentric coordinates (x,y,z)\n  geocentric_from_wgs84 : function( p ) {\n\n    if( this.datum_type == Proj4js.common.PJD_3PARAM )\n    {\n      //if( x[io] == HUGE_VAL )\n      //    continue;\n      p.x -= this.datum_params[0];\n      p.y -= this.datum_params[1];\n      p.z -= this.datum_params[2];\n\n    }\n    else if (this.datum_type == Proj4js.common.PJD_7PARAM)\n    {\n      var Dx_BF =this.datum_params[0];\n      var Dy_BF =this.datum_params[1];\n      var Dz_BF =this.datum_params[2];\n      var Rx_BF =this.datum_params[3];\n      var Ry_BF =this.datum_params[4];\n      var Rz_BF =this.datum_params[5];\n      var M_BF  =this.datum_params[6];\n      var x_tmp = (p.x - Dx_BF) / M_BF;\n      var y_tmp = (p.y - Dy_BF) / M_BF;\n      var z_tmp = (p.z - Dz_BF) / M_BF;\n      //if( x[io] == HUGE_VAL )\n      //    continue;\n\n      p.x =        x_tmp + Rz_BF*y_tmp - Ry_BF*z_tmp;\n      p.y = -Rz_BF*x_tmp +       y_tmp + Rx_BF*z_tmp;\n      p.z =  Ry_BF*x_tmp - Rx_BF*y_tmp +       z_tmp;\n    } //cs_geocentric_from_wgs84()\n  }\n});\n\n/** point object, nothing fancy, just allows values to be\n    passed back and forth by reference rather than by value.\n    Other point classes may be used as long as they have\n    x and y properties, which will get modified in the transform method.\n*/\nProj4js.Point = Proj4js.Class({\n\n    /**\n     * Constructor: Proj4js.Point\n     *\n     * Parameters:\n     * - x {float} or {Array} either the first coordinates component or\n     *     the full coordinates\n     * - y {float} the second component\n     * - z {float} the third component, optional.\n     */\n    initialize : function(x,y,z) {\n      if (typeof x == 'object') {\n        this.x = x[0];\n        this.y = x[1];\n        this.z = x[2] || 0.0;\n      } else if (typeof x == 'string' && typeof y == 'undefined') {\n        var coords = x.split(',');\n        this.x = parseFloat(coords[0]);\n        this.y = parseFloat(coords[1]);\n        this.z = parseFloat(coords[2]) || 0.0;\n      } else {\n        this.x = x;\n        this.y = y;\n        this.z = z || 0.0;\n      }\n    },\n\n    /**\n     * APIMethod: clone\n     * Build a copy of a Proj4js.Point object.\n     *\n     * Return:\n     * {Proj4js}.Point the cloned point.\n     */\n    clone : function() {\n      return new Proj4js.Point(this.x, this.y, this.z);\n    },\n\n    /**\n     * APIMethod: toString\n     * Return a readable string version of the point\n     *\n     * Return:\n     * {String} String representation of Proj4js.Point object. \n     *           (ex. <i>\"x=5,y=42\"</i>)\n     */\n    toString : function() {\n        return (\"x=\" + this.x + \",y=\" + this.y);\n    },\n\n    /** \n     * APIMethod: toShortString\n     * Return a short string version of the point.\n     *\n     * Return:\n     * {String} Shortened String representation of Proj4js.Point object. \n     *         (ex. <i>\"5, 42\"</i>)\n     */\n    toShortString : function() {\n        return (this.x + \", \" + this.y);\n    }\n});\n\nProj4js.PrimeMeridian = {\n    \"greenwich\": 0.0,               //\"0dE\",\n    \"lisbon\":     -9.131906111111,   //\"9d07'54.862\\\"W\",\n    \"paris\":       2.337229166667,   //\"2d20'14.025\\\"E\",\n    \"bogota\":    -74.080916666667,  //\"74d04'51.3\\\"W\",\n    \"madrid\":     -3.687938888889,  //\"3d41'16.58\\\"W\",\n    \"rome\":       12.452333333333,  //\"12d27'8.4\\\"E\",\n    \"bern\":        7.439583333333,  //\"7d26'22.5\\\"E\",\n    \"jakarta\":   106.807719444444,  //\"106d48'27.79\\\"E\",\n    \"ferro\":     -17.666666666667,  //\"17d40'W\",\n    \"brussels\":    4.367975,        //\"4d22'4.71\\\"E\",\n    \"stockholm\":  18.058277777778,  //\"18d3'29.8\\\"E\",\n    \"athens\":     23.7163375,       //\"23d42'58.815\\\"E\",\n    \"oslo\":       10.722916666667   //\"10d43'22.5\\\"E\"\n};\n\nProj4js.Ellipsoid = {\n  \"MERIT\": {a:6378137.0, rf:298.257, ellipseName:\"MERIT 1983\"},\n  \"SGS85\": {a:6378136.0, rf:298.257, ellipseName:\"Soviet Geodetic System 85\"},\n  \"GRS80\": {a:6378137.0, rf:298.257222101, ellipseName:\"GRS 1980(IUGG, 1980)\"},\n  \"IAU76\": {a:6378140.0, rf:298.257, ellipseName:\"IAU 1976\"},\n  \"airy\": {a:6377563.396, b:6356256.910, ellipseName:\"Airy 1830\"},\n  \"APL4.\": {a:6378137, rf:298.25, ellipseName:\"Appl. Physics. 1965\"},\n  \"NWL9D\": {a:6378145.0, rf:298.25, ellipseName:\"Naval Weapons Lab., 1965\"},\n  \"mod_airy\": {a:6377340.189, b:6356034.446, ellipseName:\"Modified Airy\"},\n  \"andrae\": {a:6377104.43, rf:300.0, ellipseName:\"Andrae 1876 (Den., Iclnd.)\"},\n  \"aust_SA\": {a:6378160.0, rf:298.25, ellipseName:\"Australian Natl & S. Amer. 1969\"},\n  \"GRS67\": {a:6378160.0, rf:298.2471674270, ellipseName:\"GRS 67(IUGG 1967)\"},\n  \"bessel\": {a:6377397.155, rf:299.1528128, ellipseName:\"Bessel 1841\"},\n  \"bess_nam\": {a:6377483.865, rf:299.1528128, ellipseName:\"Bessel 1841 (Namibia)\"},\n  \"clrk66\": {a:6378206.4, b:6356583.8, ellipseName:\"Clarke 1866\"},\n  \"clrk80\": {a:6378249.145, rf:293.4663, ellipseName:\"Clarke 1880 mod.\"},\n  \"CPM\": {a:6375738.7, rf:334.29, ellipseName:\"Comm. des Poids et Mesures 1799\"},\n  \"delmbr\": {a:6376428.0, rf:311.5, ellipseName:\"Delambre 1810 (Belgium)\"},\n  \"engelis\": {a:6378136.05, rf:298.2566, ellipseName:\"Engelis 1985\"},\n  \"evrst30\": {a:6377276.345, rf:300.8017, ellipseName:\"Everest 1830\"},\n  \"evrst48\": {a:6377304.063, rf:300.8017, ellipseName:\"Everest 1948\"},\n  \"evrst56\": {a:6377301.243, rf:300.8017, ellipseName:\"Everest 1956\"},\n  \"evrst69\": {a:6377295.664, rf:300.8017, ellipseName:\"Everest 1969\"},\n  \"evrstSS\": {a:6377298.556, rf:300.8017, ellipseName:\"Everest (Sabah & Sarawak)\"},\n  \"fschr60\": {a:6378166.0, rf:298.3, ellipseName:\"Fischer (Mercury Datum) 1960\"},\n  \"fschr60m\": {a:6378155.0, rf:298.3, ellipseName:\"Fischer 1960\"},\n  \"fschr68\": {a:6378150.0, rf:298.3, ellipseName:\"Fischer 1968\"},\n  \"helmert\": {a:6378200.0, rf:298.3, ellipseName:\"Helmert 1906\"},\n  \"hough\": {a:6378270.0, rf:297.0, ellipseName:\"Hough\"},\n  \"intl\": {a:6378388.0, rf:297.0, ellipseName:\"International 1909 (Hayford)\"},\n  \"kaula\": {a:6378163.0, rf:298.24, ellipseName:\"Kaula 1961\"},\n  \"lerch\": {a:6378139.0, rf:298.257, ellipseName:\"Lerch 1979\"},\n  \"mprts\": {a:6397300.0, rf:191.0, ellipseName:\"Maupertius 1738\"},\n  \"new_intl\": {a:6378157.5, b:6356772.2, ellipseName:\"New International 1967\"},\n  \"plessis\": {a:6376523.0, rf:6355863.0, ellipseName:\"Plessis 1817 (France)\"},\n  \"krass\": {a:6378245.0, rf:298.3, ellipseName:\"Krassovsky, 1942\"},\n  \"SEasia\": {a:6378155.0, b:6356773.3205, ellipseName:\"Southeast Asia\"},\n  \"walbeck\": {a:6376896.0, b:6355834.8467, ellipseName:\"Walbeck\"},\n  \"WGS60\": {a:6378165.0, rf:298.3, ellipseName:\"WGS 60\"},\n  \"WGS66\": {a:6378145.0, rf:298.25, ellipseName:\"WGS 66\"},\n  \"WGS72\": {a:6378135.0, rf:298.26, ellipseName:\"WGS 72\"},\n  \"WGS84\": {a:6378137.0, rf:298.257223563, ellipseName:\"WGS 84\"},\n  \"sphere\": {a:6370997.0, b:6370997.0, ellipseName:\"Normal Sphere (r=6370997)\"}\n};\n\nProj4js.Datum = {\n  \"WGS84\": {towgs84: \"0,0,0\", ellipse: \"WGS84\", datumName: \"WGS84\"},\n  \"GGRS87\": {towgs84: \"-199.87,74.79,246.62\", ellipse: \"GRS80\", datumName: \"Greek_Geodetic_Reference_System_1987\"},\n  \"NAD83\": {towgs84: \"0,0,0\", ellipse: \"GRS80\", datumName: \"North_American_Datum_1983\"},\n  \"NAD27\": {nadgrids: \"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat\", ellipse: \"clrk66\", datumName: \"North_American_Datum_1927\"},\n  \"potsdam\": {towgs84: \"606.0,23.0,413.0\", ellipse: \"bessel\", datumName: \"Potsdam Rauenberg 1950 DHDN\"},\n  \"carthage\": {towgs84: \"-263.0,6.0,431.0\", ellipse: \"clark80\", datumName: \"Carthage 1934 Tunisia\"},\n  \"hermannskogel\": {towgs84: \"653.0,-212.0,449.0\", ellipse: \"bessel\", datumName: \"Hermannskogel\"},\n  \"ire65\": {towgs84: \"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\", ellipse: \"mod_airy\", datumName: \"Ireland 1965\"},\n  \"nzgd49\": {towgs84: \"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993\", ellipse: \"intl\", datumName: \"New Zealand Geodetic Datum 1949\"},\n  \"OSGB36\": {towgs84: \"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894\", ellipse: \"airy\", datumName: \"Airy 1830\"}\n};\n\nProj4js.WGS84 = new Proj4js.Proj('WGS84');\nProj4js.Datum['OSB36'] = Proj4js.Datum['OSGB36']; //as returned from spatialreference.org\n\n//lookup table to go from the projection name in WKT to the Proj4js projection name\n//build this out as required\nProj4js.wktProjections = {\n  \"Lambert Tangential Conformal Conic Projection\": \"lcc\",\n  \"Mercator\": \"merc\",\n  \"Popular Visualisation Pseudo Mercator\": \"merc\",\n  \"Mercator_1SP\": \"merc\",\n  \"Transverse_Mercator\": \"tmerc\",\n  \"Transverse Mercator\": \"tmerc\",\n  \"Lambert Azimuthal Equal Area\": \"laea\",\n  \"Universal Transverse Mercator System\": \"utm\"\n};\n\n\n/*******************************************************************************\r\nNAME                            TRANSVERSE MERCATOR\r\n\r\nPURPOSE:\tTransforms input longitude and latitude to Easting and\r\n\t\tNorthing for the Transverse Mercator projection.  The\r\n\t\tlongitude and latitude must be in radians.  The Easting\r\n\t\tand Northing values will be returned in meters.\r\n\r\nALGORITHM REFERENCES\r\n\r\n1.  Snyder, John P., \"Map Projections--A Working Manual\", U.S. Geological\r\n    Survey Professional Paper 1395 (Supersedes USGS Bulletin 1532), United\r\n    State Government Printing Office, Washington D.C., 1987.\r\n\r\n2.  Snyder, John P. and Voxland, Philip M., \"An Album of Map Projections\",\r\n    U.S. Geological Survey Professional Paper 1453 , United State Government\r\n    Printing Office, Washington D.C., 1989.\r\n*******************************************************************************/\r\n\r\n\r\n/**\r\n  Initialize Transverse Mercator projection\r\n*/\r\n\r\nProj4js.Proj.tmerc = {\r\n  init : function() {\r\n    this.e0 = Proj4js.common.e0fn(this.es);\r\n    this.e1 = Proj4js.common.e1fn(this.es);\r\n    this.e2 = Proj4js.common.e2fn(this.es);\r\n    this.e3 = Proj4js.common.e3fn(this.es);\r\n    this.ml0 = this.a * Proj4js.common.mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\r\n  },\r\n\r\n  /**\r\n    Transverse Mercator Forward  - long/lat to x/y\r\n    long/lat in radians\r\n  */\r\n  forward : function(p) {\r\n    var lon = p.x;\r\n    var lat = p.y;\r\n\r\n    var delta_lon = Proj4js.common.adjust_lon(lon - this.long0); // Delta longitude\r\n    var con;    // cone constant\r\n    var x, y;\r\n    var sin_phi=Math.sin(lat);\r\n    var cos_phi=Math.cos(lat);\r\n\r\n    if (this.sphere) {  /* spherical form */\r\n      var b = cos_phi * Math.sin(delta_lon);\r\n      if ((Math.abs(Math.abs(b) - 1.0)) < .0000000001)  {\r\n        Proj4js.reportError(\"tmerc:forward: Point projects into infinity\");\r\n        return(93);\r\n      } else {\r\n        x = .5 * this.a * this.k0 * Math.log((1.0 + b)/(1.0 - b));\r\n        con = Math.acos(cos_phi * Math.cos(delta_lon)/Math.sqrt(1.0 - b*b));\r\n        if (lat < 0) con = - con;\r\n        y = this.a * this.k0 * (con - this.lat0);\r\n      }\r\n    } else {\r\n      var al  = cos_phi * delta_lon;\r\n      var als = Math.pow(al,2);\r\n      var c   = this.ep2 * Math.pow(cos_phi,2);\r\n      var tq  = Math.tan(lat);\r\n      var t   = Math.pow(tq,2);\r\n      con = 1.0 - this.es * Math.pow(sin_phi,2);\r\n      var n   = this.a / Math.sqrt(con);\r\n      var ml  = this.a * Proj4js.common.mlfn(this.e0, this.e1, this.e2, this.e3, lat);\r\n\r\n      x = this.k0 * n * al * (1.0 + als / 6.0 * (1.0 - t + c + als / 20.0 * (5.0 - 18.0 * t + Math.pow(t,2) + 72.0 * c - 58.0 * this.ep2))) + this.x0;\r\n      y = this.k0 * (ml - this.ml0 + n * tq * (als * (0.5 + als / 24.0 * (5.0 - t + 9.0 * c + 4.0 * Math.pow(c,2) + als / 30.0 * (61.0 - 58.0 * t + Math.pow(t,2) + 600.0 * c - 330.0 * this.ep2))))) + this.y0;\r\n\r\n    }\r\n    p.x = x; p.y = y;\r\n    return p;\r\n  }, // tmercFwd()\r\n\r\n  /**\r\n    Transverse Mercator Inverse  -  x/y to long/lat\r\n  */\r\n  inverse : function(p) {\r\n    var con, phi;  /* temporary angles       */\r\n    var delta_phi; /* difference between longitudes    */\r\n    var i;\r\n    var max_iter = 6;      /* maximun number of iterations */\r\n    var lat, lon;\r\n\r\n    if (this.sphere) {   /* spherical form */\r\n      var f = Math.exp(p.x/(this.a * this.k0));\r\n      var g = .5 * (f - 1/f);\r\n      var temp = this.lat0 + p.y/(this.a * this.k0);\r\n      var h = Math.cos(temp);\r\n      con = Math.sqrt((1.0 - h * h)/(1.0 + g * g));\r\n      lat = Proj4js.common.asinz(con);\r\n      if (temp < 0)\r\n        lat = -lat;\r\n      if ((g == 0) && (h == 0)) {\r\n        lon = this.long0;\r\n      } else {\r\n        lon = Proj4js.common.adjust_lon(Math.atan2(g,h) + this.long0);\r\n      }\r\n    } else {    // ellipsoidal form\r\n      var x = p.x - this.x0;\r\n      var y = p.y - this.y0;\r\n\r\n      con = (this.ml0 + y / this.k0) / this.a;\r\n      phi = con;\r\n      for (i=0;true;i++) {\r\n        delta_phi=((con + this.e1 * Math.sin(2.0*phi) - this.e2 * Math.sin(4.0*phi) + this.e3 * Math.sin(6.0*phi)) / this.e0) - phi;\r\n        phi += delta_phi;\r\n        if (Math.abs(delta_phi) <= Proj4js.common.EPSLN) break;\r\n        if (i >= max_iter) {\r\n          Proj4js.reportError(\"tmerc:inverse: Latitude failed to converge\");\r\n          return(95);\r\n        }\r\n      } // for()\r\n      if (Math.abs(phi) < Proj4js.common.HALF_PI) {\r\n        // sincos(phi, &sin_phi, &cos_phi);\r\n        var sin_phi=Math.sin(phi);\r\n        var cos_phi=Math.cos(phi);\r\n        var tan_phi = Math.tan(phi);\r\n        var c = this.ep2 * Math.pow(cos_phi,2);\r\n        var cs = Math.pow(c,2);\r\n        var t = Math.pow(tan_phi,2);\r\n        var ts = Math.pow(t,2);\r\n        con = 1.0 - this.es * Math.pow(sin_phi,2);\r\n        var n = this.a / Math.sqrt(con);\r\n        var r = n * (1.0 - this.es) / con;\r\n        var d = x / (n * this.k0);\r\n        var ds = Math.pow(d,2);\r\n        lat = phi - (n * tan_phi * ds / r) * (0.5 - ds / 24.0 * (5.0 + 3.0 * t + 10.0 * c - 4.0 * cs - 9.0 * this.ep2 - ds / 30.0 * (61.0 + 90.0 * t + 298.0 * c + 45.0 * ts - 252.0 * this.ep2 - 3.0 * cs)));\r\n        lon = Proj4js.common.adjust_lon(this.long0 + (d * (1.0 - ds / 6.0 * (1.0 + 2.0 * t + c - ds / 20.0 * (5.0 - 2.0 * c + 28.0 * t - 3.0 * cs + 8.0 * this.ep2 + 24.0 * ts))) / cos_phi));\r\n      } else {\r\n        lat = Proj4js.common.HALF_PI * Proj4js.common.sign(y);\r\n        lon = this.long0;\r\n      }\r\n    }\r\n    p.x = lon;\r\n    p.y = lat;\r\n    return p;\r\n  } // tmercInv()\r\n};Proj4js.defs['UTMK'] = '+title=UTMK +proj=tmerc +lat_0=38.0 +lon_0=127.5 +x_0=1000000.0 +y_0=2000000.0 +k=0.9996 +a=6378137.0 +b=6356752.3141403 +ellps=GRS80 +towgs84=0,0,0 +no_defs';\r\nProj4js.defs['KATECH'] = '+title=KATECH +proj=tmerc +lat_0=38.0 +lon_0=128.0 +x_0=400000.0 +y_0=600000.0 +k=0.9999 +a=6377397.155 +b=6356078.9633422494 +ellps=bessel +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43 +no_defs';\r\n/**\r\n *   . Coord     ,\r\n *       .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Coord').define({\r\n\r\n  $static: {\r\n    /**\r\n     * {@link olleh.maps.Coord#almostEquals}    .  .\r\n     * @constant\r\n     * @type Number\r\n     */\r\n    DEFAULT_EPSILON_IN_METER: 0.001 // 1 mm\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   */\r\n  Coord: function () {\r\n    if (this.$classname === 'olleh.maps.Coord') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.Coord directly.');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * x.\r\n   * @name x\r\n   * @memberof olleh.maps.Coord.prototype\r\n   * @field\r\n   * @type Number\r\n   * @readonly\r\n   */\r\n\r\n  /**\r\n   * y.\r\n   * @name y\r\n   * @memberof olleh.maps.Coord.prototype\r\n   * @field\r\n   * @type Number\r\n   * @readonly\r\n   */\r\n\r\n  /**\r\n   *     .     . \r\n   * @param {olleh.maps.Coord} other   .\r\n   * @returns {Boolean}   true,    false.\r\n   */\r\n  equals: function (other) {\r\n    return other && this.x === other.x && this.y === other.y && other.getClass() === this.getClass();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *          .\r\n   *           . \r\n   * @param {olleh.maps.Coord} other   \r\n   * @param {Number} [epsilonInMeter=olleh.maps.Coord.DEFAULT_EPSILON_IN_METER]  .  .\r\n   * @returns {Boolean}      true,    false.\r\n   */\r\n  almostEquals: function (other, epsilonInMeter) {\r\n    return this.distanceTo(other) < (epsilonInMeter || olleh.maps.Coord.DEFAULT_EPSILON_IN_METER);\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @param {olleh.maps.Coord} other  .\r\n   * @returns {Number}   .  .\r\n   */\r\n  distanceTo: function (other) {\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other ? other.asDefault() : {\r\n      x: 0,\r\n      y: 0\r\n    };\r\n    var diff = {\r\n      x: utmkThis.x - utmkOther.x,\r\n      y: utmkThis.y - utmkOther.y\r\n    };\r\n    return Math.sqrt(Math.abs(diff.x * diff.x + diff.y * diff.y));\r\n  },\r\n  \r\n  /**\r\n   *  x, y      .\r\n   * @returns {Object} Plain-old JavaScript Object \r\n   */\r\n  xy: function () {\r\n    return {\r\n      x: this.x,\r\n      y: this.y\r\n    };\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @private\r\n   * @param {cls} Type   .\r\n   * @returns {olleh.maps.Coord}  .\r\n   */\r\n  transform: function (Type) {\r\n    if (this.getClass() === Type) {\r\n      return this;\r\n    }\r\n    return new Type(Proj4js.transform(this.getClass().PROJ, Type.PROJ, this.xy()));\r\n  },\r\n\r\n  /**\r\n   *     {@link olleh.maps.UTMK}  .\r\n   * @returns {olleh.maps.UTMK}  .\r\n   */\r\n  asDefault: function () {\r\n    return olleh.maps.UTMK.valueOf(this);\r\n  },\r\n  \r\n  /**\r\n   * Coord  .\r\n   * @returns {olleh.maps.Coord}  \r\n   */\r\n  clone: function () {\r\n    return new this.constructor(this.xy());\r\n  }\r\n\r\n});\r\n/**\r\n * UTM-K     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.UTMK').extend(olleh.maps.Coord).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type Proj4js.Proj\r\n     */\r\n    PROJ: new Proj4js.Proj('UTMK'),\r\n    \r\n    _projs: {},\r\n    \r\n    /**\r\n     *   UTM-K   .\r\n     * @param {olleh.maps.Coord} coord   .\r\n     * @returns {olleh.maps.UTMK}  .\r\n     *//**\r\n     *     UTM-K    .\r\n     * {@link olleh.maps.LatLng}, {@link olleh.maps.Katech}   \r\n     *      ,   \r\n     *    {@link olleh.maps.UTMK.valueOf(coord)} \r\n     *  .\r\n     * @param {Object} xy x y   .\r\n     * @param {Number} xy.x x.\r\n     * @param {Number} xy.y y.\r\n     * @param {String} crs   Proj4js CRS .\r\n     * @returns {olleh.maps.UTMK}  .\r\n     * @see http://trac.osgeo.org/proj4js/wiki/UserGuide\r\n     *//**\r\n     *     UTM-K    .\r\n     * {@link olleh.maps.LatLng}, {@link olleh.maps.Katech}   \r\n     *      ,   \r\n     *    {@link olleh.maps.UTMK.valueOf(coord)} \r\n     *  .\r\n     * @param {Number} x x.\r\n     * @param {Number} y y.\r\n     * @param {String} crs   Proj4js CRS .\r\n     * @returns {olleh.maps.UTMK}  .\r\n     * @see http://trac.osgeo.org/proj4js/wiki/UserGuide\r\n     */\r\n    valueOf: function () {\r\n      var proj, xy, crs;\r\n      switch (arguments.length) {\r\n      case 0:\r\n        return olleh.maps.UTMK;\r\n      case 1:\r\n        return arguments[0].transform(olleh.maps.UTMK);\r\n      case 2:\r\n        xy = arguments[0];\r\n        crs = arguments[1];\r\n        break;\r\n      default:\r\n        xy = {\r\n          x: arguments[0],\r\n          y: arguments[1]\r\n        };\r\n        crs = arguments[2];\r\n        break;\r\n      } \r\n\r\n      if (crs != 'UTMK') {\r\n        proj = olleh.maps.UTMK._projs[crs];\r\n        if (!proj) {\r\n          proj = olleh.maps.UTMK._projs[crs] = new Proj4js.Proj(crs);\r\n        }\r\n        xy = Proj4js.transform(proj, olleh.maps.UTMK.PROJ, xy);\r\n      }\r\n      \r\n      return new olleh.maps.UTMK(xy);\r\n    }\r\n\r\n  },\r\n  \r\n  /**\r\n   *  UTMK  .\r\n   * @param {Object} xy x y   .\r\n   * @function UTMK\r\n   * @memberof olleh.maps.UTMK\r\n   * @instance\r\n   */\r\n  /**\r\n   * UTMK  .\r\n   * @param {Number} x x.\r\n   * @param {Number} y y.\r\n   */\r\n  UTMK: function (arg0, arg1) {\r\n    if (arguments.length > 1) {\r\n      this.x = +arg0;\r\n      this.y = +arg1;\r\n    } else {\r\n      this.x = +arg0.x;\r\n      this.y = +arg0.y;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  UTMK   .<br/>\r\n   *  {x: 957085.70, y: 1944017.52} .\r\n   * @returns   \r\n   */\r\n  toString: function () {\r\n    return '{x: ' + this.x + ', y: ' + this.y + '}';\r\n  },\r\n\r\n  /**\r\n   *     {@link olleh.maps.UTMK}  .\r\n   * @returns {olleh.maps.UTMK}  .\r\n   */\r\n  asDefault: function () {\r\n    // asDefault()       \r\n    return this;\r\n  }\r\n  \r\n});\r\n/** \r\n * LatLng(WGS84)     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.LatLng').extend(olleh.maps.Coord).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type Proj4js.Proj\r\n     */\r\n    PROJ: new Proj4js.Proj('WGS84'),\r\n    \r\n    /**\r\n     *   LatLng   .\r\n     * @param {olleh.maps.Coord}   .\r\n     * @returns {olleh.maps.LatLng}  .\r\n     */\r\n   valueOf: function (coord) {\r\n     if (!arguments.length) {\r\n       return olleh.maps.LatLng;\r\n     }\r\n      return coord.transform(olleh.maps.LatLng);\r\n    }\r\n  },\r\n\r\n\r\n  /**\r\n   *  LatLng  .\r\n   * @param {Object} xy x y   .\r\n   * @function LatLng\r\n   * @memberof olleh.maps.LatLng\r\n   * @instance\r\n   */\r\n  /**\r\n   *  LatLng  .\r\n   * @param {Object} latlng lat lng   .\r\n   * @function LatLng\r\n   * @memberof olleh.maps.LatLng\r\n   * @instance\r\n   */\r\n  /**\r\n   * LatLng  .   y, x  .\r\n   * @param {Number} y y(Latitude).\r\n   * @param {Number} x x(Longitude).\r\n   */\r\n  LatLng: function (arg0, arg1) {\r\n    if (arguments.length > 1) {\r\n      this.y = +arg0;\r\n      this.x = +arg1;\r\n    } else if (arg0.lat !== undefined) {\r\n      this.y = +arg0.lat;\r\n      this.x = +arg0.lng;\r\n    } else {\r\n      this.y = +arg0.y;\r\n      this.x = +arg0.x;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  LatLng(WGS84)   .<br/>\r\n   *  {lat: 37.494416325586315, lng: 127.0145272694056} .\r\n   * @returns   \r\n   */\r\n  toString: function () {\r\n    return '{lat: ' + this.y + ', lng: ' + this.x + '}';\r\n  }\r\n});\r\n/**\r\n * Katech     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Katech').extend(olleh.maps.Coord).define({\r\n\r\n  $static:  {\r\n    /**\r\n     * @constant\r\n     * @type Proj4js.Proj\r\n     */\r\n    PROJ: new Proj4js.Proj('KATECH'),\r\n    \r\n    /**\r\n     *  Katech  .\r\n     * @param {olleh.maps.Coord}   .\r\n     * @returns {olleh.maps.Katech}  .\r\n     */\r\n    valueOf: function (coord) {\r\n      if (!arguments.length) {\r\n        return olleh.maps.Katech;\r\n      }\r\n      return coord.transform(olleh.maps.Katech);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  Katech  .\r\n   * @param {Object} xy x y   .\r\n   * @function Katech\r\n   * @memberof olleh.maps.Katech\r\n   * @instance\r\n   */\r\n  /**\r\n   * Katech  .\r\n   * @param {Number} x x.\r\n   * @param {Number} y y.\r\n   */\r\n  Katech: function (arg0, arg1) {\r\n    if (arguments.length > 1) {\r\n      this.x = +arg0;\r\n      this.y = +arg1;\r\n    } else {\r\n      this.x = +arg0.x;\r\n      this.y = +arg0.y;\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *     class.   {@link olleh.maps.Coord} class  .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Path').define({\r\n\r\n  /**\r\n   * ,  coords    .\r\n   * @param {Array.<olleh.maps.Coord>} [coords] {@link olleh.maps.Coord} \r\n   */\r\n  Path: function (coords) {\r\n    this._coords = coords || [];\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   */\r\n  clear: function () {\r\n    this._coords = [];\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @returns {Array.<olleh.maps.Coord>}\r\n   */\r\n  getCoords: function () {\r\n    return this._coords;\r\n  },\r\n\r\n  /**\r\n   * i   .\r\n   * @param {Number} i\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getAt: function (i) {\r\n    return this._coords[i];\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @return {Number}\r\n   */\r\n  getLength: function () {\r\n    return this._coords.length;\r\n  },\r\n\r\n  /**\r\n   *  coord  i   .\r\n   * @param {Number} i \r\n   * @param {olleh.maps.Coord} coord \r\n   */\r\n  insertAt: function (i, coord) {\r\n    this._coords.splice(i, 0, coord);\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {olleh.maps.Coord}   \r\n   */\r\n  pop: function () {\r\n    var last = this._coords.pop();\r\n    this._notifyListeners();\r\n    return last;\r\n  },\r\n\r\n  /**\r\n   *  coord   .\r\n   * @param {olleh.maps.Coord} coord\r\n   */\r\n  push: function (coord) {\r\n    this._coords.push(coord);\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   * i   .\r\n   * @param {Number} i\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  removeAt: function (i) {\r\n    return this._coords.splice(i, 1)[0];\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   * i   coord  .\r\n   * @param {Number} i\r\n   * @param {olleh.maps.Coord} coord\r\n   */\r\n  setAt: function (i, coord) {\r\n    this._coords[i] = coord;\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   *  Path    callbackFn  . \r\n   * @param {Function} callbackFn function(path) - path: this object (olleh.maps.Path) \r\n   */\r\n  onChange: function (callbackFn, ctx) {\r\n    var listener = this._getEventListener(callbackFn, true);\r\n    var idx = olleh.maps.util.indexOf(listener.ctxs, ctx);\r\n    if (idx === -1) {\r\n      listener.ctxs.push(ctx);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * onChange()   callbackFn  .\r\n   * @param {Function} callbackFn \r\n   * @param {Object} ctx \r\n   */\r\n  unsubscribeChange: function (callbackFn, ctx) {\r\n    var listener = this._getEventListener(callbackFn, false);\r\n    if (listener) {\r\n      var idx = olleh.maps.util.removeFromArray(listener.ctxs, ctx);\r\n      if (idx > -1 && listener.ctxs.length === 0) {\r\n        olleh.maps.util.removeFromArray(this._listeners, listener);\r\n      }\r\n    }\r\n  },\r\n\r\n  _notifyListeners: function () {\r\n    if (!this._listeners) {\r\n      return;\r\n    }\r\n    for ( var i = 0, len = this._listeners.length; i < len; i++) {\r\n      var listener = this._listeners[i];\r\n      var callbackFn = listener.callbackFn;\r\n      var ctxs = listener.ctxs;\r\n      for ( var j = 0, len = ctxs.length; j < len; j++) {\r\n        callbackFn.call(ctxs[j], this);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @param {Function} callbackFn\r\n   * @param {Boolean} create\r\n   * @returns {Object} callbackFn: Function, ctxs: {Array} \r\n   */\r\n  _getEventListener: function (callbackFn, create) {\r\n    var listener;\r\n    var listeners = this._listeners;\r\n    if (listeners) {\r\n      for ( var i = 0, len = listeners.length; i < len; i++) {\r\n        if (listeners[i].callbackFn === callbackFn) {\r\n          listener = listeners[i];\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    if (!listener && create) {\r\n      if(!listeners) {\r\n        this._listeners = [];\r\n      }\r\n      listener = {\r\n        callbackFn: callbackFn,\r\n        ctxs: []\r\n      };\r\n      this._listeners.push(listener);\r\n    }\r\n    return listener;\r\n  },\r\n  \r\n  /**\r\n   *  Coord  .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getFirst: function() {\r\n    return this.getAt(0);\r\n  },\r\n  \r\n  /**\r\n   *  Coord  .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getLast: function() {\r\n    return this.getAt(this.getLength() - 1);\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @returns {Number}\r\n   */\r\n  getDistance: function() {\r\n    var coords = this._coords;\r\n    if(coords.length < 2)\r\n      return 0;\r\n    var distance = 0;\r\n    for(var i = 1 ; i < coords.length; i++) {\r\n      distance += coords[i - 1].distanceTo(coords[i]);  \r\n    } \r\n    return distance;\r\n  },\r\n  \r\n  /**\r\n   * path  polygon    .\r\n   * @see http://www.mathopenref.com/coordpolygonarea2.html\r\n   */\r\n  getArea: function() {\r\n    var coords = this._coords;\r\n    if(coords.length < 3)\r\n      return 0;\r\n    var j = coords.length - 1;\r\n    var area = 0;\r\n    for (var i = 0; i < coords.length ; i++) {\r\n      var coord1 = coords[j];\r\n      var coord2 = coords[i];\r\n      area += (coord1.x + coord2.x) * (coord1.y - coord2.y);\r\n      j = i;\r\n    }\r\n    area /= 2;\r\n    if(area < 0)\r\n      area = -area;\r\n    return area;\r\n  },\r\n  \r\n  /**\r\n   * Path    .\r\n   * @returns {class}  .\r\n   */\r\n  getType: function () {\r\n    if(this._coords.length === 0)\r\n      return null;\r\n    return this._coords[0].getClass();\r\n  },\r\n  \r\n  /**\r\n   * Path  Polygon    .\r\n   * @returns {olleh.maps.Coord} \r\n   */\r\n  getCenteroid: function() {\r\n    var coords = this._coords;\r\n    var len = coords.length;\r\n    if(len === 0)\r\n      return null;\r\n    if(len === 1)\r\n      return coords[0];\r\n    var sumX = 0.0;\r\n    var sumY = 0.0;\r\n    for (var i=0, j=len-1 ; i < len ; i++ ){\r\n      var b = coords[j];\r\n      var c = coords[i];\r\n      sumX += (b.x + c.x) * (b.x * c.y - c.x * b.y);\r\n      sumY += (b.y + c.y) * (b.x * c.y - c.x * b.y);\r\n      j = i;\r\n    }\r\n    var area = this.getArea();\r\n    var x = sumX / (6 * area);\r\n    var y = sumY / (6 * area);\r\n    var center = new (this.getType())({x: x, y: y});\r\n    return center;\r\n  },\r\n\r\n  /**\r\n   * Path  bounds  .\r\n   * @returns {olleh.maps.Bounds} bounds\r\n   */\r\n  getBounds: function() {\r\n    var coords = this._coords;\r\n    if (!coords.length) {\r\n      return null;\r\n    }\r\n    \r\n    var left = Infinity, bottom = Infinity, right = 0, top = 0;\r\n    for (var i = 0; i < this.getLength(); i++) {\r\n      var coord = this.getAt(i);\r\n      if (left > coord.x) {\r\n        left = coord.x;\r\n      }\r\n      if (bottom > coord.y) {\r\n        bottom = coord.y;\r\n      }\r\n      if (right < coord.x) {\r\n        right = coord.x;\r\n      }\r\n      if (top < coord.y) {\r\n        top = coord.y;\r\n      }\r\n    }\r\n\r\n    var Type = this.getType();\r\n    var leftBottom = new Type({x: left, y: bottom});\r\n    var rightTop = new Type({x: right, y: top});\r\n    return new olleh.maps.Bounds(leftBottom, rightTop);\r\n  },\r\n  \r\n  /**\r\n   * Path  coord    .\r\n   * @param {olleh.maps.Coord} coord \r\n   * @param {Boolean} [closedPath=false] true      closedPath  . \r\n   * @returns {Number} \r\n   */\r\n  distanceTo: function(coord, closedPath) {\r\n    coord = coord.asDefault();\r\n    var coords = this._coords;\r\n    var dist;\r\n    for(var i=0; i<coords.length; i++) {\r\n      var coord1;\r\n      var coord2;\r\n      if(i==coords.length-1) {\r\n        if(closedPath) {\r\n          coord1 = coords[i].asDefault();\r\n          coord2 = coords[0].asDefault();\r\n        } else {\r\n          break;\r\n        }\r\n      } else {\r\n        coord1 = coords[i].asDefault();\r\n        coord2 = coords[i+1].asDefault();\r\n      }\r\n      var d = this._distanceToSegment(coord, {x1:coord1.x, y1:coord1.y, x2:coord2.x, y2:coord2.y });\r\n      if(dist === undefined || d < dist) {\r\n        dist = d;\r\n      }\r\n    }\r\n    return dist;\r\n  },\r\n  \r\n  /**\r\n   * point  segment   .\r\n   * @param {olleh.maps.Coord} coord\r\n   * @param {Object} {x1,y1,x2,y2} x1,y1  x2,y2   \r\n   * @returns {Number} \r\n   * @private \r\n   */\r\n  _distanceToSegment: function(point, segment) {\r\n    var x0 = point.x;\r\n    var y0 = point.y;\r\n    var x1 = segment.x1;\r\n    var y1 = segment.y1;\r\n    var x2 = segment.x2;\r\n    var y2 = segment.y2;\r\n    var dx = x2 - x1;\r\n    var dy = y2 - y1;\r\n    var along = ((dx * (x0 - x1)) + (dy * (y0 - y1))) /\r\n                (Math.pow(dx, 2) + Math.pow(dy, 2));\r\n    var x, y;\r\n    if(along <= 0.0) {\r\n        x = x1;\r\n        y = y1;\r\n    } else if(along >= 1.0) {\r\n        x = x2;\r\n        y = y2;\r\n    } else {\r\n        x = x1 + along * dx;\r\n        y = y1 + along * dy;\r\n    }\r\n    return Math.sqrt(Math.pow(x - x0, 2) + Math.pow(y - y0, 2));\r\n  },\r\n  \r\n  /**\r\n   * Path     douglas-peucker  . <br>\r\n   * douglas-peucker : http://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm\r\n   * @param {Number} tolerance dp  threshold\r\n   * @returns {olleh.maps.Path}  path  \r\n   */\r\n  simplify: function(tolerance) {\r\n    var coords = this._coords;\r\n    if(coords.length < 3)\r\n      return this;\r\n    var firstPoint = 0;\r\n    var lastPoint = coords.length - 1;\r\n    var pointIndexsToKeep = [];\r\n    \r\n    pointIndexsToKeep.push(firstPoint);\r\n    pointIndexsToKeep.push(lastPoint);\r\n\r\n    while (coords[firstPoint].equals(coords[lastPoint])) {\r\n        lastPoint--;\r\n        pointIndexsToKeep.push(lastPoint);\r\n    }\r\n    \r\n    this._douglasPeuckerReduction(coords, firstPoint, lastPoint, tolerance, pointIndexsToKeep);\r\n    \r\n    var returnPoints = [];\r\n    pointIndexsToKeep.sort(function(a, b){\r\n        return (a-b);\r\n    });\r\n    for (var index = 0; index < pointIndexsToKeep.length; index++) {\r\n        returnPoints.push(coords[pointIndexsToKeep[index]]);\r\n    }\r\n    return new olleh.maps.Path(returnPoints);\r\n  },\r\n  \r\n  _douglasPeuckerReduction: function(coords, firstPoint, lastPoint, tolerance, pointIndexsToKeep) {\r\n    var maxDistance = 0;\r\n    var indexFarthest = 0;\r\n\r\n    for (var index = firstPoint, distance; index < lastPoint; index++) {\r\n        distance = this._perpendicularDistance(coords[firstPoint], coords[lastPoint], coords[index]);\r\n        if (distance > maxDistance) {\r\n            maxDistance = distance;\r\n            indexFarthest = index;\r\n        }\r\n    }\r\n\r\n    if (maxDistance > tolerance && indexFarthest != firstPoint) {\r\n        pointIndexsToKeep.push(indexFarthest);\r\n        this._douglasPeuckerReduction(coords, firstPoint, indexFarthest, tolerance, pointIndexsToKeep);\r\n        this._douglasPeuckerReduction(coords, indexFarthest, lastPoint, tolerance, pointIndexsToKeep);\r\n    }\r\n  },\r\n  \r\n  _perpendicularDistance: function(point1, point2, point){\r\n      var area = Math.abs(0.5 * (point1.x * point2.y + point2.x * point.y + point.x * point1.y - point2.x * point1.y - point.x * point2.y - point1.x * point.y));\r\n      var bottom = Math.sqrt(Math.pow(point1.x - point2.x, 2) + Math.pow(point1.y - point2.y, 2));\r\n      var height = area / bottom * 2;\r\n      return height;\r\n  }\r\n\r\n});\n/**\r\n *     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Bounds').define({\r\n\r\n  /**\r\n   * ,  leftBottom,rightTop    .\r\n   * @param {olleh.maps.Coord} leftBottom   .\r\n   * @param {olleh.maps.Coord} rightTop   . <code>leftBottom</code>    .\r\n   */\r\n  Bounds: function (leftBottom, rightTop) {\r\n    if (leftBottom.getClass() != rightTop.getClass()) {\r\n      throw new TypeError('Coordinate system mismatch: ' + leftBottom.$classname + ', ' + rightTop.$classname);\r\n    }\r\n    \r\n    /**\r\n     *   .     .\r\n     * @type olleh.maps.Coord\r\n     */\r\n    this.leftBottom = leftBottom;\r\n\r\n    /**\r\n     *   .     .\r\n     * @type olleh.maps.Coord\r\n     */\r\n    this.rightTop = rightTop;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {cls}  .\r\n   */\r\n  getType: function () {\r\n    return this.leftBottom.getClass();\r\n  },\r\n\r\n  /**\r\n   *     .     . \r\n   * @param {olleh.maps.Bounds} other   .\r\n   * @returns {Boolean}   true,    false.\r\n   */\r\n  equals: function (other) {\r\n    return this.leftBottom.equals(other.leftBottom)\r\n        && this.rightTop.equals(other.rightTop);\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *        . \r\n   * @param {olleh.maps.Bounds} other   \r\n   * @param {Number} [epsilonInMeter]  .  .\r\n   * @returns {Boolean}      true,    false.\r\n   * @see olleh.maps.Coord#almostEquals()\r\n   */\r\n  almostEquals: function (other, epsilonInMeter) {\r\n    return this.leftBottom.almostEquals(other.leftBottom, epsilonInMeter)\r\n        && this.rightTop.almostEquals(other.rightTop, epsilonInMeter);\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getLeft: function () {\r\n    return this.leftBottom.x;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getBottom: function () {\r\n    return this.leftBottom.y;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getRight: function () {\r\n    return this.rightTop.x;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getTop: function () {\r\n    return this.rightTop.y;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.Coord}  .\r\n   */\r\n  getLeftTopCoord: function() {\r\n    return new (this.getType())({x: this.getLeft(), y: this.getTop()});\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.Coord}  .\r\n   */\r\n  getRightBottomCoord: function() {\r\n    return new (this.getType())({x: this.getRight(), y: this.getBottom()});\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Number} .  .\r\n   */\r\n  getWidth: function () {\r\n    var utmkBounds = this.asDefault();\r\n    return utmkBounds.getRight() - utmkBounds.getLeft();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Number} .  .\r\n   */\r\n  getHeight: function () {\r\n    var utmkBounds = this.asDefault();\r\n    return utmkBounds.getTop() - utmkBounds.getBottom();\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.UTMK}   .   {@link olleh.maps.UTMK} .\r\n   */\r\n  getCenter: function () {\r\n    var utmkThis = this.asDefault();\r\n    var coord = new olleh.maps.UTMK((utmkThis.getLeft() + utmkThis.getRight()) / 2,\r\n        (utmkThis.getBottom() + utmkThis.getTop()) / 2); \r\n    return coord;\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   * @param {olleh.maps.Bounds|olleh.maps.Coord} other    .\r\n   * @returns {Boolean}       true,    false.\r\n   */\r\n  intersects: function (other) {\r\n    if(!other)\r\n      return false;\r\n    if (other.x !== undefined && other.y !== undefined) {\r\n      return this._containsCoord(other);\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return utmkThis.getLeft() <= utmkOther.getRight()\r\n        && utmkThis.getBottom() <= utmkOther.getTop()\r\n        && utmkThis.getRight() >= utmkOther.getLeft()\r\n        && utmkThis.getTop() >= utmkOther.getBottom();\r\n  },\r\n\r\n  /**\r\n   *        .\r\n   * @param {olleh.maps.Bounds|olleh.maps.Coord} other    .\r\n   * @returns {Boolean}       true,    false.\r\n   */\r\n  contains: function (other) {\r\n    if(!other)\r\n      return false;\r\n    if (other.x !== undefined && other.y !== undefined) {\r\n      return this._containsCoord(other);\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return utmkThis.getLeft() <= utmkOther.getLeft()\r\n        && utmkThis.getBottom() <= utmkOther.getBottom()\r\n        && utmkThis.getRight() >= utmkOther.getRight()\r\n        && utmkThis.getTop() >= utmkOther.getTop();\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @private\r\n   * @param {olleh.maps.Coord} coord  .\r\n   * @returns {Boolean}     true,    false.\r\n   */\r\n  _containsCoord: function (coord) {\r\n    var utmkThis = this.asDefault();\r\n    var utmkCoord = coord.asDefault();\r\n    return utmkThis.getLeft() <= utmkCoord.x\r\n        && utmkThis.getBottom() <= utmkCoord.y\r\n        && utmkThis.getRight() >= utmkCoord.x\r\n        && utmkThis.getTop() >= utmkCoord.y;\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @param {olleh.maps.Bounds} other  .\r\n   * @returns {olleh.maps.Bounds}    .   {@link olleh.maps.UTMK} .      <code>null</code> .\r\n   */\r\n  intersection: function (other) {\r\n    if (!this.intersects(other)) {\r\n      return null;\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(Math.max(utmkThis.getLeft(), utmkOther.getLeft()), Math.max(utmkThis.getBottom(), utmkOther.getBottom())),\r\n        new olleh.maps.UTMK(Math.min(utmkThis.getRight(), utmkOther.getRight()), Math.min(utmkThis.getTop(), utmkOther.getTop()))\r\n    );\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @param {olleh.maps.Bounds|olleh.maps.Coord} other    .\r\n   * @returns {olleh.maps.Bounds}      .   {@link olleh.maps.UTMK} .          .\r\n   */\r\n  union: function (other) {\r\n    if (this.contains(other)) {\r\n      return this;\r\n    }\r\n    if (other.x !== undefined && other.y !== undefined) {\r\n      return this._unionCoord(other);\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(Math.min(utmkThis.getLeft(), utmkOther.getLeft()), Math.min(utmkThis.getBottom(), utmkOther.getBottom())),\r\n        new olleh.maps.UTMK(Math.max(utmkThis.getRight(), utmkOther.getRight()), Math.max(utmkThis.getTop(), utmkOther.getTop()))\r\n    );\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @private\r\n   * @param {olleh.maps.Coord} other    .\r\n   * @returns {olleh.maps.Bounds}      .   {@link olleh.maps.UTMK} .\r\n   */\r\n  _unionCoord: function (coord) {\r\n    var utmkThis = this.asDefault();\r\n    var utmkCoord = coord.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(Math.min(utmkThis.getLeft(), utmkCoord.x), Math.min(utmkThis.getBottom(), utmkCoord.y)),\r\n        new olleh.maps.UTMK(Math.max(utmkThis.getRight(), utmkCoord.x), Math.max(utmkThis.getTop(), utmkCoord.y))\r\n    );\r\n  },\r\n  \r\n  /**\r\n   *         . \r\n   * @param {Number} width   .  .\r\n   * @param {Number} height   .  .\r\n   * @returns {olleh.maps.Bounds}  .   {@link olleh.maps.UTMK} .\r\n   */\r\n  expand: function (width, height) {\r\n    var utmkThis = this.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(utmkThis.getLeft() - width / 2, utmkThis.getBottom() - height / 2),\r\n        new olleh.maps.UTMK(utmkThis.getRight() + width / 2, utmkThis.getTop() + height / 2)\r\n    );\r\n  },\r\n  \r\n  /**\r\n   *       .\r\n   * @param {cls} Type   .\r\n   * @returns {olleh.maps.Bounds}  .\r\n   * @see olleh.maps.Coord.valueOf()\r\n   */\r\n  transform: function (Type) {\r\n    if (this.getType() === Type) {\r\n      return this;\r\n    }\r\n    return new olleh.maps.Bounds(Type.valueOf(this.leftBottom), Type.valueOf(this.rightTop));\r\n  },\r\n  \r\n  /**\r\n   *      {@link olleh.maps.UTMK}  .\r\n   * @returns {olleh.maps.Bounds}  .\r\n   * @see olleh.maps.Coord#asDefault()\r\n   */\r\n  asDefault: function () {\r\n    return this.transform(olleh.maps.UTMK);\r\n  }\r\n\r\n});\r\n/**\r\n *    .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Point').define({\r\n  \r\n  $static: {\r\n    zero: function () {\r\n      return olleh.maps.Point._zero || (olleh.maps.Point._zero = new olleh.maps.Point(0, 0));\r\n    }\r\n  },\r\n\r\n  /**\r\n   * ,  x, y    .\r\n   * @param {Number} x  x .  .\r\n   * @param {Number} y  y .  .\r\n   */\r\n  Point: function (x, y) {\r\n    /**\r\n     *  x .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.x = +x;\r\n\r\n    /**\r\n     *  y .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.y = +y;\r\n  },\r\n  \r\n  /**\r\n   * clone this object\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  clone: function () {\r\n    return new olleh.maps.Point(this.x, this.y);\r\n  },\r\n  \r\n  /**\r\n   * Test for equality\r\n   * @param {olleh.maps.Point} other\r\n   * @returns {Boolean}\r\n   */\r\n  equals: function (other) {\r\n    return this.x === other.x && this.y === other.y;\r\n  },\r\n\r\n  /**\r\n   * point       return . \r\n   * @param {olleh.maps.Point} point\r\n   * @returns {olleh.maps.Point} newly created Point\r\n   */\r\n  //non-destructive, returns a new point\r\n  add: function (point) {\r\n    return this.clone()._add(point);\r\n  },\r\n\r\n  /**\r\n   * arg0 Point   arg0, arg1   x,y  . \r\n   * this   .\r\n   * @param {olleh.maps.Ponint | Number} arg0\r\n   * @param {Number} arg1 (optional)\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  // destructive, used directly for performance in situations where it's safe to modify existing point\r\n  _add: function (arg0, arg1) {\r\n    if(arguments.length === 1) {\r\n      this.x += arg0.x;\r\n      this.y += arg0.y;\r\n    } else {\r\n      this.x += arg0;\r\n      this.y += arg1;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * point     return .\r\n   * @param {olleh.maps.Point} point\r\n   * @returns {olleh.maps.Point} newly created Point\r\n   */\r\n  subtract: function (point) {\r\n    return this.clone()._subtract(point);\r\n  },\r\n\r\n  /**\r\n   * arg0 Point   arg0, arg1   x,y  .\r\n   * this   .\r\n   * @param {olleh.maps.Ponint | Number} arg0\r\n   * @param {Number} arg1 (optional)\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _subtract: function (arg0, arg1) {\r\n    if(arguments.length === 1) {\r\n      this.x -= arg0.x;\r\n      this.y -= arg0.y;\r\n    } else {\r\n      this.x -= arg0;\r\n      this.y -= arg1;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x, y  num    Point  return\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  divideBy: function (num) {\r\n    return this.clone()._divideBy(num);\r\n  },\r\n\r\n  /**\r\n   * this  x, y  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point} this \r\n   */\r\n  _divideBy: function (num) {\r\n    this.x /= num;\r\n    this.y /= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x, y  num    Point  return\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  multiplyBy: function (num) {\r\n    return this.clone()._multiplyBy(num);\r\n  },\r\n\r\n  /**\r\n   * this  x, y  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _multiplyBy: function (num) {\r\n    this.x *= num;\r\n    this.y *= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x,y    Point  \r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  round: function () {\r\n    return this.clone()._round();\r\n  },\r\n\r\n  /**\r\n   * x,y  .\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _round: function () {\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x,y    Point  \r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  floor: function () {\r\n    return this.clone()._floor();\r\n  },\r\n\r\n  /**\r\n   * x,y  .\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _floor: function () {\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Calculates the distance from this Point to the one specified.\r\n   * @param {olleh.maps.Point} point \r\n   * @returns {Number}\r\n   */\r\n  distanceTo: function (point) {\r\n    var x = point.x - this.x,\r\n      y = point.y - this.y;\r\n    return Math.sqrt(x * x + y * y);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  toCSSString: function () {\r\n    return this.x + 'px ' +  this.y + 'px';\r\n  }\r\n\r\n});\r\n/**\r\n *    .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Size').define({\r\n\r\n  $static: {\r\n    zero: function () {\r\n      return olleh.maps.Size._zero || (olleh.maps.Size._zero = new olleh.maps.Size(0, 0));\r\n    },\r\n\r\n    full: function () {\r\n      return olleh.maps.Size._full || (olleh.maps.Size._full = new olleh.maps.Size(100, 100, '%'));\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * ,  width, height    .\r\n   * @param {Number} width  .\r\n   * @param {Number} height  .\r\n   * @param {String} [unit=px]   .\r\n   */\r\n  Size: function (width, height, unit) {\r\n    /**\r\n     *  .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.width = +width;\r\n    \r\n    /**\r\n     *  .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.height = +height;\r\n\r\n    /**\r\n     *   .\r\n     * @type String\r\n     * @readonly\r\n     */\r\n    this.unit = unit || 'px';\r\n  },\r\n  \r\n  /**\r\n   * clone this object\r\n   * @returns {olleh.maps.Size}\r\n   */\r\n  clone: function () {\r\n    return new olleh.maps.Size(this.width, this.height, this.unit);\r\n  },\r\n  \r\n  /**\r\n   * Test for equality\r\n   * @param {olleh.maps.Size} other\r\n   * @returns {Boolean}\r\n   */\r\n  equals: function (other) {\r\n    return this.width === other.width && this.height === other.height && this.unit === other.unit;\r\n  },\r\n\r\n  /**\r\n   * size  width, height    .\r\n   * @param {olleh.maps.Size} size\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  add: function (size) {\r\n    return this.clone()._add(size);\r\n  },\r\n  \r\n  /**\r\n   * destructive, used directly for performance in situations where it's safe to modify existing Size\r\n   * @param arg0 {Number | olleh.maps.Size} arg0\r\n   * @param arg1 {Number} [arg1]\r\n   * @returns {olleh.maps.Size}\r\n   * @private\r\n   */\r\n  _add: function(arg0, arg1) {\r\n    if (arguments.length === 1) {\r\n      if (this.unit != arg0.unit) {\r\n        throw new TypeError('Unit mismatch: ' + this.unit + ', ' + arg0.unit);\r\n      }\r\n      this.width += arg0.width;\r\n      this.height += arg0.height;\r\n    } else {\r\n      this.width += arg0;\r\n      this.height += arg1;\r\n    }\r\n    return this;\r\n  },\r\n  \r\n\r\n  /**\r\n   * size  width, height    .\r\n   * @param {olleh.maps.Size} size\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  subtract: function (size) {\r\n    return this.clone()._subtract(size);\r\n  },\r\n  \r\n  /**\r\n   * destructive, used directly for performance in situations where it's safe to modify existing Size\r\n   * @param arg0 {Number | olleh.maps.Size} arg0\r\n   * @param arg1 {Number} [arg1]\r\n   * @returns {olleh.maps.Size}\r\n   * @private\r\n   */\r\n  _subtract: function (arg0, arg1) {\r\n    if (arguments.length === 1) {\r\n      if (arg0.unit != this.unit) {\r\n        throw new TypeError(\"unit\");\r\n      }\r\n      this.width -= arg0.width;\r\n      this.height -= arg0.height;\r\n    } else {\r\n      this.width -= arg0;\r\n      this.height -= arg1;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  divideBy: function (num) {\r\n    return this.clone()._divideBy(num);\r\n  },\r\n  \r\n  _divideBy: function (num) {\r\n    this.width /= num;\r\n    this.height /= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  multiplyBy: function (num) {\r\n    return this.clone()._multiplyBy(num);\r\n  },\r\n  \r\n  _multiplyBy: function (num) {\r\n    this.width *= num;\r\n    this.height *= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  .\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  round: function () {\r\n    return this.clone()._round();\r\n  },\r\n  \r\n  _round: function () {\r\n    this.width = Math.round(this.width);\r\n    this.height = Math.round(this.height);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  .\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  floor: function () {\r\n    return this.clone()._floor();\r\n  },\r\n  \r\n  _floor: function () {\r\n    this.width = Math.floor(this.width);\r\n    this.height = Math.floor(this.height);\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  toCSSString: function () {\r\n    return this.width + this.unit + ' ' +  this.height + this.unit;\r\n  },\r\n  \r\n  /**\r\n   * width => point.x, height => point.y\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  asPoint: function() {\r\n    if (this.unit != 'px') {\r\n      throw new TypeError('Unit must be a px: ' + this.unit);\r\n    }\r\n    return new olleh.maps.Point(this.width, this.height);\r\n  }\r\n\r\n});\n/**\r\n * HTML          .\r\n */\r\n$class('olleh.maps.Element').define({\r\n  \r\n  $static: {\r\n    /**\r\n     *     HTML \r\n     *   {@link olleh.maps.Element}   .\r\n     * @param {String} tagName  .\r\n     * @returns {olleh.maps.Element}  {@link olleh.maps.Element} .\r\n     */\r\n    create: function (tagName) {\r\n      if (!tagName) return null;\r\n      var element = new olleh.maps.Element(document.createElement(tagName));\r\n      var browser = olleh.maps.browser;\r\n      if (browser.browserName === browser.BROWSER_NAME.ie) {\r\n        element.elem.setAttribute('unselectable', 'on');\r\n      }\r\n      return element;\r\n    }\r\n    \r\n  },\r\n  \r\n  /**\r\n   * ,  elem    .\r\n   * @param {HTMLElement} elem HTML .\r\n   */\r\n  Element: function (elem) {\r\n    /**\r\n     * HTML .\r\n     * @readonly\r\n     * @type HTMLElement\r\n     */\r\n    this.elem = elem;\r\n  },\r\n  \r\n  /**\r\n   * HTML   .\r\n   * @param {String} name  .\r\n   * @returns {String}  .\r\n   */\r\n  getProperty: function (name) {\r\n    return this.elem[name];\r\n  },\r\n  \r\n  /**\r\n   * HTML   .\r\n   * @param {String} name  .\r\n   * @param {String} value  .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  setProperty: function (name, value) {\r\n    this.elem[name] = value;\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * HTML      .\r\n   * @param {Object} properties key-value    .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  setProperties: function (properties) {\r\n    var k;\r\n    for (k in properties) {\r\n      this.setProperty(k, properties[k]);\r\n    }\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * HTML  CSS  .\r\n   * @param {String} style  .\r\n   * @returns {String}  .\r\n   */\r\n  getStyle: function (style) {\r\n    return olleh.maps.util.dom.getStyle(this.elem, style);\r\n  },\r\n  \r\n  /**\r\n   * HTML  CSS  .\r\n   * @param {String} name  .\r\n   * @param {String} value  .\r\n   */\r\n  setStyle: function (name, value) {\r\n    olleh.maps.util.dom.setStyle(this.elem, name, value);\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * HTML   CSS    .\r\n   * @param {Object} styles key-value    .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  setStyles: function (styles) {\r\n    var k;\r\n    for (k in styles) {\r\n      this.setStyle(k, styles[k]);\r\n    }\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * CSS className .\r\n   * @param {String} className CSS  \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  addClass: function (className) {\r\n    olleh.maps.util.dom.addClass(this.elem, className);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * CSS className     .\r\n   * @param {String} className CSS \r\n   * @returns {Boolean}  className  \r\n   * true .\r\n   */\r\n  hasClass: function (className) {\r\n    return olleh.maps.util.dom.hasClass(this.elem, className);\r\n  },\r\n\r\n  /**\r\n   * CSS className .\r\n   * @param {String} className css  \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  removeClass: function (className) {\r\n    olleh.maps.util.dom.removeClass(this.elem, className);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * oldClassName   newClassName   .<p/>\r\n   *  oldClassName    newClassName  .\r\n   * @param {String} oldClassName    \r\n   * @param {String} newClassName    \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  replaceClass: function (oldClassName, newClassName) {\r\n    olleh.maps.util.dom.replaceClass(this.elem, oldClassName, newClassName);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * @param {String} name    \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  toggleClass: function (name) {\r\n    olleh.maps.util.dom.toggleClass(this.elem, name);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Element|HTMLElement} elem   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  appendChild: function (elem) {\r\n    this.elem.appendChild(elem.elem || elem);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Element|HTMLElement} elem   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  removeChild: function (elem) {\r\n    this.elem.removeChild(elem.elem || elem);\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   *  HTML   child .\r\n   * @param {olleh.maps.Element|HTMLElement} elem  HTML  \r\n   * @returns {Boolean}  (elm)  \r\n   * true .\r\n   */\r\n  pushElement: function (elem) {\r\n    return olleh.maps.util.dom.pushElement(this.elem, elem.elem || elem);\r\n  },\r\n\r\n  /**\r\n   * Child   child    .\r\n   * @param {olleh.maps.Element|HTMLElement} elem  DOM \r\n   * @returns {HTMLElement}\r\n   */\r\n  popElement: function (elem) {\r\n    return olleh.maps.util.dom.popElement(this.elem, elem.elem || elem);\r\n  },\r\n\r\n  /**\r\n   * HTML   CSS  .     .\r\n   * @param {String} name  .\r\n   * @returns {String}   .\r\n   */\r\n  getComputedStyle: function (name) {\r\n    return olleh.maps.util.dom.getComputedStyle(this.elem, name);\r\n  },\r\n\r\n  /**\r\n   *   .   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  forceReflow: function () {\r\n    var _ = this.elem.clientWidth;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * HTML    .\r\n   * @param {String} type  .\r\n   * @param {Function} fn   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  addEventListener: function (type, fn) {\r\n    var elem = this.elem;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(type, fn, false);\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + type, fn);\r\n    } else {\r\n      elem['on' + type] = fn;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * HTML    .\r\n   * @param {String} type  .\r\n   * @param {Function} fn    .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  removeEventListener: function (type, fn) {\r\n    var elem = this.elem;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(type, fn, false);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + type, fn);\r\n    } else {\r\n      elem['on' + type] = null;\r\n    }\r\n    return this;\r\n  }\r\n});\r\n/**\r\n * <code>backgroundSize</code> CSS    (IE 8 )\r\n *            .<br/>\r\n * \r\n *   <code>backgroundImage</code>, <code>backgroundPosition</code>,\r\n * <code>backgroundSize</code>         .\r\n *  <code>backgroundSize</code>  \r\n *   <code>overflow:hidden</code>  <code>div</code> \r\n *   <code>img</code>     <code>src</code> \r\n * <code>backgroundImage</code>, (<code>left</code>/<code>top</code>)\r\n * <code>backgroundPosition</code>, (<code>width</code>/<code>height</code>)\r\n * <code>backgroundSize</code>    .<br/>\r\n * \r\n *        ,\r\n *           .\r\n */\r\n$class('olleh.maps.SpritedImage').extend(olleh.maps.Element).define({\r\n  \r\n  /**\r\n   * .   <code>div</code>  .  \r\n   * <code>backgroundSize</code>   <code>div</code> \r\n   * <code>img</code>   .  \r\n   */\r\n  SpritedImage: function () {\r\n    this.elem = document.createElement('div');\r\n    this.setStyles({\r\n      position: 'absolute',\r\n      backgroundColor: 'transparent',\r\n      backgroundRepeat: 'no-repeat'\r\n    });\r\n    if (!olleh.maps.browser.style.backgroundSize) {\r\n      this.setStyle('overflow', 'hidden');\r\n      this._img = olleh.maps.Element.create('img').setStyle('position', 'absolute');\r\n      this.appendChild(this._img);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  .    <code>div</code>    .\r\n   * @param {String} url  URL.\r\n   * @param {olleh.maps.Point} [origin]     . \r\n   * @param {olleh.maps.Size} [scaledSize]      .\r\n   * @returns {olleh.maps.SpritedImage}  .\r\n   */\r\n  setImage: function (url, origin, scaledSize) {\r\n    if (this._img) {\r\n      this._img.setStyles({\r\n        left: origin ? -origin.x + 'px' : '0',\r\n        top: origin ? -origin.y + 'px' : '0',\r\n        width: scaledSize ? scaledSize.width + scaledSize.unit : origin ? '' : '100%',\r\n        height: scaledSize ? scaledSize.height + scaledSize.unit : origin ? '' : '100%'\r\n      }).setProperty('src', url);\r\n    } else {\r\n      this.setStyles({\r\n        backgroundImage: 'url(' + url + ')',\r\n        backgroundPosition: origin ? -origin.x + 'px ' + -origin.y + 'px' : '',\r\n        backgroundSize: scaledSize ? scaledSize.toCSSString() : origin ? 'auto' : '100% 100%'\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n  \r\n});/**\r\n *    .\r\n *     t  x   .\r\n * t x  0~1   . \r\n */\r\n$class('olleh.maps.fx.timing.Timing').define({\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  Timing: function () {\r\n    if (this.$classname === 'olleh.maps.fx.timing.Timing') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.fx.timing.Timing directly.');\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * CSS3 transition     .\r\n   * null   CSS3 transition      .\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   * CSS3 transition        .\r\n   *  y=x    . \r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return null;\r\n  },\r\n\r\n  /**\r\n   *  t  x    .  \r\n   * @returns {Function}  .\r\n   */\r\n  getFn: function () {\r\n    if (!this._fn) {\r\n      this._fn = this.genFn();\r\n    }\r\n    return this._fn;\r\n  },\r\n\r\n  /**\r\n   *  t  x    .      .\r\n   * @private  \r\n   * @returns {Function}  .\r\n   */\r\n  genFn: function () {\r\n    return null;\r\n  }\r\n  \r\n});\r\n/**\r\n * y=x     .\r\n */\r\n$class('olleh.maps.fx.timing.Linear').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'linear';\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return this.getCSSName();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function(t) {\r\n      return t;\r\n    };\r\n  }\r\n  \r\n});\r\n/**\r\n * 3      .\r\n */\r\n$class('olleh.maps.fx.timing.CubicBezier').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   *   .\r\n   * @param {Number} x1 p1 x.\r\n   * @param {Number} y1 p1 y.\r\n   * @param {Number} x2 p2 x.\r\n   * @param {Number} y2 p2 y.\r\n   */\r\n  CubicBezier: function (x1, y1, x2, y2) {\r\n    this.x1 = x1;\r\n    this.y1 = y1;\r\n    this.x2 = x2;\r\n    this.y2 = y2;\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'cubic-bezier(' + this.x1 + ',' + this.y1 + ',' + this.x2 + ',' + this.y2 + ')';\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return 'cubic-bezier(' + (1 - this.x2) + ',' + (1 - this.y2) + ',' + (1 - this.x1) + ',' + (1 - this.y1) + ')';\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   * @see http://blogs.msdn.com/b/eternalcoding/archive/2011/12/06/css3-transitions.aspx \r\n   */\r\n  genFn: function () {\r\n    var x1 = this.x1, y1 = this.y1, x2 = this.x2, y2 = this.y2;\r\n    return function (t) {\r\n      var i, f0, f1, f2, refinedT, refinedT2, refinedT3, x, slope;\r\n      if (t == 0)\r\n        return 0;\r\n      f0 = 1 - 3 * x2 + 3 * x1;\r\n      f1 = 3 * x2 - 6 * x1;\r\n      f2 = 3 * x1;\r\n      refinedT = t;\r\n      for (i = 0; i < 5; i++) {\r\n        refinedT2 = refinedT * refinedT;\r\n        refinedT3 = refinedT2 * refinedT;\r\n        x = f0 * refinedT3 + f1 * refinedT2 + f2 * refinedT;\r\n        slope = 1.0 / (3.0 * f0 * refinedT2 + 2.0 * f1 * refinedT + f2);\r\n        refinedT -= (x - t) * slope;\r\n        refinedT = Math.min(1, Math.max(0, refinedT));\r\n      }\r\n      return 3 * Math.pow(1 - refinedT, 2) * refinedT * y1 + 3\r\n          * (1 - refinedT) * Math.pow(refinedT, 2) * y2\r\n          + Math.pow(refinedT, 3);\r\n    };\r\n  }\r\n  \r\n});\r\n/**\r\n * 3      .  CSS3 transition  .\r\n */\r\n$class('olleh.maps.fx.timing.CubicBezierBasedTiming').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  CubicBezierBasedTiming: function () {\r\n    if (this.$classname === 'olleh.maps.fx.timing.CubicBezierBasedTiming') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.fx.timing.CubicBezierBasedTiming directly.');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return this._curve.getBackwardCSSName();\r\n  },\r\n\r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getFn: function () {\r\n    return this._curve.getFn();\r\n  }\r\n  \r\n});\r\n/**\r\n * Ease    .\r\n */\r\n$class('olleh.maps.fx.timing.Ease').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  Ease: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0.25, 0.1, 0.25, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease';\r\n  }\r\n  \r\n});\r\n/**\r\n * Ease-in    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseIn').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  EaseIn: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0.42, 0, 1, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease-in';\r\n  }\r\n  \r\n});\r\n\r\n/**\r\n * Ease-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseOut').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  EaseOut: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0, 0, 0.58, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease-out';\r\n  }\r\n  \r\n});\r\n/**\r\n * Ease-in-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseInOut').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  EaseInOut: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0.42, 0, 0.58, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease-in-out';\r\n  }\r\n  \r\n});\r\n/**\r\n *       .\r\n */\r\nolleh.maps.namespace('olleh.maps.fx.timing', {\r\n  /**\r\n   * @type {olleh.maps.fx.timing.Linear}\r\n   */\r\n  linear: new olleh.maps.fx.timing.Linear(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.Ease}\r\n   */\r\n  ease: new olleh.maps.fx.timing.Ease(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.EaseIn}\r\n   */\r\n  easeIn: new olleh.maps.fx.timing.EaseIn(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.EaseOut}\r\n   */\r\n  easeOut: new olleh.maps.fx.timing.EaseOut(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.EaseInOut}\r\n   */\r\n  easeInOut: new olleh.maps.fx.timing.EaseInOut()\r\n});\r\n///////////////////////////\r\n//  Animation    //\r\n///////////////////////////\r\n/**\r\n * {@link olleh.maps.fx.Animation} \r\n * @typedef olleh.maps.fx.AnimationOptions \r\n * @property {Object} [from]    . Key-value .\r\n *                 .\r\n * @property {Object} to  . Key-value .\r\n * @property {Number} [duration={@link olleh.maps.fx.Animation#DEFAULT_DURATION}]  .   .\r\n * @property {olleh.maps.fx.timing.Timing} [timing={@link olleh.maps.fx.Animation#DEFAULT_TIMING}]  .\r\n * @property {Number} [repeat=1]   .\r\n *         <code>1</code>, {@link olleh.maps.fx.Animation#REPEAT_FOREVER}   .\r\n * @property {Boolean} [comeback=false]       .\r\n *        <code>true</code>  <code>duration/2</code>   \r\n *              .\r\n * @property {Function} [callback]  .      .\r\n *            <code>true</code>, {@link olleh.maps.fx.Animator#stop()}\r\n *           <code>false</code>  .\r\n * @property {Object} [ctx]   .     <code>HTMLElement</code>  .\r\n * @property {olleh.maps.fx.Pulse|olleh.maps.fx.PulseAnimator|boolean} [pulse]   .\r\n *        {@link olleh.maps.fx.Pulse}    ,\r\n *        {@link olleh.maps.fx.PulseAnimator}      ,\r\n *        <code>true</code>      .\r\n *        <code>null</code>  <code>false</code>     CSS   \r\n *        CSS        .\r\n */\r\n\r\n/**\r\n *   \r\n */\r\n$class('olleh.maps.fx.Animation').define({\r\n  \r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type Number\r\n     */\r\n    DEFAULT_DURATION: .3,\r\n    \r\n    /**\r\n     * @constant\r\n     * @type olleh.maps.fx.timing.Timing\r\n     */\r\n    DEFAULT_TIMING: olleh.maps.fx.timing.ease,\r\n    \r\n    /**\r\n     * @constant\r\n     * @type Number\r\n     */\r\n    REPEAT_FOREVER: -1\r\n  },\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.fx.AnimationOptions} opts .\r\n   */\r\n  Animation: function (opts) {\r\n    this.from = {};\r\n    this.to = {};\r\n    this.duration = olleh.maps.fx.Animation.DEFAULT_DURATION;\r\n    this.timing = olleh.maps.fx.Animation.DEFAULT_TIMING;\r\n    this.repeat = 1;\r\n    this.comeback = false;\r\n    this.callback = null;\r\n    this.ctx = null;\r\n    this.pulse = null;\r\n    olleh.maps.mixin(this, opts, true, ['from', 'to', 'duration', 'timing', 'repeat', 'comeback', 'callback', 'ctx', 'pulse']);\r\n  },\r\n  \r\n  /**\r\n   *      Animator .\r\n   *  ,       Animator  .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  newAnimator: function (elem, opts) {\r\n    var Animator;\r\n    \r\n    opts = olleh.maps.mixin({\r\n      duration: this.duration,\r\n      timing: this.timing,\r\n      repeat: this.repeat,\r\n      comeback: this.comeback,\r\n      callback: this.callback,\r\n      ctx: this.ctx,\r\n      pulse: this.pulse\r\n    }, opts, true);\r\n    \r\n    opts.from = olleh.maps.mixin(olleh.maps.util.clone(this.from), opts.from || {}, 'remix');\r\n    opts.to = olleh.maps.mixin(olleh.maps.util.clone(this.to), opts.to || {}, 'remix');\r\n\r\n    if (opts.duration == 0) {\r\n      Animator = olleh.maps.fx.NoAnimationAnimator;\r\n    } else if (!opts.pulse && olleh.maps.browser.style.transition && opts.timing.getCSSName()) {\r\n      Animator = olleh.maps.fx.CSSAnimator;\r\n    } else {\r\n      Animator = olleh.maps.fx.PulseAnimator;\r\n    }\r\n    \r\n    return new Animator(elem, opts);\r\n  },\r\n  \r\n  /**\r\n   * {@link olleh.maps.fx.Animation#newAnimator()} \r\n   *    {@link olleh.maps.fx.Animator#start}  .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  animate: function (elem, opts) {\r\n    var a = this.newAnimator(elem, opts);\r\n    a.start();\r\n    return a;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.fx.Animation#newAnimator()} \r\n   *    {@link olleh.maps.fx.Animator#startSync}  .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  animateSync: function (elem, opts) {\r\n    var a = this.newAnimator(elem, opts);\r\n    a.startSync();\r\n    return a;\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .  duration .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  applyImmediately: function (elem, opts) {\r\n    opts || (opts = {});\r\n    opts.duration = 0;\r\n    return this.animate(elem, opts);\r\n  }\r\n  \r\n});\r\n/**\r\n * {@link olleh.maps.fx.PulseAnimator}        . \r\n *       \r\n *  {@link olleh.maps.fx.Animator}      , \r\n * CSS3 transition           .\r\n */\r\n$class('olleh.maps.fx.Pulse').define({\r\n  \r\n  /**\r\n   *   .\r\n   * @param {Number} period  ,  .\r\n   */\r\n  Pulse: function (period) {\r\n    /**\r\n     *  ,  .\r\n     * @readonly\r\n     * @type Number\r\n     */\r\n    this.period = period;\r\n    \r\n    this._jobs = [];\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.fx.PulseAnimator} fn\r\n   */\r\n  add: function (fn, initTime) {\r\n    this._jobs.push(fn);\r\n    if (this._jobs.length == 1) {\r\n      this.start(initTime);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.fx.PulseAnimator} fn\r\n   */\r\n  remove: function (fn) {\r\n    olleh.maps.util.removeFromArray(this._jobs, fn);\r\n    if (this._jobs.length == 0) {\r\n      this.stop();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {Boolean}   <code>true</code>,    <code>false</code>.\r\n   */\r\n  isPlaying: function () {\r\n    return !!this._af;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   */\r\n  start: function (initTime) {\r\n    if (!this._af) {\r\n      this.startTime = olleh.maps.fx.now();\r\n      if (initTime) {\r\n        this.startTime -= initTime * 1000;\r\n      }\r\n      this._af = olleh.maps.util.deferAF(this._step, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   */\r\n  stop: function () {\r\n    if (this._af) {\r\n      window.cancelAnimationFrame(this._af);\r\n      this._af = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {Number} time\r\n   */\r\n  _step: function (time) {\r\n    var i, playTime;\r\n\r\n    if (this._jobs.length == 0) {\r\n      this.stop();\r\n      return;\r\n    }\r\n\r\n    this._af = olleh.maps.util.deferAF(this._step, this);\r\n    \r\n    // See #2718\r\n    if (!olleh.maps.fx.useAFTime) {\r\n      time = olleh.maps.fx.now();\r\n    }\r\n\r\n    playTime = (time - this.startTime) / 1000;\r\n    \r\n    //    \r\n    if (playTime >= this.period) {\r\n      playTime = this.period;\r\n      this.startTime = time;\r\n    }\r\n\r\n    for (i = this._jobs.length - 1; i >= 0; i--) {\r\n      this._jobs[i](playTime);\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *    <code>setTimeout</code>         .\r\n *         .\r\n */\r\n$class('olleh.maps.fx.AnimatorBuffer').define({\r\n\r\n  /**\r\n   *   .\r\n   * @private\r\n   */\r\n  AnimatorBuffer: function () {\r\n    this._animators = [];\r\n    this._timer = null;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   *  <code>setTimeout</code>  {@link olleh.maps.fx.AnimatorBuffer#flush} .\r\n   * @param {olleh.maps.fx.Animator} animator\r\n   */\r\n  add: function (animator) {\r\n    this._animators.push(animator);\r\n    if (!this._timer) {\r\n      this._timer = olleh.maps.util.defer(this.flush, this);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *      {@link olleh.maps.fx.Animator#startSync} .\r\n   */\r\n  flush: function () {\r\n    var i, l;\r\n    for (i = 0, l = this._animators.length; i < l; i++) {\r\n      this._animators[i].startSync();\r\n    }\r\n    this._animators = [];\r\n    if (this._timer) {\r\n      window.clearTimeout(this._timer);\r\n      this._timer = null;\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *  .  HTML      .\r\n * {@link olleh.maps.fx.Animation}   ,     .\r\n */\r\n$class('olleh.maps.fx.Animator').define({\r\n\r\n  /**\r\n   * .     .\r\n   * @private\r\n   * @param {olleh.maps.Element|HTMLElement} elem   HTML .\r\n   * @param {olleh.maps.fx.AnimationOptions} opts  .\r\n   */\r\n  Animator: function (elem, opts) {\r\n    /**\r\n     *   HTML .\r\n     * @readonly\r\n     * @type olleh.maps.Element\r\n     */\r\n    this.element = elem instanceof olleh.maps.Element ? elem : new olleh.maps.Element(elem);\r\n\r\n    olleh.maps.mixin(this, opts || {}, true, ['from', 'to', 'duration', 'timing', 'repeat', 'comeback', 'callback', 'ctx', 'pulse']);\r\n\r\n    /**\r\n     *  . <code>ready</code>, <code>started</code>, <code>paused</code>, <code>finished</code>    .\r\n     * @readonly\r\n     * @type String\r\n     */\r\n    this.status = 'ready';\r\n  },\r\n\r\n  /**\r\n   *  .     \r\n   *     .\r\n   *  duration    \r\n   *    (t=1)   .\r\n   */\r\n  start: function () {\r\n    if (this.status !== 'ready') {\r\n      return;\r\n    }\r\n    if (this.duration == 0) {\r\n      this.startSync();\r\n    } else {\r\n      olleh.maps.fx.animatorBuffer.add(this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.fx.Animator#start}    .\r\n   *       .\r\n   */\r\n  startSync: function () {\r\n    var k;\r\n\r\n    if (this.status !== 'ready') {\r\n      return;\r\n    }\r\n    \r\n    if (this.comeback) {\r\n      for (k in this.to) {\r\n        if (this.to[k] == undefined || !this.to.hasOwnProperty(k)) {\r\n          continue;\r\n        }\r\n        if (!this.from[k]) {\r\n          this.from[k] = this.element.getComputedStyle(k);\r\n          olleh.maps.log.info('Initial style \"' + k + '\" is not defined; can cause performance issue', this);\r\n        }\r\n      }\r\n    }\r\n    \r\n    this.status = 'started';\r\n    this.doInit();\r\n    this.doCycle();\r\n  },\r\n\r\n  /**\r\n   *  .   \r\n   *    (t=1)   .\r\n   */\r\n  stop: function () {\r\n    if (this.status === 'finished') {\r\n      return;\r\n    }\r\n    \r\n    if (this.status === 'ready') {\r\n      this.element.setStyles(this.to);\r\n    } else {\r\n      this.doStop();\r\n      this.doClean();\r\n    }\r\n    \r\n    this.status = 'finished';\r\n    \r\n    if (this.callback) {\r\n      this.callback.call(this.ctx || this.element.elem, false);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   */\r\n  stopRepeat: function () {\r\n    if (this.status === 'finished') {\r\n      return;\r\n    }\r\n    this.repeat = false;\r\n  },\r\n\r\n  /**\r\n   *   .      .\r\n   * @returns {Object}    key-value   .\r\n   */\r\n  pause: function () {\r\n    if (this.status !== 'started') {\r\n      return;\r\n    }\r\n    this.status = 'paused';\r\n    return this.doPause();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  resume: function () {\r\n    if (this.status !== 'paused') {\r\n      return;\r\n    }\r\n    this.status = 'started';\r\n    this.doResume();\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   *   .\r\n   */\r\n  cancel: function () {\r\n    if (this.status === 'ready') {\r\n      this.status = 'finished';\r\n      return;\r\n    }\r\n    if (this.status === 'finished') {\r\n      return;\r\n    }\r\n    this.status = 'finished';\r\n    this.doCancel();\r\n    this.doClean();\r\n    //   \r\n  },\r\n\r\n  /**\r\n   *     .      .\r\n   *   .\r\n   * @returns {Object}    key-value   .\r\n   */\r\n  abort: function () {\r\n    if (this.status !== 'finished') {\r\n      this.status = 'finished';\r\n    }\r\n    return this.doPause();\r\n  },\r\n  \r\n  /**\r\n   *    . abort()    .\r\n   *           .   .\r\n   *            .\r\n   * @returns {Object}    key-value   .\r\n   */\r\n  ignore: function () {\r\n    if (this.status !== 'finished') {\r\n      this.status = 'finished';\r\n    }\r\n    return this.doIgnore();\r\n  },\r\n  \r\n  /**\r\n   * @returns {Boolean}    .\r\n   */\r\n  finishCycle: function () {\r\n    if (this.repeat === -1 && this.duration > 0) {\r\n      this.doCycle();\r\n    } else if (this.repeat > 1) {\r\n      this.repeat--;\r\n      this.doCycle();\r\n    } else {\r\n      this.doClean();\r\n      this.status = 'finished';\r\n    }\r\n    \r\n    if (this.callback) {\r\n      this.callback.call(this.ctx || this.element.elem, true);\r\n    }\r\n  }\r\n\r\n});\r\n/**\r\n *        {@link olleh.maps.fx.Animator} .\r\n *     . \r\n */\r\n$class('olleh.maps.fx.NoAnimationAnimator').extend(olleh.maps.fx.Animator).define({\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doInit: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCycle: function () {\r\n    if (!this.comeback) {\r\n      this.element.setStyles(this.to);\r\n    }\r\n    this.finishCycle();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doClean: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doPause: function () {\r\n    return this.to;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doResume: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCancel: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doIgnore: function () {\r\n    return this.to;\r\n  }\r\n  \r\n});\r\n/**\n * CSS3 transition    {@link olleh.maps.fx.Animator} .\n *     .\n */\n$class('olleh.maps.fx.CSSAnimator').extend(olleh.maps.fx.Animator).define({\n\n  /**\n   * .     .\n   * @private\n   * @param {HTMLElement} elem   HTML .\n   * @param {olleh.maps.fx.AnimationOptions} opts  .\n   */\n  CSSAnimator: function (elem, opts) {\n    var browser = olleh.maps.browser;\n\n    this._styleName = browser.style.transition;\n    this._eventType = browser.event.transitionend;\n    this._bound_onTransitionend = this._onTransitionend.bind(this);\n    this._isForward = true;\n  },\n\n  /**\n   * @private\n   */\n  doInit: function () {\n  },\n\n  /**\n   * @private\n   */\n  doClean: function () {\n    if (this._listening) {\n      this.element.setStyle(this._styleName, '');\n      this.element.removeEventListener(this._eventType, this._bound_onTransitionend);\n      this._listening = false;\n    }\n    this._clearEventFallback();\n  },\n\n  /**\n   * @private\n   */\n  doCycle: function () {\n    //     .\n    //  CSS        t = 0 .\n    //   t = 0.7      \n    // 0.3  t = 0.7 -> 1   \n    // CSS   0.3  t = 0 -> 1  .\n    this._startTimestamp = +Date.now();\n    this._playedTimestamp = 0;\n    this._receivedEvent = 0;\n\n    this._startTransition(this.comeback ? this.duration / 2 : this.duration);\n  },\n\n  /**\n   * @private\n   */\n  doStop: function () {\n    var k;\n    if (this.comeback && this._isForward) {\n      for (k in this.to) {\n        this.element.setStyle(k, this.from[k]);\n      }\n    }\n  },\n\n  /**\n   * @private\n   * @returns {Object}\n   */\n  doPause: function () {\n    var k, styles;\n    \n    if (!this._pausedStyles) {\n      olleh.maps.log.info('CSS animator paused; can cause performance issue', this);\n      \n      styles = {};\n      for (k in this.to) {\n        styles[k] = this.element.getComputedStyle(k);\n        this.element.setStyle(k, styles[k]);\n      }\n      \n      this.doClean();\n      this._playedTimestamp += +Date.now() - this._startTimestamp;\n      this._pausedStyles = styles;\n    }\n    \n    this._clearEventFallback();\n    \n    return this._pausedStyles;\n  },\n\n  /**\n   * @private\n   */\n  doResume: function () {\n    this._pausedStyles = null;\n    this._startTimestamp = +Date.now();\n    this._startTransition(((this.comeback ? this.duration / 2 : this.duration) - this._playedTimestamp / 1000));\n  },\n\n  /**\n   * @private\n   */\n  doCancel: function () {\n    var k;\n    for (k in this.to) {\n      this.element.setStyle(k, this.from[k]);\n    }\n  },\n\n  /**\n   * @private\n   * @returns {Object}\n   */\n  doIgnore: function () {\n    if (this._listening) {\n      this.element.removeEventListener(this._eventType, this._bound_onTransitionend);\n      this._listening = false;\n    }\n    this._clearEventFallback();\n    return this[this._isForward ? 'to' : 'from'];\n  },\n\n  /**\n   * @private\n   * @param {Number} duration\n   */\n  _startTransition: function (duration) {\n    var k, a = [];\n    var styles = this[this._isForward ? 'to' : 'from'];\n    var timing = this._isForward ? this.timing.getCSSName() : this.timing.getBackwardCSSName();\n    var camelCaseToHyphen = olleh.maps.util.dom.camelCaseToHyphen;\n    var browserStyle = olleh.maps.browser.style;\n    \n    //    \n    //   transitionend       \n    this._styleCount = 0;\n    \n    for (k in this.to) {\n      if (styles[k] != this.element.getStyle(k)) {\n        a.push(camelCaseToHyphen(browserStyle[k] ? browserStyle[k] : k) + ' ' + duration + 's ' + timing);\n        this._styleCount++;\n      }\n    }\n    \n    if (this._styleCount > 0) {\n      this.element.addEventListener(this._eventType, this._bound_onTransitionend);\n      this.element.setStyle(this._styleName, a.join(','));\n      this.element.setStyles(styles);\n      this._listening = true;\n    }\n    \n    //         \n    //     ,   transitionend \n    //   _finish()  . _styleCount  \n    //   _finish()  .   \n    // duration + 0.1   _finish()  .\n    this._eventFallback = olleh.maps.util.delay(this._finish, duration * 1000 + 100, this);\n  },\n\n  /**\n   * @private\n   * @param {Event} event\n   */\n  _onTransitionend: function (event) {\n    if (event.target == this.element.elem) {\n      event.stopPropagation();\n      this._receivedEvent++;\n      if (this._receivedEvent == this._styleCount) {\n        this._finish();\n      }\n    }\n  },\n\n  /**\n   * @private\n   */\n  _clearEventFallback: function () {\n    if (this._eventFallback) {\n      window.clearTimeout(this._eventFallback);\n      this._eventFallback = null;\n    }\n  },\n  \n  /**\n   * @private\n   */\n  _finish: function () {\n    this._clearEventFallback();\n    if (this.comeback && this._isForward) {\n      this._isForward = false;\n      this.doCycle();\n    } else {\n      this._isForward = true;\n      this.finishCycle();\n    }\n  }\n\n});\n/**\r\n * {@link olleh.maps.fx.Pulse}    {@link olleh.maps.fx.Animator} .\r\n *     .\r\n */\r\n$class('olleh.maps.fx.PulseAnimator').extend(olleh.maps.fx.Animator).define({\r\n\r\n  /**\r\n   * .     .\r\n   * @private\r\n   * @param {HTMLElement} elem   HTML .\r\n   * @param {olleh.maps.fx.AnimationOptions} opts  .\r\n   */\r\n  PulseAnimator: function (elem, opts) {\r\n    var fn = this.timing.getFn(), pulse = this.pulse;\r\n    \r\n    if (this.comeback) {\r\n      this._fn = function (t) {\r\n        return fn((t > .5 ? 1 - t : t) * 2);\r\n      };\r\n    } else {\r\n      this._fn = fn;\r\n    }\r\n    \r\n    if (pulse && pulse.getPulse) {\r\n      this._pulse = pulse.getPulse();\r\n    } else if (pulse && pulse.add) {\r\n      this._pulse = pulse;\r\n    } else {\r\n      this._pulse = new olleh.maps.fx.Pulse(this.duration);\r\n    }\r\n    \r\n    this._lastStyle = this.from;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.fx.Pulse} pulse\r\n   */\r\n  setPulse: function (pulse) {\r\n    if (this._attached) {\r\n      this._pulse.remove(this);\r\n      pulse.add(this);\r\n    }\r\n    this._pulse = pulse;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.fx.Pulse}\r\n   */\r\n  getPulse: function () {\r\n    return this._pulse;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doInit: function() {\r\n    var k, from, to;\r\n    var parseStyleValue = olleh.maps.util.dom.parseStyleValue;\r\n\r\n    this._bound_step = this.step.bind(this);\r\n    this._from = {};\r\n    this._to = {};\r\n    \r\n    for (k in this.to) {\r\n      if (this.to[k] == undefined || !this.to.hasOwnProperty(k)) {\r\n        continue;\r\n      }\r\n      \r\n      if (this.from[k]) {\r\n        from = parseStyleValue(this.from[k]);\r\n      } else {\r\n        olleh.maps.log.info('Initial style \"' + k + '\" is not defined; can cause performance issue', this);\r\n        from = parseStyleValue(this.element.getComputedStyle(k));\r\n      }\r\n      \r\n      to = parseStyleValue(this.to[k]);\r\n      \r\n      this._from[k] = from;\r\n      this._to[k] = to;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  doClean: function () {\r\n    this._detachPulse();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCycle: function () {\r\n    this._attachPulse();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doStop: function () {\r\n    this._applyStyle(1);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doPause: function () {\r\n    this._detachPulse();\r\n    return this._lastStyle;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doResume: function () {\r\n    this._attachPulse();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCancel: function () {\r\n    var k;\r\n    for (k in this.to) {\r\n      this.element.setStyle(k, this.from[k]);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doIgnore: function () {\r\n    this._detachPulse();\r\n    return this._lastStyle;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _attachPulse: function () {\r\n    if (!this._attached) {\r\n      if (this.duration > this._pulse.period) {\r\n        throw new RangeError('Animator duration must be greater than period: ' + this.duration + ', ' + this._pulse.period);\r\n      }\r\n      this._pulse.add(this._bound_step, this._lastTime);\r\n      this._attached = true;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _detachPulse: function () {\r\n    if (this._attached) {\r\n      this._pulse.remove(this._bound_step);\r\n      this._attached = false;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Number} t\r\n   */\r\n  _applyStyle: function (t) {\r\n    var k, i, j, l, ll, result, params, from, to, fromOpt, toOpt, fromParam, toParam, value, percent = this._fn(t);\r\n    var parsedStyleToString = olleh.maps.util.dom.parsedStyleToString;\r\n\r\n    this._lastStyle = {};\r\n    \r\n    for (k in this._to) {\r\n      result = [];\r\n      from = this._from[k];\r\n      to = this._to[k];\r\n      \r\n      for (i = 0, l = to.length; i < l; i++) {\r\n        fromOpt = from[i];\r\n        toOpt = to[i];\r\n        \r\n        if (toOpt.name) {\r\n          params = [];\r\n          \r\n          for (j = 0, ll = toOpt.params.length; j < ll; j++) {\r\n            fromParam = fromOpt && fromOpt.name ? fromOpt.params[j].value : 0;\r\n            toParam = toOpt.params[j];\r\n            value = fromParam + (toParam.value - fromParam) * percent;\r\n            params.push({\r\n              unit: toParam.unit,\r\n              value: toParam.unit === 'px' ? Math.ceil(value) : value\r\n            });\r\n          }\r\n\r\n          result.push({\r\n            name: toOpt.name,\r\n            params: params\r\n          });\r\n        } else {\r\n          value = fromOpt.value + (toOpt.value - fromOpt.value) * percent;\r\n          result.push({\r\n            unit: toOpt.unit,\r\n            value: toOpt.unit === 'px' ? Math.ceil(value) : value\r\n          });\r\n        }\r\n      }\r\n      \r\n      this._lastStyle[k] = parsedStyleToString(result);\r\n      this.element.setStyle(k, this._lastStyle[k]);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {Number} playTime\r\n   * @returns {Boolean}\r\n   */\r\n  step: function (playTime) {\r\n    if (!this._attached) {\r\n      return;\r\n    }\r\n    \r\n    this._applyStyle(playTime / this.duration);\r\n    \r\n    this._lastTime = playTime;\r\n\r\n    if (playTime == this._pulse.period) {\r\n      this.finishCycle();\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *      <code>requestAnimationFrame</code>        .\r\n *          .\r\n */\r\n$class('olleh.maps.fx.AnimationFrameQueue').define({\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  AnimationFrameQueue: function () {\r\n    this._jobs = [];\r\n    this._enabled = false;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {Boolean}    <code>true</code>,    <code>false</code>.\r\n   */\r\n  isEnabled: function () {\r\n    return this._enabled;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   *      <code>requestAnimationFrame</code>     .\r\n   *       {@link olleh.maps.fx.AnimationFrameQueue#flush} .\r\n   * @param {Boolean} enabled <code>true</code>   ,    .\r\n   */\r\n  setEnabled: function (enabled) {\r\n    if (enabled) {\r\n      this.start();\r\n    } else {\r\n      this.flush();\r\n    }\r\n    this._enabled = enabled;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  flush: function () {\r\n    var job, jobs = this._jobs;\r\n    this.stop();\r\n    while (jobs.length) {\r\n      job = jobs.shift();\r\n      job.fn.apply(job.ctx);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   */\r\n  clear: function () {\r\n    this.stop();\r\n    this._jobs.length = 0;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @param {Function} fn   .\r\n   * @param {Object} ctx    .\r\n   */\r\n  push: function (fn, ctx) {\r\n    if (this._enabled) {\r\n      this._jobs.push({\r\n        fn: fn,\r\n        ctx: ctx\r\n      });\r\n      this.start();\r\n    } else {\r\n      fn.apply(ctx);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  start: function () {\r\n    if (!this._af && this._jobs.length > 0) {\r\n      this._af = olleh.maps.util.deferAF(this._step, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  stop: function () {\r\n    if (this._af) {\r\n      window.cancelAnimationFrame(this._af);\r\n      this._af = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _step: function () {\r\n    var job, jobs = this._jobs;\r\n    \r\n    if (jobs.length == 0) {\r\n      this.stop();\r\n      return;\r\n    }\r\n    \r\n    this._af = olleh.maps.util.deferAF(this._step, this);\r\n    \r\n    job = jobs.shift();\r\n    job.fn.apply(job.ctx);\r\n  }\r\n  \r\n});\r\n/**\r\n * FX .\r\n * @private\r\n */\r\nolleh.maps.namespace('olleh.maps.fx', {\r\n  /**\r\n   *  \r\n   * @private\r\n   * @type olleh.maps.fx.AnimatorBuffer\r\n   */\r\n  animatorBuffer: new olleh.maps.fx.AnimatorBuffer(),\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Number}\r\n   */\r\n  now: function () {\r\n    return +Date.now();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @type {Boolean}\r\n   */\r\n  useAFTime: false\r\n\r\n});\r\n\r\n// See #2718\r\n(function () {\r\n  if (window.performance && window.performance.now) {\r\n    olleh.maps.fx.now = function () {\r\n      return window.performance.now();\r\n    };\r\n    olleh.maps.util.deferAF(function (time) {\r\n      olleh.maps.fx.useAFTime = time && time > 1e12 && olleh.maps.fx.now() > 1e12;\r\n    });\r\n  }\r\n})();/**\r\n * KT    .\r\n * KT     \r\n *  <code>olleh.maps.event.Event</code>  .<p/>\r\n *    {@link olleh.maps.event.EventDelegator} mixin .\r\n * <p/>\r\n * <h3>KT  </h3>\r\n *      .\r\n * {@link olleh.maps.event.EventManager}    hit target ,\r\n * {@link olleh.maps.event.Recognizer}     .\r\n * <p/>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keydown|keydown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keyup|keyup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keypress|keypress}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n *   <li>{@link olleh.maps.Map#event:resize|resize}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousemove|mousemove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousewheel|mousewheel}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchstart|touchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchmove|touchmove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchend|touchend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchcancel|touchcancel}</li>\r\n * </ul>\r\n * <h5>   </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchstart|pinchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinch|pinch}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchend|pinchend}</li>\r\n * </ul>\r\n * <h3>  </h3>\r\n * KT        .\r\n *   {@link olleh.maps.event.EventDelegator#fireEvent} , {@link olleh.maps.event.EventDelegator#onEvent}\r\n *   .\r\n * @example\r\n * marker.onEvent('custom', function (event, payload) {\r\n *   olleh.maps.log.info(payload.x);\r\n * });\r\n * ... \r\n * var customEvent = new olleh.maps.event.Event('custom', marker);\r\n * marker.fireEvent(customEvent, {x: 1, y: 1, z:1});\r\n * \r\n * @summary KT    .\r\n */\r\n$class('olleh.maps.event.Event').define({\r\n  $static: {\r\n    /** \r\n     *   CAPTURE .\r\n     * @type Number\r\n     */\r\n    CAPTURING_PHASE: 1,\r\n    /** \r\n     *   TARGET .\r\n     * @type Number\r\n     */\r\n    AT_TARGET: 2,\r\n    /** \r\n     *   BUBBLING .\r\n     * @type Number\r\n     */\r\n    BUBBLING_PHASE: 3,\r\n    /**\r\n     *  phase  default behavior   . \r\n     * @private\r\n     * @type Number\r\n     */\r\n    DEFAULT_PHASE: 8\r\n  },\r\n  \r\n  /**\r\n   * ,  Event  .\r\n   * @param {String} name  \r\n   * @param {Object} src\r\n   * @param {olleh.maps.event.EventDelegator}  src   {@link olleh.maps.event.EventDelegator} \r\n   * @param {Object} [opts] \r\n   * @param {UIEvent} [opts.originEvent]   \r\n   * @param {HTMLElement} [opts.targetDOM]   Event DOM Element\r\n   * @param {Array.<Touch>} [opts.touches]    Touch \r\n   * @param {Array.<Touch>} [opts.targetTouches]  DOM element  Touch \r\n   * @param {Array.<Touch>} [opts.changedTouches]     Touch \r\n   * @see http://dvcs.w3.org/hg/webevents/raw-file/tip/touchevents.html#idl-def-TouchEvent|w3c TouchEvent\r\n   */\r\n  Event: function (name, src, opts) {\r\n    var maps = olleh.maps; \r\n    \r\n    this._name = name;\r\n    this._src = src;\r\n    this._stopPropagation = false;\r\n    this._stopImmediatePropagation = false;\r\n    this._defaultPrevented = false;\r\n\r\n    /**\r\n     *    .<p/>\r\n     *    {@link olleh.maps.event.Event.CAPTURING_PHASE}, {@link olleh.maps.event.Event.AT_TARGET}, \r\n     * {@link olleh.maps.event.Event.BUBBLING_PHASE}  .\r\n     * @type Number\r\n     * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-Event|w3c Event\r\n     */\r\n    this.eventPhase = 0;\r\n    \r\n    this.pageXY = undefined;\r\n    this._point = undefined;\r\n    this._coord = undefined;\r\n    this._map = undefined;\r\n    \r\n    if (opts) {\r\n      maps.mixin(this, opts, true);\r\n      \r\n      if (this.hasOwnProperty('touches')) { // Touch Event members\r\n        this.targetTouches = this.targetTouches || this.touches;\r\n        this.changedTouches = this.changedTouches || this.touches;\r\n      }\r\n\r\n      /**\r\n       *   Event DOM Element\r\n       * <p />\r\n       * {@link olleh.maps.event.EventDelegator#registerEventDom}   HTMLElement \r\n       * @type HTMLElement\r\n       * @name olleh.maps.event.Event#targetDOM\r\n       * @see olleh.maps.event.EventDelegator#registerEventDom\r\n       */\r\n      /**\r\n       *  \r\n       * <p />\r\n       *     <code>undefined</code>\r\n       * @type UIEvent\r\n       * @name olleh.maps.event.Event#originEvent\r\n       */\r\n      var originEvent = opts.originEvent;\r\n      \r\n      if (originEvent) {\r\n        this.timeStamp = originEvent.timeStamp || +(new Date());\r\n        \r\n        if (maps.isUndefined(opts.pageXY)) {\r\n          \r\n          var x = originEvent.pageX;\r\n          var y = originEvent.pageY;\r\n          \r\n          if (x == null && originEvent.x != null) { // ie9\r\n            var targetDOM = this.targetDOM ? this.targetDOM.ownerDocument || document : document;\r\n            var doc = targetDOM.documentElement;\r\n            var body = doc.body;\r\n            \r\n            x = originEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - \r\n            (doc && doc.clientLeft || body && body.clientLeft || 0);\r\n            y = originEvent.clientY + (doc && doc.scrollTop  || body && body.scrollTop  || 0) - \r\n            (doc && doc.clientTop  || body && body.clientTop  || 0);\r\n          } \r\n          /**\r\n           *   ()  pageX, pageY  \r\n           * @type olleh.maps.Point\r\n           */\r\n          this.pageXY = new maps.Point(x || 0, y || 0);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!this.hasOwnProperty('timeStamp')) {\r\n      /**\r\n       *    timestamp <p/>\r\n       *   {@link #originEvent}     <code>timeStamp</code> .\r\n       * @type Number\r\n       */\r\n      this.timeStamp = +(new Date());\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {String}   \r\n   */\r\n  getName: function () {\r\n    return this._name;\r\n  },\r\n\r\n  /**\r\n   *   ({@link olleh.maps.event.EventDelegator}) .\r\n   * @returns {olleh.maps.event.EventDelegator} EventDelegator  \r\n   */\r\n  getSource: function () {\r\n    return this._src;\r\n  },\r\n\r\n  /**\r\n   * bubbling, capture phase            . \r\n   * @see #stopImmediatePropagation\r\n   * @see http://www.w3.org/TR/2006/WD-DOM-Level-3-Events-20060413/events.html#Events-Event-stopPropagation|w3c Event-stopPropagation\r\n   */ \r\n  stopPropagation: function () {\r\n    this._stopPropagation = true;\r\n  },\r\n\r\n  /**\r\n   * {@link #stopPropagation}      .\r\n   * @see #stopPropagation\r\n   * @see http://www.w3.org/TR/2006/WD-DOM-Level-3-Events-20060413/events.html#Events-Event-stopImmediatePropagation|w3c Event-stopImmediatePropagation\r\n   */ \r\n  stopImmediatePropagation: function () {\r\n    this._stopImmediatePropagation = true;\r\n  },\r\n\r\n  /**\r\n   *  default function   .\r\n   */\r\n  preventDefault: function () {\r\n    this._defaultPrevented = true;\r\n  },\r\n\r\n  /**\r\n   *       viewport pixel  .\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  getPoint: function () {\r\n    var xy = this.pageXY;\r\n    \r\n    if (olleh.maps.isUndefined(xy)) return null;\r\n    \r\n    if (olleh.maps.isUndefined(this._point)) {\r\n      var map = this._getMap();\r\n      if (!map) {\r\n        return (this._point = null);\r\n      }\r\n      var rootXY = map.layerMgr.getViewportOffset();\r\n      this._point = xy.subtract(rootXY);\r\n    }\r\n    return this._point;\r\n  },\r\n  \r\n  /**\r\n   * viewport pixel  coord  .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getCoord: function () {\r\n    if (this._coord !== null) {\r\n      var viewportPx = this.getPoint();\r\n      \r\n      if (!viewportPx) {\r\n        return this._coord = null;\r\n      }\r\n      var map = this._getMap();\r\n      this._coord = map ?  map.layerMgr.getCoordFromViewportPx(viewportPx) : \r\n        null;\r\n    }\r\n    return this._coord;\r\n  },\r\n  \r\n  /**\r\n   *  ({@link olleh.maps.Map}) .\r\n   * @returns {olleh.maps.Map}\r\n   * @private\r\n   */\r\n  _getMap: function () {\r\n    var hit = this._src;\r\n    \r\n    if (!hit || this._map === null) return null;\r\n    \r\n    var bubble = hit.getMap ? hit.getMap() || hit.getBubble() : hit.getBubble();\r\n    var Map = olleh.maps.Map;\r\n    \r\n    while (bubble && !(bubble instanceof Map)) {\r\n      bubble = bubble.getMap ? bubble.getMap() || bubble.getBubble() : bubble.getBubble();\r\n    }\r\n    bubble = bubble || hit;\r\n    \r\n    if (bubble instanceof Map) {\r\n      this._map = bubble; \r\n    } else {\r\n      this._map = null;\r\n    }\r\n    return this._map;\r\n  } \r\n});/**\r\n *      .\r\n *   mixin  {@link #onEvent}, {@link #fireEvent}    . \r\n * <p/>\r\n * <h3>EventDelegator mixin  </h3>\r\n * KT  UI   <code>EventDelegator</code> mixin .\r\n *    mixin . \r\n * <ul>\r\n *   <li>{@link olleh.maps.Map|}</li>\r\n *   <li>{@link olleh.maps.overlay.Marker|}</li>\r\n *   <li>{@link olleh.maps.overlay.InfoWindow|}</li>\r\n * </ul>\r\n * <h3>  API</h3>\r\n *  API   API. \r\n *   API        API .\r\n * <ul>\r\n *   <li>{@link #onEvent}</li>\r\n *   <li>{@link #fireEvent}</li>\r\n * </ul>\r\n * <h3>     API</h3>\r\n *     DOM Element       \r\n * {@link #registerEventDom},   {@link #unregisterEventDom} .\r\n * \r\n * @example\r\n * $class('Foo').mixin(olleh.maps.event.EventDelegator).define({\r\n *   init: function () {\r\n *     this.fooDOM1 = document.createElement('div');\r\n *     this.fooDOM2 = document.createElement('div');\r\n *     this.fooDOM3 = document.createElement('div');\r\n *     ...\r\n *     this.registerEventDom(this.fooDOM1);\r\n *     this.registerEventDom(this.fooDOM2);\r\n *     this.registerEventDom(this.fooDOM3);\r\n *   },\r\n *   \r\n *   $default_click: function (event, payload) {\r\n *     if (event.targetDOM === this.fooDOM1) {\r\n *       olleh.maps.log.info('fooDOM1 clicked');\r\n *     }\r\n *   }\r\n * });\r\n * \r\n * var foo = new Foo();\r\n *\r\n * foo.onEvent('click', function (event, payload) {\r\n *   olleh.maps.log.info(event.targetDOM);\r\n *   foo.fireEvent('customEvent', {customX: 1, customY: 2});\r\n * });\r\n * foo.onEvent('customEvent', function (event, payload) {\r\n *   olleh.maps.log.info(payload.customX + ',' + payload.customY);\r\n * });\r\n * \r\n * @summary EventDelegator       .\r\n *    EventDelegator Bubbling .\r\n */\r\n$class('olleh.maps.event.EventDelegator').define({\r\n  /**\r\n   *        hit test \r\n   *   {@link olleh.maps.event.EventManager}   .\r\n   * <p />\r\n   *      API    .\r\n   * @private\r\n   */\r\n  registerEvent: function () {\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.registry(this);\r\n  },\r\n  \r\n  /**\r\n   *        hit test \r\n   *   {@link olleh.maps.event.EventManager}   .\r\n   * <p />\r\n   *      API    .\r\n   * @param {HTMLElement} elem\r\n   * @private\r\n   */\r\n  registerEventDom: function (elem) {\r\n    if (!elem) return;\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.registryDom(this, elem);\r\n  },\r\n\r\n  /**\r\n   *  <code>elem</code>      .\r\n   * <p />\r\n   *       API    .\r\n   * @param {HTMLElement} elem\r\n   * @see #registerEventDom\r\n   * @private\r\n   */\r\n  unregisterEventDom: function (elem) {\r\n    if (!elem) return;\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.unregistryDom(elem);\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *   {@link olleh.maps.event.EventManager}   .\r\n   * <p />\r\n   *       API    .\r\n   * @see #unregisterEventDom\r\n   * @private\r\n   */\r\n  unregisterEvent: function () {\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.unregistry(this);\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   *    .      .\r\n   * @returns {String}\r\n   * @private\r\n   */\r\n  getId: function () {\r\n    if (!this.hasOwnProperty('_id') || this._id == null) {\r\n      this._id = olleh.maps.util.genId();\r\n    } \r\n    return this._id;\r\n  },\r\n  \r\n  /**\r\n   *   bubble-target  . \r\n   *  bubble-target    <code>null</code> .\r\n   * <p />\r\n   * bubble-target    .\r\n   * @returns {olleh.maps.event.EventDelegator} bubble-target , \r\n   *   <code>null</code> \r\n   * @private\r\n   */\r\n  getBubble: function () {\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   *         .\r\n   * <p/>\r\n   *   bubbling-up    .\r\n   * <p/>\r\n   *   delay 0    Async     -1\r\n   *  Sync       .\r\n   * <p/>\r\n   *    ,      .\r\n   * @example\r\n   * var marker = new olleh.maps.overlay.Marker({\r\n   *   position: new olleh.maps.UTMK(958094.063532902, 1942790.8261742294),\r\n   *   map: map\r\n   * })\r\n   * \r\n   * var customEvent = new olleh.maps.event.Event('custom1', marker);\r\n   * marker.fireEvent(customEvent, {x: 1, y: 1});\r\n   * marker.fireEvent('custom2', {x: 1, y: 1});\r\n   * \r\n   * @param {String|olleh.maps.event.Event} event    \r\n   * @param {Object} payload      \r\n   * @param {Number} delay     (milliseconds)\r\n   * @see #onEvent\r\n   */\r\n  fireEvent: function (event, payload, delay) {\r\n    if (olleh.maps.isString(event)) {\r\n      event = new olleh.maps.event.Event(event, this);\r\n    }\r\n    if (event._stopPropagation) return false;\r\n\r\n    if (delay >= 0) {\r\n      olleh.maps.util.delay(this._handleFireEvent, delay, this, event, payload);\r\n    } else {\r\n      this._handleFireEvent(event, payload);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *   bubble-up    target \r\n   *        \r\n   * .  bubble-up   target \r\n   *      .\r\n   * @returns {Array.<olleh.maps.event.EventDelegator>}     bubble-up target \r\n   *   \r\n   * @private\r\n   */\r\n  lookupBubbles: function () {\r\n    var results = [];\r\n    var target = this.getBubble();\r\n\r\n    while (target) {\r\n      results.push(target);\r\n      target = target.getBubble();\r\n    }\r\n    return results;\r\n  },\r\n  \r\n  /**\r\n   *     callback  .\r\n   * <p/>\r\n   * callback   {@link #fireEvent}    .\r\n   * @example\r\n   * var map = new olleh.maps.Map(document.getElementById('map'), {\r\n   *  center: new olleh.maps.UTMK(958094.063532902, 1942790.8261742294)\r\n   * });\r\n   * var marker = new olleh.maps.overlay.Marker({\r\n   *   position: new olleh.maps.UTMK(958094.063532902, 1942790.8261742294),\r\n   *   map: map\r\n   * })\r\n   * ...\r\n   *  // marker   map capture     .\r\n   * map.onEvent('click', function (event, payload) {\r\n   *   var src = event.getSource();\r\n   *   olleh.maps.log.info('1 ' + src + ': clicked'); \r\n   * }, this, true);\r\n   *  // marker   marker target    .\r\n   * marker.onEvent('click', function (event, payload) {\r\n   *   var src = event.getSource();\r\n   *   olleh.maps.log.info('2 ' + src + ': clicked');\r\n   * }, this);\r\n   *  // marker   map bubbleup    .\r\n   * map.onEvent('click', function (event, payload) {\r\n   *   var src = event.getSource();\r\n   *   olleh.maps.log.info('3 ' + src + ': clicked'); \r\n   * }, this);\r\n   * @param {String} eventName  \r\n   * @param {Function} callbackFn     callback \r\n   * @param {Object} ctx callback   <code>this</code> .\r\n   *    source   .\r\n   * @param {Boolean} [capture = false]   . \r\n   * <code>true</code> capture    bubble-up . \r\n   * @returns {Boolean}   <code>true</code> \r\n   * @see #fireEvent\r\n   * @see #unsubscribeEvent\r\n   */\r\n  onEvent: function (eventName, callbackFn, ctx, capture) {\r\n\r\n    if (!olleh.maps.isFunction(callbackFn)) {\r\n      throw new TypeError('Specified event listener is not a function: '\r\n          + callbackFn + this.currentStack());\r\n    }\r\n    if (ctx && !olleh.maps.isObject(ctx)) {\r\n      throw new TypeError('Specified event context is not an Object type: '\r\n          + ctx + this.currentStack());\r\n    }\r\n    \r\n    var listener = this._findEventListener(eventName, callbackFn, true);\r\n    // 1(Capture), 2(Bubble), 3 (Both)\r\n    callbackFn.capture |= (capture ? 1 : 2); // BIT-OR operation\r\n    if (listener) {\r\n      ctx = ctx || this;\r\n      if (olleh.maps.util.indexOf(listener.$ctxs, ctx) === -1) {\r\n        listener.$ctxs.push(ctx);\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  \r\n  /**\r\n   *    {@link olleh.maps.event.EventDelegator}\r\n   * propatation.(bubble-up)\r\n   * <p/>\r\n   *       Bubble-up   .\r\n   * <p/>\r\n   *     .   .\r\n   * @param {olleh.maps.event.Event} event \r\n   * @param {Object} [payload]     \r\n   * @returns {Boolean}     <code>true</code> \r\n   * @see #fireEvent\r\n   * @private\r\n   */\r\n  propagateEvent: function (event, payload) {\r\n    if (!event) return false;\r\n    \r\n    var bubble;\r\n    var ns = olleh.maps.event.Event;\r\n    \r\n    this._notifyListeners(event, payload);\r\n    \r\n    if (event.eventPhase !== ns.BUBBLING_PHASE) {\r\n      event.eventPhase = ns.BUBBLING_PHASE;\r\n    }\r\n    // Continue bubbling up if it wasn't stopped or local event wasn't fired\r\n    if (!event._stopPropagation && !event._stopImmediatePropagation) {\r\n      bubble = this.getBubble();\r\n      bubble && bubble.propagateEvent.apply(bubble, arguments);\r\n    }\r\n    return true;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * <p/>\r\n   * callbackFn  ,     .\r\n   * ctx   callbackFn    .\r\n   * @param {String} eventName  \r\n   * @param {Function} [callbackFn]   \r\n   * @param {Object} [ctx]    <code>this</code> \r\n   * @see #onEvent\r\n   */\r\n  unsubscribeEvent: function (eventName, callbackFn, ctx) {\r\n    var listeners = this._getEventListeners(eventName);\r\n    \r\n    if (!listeners || listeners.length === 0) return;\r\n\r\n    if (callbackFn) {\r\n      var listener = this._findEventListener(eventName, callbackFn);\r\n      \r\n      if (!listener) return;\r\n      \r\n      if (olleh.maps.isUndefined(ctx)) { // removes all the listeners\r\n        listeners.splice(olleh.maps.util.indexOf(listeners, listener), 1);\r\n        return;\r\n      }\r\n      \r\n      var c = olleh.maps.util.indexOf(listener.$ctxs, ctx || this);\r\n      if (c != -1) {\r\n        listener.$ctxs.splice(c, 1); // remove\r\n      }\r\n      if (listener.$ctxs.length === 0) {\r\n        listener.$fn = undefined;\r\n        listeners.splice(olleh.maps.util.indexOf(listeners, listener), 1);\r\n      }\r\n    } else { // removes all the listeners\r\n      this._eventListeners[eventName] = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * , callbackFn    . \r\n   *      .\r\n   * @param {String} name \r\n   * @param {Function} callbackFn    \r\n   * @param {Boolean} create <code>true</code>     .\r\n   * @returns {{$fn: Function, $ctxs: Array}}    context\r\n   *   $fn:    , \r\n   *   $ctxs: $fn  <code>this</code>  context  \r\n   * @private\r\n   */\r\n  _findEventListener: function (name, callbackFn, create) {\r\n    var listeners = this._getEventListeners(name); \r\n    var listener = null;\r\n\r\n    if (!listeners && create) {\r\n      listeners = [];\r\n      this._eventListeners[name] = listeners;\r\n      listener = {$fn: callbackFn, $ctxs: []};\r\n      listeners.push(listener);\r\n      return listener;\r\n    }\r\n    \r\n    for(var i = 0, len = listeners.length; i < len; i++) {\r\n      listener = listeners[i];\r\n      if (listener && listener.$fn === callbackFn) {\r\n        return listener;\r\n      }\r\n    }\r\n\r\n    if (listeners && create) {\r\n      listener = {$fn: callbackFn, $ctxs: []};\r\n      listeners.push(listener);\r\n      return listener;\r\n    }\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   *   callback   . \r\n   * @param {Boolean} [capture = false] true capture\r\n   *       bubble up\r\n   *  .\r\n   * @returns {Array.<{$fn: Function, $ctxs: Array}>}     context  \r\n   *   $fn:    , \r\n   *   $ctxs: $fn  <code>this</code>  context  \r\n   * @private\r\n   */\r\n  _findEventListeners: function (event, capture) {\r\n    var listeners = this._getEventListeners(event.getName());\r\n    var results = [];\r\n    var phase = capture ? 1 : 2;\r\n    for (var i = 0, len = listeners ? listeners.length : 0; i < len; i++) {\r\n      if ((listeners[i].$fn.capture & phase) == phase) { // BIT-AND operation\r\n        results.push(listeners[i]);\r\n      }\r\n    }\r\n    return results;\r\n  },\r\n\r\n  /**\r\n   *      context   .\r\n   * @param {String} eventName\r\n   * @returns {Array.<{$fn: Function, $ctxs: Array}>}    context  \r\n   *   $fn:    , \r\n   *   $ctxs: $fn  <code>this</code>  context  \r\n   * @private\r\n   */\r\n  _getEventListeners: function (eventName) {\r\n    if (!this.hasOwnProperty('_eventListeners')) {\r\n      this._eventListeners = {};\r\n      return null;\r\n    }\r\n    return this._eventListeners[eventName];\r\n  },\r\n  \r\n  /**\r\n   * {@link olleh.maps.event.EventManager} .\r\n   * @returns {olleh.maps.event.EventManager}\r\n   * @private\r\n   * @see #registerEventDom\r\n   * @see #unregisterEventDom\r\n   */\r\n  _getEventManager: function () {\r\n    if (!this.hasOwnProperty('_eventMgr')) {\r\n      var bubble = this.getMap ? this.getMap() || this.getBubble(): this.getBubble();\r\n      var Map = olleh.maps.Map;\r\n  \r\n      while (bubble && !(bubble instanceof Map)) {\r\n        bubble = bubble.getMap ? bubble.getMap() || bubble.getBubble(): bubble.getBubble();\r\n      }\r\n      bubble = bubble || this;\r\n  \r\n      if (bubble instanceof Map) {\r\n        this._eventMgr = bubble.eventMgr;\r\n      } else {\r\n        this._eventMgr = null;\r\n      }\r\n    }\r\n    return this._eventMgr;\r\n  },\r\n  \r\n  /**\r\n   *  fire   \r\n   * <p/>\r\n   * capture   ,\r\n   * target   ,\r\n   *    bubble   .\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} payload\r\n   * @private\r\n   */\r\n  _handleFireEvent: function (event, payload) {\r\n    \r\n    var path = this.lookupBubbles();\r\n    var ns = olleh.maps.event.Event;\r\n    var name = event.getName();\r\n    var ctx, defaultFn, i, len;\r\n    \r\n    event.eventPhase = ns.CAPTURING_PHASE;\r\n\r\n    // capture phase\r\n    while (path.length != 0 && !event._stopPropagation && !event._stopImmediatePropagation) {\r\n      path.pop()._notifyListeners(event);\r\n    }\r\n    if (!event._stopPropagation && !event._stopImmediatePropagation) {\r\n      this._notifyListeners(event, payload); // capture phase(target)\r\n      event.eventPhase = ns.AT_TARGET; // 2; target phase\r\n      this.propagateEvent(event, payload);\r\n    }\r\n    // default\r\n    path = [this].concat(this.lookupBubbles());\r\n    for(i = 0, len = path.length; i < len && !event._defaultPrevented; i++) {\r\n      ctx = path[i];\r\n      \r\n      if (this._checkEvent.apply(ctx, [name, ns.DEFAULT_PHASE])) {\r\n        defaultFn = ctx['$default_' + name];\r\n        defaultFn && defaultFn.apply(ctx, arguments);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *    callback  .\r\n   * @param {olleh.maps.event.Event} event  \r\n   * @param {Object} [payload]    \r\n   * @returns {Number}   \r\n   * @private\r\n   */\r\n  _notifyListeners: function (event, payload) {\r\n    var j, ctxs, ctx, listener, fn;\r\n    var phase = event.eventPhase;\r\n    var capturing = (phase === olleh.maps.event.Event.CAPTURING_PHASE);\r\n    var listeners = this._findEventListeners(event, capturing);\r\n    var i = listeners ? listeners.length : 0;\r\n    var eventName = event.getName();\r\n    \r\n    if (this._checkEvent(eventName, phase)) {\r\n      fn = this[(capturing ? '$capture_' : '$current_') + eventName];\r\n      fn && fn.apply(this, arguments);\r\n    }\r\n\r\n    if (event._stopImmediatePropagation) return true;\r\n    \r\n    while (i--) {\r\n      listener = listeners[i];\r\n      if (!listener) continue;\r\n      try {\r\n        ctxs = listener.$ctxs;\r\n        j = ctxs ? ctxs.length : 0;\r\n        while (j--) {\r\n          ctx = ctxs[j];\r\n          ctx && listener.$fn && listener.$fn.apply(ctx, arguments);\r\n          if (event._stopImmediatePropagation) return true;\r\n        }\r\n      } catch (ex) {\r\n        // If graceful errors is set, log error and continue event callback\r\n        olleh.maps.log.error('Error occured during event listener: ' + ex, this);\r\n        \r\n        if (ex.stack) { // chrome\r\n          olleh.maps.log.error(ex.stack, this);\r\n        } else {\r\n          throw ex;\r\n        }\r\n      }\r\n    }\r\n    return true;\r\n  },\r\n\r\n  /**\r\n   * @param {String} eventName \r\n   * @param {Number} phase  \r\n   * @see olleh.maps.event.Event\r\n   * @private\r\n   */\r\n  _checkEvent: function (eventName, phase) {\r\n    var Event = olleh.maps.event.Event;\r\n    \r\n    // targetting, bubbling  $current .\r\n    if (phase === Event.BUBBLING_PHASE) {\r\n      phase = Event.AT_TARGET;\r\n    }\r\n    var event = this.$EVENTS[eventName];\r\n    \r\n    return !!(event && event | phase);\r\n  },\r\n  \r\n  /**\r\n   *  define   .\r\n   * <p/>\r\n   * $cature_, $current_, $default_    $EVENTS   .\r\n   * @private\r\n   */\r\n  $afterDefine: function () {\r\n    var clazz = this;\r\n    var clazzPrototype = clazz.prototype;\r\n    var Event = olleh.maps.event.Event;\r\n\r\n    clazzPrototype.$EVENTS = {};\r\n    \r\n    var events = clazzPrototype.$EVENTS;\r\n    \r\n    // TODO   refactoring\r\n    for(var k in clazzPrototype) {\r\n      if (k.indexOf('$') != 0) {\r\n        continue;\r\n      }\r\n      var eventName = null;\r\n      if (k.indexOf('capture_') == 1) {\r\n        eventName = k.substring(9);\r\n        events[eventName] = events[eventName] | Event.CAPTURING_PHASE;\r\n      } else if (k.indexOf('current_') == 1) {\r\n        eventName = k.substring(9);\r\n        events[eventName] = events[eventName] | Event.AT_TARGET;\r\n      } else if (k.indexOf('default_') == 1) {\r\n        eventName = k.substring(9);\r\n        events[eventName] = events[eventName] | Event.DEFAULT_PHASE;\r\n      }\r\n    }\r\n  }\r\n});/**\r\n * KT      {@link olleh.maps.event.Event}    {@link olleh.maps.event.EventDelegator}   .\r\n * EventManager    .\r\n * <h3>  </h3>\r\n * KT      DOM element  .\r\n * KT {@link olleh.maps.event.EventDelegator}      EventManager  . \r\n * <p/> \r\n * EventManager   (ie7, ff, safari, chrome)    {@link olleh.maps.event.Event}  ,\r\n *      {@link olleh.maps.event.Event}    .\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keydown|keydown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keyup|keyup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keypress|keypress}</li>\r\n *   <li>{@link olleh.maps.Map#event:resize|resize}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousemove|mousemove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousewheel|mousewheel}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchstart|touchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchmove|touchmove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchend|touchend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchcancel|touchcancel}</li>\r\n * </ul>\r\n * <p/>\r\n * <h3>hit Target</h3>\r\n *      DOM element {@link olleh.maps.event.EventDelegator}   .\r\n * EventManger     {@link olleh.maps.event.EventDelegator} .\r\n * <h5>{@link olleh.maps.event.EventDelegator}  </h5>\r\n * {@link #registry}   {@link olleh.maps.event.EventDelegator}     DOM element  .\r\n * <p/>\r\n *  DOM element  DOM element   bubble up    DOM element    .  \r\n * <h5>{@link olleh.maps.event.EventDelegator}  </h5>\r\n *    DOM element     {@link #unregistry}  .\r\n * <h5>hit test</h5>\r\n *   KT  <code>UIEvent#target</code> DOM element KT  DOM element .\r\n *  DOM element bubble up       DOM element {@link olleh.maps.event.EventDelegator}     . \r\n * <p/>\r\n * <h3> </h3>\r\n * KT     . \r\n * <h5>   </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchstart|pinchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinch|pinch}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchend|pinchend}</li>\r\n * </ul>\r\n *       EventManager {@link olleh.maps.event.Recognizer}  .\r\n * {@link #addRecognizer}  recognizer  ,\r\n * {@link #findRecognizer}    recognizer       .\r\n * , {@link #removeRecognizer}    recognizer   .\r\n * <p/>\r\n *  EventManager {@link olleh.maps.Map} Signleton , .\r\n * @summary\r\n * KT      {@link olleh.maps.event.Event}    {@link olleh.maps.event.EventDelegator}   . \r\n * @param {olleh.maps.Map} map Map \r\n * @param {HTMLElement} elem KT  DOM element\r\n */\r\n$class('olleh.maps.event.EventManager').define({\r\n  $static: {\r\n    /**\r\n     *  event stopPropagation .\r\n     * @example\r\n     * var domEvent = event.originEvent; // event olleh.maps.event.Event \r\n     * \r\n     * olleh.maps.event.EventManager.stopPropagation(domEvent);\r\n     * @param {UIEvent} domEvent  \r\n     * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface|w3c Event#stopPropagation\r\n     */\r\n    stopPropagation: function (domEvent) {\r\n      domEvent.stopPropagation ? domEvent.stopPropagation() : \r\n        (domEvent.cancelBubble = true); // ie7,8 cancelBubble\r\n    },\r\n\r\n    /**\r\n     *  event preventDefault .\r\n     * @example\r\n     * var domEvent = event.originEvent; // event olleh.maps.event.Event \r\n     * olleh.maps.event.EventManager.preventDefault(domEvent);\r\n     * @param {UIEvent} domEvent  \r\n     * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface|w3c Event#preventDefault\r\n     */\r\n    preventDefault: function (domEvent) {\r\n      domEvent.preventDefault ? domEvent.preventDefault() : \r\n        (domEvent.returnValue = false); // ie7,8 returnValue\r\n    },\r\n    \r\n    /**\r\n     *   .\r\n     * @param {MouseEvent} domEvent   \r\n     * @returns {Boolean}\r\n     */\r\n    isRightClick: function (domEvent) {\r\n      return (domEvent.which && domEvent.which == 3) || (domEvent.button && domEvent.button == 2);\r\n    },\r\n    \r\n    /**\r\n     *    DOM input, select, textarea  <code>false</code> .\r\n     * @returns {Boolean}\r\n     */\r\n    checkEnabledKeyevent: function (activeElement) {\r\n      olleh.maps.isUndefined(activeElement) && (activeElement = document.activeElement);\r\n      \r\n      if (!activeElement) return true;\r\n      \r\n      var nodeName = activeElement.nodeName;\r\n      return !(nodeName === 'INPUT' || nodeName === 'SELECT' || nodeName === 'TEXTAREA');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * req_zoomin \r\n   * @event olleh.maps.event.EventDelegator#event:req_zoomin\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  /**\r\n   * req_zoomout \r\n   * @event olleh.maps.event.EventDelegator#event:req_zoomout\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  /**\r\n   * ,  EventManager  .\r\n   * @param {olleh.maps.Map} map Map \r\n   * @param {HTMLElement} elem KT  DOM element\r\n   */\r\n  EventManager: function (map, elem) {\r\n    this._map = map;\r\n    this._root = elem;  // olleh.maps.Map     .\r\n    this._hitTargets = {}; // hit test      hashmap\r\n    this._recognizers = {};\r\n    \r\n    this._desktopIE = false;\r\n    this._clicked = false; //    true,    false\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * <p/>\r\n   *   .   . map start   .\r\n   * @private\r\n   */\r\n  start: function () {\r\n    var browser = olleh.maps.browser;\r\n    var events;\r\n    \r\n    this.registryDom(this._map, this._root);\r\n    this._layerMgr = this._map.layerMgr;\r\n\r\n    // Track history map by track ID\r\n    this._history = {};\r\n    \r\n    if (browser.isMobile) {\r\n      /**\r\n       * touchstart .   .\r\n       * @event olleh.maps.event.EventDelegator#event:touchstart\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * touchmove .     .\r\n       * @event olleh.maps.event.EventDelegator#event:touchmove\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * touchend .   .\r\n       * @event olleh.maps.event.EventDelegator#event:touchend\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * touchcancel .    .\r\n       * @event olleh.maps.event.EventDelegator#event:touchcancel\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      this._addEventsListener(document, ['touchstart', 'touchmove', 'touchend',\r\n        'touchcancel'], this, false);\r\n    } else {\r\n      if (browser.browserName === browser.BROWSER_NAME.ie) { // ie   \r\n        var hackDOM = document.createElement('div');\r\n        olleh.maps.util.dom.setStyles(hackDOM, {\r\n          position: 'absolute',\r\n          width: '100%',\r\n          height: '100%',\r\n          zIndex: 2\r\n        });\r\n        this._desktopIE = true;\r\n        this._hackDOM = hackDOM;\r\n        this._root.appendChild(hackDOM);\r\n      }\r\n      /**\r\n       * mousewheel .       .\r\n       * <p/> \r\n       * firefox DOMMouseScroll mousewheel .\r\n       * @event olleh.maps.event.EventDelegator#event:mousewheel\r\n       * @param {olleh.maps.event.Event} event\r\n       * @see http://www.w3.org/TR/2007/WD-DOM-Level-3-Events-20071221/events.html#event-mousewheel|w3c mousewheel\r\n       * @see https://developer.mozilla.org/en-US/docs/DOM/DOM_event_reference/DOMMouseScroll|DOMMouseScroll\r\n       */\r\n      /**\r\n       * mousedown .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mousedown\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mousemove .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mousemove\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mouseup .        .\r\n       * @event olleh.maps.event.EventDelegator#event:mouseup\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mouseover .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mouseover\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mouseout .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mouseout\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * click .        .\r\n       * @event olleh.maps.event.EventDelegator#event:click\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * rightclick .        .\r\n       * @event olleh.maps.event.EventDelegator#event:rightclick\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * dblclick .       .\r\n       * @event olleh.maps.event.EventDelegator#event:dblclick\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      this._mousewheel = (browser.browserName === browser.BROWSER_NAME.firefox)\r\n        ? 'DOMMouseScroll' : 'mousewheel';\r\n      this._addEventsListener(document, ['mousedown', 'mousemove', 'mouseup'], this, false);\r\n      \r\n      if (this._desktopIE) {\r\n        events = ['dragstart', 'contextmenu', this._mousewheel];\r\n      } else {\r\n        events = ['dragstart', 'selectstart', 'contextmenu', this._mousewheel, 'mouseout', 'mouseover'];\r\n      }\r\n      this._addEventsListener(this._root, events, this, false);\r\n    }\r\n    this._addEventsListener(window, ['resize'], this, false);\r\n    this._addEventsListener(this._root, ['click'], this, false);\r\n    this._started = true;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * <p/>\r\n   *   .   . map stop   .\r\n   * @private\r\n   */\r\n  stop: function () {\r\n    var browser = olleh.maps.browser;\r\n    var events;\r\n\r\n    this.unregistry(this._map);\r\n    this._history = null;\r\n    \r\n    if (browser.isMobile) {\r\n      this._removeEventsListener(document, ['touchstart', 'touchmove', \r\n        'touchend', 'touchcancel'], this, false);\r\n    } else {\r\n      this._removeEventsListener(document, ['mousedown', 'mouseup', 'mousemove'], this, false);\r\n      if (this._desktopIE) {\r\n        events = ['dragstart', 'contextmenu', this._mousewheel];\r\n      } else {\r\n        events = ['dragstart', 'selectstart', 'contextmenu', this._mousewheel, 'mouseout', 'mouseover'];\r\n      }\r\n      this._removeEventsListener(this._root, events, this, false);\r\n    }\r\n    this._removeEventsListener(window, ['resize'], this, false);\r\n    this._removeEventsListener(this._root, ['click'], this, false);\r\n    this._started = false;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * @returns {Boolean}\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n  \r\n\r\n  /**\r\n   * {@link olleh.maps.event.EventDelegator}  EventManager hashmap .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#registerEvent} .\r\n   * @param {olleh.maps.event.EventDelegator} delegator  EventDelegator \r\n   */\r\n  registry: function (delegator) {\r\n    var id = delegator.getId();\r\n    this._hitTargets[id] = delegator;\r\n  },\r\n  \r\n  /**\r\n   * DOM element data-id, style class ,\r\n   * {@link olleh.maps.event.EventDelegator}  EventManager hashmap .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#registerEventDom} .\r\n   * @param {olleh.maps.event.EventDelegator} delegator  EventDelegator \r\n   * @param {HTMLElement} elem    DOM element\r\n   */\r\n  registryDom: function (delegator, elem) {\r\n    if (!elem) return;\r\n    var id = delegator.getId();\r\n    elem.setAttribute('data-id', id);\r\n    olleh.maps.util.dom.addClass(elem, 'ollehmap-event');\r\n    this._hitTargets[id] = delegator;\r\n  },\r\n\r\n  /**\r\n   * DOM element data-id, style class .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#unregisterEventDom} .\r\n   * @param {HTMLElement} elem    DOM element\r\n   */\r\n  unregistryDom: function (elem) {\r\n    if (elem) {\r\n      elem.removeAttribute('data-id');\r\n      olleh.maps.util.dom.removeClass(elem, 'ollehmap-event');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.event.EventDelegator}  EventManager hashmap .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#unregisterEvent} .\r\n   * @param {olleh.maps.event.EventDelegator} delegator  EventDelegator \r\n   */\r\n  unregistry: function (delegator) {\r\n    this._hitTargets[delegator.getId()] = null;\r\n    delete this._hitTargets[delegator.getId()];\r\n  },\r\n\r\n  /**\r\n   * recognizer  .\r\n   * @example\r\n   * eventMgr.findRecognizer('olleh.maps.event.DoubleClickZoom');\r\n   * @param {String} classname recognizer \r\n   * @returns {olleh.maps.event.Recognizer} recognizer \r\n   */\r\n  findRecognizer: function (classname) {\r\n    return this._recognizers[classname];\r\n  },\r\n\r\n  /**\r\n   * event recognizer  .\r\n   * @example\r\n   * eventMgr.addRecognizer(new olleh.maps.event.DoubleClickZoom({dblrightclick: true}));\r\n   * @param {olleh.maps.event.Recognizer} recognizer \r\n   * @see olleh.maps.event.Recognizer\r\n   */\r\n  addRecognizer: function (recognizer) {\r\n    if (!recognizer || !recognizer.isMixinOf(olleh.maps.event.Recognizer)) \r\n      return;\r\n    this._recognizers[recognizer.$classname] = recognizer;\r\n  },\r\n\r\n  /**\r\n   *   recognizer  .\r\n   * @example\r\n   * eventMgr.removeRecognizer('olleh.maps.event.DoubleClickZoom');\r\n   * @param {String} classname recognizer \r\n   */\r\n  removeRecognizer: function (classname) {\r\n    this._recognizers[classname] = null;\r\n    delete this._recognizers[classname];\r\n  },\r\n  \r\n  /**\r\n   * UIEvent( )    .\r\n   * @param {Object} from   Object(window or DOM)\r\n   * @param {Array.<string>} names   \r\n   * @param {Function|Object} handler  , \r\n      <code>context</code>   <code>context#handleEvent</code>   .\r\n   * @param {Boolean} [capture=false] if true, handles event listeners \r\n   * on capture phase of DOM event propagation process.\r\n   * @private\r\n   */\r\n  _addEventsListener: function (from, names, handler, capture) {\r\n    var i = names.length;\r\n\r\n    if (from.addEventListener) {\r\n      capture = !!capture;\r\n      handler = handler || this;\r\n      while(i--) {\r\n        from.addEventListener(names[i], handler, capture);\r\n      }\r\n    } else if (from.attachEvent) {\r\n      if (handler === this || !handler) {\r\n        !this._ieHandler && (this._ieHandler = this.handleEvent.bind(this));\r\n        handler = this._ieHandler;\r\n      } \r\n      while(i--) {\r\n        from.attachEvent('on' + names[i], handler);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * UIEvent( )    .\r\n   * @param {Object} from   Object(window or DOM)\r\n   * @param {Array.<string>} names   \r\n   * @param {Function|Object} handler  , \r\n      <code>context</code>   <code>context#handleEvent</code>   .\r\n   * @param {Boolean} capture if true, handles event listeners \r\n   * on capture phase of DOM event propagation process.\r\n   * @private\r\n   */\r\n  _removeEventsListener: function (from, names, handler, capture) {\r\n    var i = names.length;\r\n\r\n    if (from.removeEventListener) {\r\n      capture = !!capture;\r\n      handler = handler || this;\r\n      while(i--) {\r\n        from.removeEventListener(names[i], handler, capture);\r\n      }\r\n    } else if (from.detachEvent) {\r\n      (handler === this || !handler) && (handler = this._ieHandler); \r\n      while(i--) {\r\n        from.detachEvent('on' + names[i], handler);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * <p/>\r\n   *   DOM         .\r\n   * @param {UIEvent} domEvent   \r\n   * @private\r\n   */\r\n  handleEvent: function (domEvent) {\r\n    if (!this.isStarted()) {\r\n      return;\r\n    }\r\n    var clazz = olleh.maps.event.EventManager;\r\n    var domTarget = domEvent.target = (domEvent.target || domEvent.srcElement);  // ie7,8 srcElement\r\n    \r\n    domEvent = domEvent || window.event;\r\n    this._prevDomEvent = this._domEvent;\r\n    this._domEvent = domEvent;\r\n    this._prevActiveElement = this._activeElement;\r\n    this._activeElement = document.activeElement;\r\n    \r\n    if (this._prevDomEvent === domEvent) { // ie  .    .\r\n      return;\r\n    }\r\n    switch (domEvent.type) {\r\n      case 'mousedown':\r\n        return this.domMousedownEvent(domEvent);\r\n      case 'mouseup':\r\n        return this.domMouseupEvent(domEvent);\r\n      case 'mousemove':\r\n        //clazz.preventDefault(domEvent);\r\n        return this.domMousemoveEvent(domEvent);\r\n      case 'click':\r\n        return this.domGenericEvent(domEvent);\r\n      case 'mouseover':\r\n        return this.domMouseoverEvent(domEvent);\r\n      case 'mouseout':\r\n        return this.domMouseoutEvent(domEvent);\r\n      case 'resize':\r\n        return this.domResizeEvent(domEvent, 'resize');\r\n      case 'selectstart':\r\n        if (domTarget.nodeType == 3 && domTarget.parentElement && \r\n            olleh.maps.util.dom.getStyle(domTarget.parentElement, 'userSelect') != 'none') { // webkit  cursor  \r\n          return;\r\n        }\r\n      case 'dragstart':\r\n        clazz.preventDefault(domEvent);\r\n        return;\r\n      case 'contextmenu':\r\n        return clazz.preventDefault(domEvent);\r\n      case 'keydown':\r\n      case 'keyup':\r\n      case 'keypress':\r\n        return this.domKeyboardEvent(domEvent);\r\n      case 'touchstart':\r\n      case 'touchmove':\r\n      case 'touchend':\r\n      case 'touchcancel':\r\n        return this.handleTouchEvent(domEvent);\r\n      case this._mousewheel:\r\n        return this.domGenericEvent(domEvent, 'mousewheel');\r\n      default:\r\n        return this.domGenericEvent(domEvent);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * mouseover DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domMouseoverEvent: function (domEvent, name) {\r\n    var hit = this.hitTarget(domEvent.target);\r\n    \r\n    if (!hit) {\r\n      return;\r\n    }\r\n    var relatedTarget = this.hitTarget(domEvent.relatedTarget);\r\n    \r\n    if (relatedTarget && hit.target === relatedTarget.target) return;\r\n    \r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM, relatedTarget: relatedTarget\r\n    });\r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * mouseout DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domMouseoutEvent: function (domEvent, name) {\r\n    var hit = this.hitTarget(domEvent.target);\r\n    if (!hit) {\r\n      return;\r\n    }\r\n    \r\n    var relatedTarget = this.hitTarget(domEvent.relatedTarget);\r\n    \r\n    if (relatedTarget && hit.target === relatedTarget.target) return;\r\n    \r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM, relatedTarget: relatedTarget\r\n    });\r\n    this.handleMapEvent(event);\r\n  },  \r\n  \r\n  /**\r\n   * DOM  resize orientationchange   map size  \r\n   * resize . \r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domResizeEvent: function (domEvent, name) {\r\n    var root = this._root;\r\n    var map = this._map;\r\n    var width = root.clientWidth || root.offsetWidth;\r\n    var height = root.clientHeight || root.offsetHeight;\r\n    var payload = {}; \r\n    \r\n    if (olleh.maps.browser.hasOrientationChange) {\r\n      payload.orientation = window.orientation;\r\n    } \r\n    payload.width = width;\r\n    payload.height = height;\r\n    \r\n    /**\r\n     *       . (:       .)\r\n     * <p/>\r\n     * <code>resize</code> target {@link olleh.maps.Map} .\r\n     *   payload  .\r\n     * @event olleh.maps.Map#event:resize\r\n     * @param {olleh.maps.event.Event} event\r\n     * @param {Object} payload\r\n     * @param {Number} payload.width map viewport width\r\n     * @param {Number} payload.height map viewport height\r\n     * @param {Number} [payload.orientation]    window.orientation  \r\n     */\r\n    var event = new olleh.maps.event.Event(name, map, {originEvent: domEvent, \r\n      targetDOM: root});\r\n    map.fireEvent(event, payload);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domMousedownEvent: function (domEvent, name) {\r\n    if (this._desktopIE && this._hackDOM) { // desktop ie browser bug fix\r\n      this._root.removeChild(this._hackDOM);\r\n      this._hackDOM = null;\r\n      delete this._hackDOM;\r\n   }\r\n    var doc = document;\r\n    var event;\r\n    var hit = this.hitTarget(domEvent.target);\r\n\r\n    if (!hit) {\r\n      this._clicked = false;\r\n      this._removeEventsListener(doc, ['keyup','keydown','keypress'], this, false);\r\n      return;\r\n    }\r\n    this._clicked = true;\r\n    \r\n    // Text selection \r\n    if (window.getSelection) {\r\n      if (window.getSelection().empty) {  // Chrome\r\n        window.getSelection().empty();\r\n      } else if (window.getSelection().removeAllRanges) {  // Firefox\r\n        window.getSelection().removeAllRanges();\r\n      }\r\n    } else if (document.selection) {  // IE\r\n      document.selection.empty();\r\n    }\r\n\r\n    if (this._desktopIE) { // desktop ie browser address bar focus bug fix\r\n      if (olleh.maps.event.EventManager.checkEnabledKeyevent()) {\r\n        window.focus();\r\n      } else {\r\n        if (this._prevActiveElement && \r\n            this._prevActiveElement !== domEvent.target && \r\n            !olleh.maps.event.EventManager.checkEnabledKeyevent(this._prevActiveElement)) {\r\n          this._prevActiveElement.blur();\r\n        }\r\n      }\r\n    } \r\n    /**\r\n     * keydown .      .\r\n     * @event olleh.maps.event.EventDelegator#event:keydown\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    /**\r\n     * keypress .       .\r\n     * @event olleh.maps.event.EventDelegator#event:keypress\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    /**\r\n     * keyup .      .\r\n     * @event olleh.maps.event.EventDelegator#event:keyup\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this._addEventsListener(doc, ['keyup','keydown','keypress'], this, false);\r\n\r\n    event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    \r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domMouseupEvent: function (domEvent, name) {\r\n    var doc = document;\r\n    var hit = this.hitTarget(domEvent.target);\r\n    if (!hit) {\r\n      this._removeEventsListener(doc, ['keyup','keydown','keypress'], this, false);\r\n      hit = this.hitTarget(this._root);\r\n    }\r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domMousemoveEvent: function (domEvent, name) {\r\n    if (this._desktopIE && this._hackDOM) { // desktop ie browser bug fix\r\n      this._root.removeChild(this._hackDOM);\r\n      this._hackDOM = null;\r\n      delete this._hackDOM;\r\n   }\r\n    var hit = this.hitTarget(domEvent.target) || this.hitTarget(this._root);\r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    this.handleMapEvent(event);\r\n    \r\n    if (this._desktopIE) { // IE   mouseout, mouseover   .\r\n      var prevEvent = this._prevEvent;\r\n      this._prevEvent = event;\r\n      if (prevEvent && prevEvent.getSource() !== hit.target) {\r\n        event = new olleh.maps.event.Event('mouseout', prevEvent.getSource(), {\r\n          originEvent: prevEvent.originEvent, targetDOM: prevEvent.targetDOM, relatedTarget: prevEvent.getSource()\r\n        });\r\n        this.handleMapEvent(event);\r\n      } \r\n      if (!prevEvent || prevEvent.getSource() !== hit.target) {\r\n        domEvent.relatedTarget = prevEvent ? prevEvent.targetDOM : null;\r\n        event = new olleh.maps.event.Event('mouseover', hit.target, {\r\n          originEvent: domEvent, targetDOM: hit.targetDOM, relatedTarget: prevEvent ? prevEvent.getSource() : null\r\n        });\r\n        this.handleMapEvent(event);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domKeyboardEvent: function (domEvent) {\r\n    var hit = {target: this._layerMgr, targetDOM: document};\r\n    var event = new olleh.maps.event.Event(domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM});\r\n   \r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   *  DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domGenericEvent: function (domEvent, name) {\r\n    var hit = this.hitTarget(domEvent.target);\r\n    if (!hit) {\r\n      return;\r\n    }\r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent  event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  handleTouchEvent: function (domEvent, name) {\r\n    var type = domEvent.type;\r\n    var target = domEvent.target;\r\n    var touch = domEvent.changedTouches[0];\r\n    var prevDomEvent = this._prevDomEvent;\r\n    var browser = olleh.maps.browser;\r\n    var hit = this.hitTarget(target);\r\n\r\n    if (type === 'touchstart') {\r\n      this._mousedown = !!hit;\r\n      if (!this._mousedown) {\r\n        return; \r\n      }\r\n      //  input, selectbox, textarea  focus   touchstart  blur  .(#1286) \r\n      if (this._prevActiveElement && \r\n          this._prevActiveElement !== domEvent.target && \r\n          !olleh.maps.event.EventManager.checkEnabledKeyevent(this._prevActiveElement)) {\r\n        this._prevActiveElement.blur();\r\n      }\r\n    } else if (!this._mousedown){\r\n      return;\r\n    }\r\n\r\n    // android      - os bug fix\r\n    if (browser.hotfixAndroid) {\r\n      // android longpress bug fix(touch-callout)\r\n      if (type === 'touchstart' && domEvent.touches.length == 1) {\r\n        olleh.maps.event.EventManager.preventDefault(domEvent);\r\n      } else if (prevDomEvent.type === 'touchstart' && type === 'touchend' && \r\n          prevDomEvent.touches.length == 1 && !domEvent.touches.length && \r\n          domEvent.timeStamp - prevDomEvent.timeStamp < 750) { // touchstart  preventDefault  click     \r\n          olleh.maps.util.defer(this.handleMapEvent, this, new olleh.maps.event.Event('click', hit.target, {\r\n            targetDOM: hit.targetDOM,\r\n            pageXY: new olleh.maps.Point(touch.pageX, touch.pageY),\r\n            originEvent: domEvent \r\n          }));\r\n      }\r\n    } else if (browser.osName === browser.OS_NAME.ios &&\r\n        prevDomEvent && prevDomEvent.type === 'touchend' && type === 'touchstart' && \r\n        !prevDomEvent.touches.length && prevDomEvent.changedTouches[0].identifier === touch.identifier) {\r\n      // ios browser alert & confirm touchstart bug fix\r\n      olleh.maps.event.EventManager.preventDefault(domEvent);\r\n      this.handleMapEvent(new olleh.maps.event.Event('touchcancel', hit.target));\r\n      return;\r\n    }\r\n    \r\n    this.handleMapEvent(new olleh.maps.event.Event(name || type, hit.target, {\r\n      targetDOM: hit.targetDOM,\r\n      pageXY: new olleh.maps.Point(touch.pageX, touch.pageY),\r\n      originEvent: domEvent, \r\n      touch: touch, \r\n      touches: domEvent.touches, \r\n      targetTouches: domEvent.targetTouches,\r\n      changedTouches: domEvent.changedTouches\r\n    }));\r\n  },\r\n  \r\n  /**\r\n   *   enable/disable. <p/>\r\n   *         \r\n   *        .   \r\n   * .\r\n   * @param {Boolean} value <code>false</code> event handling .\r\n   */\r\n  setEnable: function (value) {\r\n    this._opts.enabled = !!value;\r\n  },\r\n  \r\n  /**\r\n   * DOM Tree  {@link olleh.maps.event.EventDelegator}    .\r\n   * <p/>\r\n   *    <code>null</code> .\r\n   * ie  pointer-events      .\r\n   *  <code>document.elementFromPoint</code> .\r\n   * @param {HTMLElement} elem hit   DOM Element \r\n   * @returns {{target: olleh.maps.event.EventDelegator, targetDOM: HTMLElement}}\r\n   */\r\n  hitTarget: function (elem) {\r\n    var body = document.body;\r\n    var domEvent = this._domEvent;\r\n    var noPointerEvents = !olleh.maps.browser.hasPointerEvents;\r\n    var hasClass = olleh.maps.util.dom.hasClass;\r\n    var dom, parent, id, noevent, noevents = [], x, y, target, returnVal;\r\n    var layerMgrElem = this._layerMgr._root_pane;\r\n    \r\n    if (!domEvent.target) return null;\r\n\r\n    while (elem && elem !== window && elem !== body) {\r\n      if (olleh.maps.isElement(elem)) {\r\n        // pointer-events     \r\n        if (noPointerEvents && hasClass(elem, 'ollehmap-noevent')) {\r\n          elem = this._findAncestorNoEventDom(elem);\r\n          parent = elem.parentElement || elem.parentNode;\r\n\r\n          if (parent === layerMgrElem) {\r\n            returnVal = {target: this._layerMgr, targetDOM: layerMgrElem};\r\n            break;\r\n          }\r\n          \r\n          if (noevents.length == 0) {\r\n            x = domEvent.clientX; \r\n            y = domEvent.clientY;\r\n          }\r\n          noevents.push(elem);\r\n          elem.style.visibility = 'hidden';\r\n          elem = document.elementFromPoint(x, y);\r\n          \r\n          if (elem && (elem.nodeType === 3 || elem.tagName === 'svg')) { // Opera\r\n            elem = elem.parentNode;\r\n          }\r\n          if (!elem) {\r\n            returnVal = {target: this._layerMgr, targetDOM: layerMgrElem};\r\n            break;\r\n          }\r\n        }\r\n        \r\n        id = elem.getAttribute('data-id');\r\n        if (id) {\r\n          dom = elem;\r\n          break;\r\n        }\r\n      } \r\n      elem = elem.parentElement || elem.parentNode;\r\n    }\r\n    if (noPointerEvents) {\r\n      while(noevent = noevents.pop()) {\r\n        noevent.style.visibility = '';\r\n      }\r\n    }\r\n    \r\n    if (returnVal) {\r\n      return returnVal;\r\n    } else if (dom && id && (target = this._hitTargets[id])) {\r\n      !('textContent' in dom) && dom.innerText && (dom.textContent = dom.innerText); // ie7,8 innerText\r\n      return {target: target, targetDOM: dom}; \r\n    }\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   *  <code>elem</code> ollehmap-noevent css class  DOM Element .\r\n   * @private\r\n   */\r\n  _findAncestorNoEventDom: function (elem) {\r\n    var hasClass = olleh.maps.util.dom.hasClass;\r\n    var noevent = elem;\r\n\r\n    while((elem = elem.parentElement || elem.parentNode) && hasClass(elem, 'ollehmap-noevent')) {\r\n      noevent = elem;\r\n    }\r\n    return noevent;\r\n  },\r\n  \r\n  /**\r\n   *     {@link olleh.maps.event.Event}  \r\n   *   {@link olleh.maps.event.Recognizer}     \r\n   *    hit target  . \r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} [payload]\r\n   * @param {Number} [delay]\r\n   * @private\r\n   */\r\n  handleMapEvent: function (event, payload) {\r\n    var resultSrc, recognizeredEvent, resultEvent; \r\n    var hit = event.getSource();\r\n    var targetDOM = event.targetDOM;\r\n    \r\n    if (!hit) return;\r\n    \r\n    var mixin = olleh.maps.mixin;\r\n    for(var key in this._recognizers){\r\n      resultEvent = this._recognizers[key].handle(event);\r\n      if (resultEvent) {\r\n        resultSrc = resultEvent.src || hit;\r\n        recognizeredEvent = new olleh.maps.event.Event(resultEvent.name, resultSrc, \r\n            mixin({targetDOM: targetDOM}, resultEvent.opts, true));\r\n        resultSrc.fireEvent(recognizeredEvent, resultEvent.payload);\r\n      }\r\n    }\r\n    \r\n    if (!event._stopPropagation) {\r\n      hit.fireEvent(event, payload);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * <p/>\r\n   *     <code>false</code> .\r\n   * \r\n   * @returns {Boolean}\r\n   */\r\n  isMapClicked: function () {\r\n    return this._clicked;\r\n  }\r\n});\r\n/**\r\n *          .\r\n * <p/>\r\n *      mixin      .\r\n\r\n * <h3>KT   recognizer</h3>\r\n * <h5>  recognizer</h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.Drag}</li>\r\n * </ul>\r\n * <h5>   recognizer</h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.DoubleClickZoom}</li>\r\n *   <li>{@link olleh.maps.event.ScrollWheelZoom}</li>\r\n *   <li>{@link olleh.maps.event.KeyboardZoom}</li>\r\n * </ul>\r\n * <h5>   recognizer</h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.Pinch}</li>\r\n *   <li>{@link olleh.maps.event.DoubleTapZoom}</li>\r\n * </ul>\r\n * \r\n * <h3>custom recognizer </h3>\r\n *   {@link olleh.maps.event.EventManager} {@link olleh.maps.event.Event}   \r\n *       {@link olleh.maps.event.Event}      {@link olleh.maps.event.EventManager} .\r\n * <p/>\r\n * Recognizer    <code>function</code>      .\r\n *            .\r\n * <p/>\r\n *    .\r\n * <dl>\r\n *   <dt>name</dt><dd> </dd>\r\n *   <dt>src</dt><dd>   </dd>\r\n *   <dt>payload</dt><dd>olleh.maps.Event  </dd>\r\n * </dl>\r\n * @example\r\n * // custom recognizer\r\n * $class('foo').mixin(olleh.maps.event.Recognizer).define({\r\n *   mousedown: function (event) {\r\n *     olleh.maps.log(event.timStamp);\r\n *   }),\r\n *   \r\n *   click: function (event) {\r\n *     if (true) {\r\n *       return {\r\n           name: 'fooClick' // \r\n           payload: { // olleh.maps.event.Event \r\n             originEvent: event.originEvent, \r\n             pageXY: event.pageXY\r\n           }\r\n        }\r\n *     }\r\n *   }\r\n *   ...\r\n * };\r\n * @summary     (drag, pinch )      .\r\n */\r\n$class('olleh.maps.event.Recognizer').define({\r\n  /**\r\n   * event     .\r\n   * @param {olleh.maps.event.Event} event ollehmap event \r\n   * @private\r\n   */\r\n  handle: function (event) {\r\n    if (!!this._disabled || event._stopPropagation) return;\r\n    var func = this[event.getName()];\r\n    return func && func.call(this, event);\r\n  },\r\n\r\n  /**\r\n   * Recognizer  .\r\n   * <p/>\r\n   * <code>false</code>     .\r\n   * @param {Boolean} enabled Recognizer  \r\n   */\r\n  setEnabled: function (enabled) {\r\n    this._disabled = !enabled;\r\n  },\r\n\r\n  /**\r\n   * Recognizer   .\r\n   * @returns {Boolean}\r\n   */\r\n  isEnabled: function () {\r\n    return !this._disabled;\r\n  }\r\n});/**\r\n *        mixin  ,    .\r\n * <p/>\r\n *        mixin  (, )       \r\n *   . \r\n * <h3>event handler </h3>\r\n *   {@link olleh.maps.event.Event}        .\r\n * <p/>\r\n * <dl>\r\n *   <dt>$capture_</dt><dd>{@link olleh.maps.event.Event.CAPTURING_PHASE}    </dd>\r\n *   <dt>$current_</dt><dd>{@link olleh.maps.event.Event.AT_TARGET}, {@link olleh.maps.event.Event.BUBBLING_PHASE}    </dd>\r\n *   <dt>$default_</dt><dd></dd>{@link olleh.maps.event.EventDelegator#onEvent} <code>capture</code> <code>false</code>        </dd>\r\n * </dl>\r\n * @example\r\n * $class('olleh.maps.handler.Desktop').define({\r\n * \r\n *   $capture_mousedown: function (event, payload) {\r\n *     olleh.maps.log.info(event.getName()); // mousedown\r\n *   },\r\n *\r\n *   $current_click: function (event, payload) {\r\n *     olleh.maps.log.info(event.getName()); // click\r\n *   },\r\n *\r\n *   $default_mousewheel: function (event, payload) {\r\n *     olleh.maps.log.info(event.timeStamp);\r\n *   }\r\n * });\r\n */\r\nolleh.maps.namespace('olleh.maps.event.handler', {\r\n  \r\n  // TODO FIXME Handler Class     member  delegator  copy     filter \r\n  _EXCLUDES: {$constructor: true, constructor: true, getClass: true, isMixinOf: true, currentStack : true, $classname: true},  \r\n\r\n  /**\r\n   *   <code>$capture_</code>, <code>$current_</code>, <code>$default_</code> \r\n   * {@link olleh.maps.event.EventDelegator} instance attach, class attach.\r\n   * <p/>\r\n   * <code>instance</code> attach   <code>instance</code> {@link olleh.maps.event.handler.detach}.\r\n   * \r\n   * <code>class</code> attach   <code>class</code> {@link olleh.maps.event.handler.detach}. \r\n   * @example\r\n   * olleh.maps.event.handler.attach(olleh.maps.Map, olleh.maps.event.handler.Drag);\r\n   * @example\r\n   * var map = new olleh.maps.Map(div, opts);\r\n   * olleh.maps.event.handler.attach(map, olleh.maps.event.handler.Drag);\r\n   * @param {olleh.maps.event.EventDelegator | class} delegator   delegator class\r\n   * @param {class} handlerClass\r\n   *   capture phase {@link olleh.maps.event.EventDeleagtor#onEvent}     \r\n   *     <code>$capture_</code> .\r\n   *   target, bubbling phase {@link olleh.maps.event.EventDeleagtor#onEvent}     \r\n   *     <code>$current_</code> .\r\n   *   target, bubbling phase {@link olleh.maps.event.EventDeleagtor#onEvent}     \r\n   *     <code>$default_</code> .\r\n   * @see olleh.maps.event.handler.detach\r\n   */\r\n  attach: function (delegator, handlerClass) {\r\n    if ( !delegator.isMixinOf || !delegator.isMixinOf(olleh.maps.event.EventDelegator)) {\r\n      delegator = delegator.prototype;\r\n    }\r\n    handlerClass = handlerClass.prototype;\r\n    \r\n    var backup = delegator['$eventHandler'] || {};\r\n    var fnName, originHandleFn;\r\n    var Event = olleh.maps.event.Event;\r\n    var events = delegator.$EVENTS;\r\n\r\n    for(fnName in handlerClass) {\r\n      if(this._EXCLUDES[fnName])\r\n        continue;\r\n      if(originHandleFn = delegator[fnName])\r\n        backup[fnName] = originHandleFn;\r\n      delegator[fnName] =  handlerClass[fnName];\r\n      \r\n      if (fnName.indexOf('$') != 0) {\r\n        continue;\r\n      }\r\n      var eventName = null;\r\n      if (fnName.indexOf('capture_') == 1) {\r\n        eventName = fnName.substring(9);\r\n        events[eventName] = events[eventName] | Event.CAPTURING_PHASE;\r\n      } else if (fnName.indexOf('current_') == 1) {\r\n        eventName = fnName.substring(9);\r\n        events[eventName] = events[eventName] | Event.AT_TARGET;\r\n      } else if (fnName.indexOf('default_') == 1) {\r\n        eventName = fnName.substring(9);\r\n        events[eventName] = events[eventName] | Event.DEFAULT_PHASE;\r\n      }\r\n    }\r\n    delegator['$eventHandler'] = backup;\r\n  },\r\n  \r\n  /**\r\n   *   <code>$capture_</code>, <code>$current_</code>, <code>$default_</code> \r\n   * {@link olleh.maps.event.EventDelegator} instance detach, class detach.\r\n   * <p/>\r\n   * <code>instance</code> attach   <code>instance</code> {@link olleh.maps.event.handler.detach}.\r\n   * \r\n   * <code>class</code> attach   <code>class</code> {@link olleh.maps.event.handler.detach}. \r\n   * @example\r\n   * olleh.maps.event.handler.detach(olleh.maps.Map, olleh.maps.event.handler.Drag);\r\n   * @param {olleh.maps.event.EventDelegator | class} delegator   delegator class\r\n   * @param {class} handlerClass\r\n   * @see olleh.maps.event.handler.attach\r\n   */\r\n  detach: function (delegator, handlerClass) {\r\n    if ( !delegator.isMixinOf || !delegator.isMixinOf(olleh.maps.event.EventDelegator)) {\r\n      delegator = delegator.prototype;\r\n    }\r\n    handlerClass = handlerClass.prototype;\r\n    \r\n    var backup = delegator['$eventHandler'];\r\n    \r\n    for(var fnName in handlerClass) {\r\n      if(this._EXCLUDES[fnName])\r\n        continue;\r\n      if(backup && backup[fnName]) {\r\n        delegator[fnName] = backup[fnName];\r\n        delete backup[fnName];\r\n      } else {\r\n        delete delegator[fnName];\r\n      }\r\n    }\r\n  }\r\n});\r\n/**\n * Map  corner DOM  \n */\n$class('olleh.maps.control.Corner').define({\n  \n  /**\n   * ,  Corner  .\n   * @param {String} position <p/>  :\n   *        <ul>\n   *        <li>{@link olleh.maps.control.Control.BOTTOM_LEFT}</li>\n   *        <li>{@link olleh.maps.control.Control.TOP_LEFT}</li>\n   *        <li>{@link olleh.maps.control.Control.BOTTOM_RIGHT}</li>\n   *        <li>{@link olleh.maps.control.Control.TOP_RIGHT}</li>\n   *        </ul>\n   */\n  Corner: function (position) {\n    var elem = olleh.maps.Element.create('div');\n\n    this.elem = elem;\n    this.ctrls = [];\n    this.vAlign = position.indexOf('top') !== -1 ? 'top' : 'bottom';\n\n    if (position.indexOf('left') !== -1) {\n      this.hAlign = 'left';\n      this.horizontalArea = this._createInnerDom();\n      this.verticalArea = this._createInnerDom();\n    } else {\n      this.hAlign = 'right';\n      this.verticalArea = this._createInnerDom();\n      this.horizontalArea = this._createInnerDom();\n      elem.elem.setAttribute('align', this.hAlign);\n    }\n    elem.addClass('ollehmap-corner');\n    elem.addClass('ollehmap-noevent');\n    elem.setStyle(this.vAlign, '0px');\n    elem.setStyle(this.hAlign, '0px');\n  },\n\n  /**\n   *  corner   inner dom .\n   * @private\n   */\n  _createInnerDom: function () {\n    var elem = olleh.maps.Element.create('div');\n\n    elem.addClass('ollehmap-corner-area');\n    elem.setStyle('verticalAlign', this.vAlign);\n    this.elem.pushElement(elem);\n    return elem;\n  }\n});\n/**\r\n * control position direction      .\r\n */\r\n$class('olleh.maps.control.ControlManager').define({\r\n\r\n  /**\r\n   * ,  ControlManager  .\r\n   * @param {olleh.maps.Map} map\r\n   */\r\n  ControlManager: function (map) {\r\n    this._ctrls = [];\r\n    this._corners = [];\r\n    this.map = map;\r\n    this._defaultMargin = 5;\r\n\r\n    var corners = this._corners;\r\n    var cornerClass = olleh.maps.control.Corner;\r\n    var ctrlClass = olleh.maps.control.Control;\r\n    var positions = [ ctrlClass.TOP_LEFT, ctrlClass.TOP_RIGHT, ctrlClass.BOTTOM_LEFT, ctrlClass.BOTTOM_RIGHT ];\r\n    var key, corner;\r\n    var i = positions.length;\r\n    var fragment = document.createDocumentFragment();\r\n\r\n    while (i--) {\r\n      key = positions[i];\r\n      corner = new cornerClass(key);\r\n      corners[key] = corner;\r\n      fragment.appendChild(corner.elem.elem);\r\n    }\r\n    map.elem.appendChild(fragment);\r\n  },\r\n\r\n  /**\r\n   * ControlManager   control draw()  .\r\n   */\r\n  start: function () {\r\n    this._started = true;\r\n    var len = this._ctrls.length;\r\n    this._opts = olleh.maps.util.clone(this.map.getOptions());\r\n    for ( var i = 0; i < len; i++) {\r\n      this.draw(this._ctrls[i]);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.control.Control} ctrl\r\n   * @returns {String} className\r\n   */\r\n  _getCtrlClassName: function (ctrl) {\r\n    var cn = ctrl.$classname;\r\n    cn = cn.substring(cn.lastIndexOf('.') + 1);\r\n    cn = cn.charAt(0).toLowerCase() + cn.substr(1);\r\n\r\n    return cn;\r\n  },\r\n\r\n  /**\r\n   * @returns {Boolean}\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @param {olleh.maps.control.Control} ctrl  \r\n   */\r\n  add: function (ctrl) {\r\n    this._ctrls.push(ctrl);\r\n    ctrl.mgr = this;\r\n    if (this.isStarted()) {\r\n      this.draw(ctrl);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.control.Control} ctrl\r\n   */\r\n  draw: function (ctrl) {\r\n    // map option    false     .\r\n    var opts = this._opts;\r\n    var cn = this._getCtrlClassName(ctrl);\r\n    var option = opts[cn + 'Options'];\r\n    ctrl.start();\r\n    option && olleh.maps.mixin(ctrl, option, true);\r\n\r\n    ctrl.elem = ctrl.draw();\r\n    ctrl.setDrawn(true);\r\n    this._updatePosition(ctrl);\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.control.Control} ctrl\r\n   * @private\r\n   */\r\n  _updatePosition: function (ctrl) {\r\n    var corner = this._corners[ctrl.position];\r\n    var direction = ctrl.direction;\r\n    var cornerDOM = corner[direction + 'Area'].elem;\r\n    var container = olleh.maps.Element.create('div');\r\n    var containerDOM = container.elem;\r\n\r\n    corner.ctrls.push(ctrl);\r\n    container.addClass('ollehmap-corner-container');\r\n    container.pushElement(ctrl.elem.elem);\r\n    if (direction === 'vertical') {\r\n      if (corner.vAlign === 'bottom')\r\n        cornerDOM.insertBefore(containerDOM, cornerDOM.firstChild);\r\n      else\r\n        cornerDOM.appendChild(containerDOM);\r\n    } else {\r\n      container.setStyle('verticalAlign', corner.vAlign);\r\n      container.addClass('olleh-maps-inline');\r\n\r\n      if (corner.hAlign === 'left')\r\n        cornerDOM.appendChild(containerDOM);\r\n      else\r\n        cornerDOM.insertBefore(containerDOM, cornerDOM.firstChild);\r\n    }\r\n    if (corner.hAlign === 'right') {\r\n      container.addClass('ollehmap-control-rightAlign');\r\n      ctrl.elem.elem.setAttribute('align', 'left');\r\n    }\r\n    ctrl.left && container.setStyle('paddingLeft', ctrl.left + 'px');\r\n    ctrl.right && container.setStyle('paddingRight', ctrl.right + 'px');\r\n    ctrl.top && container.setStyle('paddingTop', ctrl.top + 'px');\r\n    ctrl.bottom && container.setStyle('paddingBottom', ctrl.bottom + 'px');\r\n    ctrl._containerDOM = container;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.control.Control} ctrl  \r\n   */\r\n  remove: function (ctrl) {\r\n    var ctrls = this._ctrls;\r\n    olleh.maps.util.removeFromArray(ctrls, ctrl);\r\n    ctrls = this._corners[ctrl.position].ctrls;\r\n    olleh.maps.util.removeFromArray(ctrls, ctrl);\r\n\r\n    if (this.isStarted()) {\r\n      ctrl.destroy();\r\n      ctrl._containerDOM && olleh.maps.util.dom.removeElements(ctrl._containerDOM.elem);\r\n    }\r\n    ctrl = null;\r\n  },\r\n\r\n  /**\r\n   *  class     .\r\n   * @param {String} cls class\r\n   */\r\n  removeByClass: function (cls) {\r\n    var ctrls = this._ctrls;\r\n    var i = ctrls.length;\r\n    while (i--) {\r\n      var ctrl = ctrls[i];\r\n      if (ctrl instanceof cls) {\r\n        ctrl.setMap(null);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  class     . TODO service id     \r\n   * @param {String} cls class\r\n   * @returns {olleh.maps.control.Control}\r\n   */\r\n  findByClass: function (cls) {\r\n    var ctrls = this._ctrls;\r\n    var i = ctrls.length;\r\n    while (i--) {\r\n      var ctrl = ctrls[i];\r\n      if (ctrl instanceof cls) {\r\n        return ctrl;\r\n      }\r\n    }\r\n  },\r\n\r\n  stop: function () {\r\n    var i = this._ctrls.length;\r\n    while (i--) {\r\n      this._ctrls[i].stop();\r\n    }\r\n    this._started = false;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  removeAll: function () {\r\n    var ctrl, ctrls = this._ctrls;\r\n\r\n    while (ctrl = ctrls.pop()) {\r\n      ctrl.setMap(null);\r\n    }\r\n  }\r\n});/**\r\n * ControlOptions Object Specification\r\n * @typedef olleh.maps.control.ControlOptions\r\n * @property {String} [direction]   . <p/> :\r\n *           <ul>\r\n *           <li>{@link olleh.maps.control.Control.HORIZONTAL}</li>\r\n *           <li>{@link olleh.maps.control.Control.VERTICAL}</li>\r\n *           </ul>\r\n * @property {String} [position]  . <p/> :\r\n *           <ul>\r\n *           <li>{@link olleh.maps.control.Control.BOTTOM_LEFT}</li>\r\n *           <li>{@link olleh.maps.control.Control.TOP_LEFT}</li>\r\n *           <li>{@link olleh.maps.control.Control.BOTTOM_RIGHT}</li>\r\n *           <li>{@link olleh.maps.control.Control.TOP_RIGHT}</li>\r\n *           </ul>\r\n * @property {Number} [right] control     px\r\n * @property {Number} [left] control     px\r\n * @property {Number} [top] control     px\r\n * @property {Number} [bottom] control     px\r\n */\r\n\r\n/**\r\n *          .\r\n * TODO: olleh.maps.Initializable \r\n */\r\n$class('olleh.maps.control.Control').mixin(olleh.maps.event.EventDelegator, olleh.maps.Adaptable).define({\r\n\r\n  $static: {\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    BOTTOM_LEFT: 'bottom_left',\r\n\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    BOTTOM_RIGHT: 'bottom_right',\r\n\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    TOP_LEFT: 'top_left',\r\n\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    TOP_RIGHT: 'top_right',\r\n\r\n    /**\r\n     *    direction \r\n     * @type String\r\n     */\r\n    HORIZONTAL: 'horizontal',\r\n\r\n    /**\r\n     *    direction \r\n     * @type String\r\n     */\r\n    VERTICAL: 'vertical',\r\n\r\n    /**\r\n     * @constant\r\n     * @type String\r\n     */\r\n    //IMG_URL: '../../resources/img/controls.png'\r\n    IMG_URL: olleh.maps.env.RESOURCE_URL + 'img/controls.png'\r\n  },\r\n\r\n  /**\r\n   * ,  Control  .\r\n   * @param {Object} [opts]  \r\n   */\r\n  Control: function (opts) {\r\n    this.mgr;\r\n    this.elem = null;\r\n    this.padding = 5;\r\n    this._isDrawn = false;\r\n    this._opts = opts;\r\n  },\r\n\r\n  /**\r\n   *  start .\r\n   */\r\n  start: function () {\r\n    this._started = true;\r\n    this.initOptions();\r\n  },\r\n\r\n  /**\r\n   *  option  .\r\n   * @private\r\n   */\r\n  initOptions: function () {\r\n    olleh.maps.mixin(this, this._opts, true);\r\n  },\r\n\r\n  /**\r\n   *  stop .\r\n   */\r\n  stop: function () {\r\n    this._started = false;\r\n  },\r\n\r\n  /**\r\n   *  start    .\r\n   * @returns {Boolean}\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n\r\n  /**\r\n   *   .     .\r\n   * @param {String} position  \r\n   */\r\n  setPosition: function (position) {\r\n    this.position = position;\r\n    if (this.isStarted()) {// isStarted ??\r\n      this.mgr.remove(this);\r\n      this.mgr.add(this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    .     .\r\n   * @param {String} direction  \r\n   */\r\n  setDirection: function (direction) {\r\n    this.direction = direction;\r\n    if (this.isStarted()) {// isStarted ??\r\n      this.mgr.remove(this);\r\n      this.mgr.add(this);\r\n    }\r\n  },\r\n\r\n  attach: function () {\r\n    this.mgr = this.map.controlMgr;\r\n    this.mgr.add(this);\r\n  },\r\n\r\n  detach: function () {\r\n    this.mgr.remove(this);\r\n  },\r\n\r\n  /**\r\n   * Control       .  ,  {@link #draw}    \r\n   * true    ,  {@link #draw}   {@link #destroy}   \r\n   * false .\r\n   * @returns {Boolean} isDrawn\r\n   */\r\n  isDrawn: function () {\r\n    return this._isDrawn;\r\n  },\r\n\r\n  setDrawn: function (isDrawn) {\r\n    this._isDrawn = isDrawn;\r\n  },\r\n\r\n  /**\r\n   *  .   element  . \r\n   * {@link olleh.maps.event.EventDelegator#registerEventDom}    \r\n   * element   .\r\n   * @returns {olleh.maps.Element}  element\r\n   */\r\n  draw: function () {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.control.Control#draw}    .   \r\n   * element  pane     . \r\n   * {@link olleh.maps.event.EventDelegator#unregisterEvent}     .\r\n   *\r\n   * TODO: destroy -> erase:       erase   \r\n   * @private\r\n   */\r\n  destroy: function () {\r\n    this.unregisterEvent();\r\n    this.mgr = null;\r\n    if (this.elem) {\r\n      olleh.maps.util.dom.removeElements(this.elem.elem);\r\n      this.elem = null;\r\n    }\r\n    this._isDrawn = false;\r\n  },\r\n\r\n  /**\r\n   * Control  bubble target  Map.\r\n   * @returns {olleh.maps.Map}\r\n   * @see olleh.maps.event.EventDelegator#getBubble\r\n   */\r\n  getBubble: function () {\r\n    return this.mgr.map;\r\n  }\r\n});\r\n/**\r\n * @typedef olleh.maps.layer.LayerOptions\r\n * @property {String} [name] Layer \r\n * @property {olleh.maps.Map} [map] Layer    \r\n * @property {String} [layerType=base] Layer .\r\n *        <p>:\r\n *        <ul><li>\"base\"  base layer  . </li><li>\"ground\"  ground layer  .</li></ul>\r\n * @property {Number} [zIndex=0] ground layer     index. \r\n *     0   zIndex   layer    .\r\n * @property {String} [label]   \r\n * @property {String} [group] PluginControl   group \r\n * @property {Boolean} [autoActivate] ground layer   true    activate   .\r\n * @property {string} [copyright] CopyrightControl    . Layer  base   .\r\n */\r\n\r\n/**\r\n * Layer      . <p/>\r\n *    option  layer    .\r\n * @example\r\n * new MyLayer({\r\n *  map: map,\r\n *  layerType: 'base' | 'ground',\r\n *  zIndex: 0,\r\n *  name: 'OllehMap',\r\n *  label: '',\r\n *  group: 'PluginGroup1'\r\n * });\r\n * <p/>\r\n *   Layer    layer    .\r\n * @example\r\n *  $class('MyLayer').extend(olleh.maps.layer.Layer).define({\r\n *    MyLayer: function() {\r\n *     this.layerType = 'base';\r\n *     this.zIndex = 0;\r\n *     this.name = 'OllehMap';\r\n *     this.label = '';\r\n *     this.group = 'PluginGroup1';\r\n *    }\r\n *  \r\n */\r\n$class('olleh.maps.layer.Layer').extend(olleh.maps.Initializable).mixin(olleh.maps.event.EventDelegator, olleh.maps.Plugin)\r\n    .define({\r\n      \r\n      /**\r\n       * Layer      \r\n       * @name event:added\r\n       * @event\r\n       * @memberOf olleh.maps.layer.Layer.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * Layer      \r\n       * @name event:removed\r\n       * @event\r\n       * @memberOf olleh.maps.layer.Layer.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      \r\n      /**\r\n       * Layer . LayerManager#getLayer()   layer    .\r\n       * @type String\r\n       */\r\n      name: 'Layer',\r\n      \r\n      /**\r\n       * Layer . base  ground .\r\n       * @type String\r\n       */\r\n      layerType: 'ground',\r\n      \r\n      /**\r\n       * Ground Layer    layer  zIndex\r\n       * @type Number\r\n       */\r\n      zIndex: 0,\r\n      \r\n      /**\r\n       *   \r\n       * @name olleh.maps.layer.Layer#label\r\n       * @type String\r\n       */\r\n      /**\r\n       * PluginControl   group \r\n       * @name olleh.maps.layer.Layer#group\r\n       * @type String\r\n       */\r\n      /**\r\n       * layer   copyright . Layer  base   .  \r\n       * @name olleh.maps.layer.Layer#copyright\r\n       * @type String\r\n       */\r\n      /**\r\n       * true      activate .\r\n       * true   Layer  setVisible(false)  . \r\n       * @name olleh.maps.layer.Layer#autoActivate\r\n       * @type Boolean\r\n       */\r\n            \r\n      /**\r\n       * Layer \r\n       * @param {olleh.maps.layer.LayerOptions} opts  \r\n       */\r\n      Layer: function (opts) {\r\n        /**\r\n         * Layer   LayerManager\r\n         * @type olleh.maps.layer.LayerManager\r\n         */\r\n        this.layerMgr = null;\r\n        \r\n        this._constructorOpts = opts || {};\r\n      },\r\n      \r\n      /**\r\n       *      .  option  layer  .\r\n       */\r\n      init: function() {\r\n        olleh.maps.mixin(this, this._constructorOpts, true, ['name','layerType','zIndex','label','group','autoActivate','copyright']);\r\n        // layer  pluginInfo  .\r\n        var pluginInfo = {};\r\n        this.label && (pluginInfo.label = this.label);\r\n        if(this.layerType === 'base') {\r\n          pluginInfo.group = '$baseLayer';\r\n        } else if (this.group) {\r\n          pluginInfo.group = this.group;\r\n        }\r\n        pluginInfo.autoActivate = this.autoActivate;\r\n        !this.autoActivate && this.setVisible(false);\r\n        this.setPluginInfo(pluginInfo);\r\n        this._constructorOpts.map && this.setMap(this._constructorOpts.map);\r\n        \r\n        delete this._constructorOpts;\r\n      },\r\n\r\n      /**\r\n       * Layer  bubble target  LayerManager .\r\n       * @returns {olleh.maps.layer.LayerManager} \r\n       */\r\n      getBubble: function () {\r\n        return this.layerMgr;\r\n      },\r\n\r\n      /**\r\n       * Layer   pane  return .  class     .\r\n       * @returns {HTMLElement}\r\n       */\r\n      getPane: function () {\r\n        return null;\r\n      },\r\n            \r\n      /**\r\n       * Animation     .\r\n       * @private \r\n       */\r\n      move: function () {\r\n        this.moveStart();\r\n        this.moveEnd();\r\n      },\r\n\r\n      /**\r\n       * Animation       animation  .\r\n       * Animation    moveEnd()  .\r\n       *  Animation      \r\n       *  animation   moveStart()    animation  \r\n       * moveEnd()   .\r\n       * @private   \r\n       */\r\n      moveStart: function () {\r\n\r\n      },\r\n\r\n      /**\r\n       * Animation       animation  .\r\n       * @private\r\n       */\r\n      moveEnd: function () {\r\n\r\n      },\r\n\r\n      /**\r\n       * Layer  .\r\n       * @param {Boolean} mapStart     draw   true    false .\r\n       * @private  \r\n       */\r\n      draw: function (mapStart) {\r\n\r\n      },\r\n\r\n      /**\r\n       *     LayerManager  . Layer    origin  \r\n       * scale      .\r\n       * @param {Number} scale \r\n       * @param {olleh.maps.Point} origin    layer offset  \r\n       * @param {Number} duration    \r\n       * @param {olleh.maps.fx.Pulse} [pulse] .      .\r\n       * @private\r\n       */\r\n      zoomStart: function (scale, origin, duration, pulse) {\r\n\r\n      },\r\n\r\n      /**\r\n       * zoom    LayerManager   .\r\n       * @private\r\n       */\r\n      zoomEnd: function (oldZoom, newZoom) {\r\n\r\n      },\r\n\r\n      /**\r\n       * layer      . <br>\r\n       *  <br>\r\n       * NOTE: Base Layer  LayerManager#setActiveBaseLayer(layer)    .\r\n       *  Base layer         . \r\n       * @param {Boolean} visible\r\n       * @private\r\n       */\r\n      setVisible: function (visible) {\r\n\r\n      },\r\n      \r\n      /**\r\n       * layer     \r\n       * @returns {Boolean}\r\n       * @private\r\n       */\r\n      isVisible: function () {\r\n\r\n      },\r\n\r\n      isVisibleForZoom: function () {\r\n        return true;\r\n      },\r\n      \r\n      /**\r\n       * Layer  start .\r\n       * @private\r\n       */\r\n      start: function () {\r\n        this._started = true;\r\n      },\r\n\r\n      /**\r\n       * Layer  stop .\r\n       * @private\r\n       */\r\n      stop: function () {\r\n        this._started = false;\r\n      },\r\n\r\n      /**\r\n       * Layer  start    .\r\n       * @returns {Boolean}\r\n       * @private\r\n       */\r\n      isStarted: function () {\r\n        return !!this._started;\r\n      },\r\n      \r\n      /**\r\n       * base layer  LayerManager   active base layer  , ground layer   draw()  setVisible(false)  . \r\n       * @private\r\n       */\r\n      doActivate: function() {\r\n        this.setVisible(true);\r\n        if(this.layerType === 'base') {\r\n          this.layerMgr.setActiveBaseLayer(this);\r\n        } else if(this.layerMgr.isStarted()){\r\n          this.draw();\r\n        }\r\n      },\r\n\r\n      /**\r\n       * active   visible   .\r\n       * @param active\r\n       * @private\r\n       */\r\n      setActive: function(active) {\r\n        this.setVisible(active);\r\n        olleh.maps.Plugin.prototype.setActive.call(this, active);        \r\n      },\r\n      \r\n      /**\r\n       * Layer   .  \r\n       * @returns {Boolean}\r\n       */\r\n      isActive: function() {\r\n        if(!this.layerMgr)\r\n          return false;\r\n        if(this.layerType === 'base') {\r\n          return this.layerMgr.getActiveBaseLayer() === this;\r\n        }\r\n        return this.isVisible();\r\n      },\r\n      \r\n      attach: function() {\r\n        this.map.layerMgr.addLayer(this);\r\n      },\r\n      \r\n      detach: function() {\r\n        this.map.layerMgr.removeLayer(this);\r\n      }\r\n\r\n    });\r\n/**\n * LayerManager  Layer        . \n */\n$class('olleh.maps.layer.LayerManager').mixin(olleh.maps.event.EventDelegator).define({\n\n  $static: {\n    /**\n     *    resoultion  .\n     * @param zoom\n     * @private\n     */\n    getResolutionForZoom: function (zoom) {\n      return 2048 / Math.pow(2, zoom);\n    }\n  },\n\n  defaultOpts: {\n    zoom: 7,\n    minZoom: 0,\n    maxZoom: 13,\n    maxExtent: null,\n    panAnimDuration: 1.0, // panTo()  . /    \n    zoomAnimDuration: 0.2, // zoomIn()/zoomOut()/zoomTo()  \n    useCSSTransform: true\n  },\n\n  /**\n   *       .\n   *        draw   zoom_change   . \n   * @name event:zoom_change\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   * @param {Object} payload\n   * @param {Number} payload.oldZoom   \n   * @param {Number} payload.newZoom   \n   * @param {olleh.maps.Point} payload.origin   \n   * @param {Number} payload.duration    \n   * @param {Number} payload.scale   \n   * @see olleh.maps.layer.Layer#event:zoom_changed\n   */\n  /**\n   * /   \n   * @name event:zoomrange_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   *      \n   * @name event:center_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   * @param {Object} payload\n   * @param {olleh.maps.UTMK} payload.oldCenter  \n   * @param {olleh.maps.UTMK} payload.newCenter  \n   */\n  /**\n   *      \n   * @name event:zoom_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   * @param {Object} payload\n   * @param {olleh.maps.UTMK} payload.oldZoom  \n   * @param {olleh.maps.UTMK} payload.newZoom  \n   * @see olleh.maps.layer.Layer#event:zoom_change\n   */\n  /**\n   *       \n   * center_changed  zoom_changed     .\n   * @name event:bounds_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   * {@link olleh.maps.layer.Layer#start}   LayerManager    \n   * @name event:started\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   *    ,   , /          \n   *         .\n   * @name event:idle\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   *  \n   * @param {olleh.maps.Map} map Map \n   * @param {Element} elem Map  HTML element\n   */\n  LayerManager: function (map, elem) {\n    if (map === null)\n      throw new Error('map is null');\n\n    this._center = null;\n    this._zoom = null;\n    this._minZoom = null;\n    this._maxZoom = null;\n\n    this._map = map;\n    this._mapElem = elem;\n    this._viewportSize = null;\n    this._viewportOffset = null; //  viewport  ( )\n\n    this._layerOffset = new olleh.maps.Point(0, 0); // root_pane offset. move   layerOffset  .\n    this._pendingZoom = null; //       zoom \n    this._pendingCenter = null; //       center\n    this._isZooming = false; //   \n\n    this._baseLayers = [];\n    this._groundLayers = [];\n    this._activeBaseLayer = null;\n    this._overlayLayer = null;\n\n    this._root_pane = null;\n    this._transparent_pane = null;\n    this._layer_container = null;\n\n    this._panAnimTiming = null;\n  },\n\n  /**\n   * LayerManager  bubble  Map .\n   * @returns {olleh.maps.Map}\n   * @private\n   */\n  getBubble: function () {\n    return this._map;\n  },\n\n  /**\n   * Map  .\n   * @returns {olleh.maps.Map}\n   */\n  getMap: function () {\n    return this._map;\n  },\n\n  // ////////////////////\n  // Pane Managements //\n  // ////////////////////\n  _initPanes: function () {\n    var layer_container = this._createPane('layer_container', 0);\n\n    this._layer_container = layer_container;\n    olleh.maps.util.dom.setStyles(layer_container, {\n      width: '100%',\n      height: '100%'\n    });\n    this._mapElem.appendChild(layer_container);\n    this._root_pane = this._createPane('root_pane', 0);\n    layer_container.appendChild(this._root_pane);\n\n    var transparent_pane = this._createPane('transparent_pane', 99999);\n    this._transparent_pane = transparent_pane;\n    layer_container.appendChild(transparent_pane);\n    olleh.maps.util.dom.setStyles(transparent_pane, {\n      width: '100%',\n      height: '100%',\n      display: 'none'\n    });\n    olleh.maps.util.dom.addClass(this._transparent_pane, 'ollehmap-transparent');\n  },\n\n  _createPane: function (id, zIndex) {\n    var pane = document.createElement('div');\n    pane.id = id;\n    pane.style.position = 'absolute';\n    if (olleh.maps.isNumber(zIndex)) {\n      pane.style.zIndex = zIndex;\n    }\n    return pane;\n  },\n\n  // /////////////////////\n  // Layer Managements //\n  // /////////////////////\n\n  /**\n   * Layer  . <p/>\n   * NOTE: Layer   {@link olleh.maps.layer.Layer#setMap(map)}   .\n   * @private  \n   */\n  addLayer: function (layer) {\n    if (layer.layerType === 'base') {\n      this.addBaseLayer(layer);\n    } else {\n      this.addGroundLayer(layer, layer.zIndex);\n    }\n  },\n\n  /**\n   * base layer  .\n   * @param {olleh.maps.layer.Layer} layer  Layer\n   * @private\n   */\n  addBaseLayer: function (layer) {\n    layer.layerMgr = this;\n    layer.setVisible(false);\n    layer.getPane().style.zIndex = '-2';\n    this._baseLayers.push(layer);\n\n    var addBaseLayer = function () {\n      !layer.isStarted() && layer.start();\n      var pane = layer.getPane();\n      this._root_pane.insertBefore(pane, this._root_pane.firstChild);\n      this.unsubscribeEvent('started', addBaseLayer);\n      layer.fireEvent('added');\n    };\n    if (this.isStarted()) {\n      addBaseLayer.call(this);\n      if (!this._activeBaseLayer) {\n        this.setActiveBaseLayer(layer);\n      }\n    } else {\n      this.onEvent('started', addBaseLayer, this);\n    }\n  },\n\n  /**\n   * ground layer  zIndex  . zIndex   z-index  .\n   * , zIndex       .\n   * @param {olleh.maps.layer.Layer} layer\n   * @param {Number} zIndex\n   * @private\n   */\n  addGroundLayer: function (layer, zIndex) {\n    layer.layerMgr = this;\n    layer.getPane().style.zIndex = zIndex;\n    this._groundLayers.push(layer);\n\n    var addGroundLayer = function () {\n      !layer.isStarted() && layer.start();\n      var pane = layer.getPane();\n      pane.style.position = 'absolute';\n      this._root_pane.appendChild(pane);\n      if (layer.isVisible()) {\n        layer.draw();\n      }\n      this.unsubscribeEvent('started', addGroundLayer);\n      layer.fireEvent('added');\n    };\n    if (this.isStarted()) {\n      addGroundLayer.call(this);\n    } else {\n      this.onEvent('started', addGroundLayer, this);\n    }\n  },\n\n  /**\n   * layer  .\n   * @param {olleh.maps.layer.Layer | String} layer  layer   name\n   * @private\n   */\n  removeLayer: function (layer) {\n    if (olleh.maps.isString(layer)) {\n      layer = this.getLayer(layer);\n    }\n    layer.layerMgr = null;\n    if (this.isStarted()) {\n      var pane = layer.getPane();\n      if (pane && pane.parentNode)\n        pane.parentNode.removeChild(pane);\n      layer.fireEvent('removed');\n    }\n    var idx = olleh.maps.util.removeFromArray(this._groundLayers, layer);\n    idx === -1 && olleh.maps.util.removeFromArray(this._baseLayers, layer);\n  },\n\n  /**\n   *  name  layer  .\n   * @param {String} layerName Layer name\n   * @private\n   */\n  getLayer: function (layerName) {\n    var i, len, layer;\n\n    for (i = 0, len = this._baseLayers.length; i < len; i++) {\n      layer = this._baseLayers[i];\n      if (layer.name === layerName)\n        return layer;\n    }\n    for (i = 0, len = this._groundLayers.length; i < len; i++) {\n      layer = this._groundLayers[i];\n      if (layer.name === layerName)\n        return layer;\n    }\n    if (layerName === 'olleh.maps.overlay.OverlayLayer') {\n      return this._overlayLayer;\n    }\n  },\n\n  /**\n   * LayerManager   base layer  .\n   * @returns {Array.<olleh.maps.layer.Layer>} Base Layer \n   * @private\n   */\n  getBaseLayers: function () {\n    return this._baseLayers;\n  },\n\n  /**\n   * LayerManager   ground layer  .\n   * @returns {Array.<olleh.maps.layer.Layer>} Ground Layer \n   * @private\n   */\n  getGroundLayers: function () {\n    return this._groundLayers;\n  },\n\n  /**\n   * OverlayLayer  .\n   * @returns {olleh.maps.overlay.OverlayLayer}\n   * @private\n   */\n  getOverlayLayer: function () {\n    return this._overlayLayer;\n  },\n\n  /**\n   * active base layer  .\n   * @param {olleh.maps.layer.Layer | String} layer\n   * @private\n   */\n  setActiveBaseLayer: function (layer) {\n    if (olleh.maps.isString(layer)) {\n      layer = this.getLayer(layer);\n    }\n\n    if (this._activeBaseLayer !== layer) {\n      var oldLayer = this._activeBaseLayer;\n      this._activeBaseLayer = layer;\n      layer.getPane().style.zIndex = '-1';\n      layer.setActive(true);\n      if (this.isStarted()) {\n        if (oldLayer) {\n          if (layer instanceof olleh.maps.layer.TileLayer) {\n            oldLayer.getPane().style.zIndex = '-2';\n            this._hideLayerFn = function () {\n\n              //      'loaded'      .\n              //         oldLayer    .\n              //           ,\n              //  oldlLayer  Layer .\n              //      Layer    \n              //     oldLayer.setActive(false)   \n              if(oldLayer.getPane().style.zIndex == '-2') oldLayer.setActive(false);\n              \n              layer.unsubscribeEvent('loaded', this._hideLayerFn, this);\n              this._hideLayerFn = null;\n            };\n            layer.onEvent('loaded', this._hideLayerFn, this);\n          } else {\n            oldLayer.setActive(false);\n          }\n        }\n        var minMaxZoomChanged = this._updateMinMaxZoom();\n        var zoom = Math.min(Math.max(this._zoom, this._minZoom),\n          this._maxZoom);\n        if (zoom !== this._zoom) {\n          this.moveTo(null, zoom, 'redraw');\n        } else {\n          this._activeBaseLayer.draw();\n        }\n        if (minMaxZoomChanged)\n          this.fireEvent('zoomrange_changed');\n      } else /* if(!this.isStarted()) */ {\n        if (oldLayer) {\n          oldLayer.setActive(false);\n        }\n      }\n    }\n    this.fireEvent('set_base_layer');\n  },\n\n  /**\n   *  minZoom .\n   * @param {number} minZoom \n   */\n  setMinZoom: function (minZoom) {\n    if (this.isStarted()) {\n      this._opts.minZoom = minZoom;\n      this._updateZoomRange();\n    }\n  },\n\n  /**\n   *  maxZoom .\n   * @param {number} maxZoom \n   */\n  setMaxZoom: function (maxZoom) {\n    if (this.isStarted()) {\n      this._opts.maxZoom = maxZoom;\n      this._updateZoomRange();\n    }\n  },\n\n  /**\n   * Active base layer  minZoom/maxZoom .  \n   * @private\n   */\n  _updateZoomRange: function () {\n    var minMaxZoomChanged = this._updateMinMaxZoom();\n    var zoom = Math.min(Math.max(this._zoom, this._minZoom),\n      this._maxZoom);\n    if (zoom !== this._zoom) {\n      this.moveTo(null, zoom, 'redraw');\n    }\n    if (minMaxZoomChanged)\n      this.fireEvent('zoomrange_changed');\n\n  },\n\n  /** \n   * active base layer   minZoom/maxZoom   .\n   * @returns {Boolean} minZoom/maxZoom  \n   * @private \n   */\n  _updateMinMaxZoom: function () {\n    var layer = this._activeBaseLayer;\n    // Map  maxZoom   (add code r2fresh)\n    var mapMaxZoom = this._map.getOptions().maxZoom;\n    var newMinZoom = this._opts.minZoom;\n    // mapMaxZoom   newMaxZoom   (modify code r2fresh)\n    var newMaxZoom = (mapMaxZoom && mapMaxZoom <= 15) ? mapMaxZoom : this._opts.maxZoom;\n\n    if (olleh.maps.isNumber(layer.minZoom)) {\n      newMinZoom = Math.max(layer.minZoom, newMinZoom);\n    }\n\n    // mapMaxZoom   newMaxZoom min     (modify code r2fresh)\n    if (olleh.maps.isNumber(layer.maxZoom) && !(mapMaxZoom && mapMaxZoom <= 15)) {\n      newMaxZoom = Math.min(layer.maxZoom, newMaxZoom);\n    }\n\n    var minMaxZoomChanged = false;\n    if (newMinZoom !== this._minZoom || newMaxZoom !== this._maxZoom) {\n      this._minZoom = newMinZoom;\n      this._maxZoom = newMaxZoom;\n      minMaxZoomChanged = true;\n    }\n    return minMaxZoomChanged;\n  },\n\n\n  /**\n   * active base layer  .\n   * @returns {olleh.maps.layer.Layer}\n   * @private\n   */\n  getActiveBaseLayer: function () {\n    return this._activeBaseLayer;\n  },\n\n  // //////////////////\n  // Map Operations //\n  // //////////////////\n\n  /**\n   *       .\n   * @param {olleh.maps.Bounds} bounds   \n   * @returns {Number}\n   * @private\n   */\n  getZoomForBounds: function (bounds) {\n    bounds = bounds.transform(olleh.maps.UTMK);\n    var zoom = this._minZoom;\n    var width = bounds.getWidth();\n    var height = bounds.getHeight();\n    for (; zoom <= this._maxZoom; zoom++) {\n      var coordSize = this._getCoordSizeForZoom(zoom);\n      if (coordSize.width < width || coordSize.height < height)\n        return zoom === this._minZoom ? this._minZoom : zoom - 1;\n    }\n    return zoom;\n  },\n\n  /**\n   * coord    (bounds)   .\n   * @param {olleh.maps.Coord} coord\n   * @returns {Boolean}\n   * @private\n   */\n  isValidCoord: function (coord) {\n    var bounds = this.getBounds();\n    return bounds.contains(coord);\n  },\n\n  /**\n   *   layer  start   center  zoom  draw  .\n   * 'started'  .\n   * @private\n   */\n  start: function () {\n    var opts = olleh.maps.util.clone(this.defaultOpts);\n    var i, len;\n\n    opts = olleh.maps.mixin(opts, this._map.getOptions(), true);\n    this._opts = opts;\n\n    this._minZoom = opts.minZoom;\n    this._maxZoom = opts.maxZoom;\n    this._viewportSize = new olleh.maps.Size(this._mapElem.clientWidth, this._mapElem.clientHeight);\n    this._viewportOffset = olleh.maps.util.dom.getXY(this._mapElem);\n    this._disableLoadingWhilePanning = this._map.getOption('disableLoadingWhilePanning', false);\n\n    if (!this._center && this._initialBounds) {\n      var bounds = this._initialBounds;\n      this._center = bounds.getCenter();\n      this._zoom = this.getZoomForBounds(bounds);\n      delete this._initialBounds;\n    }\n\n    // start   setCenter()  setZoom()     .\n    !this._center && (this._center = opts.center.asDefault());\n    !olleh.maps.isNumber(this._zoom) && (this._zoom = +opts.zoom);\n\n    this._panAnimTiming = new olleh.maps.fx.timing.CubicBezier(0, opts.panAnimEaseLinearity1, opts.panAnimEaseLinearity2, 1);\n    this._zoomPulse = olleh.maps.browser.usePulseForZoom ? new olleh.maps.fx.Pulse(opts.zoomAnimDuration) : false;\n\n    this._initPanes();\n\n    this._updateMinMaxZoom();\n    if (opts.overlayLayer) {\n      this._overlayLayer = opts.overlayLayer;\n      this._overlayLayer.map = this._map; // OverlayLayer  Adaptable type  map   \n      this._overlayLayer.layerMgr = this;\n      var panes = this._overlayLayer.panes;\n      for (var k in panes) {\n        this._root_pane.appendChild(panes[k]);\n      }\n    }\n    this.registerEventDom(this._layer_container);\n\n    for (i = 0, len = this._baseLayers.length; i < len; i++) {\n      this._baseLayers[i].start();\n    }\n    for (i = 0, len = this._groundLayers.length; i < len; i++) {\n      this._groundLayers[i].start();\n    }\n    this._overlayLayer && this._overlayLayer.start();\n\n    if (this._disableLoadingWhilePanning) {\n      var backgroundLayer = new olleh.maps.layer.BackgroundLayer();\n      backgroundLayer.layerMgr = this;\n      backgroundLayer.start();\n      var pane = backgroundLayer.getPane();\n      this._root_pane.appendChild(pane);\n      this._backgroundLayer = backgroundLayer;\n    }\n\n    this._started = true;\n    if (this._center)\n      this.moveTo(this._center, this._zoom, 'redraw');\n    this.fireEvent('started');\n  },\n\n  /**\n   *  layer  stop .\n   * @private\n   */\n  stop: function () {\n    var i, len;\n    for (i = 0, len = this._baseLayers.length; i < len; i++) {\n      this._baseLayers[i].stop();\n    }\n    for (i = 0, len = this._groundLayers.length; i < len; i++) {\n      this._groundLayers[i].stop();\n    }\n    this._overlayLayer && this._overlayLayer.stop();\n    this.unregisterEvent();\n    this._started = false;\n  },\n\n  /**\n   *   .\n   * @returns {Boolean}\n   * @private\n   */\n  isStarted: function () {\n    return !!this._started;\n  },\n\n  /**\n   *     resolution  .\n   * TODO resolution   tile spec       . \n   * TODO coord <-> point        \n   * @returns {Number}\n   * @private\n   */\n  getResolution: function () {\n    return 2048 / Math.pow(2, this._zoom);\n  },\n\n  /**\n   * Viewport size  .\n   * @returns {olleh.maps.Size}\n   * @private\n   */\n  getViewportSize: function () {\n    return this._viewportSize;\n  },\n\n  /**\n   * viewport   .\n   * @returns {olleh.maps.Point}\n   * @private\n   */\n  getViewportCenter: function () {\n    return new olleh.maps.Point(Math.floor(this._viewportSize.width / 2), Math.floor(this._viewportSize.height / 2));\n  },\n\n  /**\n   * Viewport pixel  .\n   * @returns {olleh.maps.Point} x  left, y  top  \n   * @private\n   */\n  getViewportOffset: function () {\n    return this._viewportOffset;\n  },\n\n  /**\n   *    viewport size  UTMK   .\n   * @param {Number} zoom\n   * @private \n   */\n  _getCoordSizeForZoom: function (zoom) {\n    var resolution = olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\n    return this._viewportSize.multiplyBy(resolution);\n  },\n\n  /**\n   * Layer offset  .\n   * @returns {olleh.maps.Point}\n   * @private\n   */\n  getLayerOffset: function () {\n    return this._layerOffset;\n  },\n\n  /**\n   * Viewport top-left  UTMK  .\n   * @param {boolean} [afterZoom] true          \n   * @returns {olleh.maps.UTMK}\n   * @private\n   */\n  _getCoordOrigin: function (afterZoom) {\n    if (!this._center)\n      throw new Error('Center must be specified.');\n    var zoom = afterZoom ? this.getPendingZoom() : this._zoom;\n    var center = afterZoom ? this.getPendingCenter() : this._center;\n    var coordSize = this._getCoordSizeForZoom(zoom);\n    var x = center.x - coordSize.width / 2;\n    var y = center.y + coordSize.height / 2;\n    return new olleh.maps.UTMK(x, y);\n  },\n\n  /**\n   *   viewport pixel  .\n   * @param {olleh.maps.Coord} coord   \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.Point}  viewport pixel \n   */\n  getViewportPxFromCoord: function (coord, afterZoom) {\n    afterZoom = afterZoom !== false;\n    coord = coord.asDefault();\n    var coordOrigin = this._getCoordOrigin(!!afterZoom);\n    var dx = coord.x - coordOrigin.x;\n    var dy = coordOrigin.y - coord.y;\n    var zoom = afterZoom ? this.getPendingZoom() : this._zoom;\n    var resolution = olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\n    return new olleh.maps.Point(dx / resolution, dy / resolution)._round();\n  },\n\n  /**\n   *   layer pixel  .\n   * @param {olleh.maps.Coord} coord   \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.Point}  layer pixel \n   */\n  getLayerPxFromCoord: function (coord, afterZoom) {\n    afterZoom = afterZoom !== false;\n    var viewportPx = this.getViewportPxFromCoord(coord, !!afterZoom);\n    return new olleh.maps.Point(viewportPx.x - this._layerOffset.x,\n      viewportPx.y - this._layerOffset.y)._round();\n  },\n\n  /**\n   * Viewport pixel  UTMK   .\n   * @param {olleh.maps.Point} viewportPx viewport pixel \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.UTMK}   \n   */\n  getCoordFromViewportPx: function (viewportPx, afterZoom) {\n    afterZoom = afterZoom !== false;\n    var zoom = afterZoom ? this.getPendingZoom() : this._zoom;\n    var resolution = olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\n    var coordOrigin = this._getCoordOrigin(!!afterZoom);\n    var dx = viewportPx.x * resolution;\n    var dy = viewportPx.y * resolution;\n    return new olleh.maps.UTMK(coordOrigin.x + dx, coordOrigin.y - dy);\n  },\n\n  /**\n   * Layer pixel  UTMK   .\n   * @param {olleh.maps.Point} layerPx layer pixel \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.UTMK}   \n   */\n  getCoordFromLayerPx: function (layerPx, afterZoom) {\n    afterZoom = afterZoom !== false;\n    var viewportPx = new olleh.maps.Point(layerPx.x\n      + this._layerOffset.x, layerPx.y + this._layerOffset.y);\n    return this.getCoordFromViewportPx(viewportPx, afterZoom);\n  },\n\n  /**\n   * Viewport pixel  layer pixel  .\n   * @param {olleh.maps.Point} viewportPx viewport pixel \n   * @returns {olleh.maps.Point}  layer pxiel \n   */\n  getLayerPxFromViewportPx: function (viewportPx) {\n    return new olleh.maps.Point(viewportPx.x - this._layerOffset.x,\n      viewportPx.y - this._layerOffset.y);\n  },\n\n  /**\n   * Layer pixel  viewport pixel  .\n   * @param {olleh.maps.Point} layerPx layer pixel \n   * @returns {olleh.maps.Point}  viewport pixel \n   */\n  getViewportPxFromLayerPx: function (layerPx) {\n    return new olleh.maps.Point(layerPx.x + this._layerOffset.x,\n      layerPx.y + this._layerOffset.y);\n  },\n\n  /**\n   *    .\n   * @returns {olleh.maps.UTMK}  \n   * @private\n   */\n  getCenter: function () {\n    return this._center;\n  },\n\n  /**\n   * viewport     UTMK  .\n   * @returns {olleh.maps.Bounds}  \n   * @private\n   */\n  getBounds: function () {\n    var coordSize = this._getCoordSizeForZoom(this._zoom);\n    // left bottom\n    var x1 = this._center.x - coordSize.width / 2;\n    var y1 = this._center.y - coordSize.height / 2;\n    // right top\n    var x2 = this._center.x + coordSize.width / 2;\n    var y2 = this._center.y + coordSize.height / 2;\n\n    return new olleh.maps.Bounds(new olleh.maps.UTMK(x1, y1),\n      new olleh.maps.UTMK(x2, y2));\n  },\n\n  /**\n   *   .\n   * @returns {Number}  \n   * @private\n   */\n  getZoom: function () {\n    return this._zoom;\n  },\n\n  /**\n   *    .\n   * @returns {Number}   \n   * @private\n   */\n  getMinZoom: function () {\n    return this._minZoom;\n  },\n\n  /**\n   *    .\n   * @returns {Number}   \n   * @private\n   */\n  getMaxZoom: function () {\n    return this._maxZoom;\n  },\n\n  /**\n   *         .\n   * @param {Number} newZoom   \n   * @private \n   */\n  _getScaleForZoom: function (newZoom) {\n    return Math.pow(2, newZoom - this._zoom);\n  },\n\n  /**\n   *      .\n   * @param changeAmount  \n   * @private\n   */\n  _getScaleForChanges: function (changeAmount) {\n    return Math.pow(2, changeAmount);\n  },\n\n  /**\n   *     .\n   * @param scale \n   * @private\n   */\n  _getZoomForScale: function (scale) {\n    return this._zoom + (Math.log(scale) / Math.LN2);\n  },\n\n  /**\n   *  .\n   * @param {Number} zoom  \n   * @private\n   */\n  setZoom: function (zoom) {\n    this.moveTo(null, zoom, 'on');\n  },\n\n  /**\n   *  1 .\n   * @private\n   */\n  zoomIn: function () {\n    this.setZoom(this.getPendingZoom() + 1);\n  },\n\n  /**\n   *  1 .\n   * @private\n   */\n  zoomOut: function () {\n    this.setZoom(this.getPendingZoom() - 1);\n  },\n\n  /**\n   * fitBounds()         animation  \n   * @param {olleh.maps.Bounds} bounds  \n   * @private\n   */\n  panToBounds: function (bounds) {\n    var center = bounds.getCenter();\n    var zoom = this.getZoomForBounds(bounds);\n    this.panTo(center, zoom);\n  },\n\n  /**\n   *  bounds     .\n   * @param {olleh.maps.Bounds} bounds\n   * @private\n   */\n  fitBounds: function (bounds) {\n    if (!this.isStarted()) {\n      this._initialBounds = bounds;\n    } else {\n      var center = bounds.getCenter();\n      var zoom = this.getZoomForBounds(bounds);\n      this.moveTo(center, zoom, 'redraw');\n    }\n  },\n\n  /**\n   *  x  dx  , y  dy     . \n   *       animation   .\n   * @param {Number} dx x   .   .\n   * @param {Number} dy y   .   .\n   * @private\n   */\n  panBy: function (dx, dy) {\n    var newCenter = this.calcNewCenter(dx, dy);\n    this.panTo(newCenter, this._zoom);\n  },\n\n  /**\n   *  center   dx, dy    . \n   * @param dx x     \n   * @param dy y     \n   * @returns {olleh.maps.UTMK}  \n   * @private\n   */\n  calcNewCenter: function (dx, dy) {\n    var resolution = this.getResolution();\n    var _dx = dx * resolution;\n    var _dy = dy * resolution;\n    return new olleh.maps.UTMK(this._center.x + _dx, this._center.y - _dy);\n  },\n\n  /**\n   *   center  .      \n   * animation   .\n   * @param {olleh.maps.Coord} center    \n   * @param {number} [zoom]  zoom\n   * @param {string} [animation=auto] 'off'     .\n   *                             'auto'            . \n   * @private\n   */\n  panTo: function (center, zoom, animation) {\n    center = center.asDefault();\n    this.moveTo(center, zoom, animation || 'auto');\n  },\n\n  /**\n   * dx, dy  layer offset  . argument   layer offset  \n   * 0,0  reset .\n   * @param {Number} dx  \n   * @param {Number} dy \n   * @private\n   */\n  _moveRootPane: function (dx, dy) {\n    if (arguments.length >= 2) {\n      this._layerOffset._add(dx, dy);\n    } else {\n      this._layerOffset.x = 0;\n      this._layerOffset.y = 0;\n    }\n    var styles = this._getPositionStyles();\n\n    olleh.maps.util.dom.setStyles(this._root_pane, styles);\n  },\n\n  _getPositionStyles: function () {\n    return olleh.maps.util.dom.getPositionStyles(this._layerOffset.x,\n      this._layerOffset.y, this._opts.useCSSTransform, olleh.maps.browser.use3DRootPane);\n  },\n\n  /**\n   * dx, dy  layer offset     . \n   * @param {Number} dx  \n   * @param {Number} dy \n   * @param {Number} animationDuration animation   \n   * @param {Function} animationCallback animation    callback function \n   * @private\n   */\n  _panRootPane: function (dx, dy, animationDuration, animationCallback) {\n    var currentStyles = this._getPositionStyles();\n    this._layerOffset._add(dx, dy);\n    var styles = this._getPositionStyles();\n    this._rootPaneAnimator = new olleh.maps.fx.Animation({\n      from: currentStyles,\n      to: styles,\n      duration: animationDuration,\n      timing: this._panAnimTiming,\n      callback: animationCallback ? animationCallback.bind(this) : null,\n      pulse: true\n    }).animate(this._root_pane);\n  },\n\n  /**\n   *  pan animation    center  update . \n   * @private\n   */\n  _abortPanAnimationAndUpdateCenter: function () {\n    if (!this._isZooming && this._rootPaneAnimator && this._rootPaneAnimator.status === 'started') {\n      var currentStyles = this._rootPaneAnimator.abort();\n      var currentPosition = olleh.maps.util.dom.getPointFromStyle(currentStyles);\n      var diff = this._layerOffset.subtract(currentPosition);\n      this._layerOffset = currentPosition;\n      var newCenter = this.calcNewCenter(diff.x, diff.y);\n      this._center = newCenter;\n      if (!this._disableLoadingWhilePanning)\n        this._moveLayers();\n      this._resetIdleTimer();\n    }\n  },\n\n  /**\n   *   coord  .\n   * @param {olleh.maps.Coord} center\n   * @private\n   */\n  setCenter: function (center) {\n    center = center.asDefault();\n    this.moveTo(center, null, 'redraw');\n  },\n\n  /**\n   * viewport size       .\n   * window resize    map element  \n   *    .  \n   * @param {String} [horizontalRef=left] left,right,center      . left     right      center  .\n   *  center   center   . center    verticalRef   .\n   * @param {String} [verticalRef=top] top  bottom    . top     bottom      center  . \n   * @private\n   */\n  resize: function (horizontalRef, verticalRef) {\n    if (!this.isStarted())\n      return;\n    var newCenter;\n    var viewportSize = new olleh.maps.Size(this._mapElem.clientWidth,\n      this._mapElem.clientHeight);\n    if (horizontalRef === 'center') {\n      newCenter = this._center;\n    } else {\n      var point = viewportSize.divideBy(2).asPoint();\n      newCenter = this.getCoordFromViewportPx(point);\n      if (horizontalRef === 'right' || verticalRef === 'bottom') {\n        var point2 = this._viewportSize.divideBy(2).asPoint();\n        this._viewportSize = viewportSize;\n        var coord2 = this.getCoordFromViewportPx(point2);\n        var x = horizontalRef === 'right' ? coord2.x : newCenter.x;\n        var y = verticalRef === 'bottom' ? coord2.y : newCenter.y;\n        newCenter = new olleh.maps.UTMK(x, y);\n      }\n    }\n    this._viewportSize = viewportSize;\n    this._viewportOffset = olleh.maps.util.dom.getXY(this._mapElem);\n    this._viewportSizeChanged = true;\n    this.moveTo(newCenter, null, 'redraw');\n  },\n\n  /**\n   * maxExtent    moveTo()    . \n   * @param center   \n   * @param zoom  \n   * @returns {olleh.maps.UTMK}   \n   * @private\n   */\n  _adjustCenter: function (center, zoom) {\n    var restrictedExtent = this._opts.restrictedExtent;\n    if (!restrictedExtent)\n      return center;\n    var coordSize = this._getCoordSizeForZoom(zoom);\n    var left, right, bottom, top;\n    if (coordSize.width > restrictedExtent.getWidth()) {\n      left = restrictedExtent.getRight() - coordSize.width / 2;\n      right = restrictedExtent.getLeft() + coordSize.width / 2;\n    } else {\n      left = restrictedExtent.getLeft() + coordSize.width / 2;\n      right = restrictedExtent.getRight() - coordSize.width / 2;\n    }\n    if (coordSize.height > restrictedExtent.getHeight()) {\n      bottom = restrictedExtent.getTop() - coordSize.height / 2;\n      top = restrictedExtent.getBottom() + coordSize.height / 2;\n    } else {\n      bottom = restrictedExtent.getBottom() + coordSize.height / 2;\n      top = restrictedExtent.getTop() - coordSize.height / 2;\n    }\n    var centerBounds = new olleh.maps.Bounds(\n      new olleh.maps.UTMK(left, bottom),\n      new olleh.maps.UTMK(right, top)\n    );\n    if (centerBounds.contains(center)) {\n      return center;\n    }\n    var x = Math.max(centerBounds.getLeft(), Math.min(centerBounds.getRight(), center.x));\n    var y = Math.max(centerBounds.getBottom(), Math.min(centerBounds.getTop(), center.y));\n    return new olleh.maps.UTMK(x, y);\n  },\n\n  /**\n   *   center   zoom  .\n   * @param {olleh.maps.UTMK} center  .  UTMK. null    center   zoom  .\n   * @param {number} zoom . null    zoom   center  .\n   * @param {string} [animation=redraw] redraw:  redraw, .    viewport    \n   *                             on:  animation.      handler   .\n   *                             auto:    animation,  draw, Map#panTo()    \n   *                             off:    animation     . \n   *                                   pan control   .    draw   \n   * @param {number} [animationDuration] animation   \n   * @private\n   */\n  moveTo: function (center, zoom, animation, animationDuration) {\n    // zoom    \n    if (zoom)\n      zoom = +zoom;\n    if (!this.isStarted()) {\n      center && (this._center = center);\n      olleh.maps.isNumber(zoom) && (this._zoom = zoom);\n      return;\n    }\n    if (this._pinch_started) { // PinchZoom.js  . pinch   zoom    .\n      return;\n    }\n    // center      center   \n    //    pendingCenter( center)  \n    if (!center) {\n      center = this._isZooming ? this._pendingCenter : this._center;\n    }\n    // zoom      zoom   \n    //     pendingZoom( zoom) \n    if (!olleh.maps.isNumber(zoom)) {\n      zoom = this._isZooming ? this._pendingZoom : this._zoom;\n    }\n    // minZoom, maxZoom  .\n    zoom = Math.max(this._minZoom, zoom);\n    zoom = Math.min(this._maxZoom, zoom);\n    // maxExtent  .\n    center = this._adjustCenter(center, zoom);\n    var oldZoom = this._zoom;\n    var oldCenter = this._center;\n    var zoomChanged = this._isZooming ? zoom !== this._pendingZoom : zoom !== oldZoom;\n    var centerChanged = this._isZooming ? !center.equals(this._pendingCenter) : !center.equals(oldCenter);\n    // forceDraw  true   redraw \n    var forceDraw = false;\n    //   \n    var useAnimation = false;\n    //    center  .\n    this._abortPanAnimationAndUpdateCenter();\n    var panDuration = olleh.maps.isNumber(animationDuration) ? animationDuration\n      : this._opts.panAnimDuration;\n    var zoomDuration = olleh.maps.isNumber(animationDuration) ?\n      animationDuration : this._opts.zoomAnimDuration;\n    //  draw\n    if (animation === 'redraw' || olleh.maps.isUndefined(animation) || (zoomChanged && zoomDuration === 0) || (centerChanged && panDuration === 0)) {\n      forceDraw = true;\n    } else if (animation === 'on') { //  animation\n      useAnimation = true;\n    } else /* if (animation === 'auto' || animation === 'off') */ { //    move,  draw\n      //      redraw .\n      var coordSize = this._getCoordSizeForZoom(Math.min(zoom, this._zoom));\n      // left bottom\n      var x1 = this._center.x - coordSize.width * 3 / 2;\n      var y1 = this._center.y - coordSize.height * 3 / 2;\n      // right top\n      var x2 = this._center.x + coordSize.width * 3 / 2;\n      var y2 = this._center.y + coordSize.height * 3 / 2;\n      if (center.x < x1 || center.y < y1 || center.x > x2 || center.y > y2) {\n        forceDraw = true;\n      } else {\n        useAnimation = animation === 'auto'; // move  animation   \n      }\n    }\n    //  zoom  forceDraw  . \n    if (!useAnimation && zoomChanged)\n      forceDraw = true;\n    if (!forceDraw && !centerChanged && !zoomChanged) {\n      return;\n    }\n    // draw: layer offset   layer.draw() \n    if (!this._center || forceDraw) {\n      if (this._isZooming) {\n        if (this._zoomEndReq) {\n          window.cancelAnimationFrame(this._zoomEndReq);\n          this._zoomEndReq = null;\n        }\n        this._isZooming = false;\n        this._pendingZoom = null;\n        this._pendingCenter = null;\n      }\n      this._setBounds(center, zoom);\n      this._moveRootPane(); // reset layer offset\n      this._drawLayers();\n      this._fireBoundsChangedEvent();\n    } else if (zoomChanged) {\n      var layerPx;\n      //      \n      if (this._isZooming) {\n        // zoom     origin   .\n        layerPx = this._initialOriginLayerPx;\n        //  zoom   center    .\n        if (this._initialCenterLayerPx) { //   center layer px\n          var initialCenterLayerPx = this._initialCenterLayerPx;\n          var scale = this._getScaleForZoom(zoom);\n          var offsetPx = layerPx.subtract(initialCenterLayerPx);\n          offsetPx._multiplyBy(1 - 1 / scale);\n          var tempCoord = initialCenterLayerPx.add(offsetPx);\n          tempCoord = this.getCoordFromLayerPx(tempCoord, false);\n          center = tempCoord;\n        }\n      } else {\n        layerPx = this.getLayerPxFromCoord(center, false);\n        if (centerChanged) {\n          // zoom animation  .\n          // leaflet    .   ;;\n          // animation  =   + (  -  )/(1 - 1 /  ) \n          var centerLayerPx = this.getLayerPxFromCoord(this._center, false);\n          var offsetPx = layerPx.subtract(centerLayerPx);\n          var scale = this._getScaleForZoom(zoom);\n          offsetPx._divideBy(1 - 1 / scale);\n          layerPx = centerLayerPx.add(offsetPx);\n          //   center layer px\n          this._initialCenterLayerPx = centerLayerPx;\n        }\n        //   zoom origin layer px \n        this._initialOriginLayerPx = layerPx;\n      }\n      this._pendingZoom = zoom;\n      this._pendingCenter = center;\n      var scale = this._getScaleForChanges(zoom - oldZoom);\n      this.fireEvent('zoom_change', {\n        origin: layerPx, scale: scale,\n        duration: zoomDuration, newZoom: zoom, oldZoom: oldZoom\n      });\n      if (this._hideLayerFn) { // base layer     \n        this._hideLayerFn.call(this);\n      }\n      this._zoomStartLayers(scale, layerPx, zoomDuration);\n      this._triggerZoomEnd(center, zoom, oldZoom, zoomDuration);\n    }\n    // move \n    //     move  .\n    else if (!this._isZooming) {\n      var resolution = this.getResolution();\n      var dx = Math.floor((center.x - this._center.x) / resolution);\n      var dy = Math.floor((center.y - this._center.y) / resolution);\n      //   \n      if (useAnimation) {\n        this._panRootPane(-dx, dy, panDuration, this._moveEndLayers);\n        this._setBounds(center, this._zoom);\n        this._moveStartLayers();\n      } else { //   move\n        this._moveRootPane(-dx, dy);\n        this._setBounds(center, this._zoom);\n        if (!this._disableLoadingWhilePanning)\n          this._moveLayers();\n        this._resetIdleTimer();\n        this._fireBoundsChangedEvent();\n      }\n    }\n  },\n\n  /**\n   *  layer  zoom animation   zoomEnd()    \n   * requestAnimationFrame   _triggerZoomEnd2  .\n   * @private\n   */\n  _triggerZoomEnd: function (center, zoom, oldZoom, zoomDuration) {\n    this._isZooming = true;\n    if (this._zoomEndReq) {\n      window.cancelAnimationFrame(this._zoomEndReq);\n    }\n    this._zoomEndReq = olleh.maps.util.deferAF(this._triggerZoomEnd2, this, center, zoom, oldZoom, zoomDuration);\n  },\n\n  /**\n   * zoomDuration  _triggerZoomEnd3  .\n   * @param {Number} t requsetAnimationFrame   \n   * @param {olleh.maps.coord} center\n   * @param {Number} zoom\n   * @param {Number} oldZoom\n   * @param {Nuber} zoomDuration\n   * @private\n   */\n  _triggerZoomEnd2: function (t, center, zoom, oldZoom, zoomDuration) {\n    if (this._zoomTimer !== null) {\n      window.clearTimeout(this._zoomTimer);\n    }\n    this._zoomEndReq = null;\n    this._zoomTimer = olleh.maps.util.delay(this._triggerZoomEnd3, 1000 * zoomDuration + 100, this, center, oldZoom, zoom);\n  },\n\n  /**\n   * center,zoom   zoomEnd layer  .\n   * @private\n   */\n  _triggerZoomEnd3: function (center, oldZoom, zoom) {\n    this._isZooming = false;\n    this._setBounds(center, zoom);\n    this._pendingZoom = null;\n    this._pendingCenter = null;\n    this._zoomEndLayers(oldZoom, zoom);\n    this._initialCenterLayerPx = null;\n    this._zoomTimer = null;\n    this._fireBoundsChangedEvent();\n  },\n\n  _setBounds: function (center, zoom) {\n    var centerChanged = this._center !== center;\n    var zoomChanged = this._zoom !== zoom;\n    if (!centerChanged && !zoomChanged)\n      return;\n    if (centerChanged) {\n      var oldCenter = this._center;\n      this._center = center;\n      this._centerChanged = { newCenter: center, oldCenter: oldCenter };\n    }\n    if (zoomChanged) {\n      var oldZoom = this._zoom;\n      this._zoom = zoom;\n      this._zoomChanged = { newZoom: zoom, oldZoom: oldZoom };\n    }\n  },\n\n  _fireBoundsChangedEvent: function () {\n    if (this._centerChanged) {\n      this.fireEvent('center_changed', this._centerChanged);\n    }\n    if (this._zoomChanged) {\n      this.fireEvent('zoom_changed', this._zoomChanged);\n    }\n    if (this._zoomChanged || this._centerChanged || this._viewportSizeChanged) {\n      this.fireEvent('bounds_changed');\n    }\n    this._centerChanged = null;\n    this._zoomChanged = null;\n    this._viewportSizeChanged = null;\n  },\n\n  /**\n   *      true  .\n   * @returns {Boolean}\n   * @private\n   */\n  isZooming: function () {\n    return this._isZooming;\n  },\n\n  /**\n   * zoom animation    getZoom()    zoom  \n   *   zoom  .\n   * zoom animation   zoom   \n   * getPendingZoom()   .\n   * @returns {Number}    \n   * @private\n   */\n  getPendingZoom: function () {\n    return olleh.maps.isNumber(this._pendingZoom) ? this._pendingZoom : this._zoom;\n  },\n\n  /**\n   * {@link #getPendingZoom()}       \n   * center  .\n   * @returns {olleh.maps.Coord}  \n   * @private\n   */\n  getPendingCenter: function () {\n    return this._pendingCenter ? this._pendingCenter : this._center;\n  },\n\n  /**\n   *  layer  draw  .\n   * @private\n   */\n  _drawLayers: function () {\n    this._forEachLayers('draw', [!this.isStarted()]);\n    if (!this.isStarted()) {\n      this._idle();\n    } else {\n      this._resetIdleTimer();\n    }\n  },\n\n  /**\n   *  layer  moveEnd  .\n   * @private\n   */\n  _moveEndLayers: function () {\n    this._forEachLayers('moveEnd');\n    this._fireBoundsChangedEvent();\n    this._idle();\n  },\n\n  /**\n   *  layer  moveStart  .\n   * @private\n   */\n  _moveStartLayers: function () {\n    this._forEachLayers('moveStart');\n  },\n\n  /**\n   *  layer  move  .\n   * @private\n   */\n  _moveLayers: function () {\n    this._forEachLayers('move');\n  },\n\n  /**\n   *  layer  zoomStart  .\n   * @param {Number} scale   \n   * @param {olleh.maps.Point} origin  \n   * @param {Number} duration    \n   * @private\n   */\n  _zoomStartLayers: function (scale, origin, duration) {\n    this._forEachLayers('zoomStart', [scale, origin,\n      duration, this._zoomPulse]);\n  },\n\n  /**\n   *  layer  zoomEnd  .\n   * @param {Number} oldZoom    \n   * @param {Number} newZoom    \n   * @private\n   */\n  _zoomEndLayers: function (oldZoom, newZoom) {\n    this._forEachLayers('zoomEnd', [oldZoom, newZoom]);\n    if (this._zoomPulse) {\n      this._zoomPulse.stop();\n    }\n    this._idle();\n  },\n\n  /**\n   *  layer    .\n   * @param {String} fnString    \n   * @param {Array} args function arguments array\n   * @private \n   */\n  _forEachLayers: function (fnString, args) {\n    args || (args = []);\n\n    if (this._backgroundLayer) {\n      this._backgroundLayer[fnString].apply(this._backgroundLayer, args);\n    }\n\n    if (this._activeBaseLayer) {\n      this._activeBaseLayer[fnString].apply(this._activeBaseLayer, args);\n    }\n\n    for (var i = 0, len = this._groundLayers.length; i < len; i++) {\n      var l = this._groundLayers[i];\n      if ((l.isVisible() && l.isVisibleForZoom()) || fnString.indexOf('End') != -1) { // TODO  \n        l[fnString].apply(l, args);\n      }\n    }\n\n    if (this._overlayLayer) {\n      this._overlayLayer[fnString].apply(this._overlayLayer, args);\n    }\n  },\n\n  /**\n   * edit mode  viewport  transparent_pane     overlay  cursor style   . \n   * @param {Boolean} editable true  edit mode   .\n   * @private\n   */\n  setEditMode: function (editable) {\n    var display = editable ? 'block' : 'none';\n    this._transparent_pane.style.display = display;\n  },\n\n  /**\n   *   max extent (  )  .\n   * @returns {olleh.maps.Bounds} max extetnt\n   * @private\n   */\n  getMaxExtent: function () {\n    return this._opts.maxExtent;\n  },\n\n  /**\n   *   restricted extent ( panning  )  .\n   * @returns {olleh.maps.Bounds} restricted extent\n   * @private\n   */\n  getRestrictedExtent: function () {\n    return this._opts.restrictedExtent;\n  },\n\n  _resetIdleTimer: function () {\n    if (this._idleTimer) {\n      window.clearTimeout(this._idleTimer);\n    }\n    this._idleTimer = olleh.maps.util.delay(this.__resetIdleTimer, 200, this);\n  },\n\n  /**\n   * @private\n   */\n  __resetIdleTimer: function () {\n    //      /   . \n    if (!this._isZooming && (!this._rootPaneAnimator || this._rootPaneAnimator.status != 'started')) {\n      if (this._disableLoadingWhilePanning)\n        this._moveLayers();\n      this.fireEvent('idle');\n    }\n    this._idleTimer = null;\n  },\n\n  _idle: function () {\n    //       .\n    if (!this._idleTimer) {\n      this.fireEvent('idle');\n    }\n  }\n\n});\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.layer.BackgroundLayer').extend(olleh.maps.layer.Layer).define({\r\n            \r\n  start: function() {\r\n    var browser = olleh.maps.browser;\r\n    var viewportSize = this.layerMgr.getViewportSize();\r\n    this._pane = document.createElement('div');\r\n    this._buffer = 3000; // buffer  10000   iOS   .\r\n    var styles = {\r\n        position: 'absolute',\r\n        zIndex: '-1000',\r\n        width: viewportSize.width + this._buffer * 2 + 'px',\r\n        height: viewportSize.height + this._buffer * 2 + 'px',\r\n        backgroundImage: 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAALUlEQVR4Xu3SMQEAMAgDwVD/2mDDDnXAb0w5Ab8k2nTlCDyBg4ADwVMx/8CBDz7/CnKqkouSAAAAAElFTkSuQmCC)',\r\n        backgroundRepeat: 'repeat'  \r\n    };\r\n    if (browser.has3D) {\r\n      styles.transform  = 'translate3d(0,0,0)';\r\n    }\r\n    olleh.maps.util.dom.setStyles(this._pane, styles);\r\n    this._updatePosition();\r\n    this.layerMgr.onEvent('idle', this._onIdle, this);\r\n  },\r\n  \r\n  getPane: function() {\r\n    return this._pane;\r\n  },\r\n  \r\n  _onIdle: function() {\r\n    if (this._idleTimer) {\r\n      window.clearTimeout(this._idleTimer);\r\n    }\r\n    this._idleTimer = olleh.maps.util.delay(this._resetIdleTimer, 500, this);\r\n  },\r\n  \r\n  _resetIdleTimer: function() {\r\n    this._updatePosition();\r\n    this._idleTimer = null;\r\n  },\r\n    \r\n  _updatePosition: function() {\r\n    var layerOffset = this.layerMgr.getLayerOffset();\r\n    olleh.maps.util.dom.setStyles(this._pane, {\r\n      left: -layerOffset.x - this._buffer + 'px',\r\n      top:  -layerOffset.y - this._buffer + 'px'\r\n    });\r\n  }\r\n      \r\n});/**\r\n * Overlay   Layer\r\n */\r\n$class('olleh.maps.overlay.OverlayLayer').extend(olleh.maps.layer.Layer).define({\r\n  \r\n  /**\r\n   * OverlayLayer name: olleh.maps.overlay.OverlayLayer \r\n   * @type String\r\n   * @private\r\n   */\r\n  name: 'olleh.maps.overlay.OverlayLayer',\r\n  \r\n  label: '',\r\n  \r\n  autoActivate: true,\r\n\r\n  /**\r\n   * overlay draw   buffer   viewport    . \r\n   * 1   viewport    buffer   0   buffer   .\r\n   *  zoom in animation  move  draw          . \r\n   *  (moveStart() ) buffer  overlay  draw/erase   . \r\n   * @type Number\r\n   * @private\r\n   */\r\n  buffeSize: 0.2,\r\n  \r\n  /**\r\n   * lower overlay pane   z-index.  pane  1  .\r\n   * @type Number\r\n   * @private\r\n   */\r\n  baseIndex: 1000,\r\n  \r\n  /**\r\n   * true   Overlay   . default: false \r\n   * @type Boolean\r\n   * @private\r\n   */\r\n  disableShadow: false,\r\n  \r\n  /**\r\n   * Overlay Pane id:\r\n   * <ul>\r\n   *  <li>lower_overlay_pane</li>\r\n   *  <li>overlay_shadow_pane</li>\r\n   *  <li>upper_overlay_pane</li>\r\n   *  <li>infowindow_shadow_pane</li>\r\n   *  <li>infowindow_pane</li>\r\n   * </ul>\r\n   * @private\r\n   */\r\n  paneIds: ['lower_overlay_pane', 'overlay_shadow_pane', 'upper_overlay_pane',\r\n             'infowindow_shadow_pane', 'infowindow_pane'],\r\n  /**\r\n   * ,   .\r\n   */\r\n  OverlayLayer: function () {\r\n    this._visible = true;\r\n    this._overlays = [];\r\n    this._displayedOverlays = {};\r\n    /**\r\n     *  Overlay Panes\r\n     *  @type Object\r\n     *  @private \r\n     */\r\n    this.panes = {};\r\n    var pane, paneId;\r\n    for (var i = 0; i < this.paneIds.length; i++) {\r\n      paneId = this.paneIds[i];\r\n      pane = this.panes[paneId] = document.createElement('div');\r\n      pane.style.position = 'absolute';\r\n      pane.style.zIndex = 1000 + i;\r\n    }\r\n    this._gridIndex = new olleh.maps.overlay.GridIndex(10000);\r\n  },\r\n  \r\n  start: function() {\r\n    olleh.maps.overlay.OverlayLayer.$super.start.call(this);\r\n    this.disableShadow = this.map.getOption('disableShadow', false);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event}\r\n   * @param {Object} payload\r\n   * @private\r\n   */\r\n  $current_bounds_changed: function (event, payload) {\r\n    var o = event.getSource();\r\n\r\n    this._gridIndex.remove(o, payload.from);\r\n    this._gridIndex.add(o);\r\n    this._updateSingleOverlayDisplayHint(o);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event}\r\n   * @param {Object} payload\r\n   * @private\r\n   */\r\n  $current_position_changed: function (event, payload) {\r\n    var o = event.getSource();\r\n    if(!o.getBounds()) {\r\n      this._gridIndex.remove(o, payload.from);\r\n      this._gridIndex.add(o);\r\n      this._updateSingleOverlayDisplayHint(o);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * <code>paneId</code>   pane   .\r\n   * @returns {Element}\r\n   */\r\n  getPane: function (paneId) {\r\n    return this.panes[paneId];\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer    Overlay  .\r\n   * @returns {Array.<olleh.maps.overlay.Overlay>} Overay \r\n   */\r\n  getOverlays: function () {\r\n    return this._overlays;\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer   .\r\n   * @param {boolean} visible false   OverlayLayer   .\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible != visible) {\r\n      this._visible = visible;\r\n      visible && this.draw();\r\n      var overlayPanes = this.panes;\r\n      var visibility = visible ? 'block' : 'none';\r\n      for (var i in overlayPanes) {\r\n        overlayPanes[i].style.display = visibility;\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer  visible   .\r\n   * @returns {boolean} visilbe \r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer  Overlay   .\r\n   * @param {olleh.maps.overlay.Overlay} overlay Overlay \r\n   * @private\r\n   */\r\n  add: function (overlay) {\r\n   // layer   attach   remove   .\r\n    overlay.layer = this; \r\n   // zoom animation  animation    .\r\n    if (this.layerMgr.isZooming()) {\r\n      if(!this._toAddOverlaysAtZoomEnd)\r\n        this._toAddOverlaysAtZoomEnd = [];\r\n      this._toAddOverlaysAtZoomEnd.push(overlay);\r\n      return;\r\n    }\r\n    this._overlays.push(overlay);\r\n    if(overlay.getPosition() || overlay.getBounds())\r\n      this._gridIndex.add(overlay);\r\n    if (this.isStarted()) {\r\n      overlay.fireEvent('attached');\r\n      this._updateSingleOverlayDisplayHint(overlay);\r\n      overlay.draw(true);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer  Overlay   .\r\n   * @param {olleh.maps.overlay.Overlay} overlay\r\n   * @private\r\n   */\r\n  remove: function (overlay) {\r\n    this._gridIndex.remove(overlay);\r\n    if(!this._toAddOverlaysAtZoomEnd\r\n        || olleh.maps.util.removeFromArray(this._toAddOverlaysAtZoomEnd, overlay) === -1) {\r\n      if (this.isStarted()) {\r\n        overlay.erase(true);\r\n      }\r\n      overlay.fireEvent('detached');\r\n      olleh.maps.util.removeFromArray(this._overlays, overlay);\r\n    }\r\n    var id = overlay.getId();\r\n    if(this._displayedOverlays[id]) {\r\n      delete this._displayedOverlays[id];\r\n    }\r\n    overlay.layer = null;\r\n  },\r\n\r\n  /**\r\n   * Pan Animation  .\r\n   * @private\r\n   */\r\n  moveStart: function () {\r\n  },\r\n\r\n  /**\r\n   * Pan Animation   .\r\n   * @private\r\n   */\r\n  moveEnd: function () {\r\n    var layerBoundsChanged;\r\n    var center = this._center;\r\n    var currentCenter = this.layerMgr.getCenter();\r\n    if (center) {\r\n      var bufferBounds = this._getBufferBounds(new olleh.maps.Bounds(center, center));\r\n      layerBoundsChanged = !bufferBounds.contains(currentCenter);\r\n    } else {\r\n      layerBoundsChanged = true;\r\n    }\r\n    if (layerBoundsChanged) {\r\n      this._center = currentCenter;\r\n      this._onBoundsChanged();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Zoom Animation  .\r\n   * @param {Number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {Number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   * @private\r\n   */\r\n  zoomStart: function (scale, origin, duration, pulse) {\r\n    var i, overlay, overlays = this._overlays;\r\n    for ( i = overlays.length - 1; i >= 0; i--) {\r\n      overlay = this._overlays[i];\r\n      overlay.zoomStart(scale, origin, duration, pulse);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Zoom Animation   .\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n    var i, overlay, overlays = this._overlays;\r\n    for ( i = overlays.length - 1; i >= 0; i--) {\r\n      overlay = this._overlays[i];\r\n      overlay.zoomEnd();\r\n    }\r\n    this._onBoundsChanged();\r\n    // zoom animation   overlay   .\r\n    if(this._toAddOverlaysAtZoomEnd) {\r\n      var toAddOverlaysAtZoomEnd = this._toAddOverlaysAtZoomEnd;\r\n      delete this._toAddOverlaysAtZoomEnd;\r\n      for(i = 0, len = toAddOverlaysAtZoomEnd.length; i < len; i++) {\r\n        this.add(toAddOverlaysAtZoomEnd[i]);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Overlay Layer  .\r\n   * @param {Boolean} isMapStart     draw   true .\r\n   * @private\r\n   */\r\n  draw: function (isMapStart) {\r\n    var i, o, overlays = this._overlays;\r\n    for ( i = overlays.length - 1; i >= 0; i--) {\r\n      o = overlays[i];\r\n      o.draw(isMapStart);\r\n    }\r\n    this._onBoundsChanged();\r\n  },\r\n  \r\n  /**\r\n   * Overlay  bounds   .\r\n   */\r\n  _onBoundsChanged: function() {\r\n    var from = this._bounds;\r\n    this._bounds = null;\r\n    var to = this.getBounds();\r\n    this._updateAllOverlayDisplayHint();\r\n    /**\r\n     * OverlayLayer  buffer bounds    .\r\n     * @name event:overlay_layer_bounds_changed\r\n     * @event\r\n     * @memberOf olleh.maps.overlay.OverlayLayer.prototype\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('overlay_layer_bounds_changed', {from: from, to: to});\r\n  },\r\n  \r\n\r\n  /**\r\n   * Buffer  .\r\n   * @returns {olleh.maps.Size} Buffer \r\n   * @private\r\n   */\r\n  _getBufferSize: function () {\r\n    var viewportSize = this.layerMgr.getViewportSize();\r\n    return viewportSize.multiplyBy(this.buffeSize);\r\n  },\r\n  \r\n  /**\r\n   * OverlayLayer bounds  . OverlayLayer bounds  buffer    viewport bounds    .\r\n   * @returns {olleh.maps.Bounds}\r\n   */\r\n  getBounds: function() {\r\n    // _getBufferBounds          .\r\n    // bounds    (onBoundsChanged()  this._bounds  null   .\r\n    if(!this._bounds) {\r\n      this._bounds = this._getBufferBounds();\r\n    }\r\n    return this._bounds; \r\n  },\r\n\r\n  /**\r\n   * Overlay draw   Buffer Bounds  .\r\n   * @param {olleh.maps.Bounds} [bounds]\r\n   * @returns {olleh.maps.Bounds}\r\n   * @private\r\n   */\r\n  _getBufferBounds: function (bounds) {\r\n    var lm = this.layerMgr;\r\n    var resolution = lm.getResolution();\r\n    var buffer = this._getBufferSize();\r\n    return (bounds || lm.getBounds()).expand(buffer.width * resolution, buffer.height * resolution);\r\n  },\r\n  \r\n  /**\r\n   *  overlay  display hint   .\r\n   * @private\r\n   */\r\n  _updateAllOverlayDisplayHint: function() {\r\n    var i, id, overlay, overlays = {};\r\n    var overlaysAsArray = this._gridIndex.getOverlays(this.getBounds());\r\n    for (i = 0; i < overlaysAsArray.length; i++) {\r\n      overlay = overlaysAsArray[i];\r\n      overlays[overlay.getId()] = overlay;\r\n    }\r\n    for(id in this._displayedOverlays) {\r\n      if (!overlays[id]) {\r\n        this._displayedOverlays[id].setDisplayHint(false);\r\n        delete this._displayedOverlays[id]; \r\n      }\r\n    }\r\n    for(id in overlays) {\r\n      if(!this._displayedOverlays[id]) {\r\n        overlays[id].setDisplayHint(true);\r\n        this._displayedOverlays[id] = overlays[id];\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  overlay  display hint   .\r\n   * @param {olleh.maps.Overlay} overlay Overlay\r\n   * @private\r\n   */\r\n  _updateSingleOverlayDisplayHint: function(overlay) {\r\n    var displayHint = this.getBounds().intersects(overlay.getBounds() || overlay.getPosition());\r\n    overlay.setDisplayHint(displayHint);\r\n    if(displayHint) {\r\n      this._displayedOverlays[overlay.getId()] = overlay;\r\n    } else if(this._displayedOverlays[overlay.getId()]) {\r\n      delete this._displayedOverlays[overlay.getId()];\r\n    }\r\n  }\r\n  \r\n});\r\n/**\n *     .\n */\n$class('olleh.maps.overlay.GridIndex').define({\n  \n  /**\n   * \n   * @param {number} cellSize\n   */\n  GridIndex: function (cellSize) {\n    this._cellSize = cellSize;\n    this._grid = [];\n  },\n\n  /**\n   * \n   * @param {olleh.maps.overlay.Overlay} overlay\n   * @param {olleh.maps.Coord|olleh.maps.Bounds} [arg]\n   */\n  add: function (overlay, arg) {\n    var x, y, col, cell;\n    var range = this._getCellRange(arg || overlay.getIndexObject());\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        col = this._grid[x] = [];\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (!cell) {\n          col[y] = [overlay];\n        } else {\n          cell.push(overlay);\n        }\n      }\n    }\n  },\n\n  /**\n   * \n   * @param {olleh.maps.overlay.Overlay} overlay\n   * @param {olleh.maps.Coord|olleh.maps.Bounds} [arg]\n   */\n  remove: function (overlay, arg) {\n    var i, x, y, col, cell;\n    var range = this._getCellRange(arg || overlay.getIndexObject());\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        continue;\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (cell) {\n          i = olleh.maps.util.indexOf(cell, overlay);\n          if (i != -1) {\n            cell.splice(i, 1);\n          }\n        }\n      }\n    }\n  },\n\n  clear: function () {\n    var x, y, o, xMax, yMax, oMax, overlays;\n    var gridX, gridY;\n\n    for(x = 0, gridX = this._grid, xMax = gridX ? gridX.length : 0; x < xMax; x++) {\n      for(y = 0, gridY = this._grid[x], yMax = gridY ? gridY.length : 0; y < yMax; y++) {\n        for(o = 0, overlays = this._grid[x][y], oMax = overlays ? overlays.length : 0; o < oMax; o++) {\n          overlays[o].setMap(null);\n        }\n      }\n    }\n  },\n  \n  /**\n   * \n   * @param {olleh.maps.overlay.Overlay} overlay\n   * @returns {boolean}\n   */\n  contains: function (overlay) {\n    var x, y, col, cell;\n    var range = this._getCellRange(overlay.getIndexObject());\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        continue;\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (cell && olleh.maps.util.indexOf(cell, overlay) != -1) {\n          return true;\n        }\n      }\n    }\n    \n    return false;\n  },\n  \n  /**\n   * \n   * @param {olleh.maps.Bounds} bounds\n   * @returns {object}\n   */\n  getOverlays: function (bounds) {\n    var x, y, col, cell, overlay, result = [];\n    var range = this._getCellRange(bounds);\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        continue;\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (!cell) {\n          continue;\n        }\n        for (var i = 0; i < cell.length; i++) {\n          overlay = cell[i];\n          if (bounds.intersects(overlay.getIndexObject())) {\n            result.push(overlay);\n          }\n        }\n      }\n    }\n    \n    return result;\n  },\n  \n  /**\n   * \n   * @private\n   * @param {olleh.maps.Coord|olleh.maps.Bounds} arg\n   * @returns {Object}\n   */\n  _getCellRange: function (arg) {\n    var minX, minY, maxX, maxY;\n    var cellSize = this._cellSize;\n\n    arg = arg.asDefault();\n    if (arg.x !== undefined && arg.y !== undefined) {\n      minX = maxX = Math.floor(arg.x / cellSize);\n      minY = maxY = Math.floor(arg.y / cellSize);\n    } else {\n      minX = Math.floor(arg.leftBottom.x / cellSize);\n      minY = Math.floor(arg.leftBottom.y / cellSize);\n      maxX = Math.floor(arg.rightTop.x / cellSize);\n      maxY = Math.floor(arg.rightTop.y / cellSize);\n    }\n\n    return {\n      minX: minX,\n      minY: minY,\n      maxX: maxX,\n      maxY: maxY\n    };\n  }\n  \n});/**\r\n *   Plugin     \r\n */\r\n$class('olleh.maps.PluginRegistry').mixin(olleh.maps.event.EventDelegator)\r\n    .define({\r\n      \r\n      /**\r\n       *      \r\n       * @name plugin_added\r\n       * @event\r\n       * @memberOf olleh.maps.PluginRegistry.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       *      \r\n       * @name plugin_removed\r\n       * @event\r\n       * @memberOf olleh.maps.PluginRegistry.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n\r\n      /**\r\n       * ,   .\r\n       */\r\n      PluginRegistry: function () {\r\n        this._plugins = [];\r\n        this._drawingTools = [];\r\n      },\r\n\r\n      /**\r\n       * Plugin  .\r\n       * @param {olleh.maps.Plugin} plugin\r\n       */\r\n      add: function (plugin) {\r\n        plugin.pluginRegistry = this;\r\n        this._plugins.push(plugin);\r\n        this.fireEvent('plugin_added', {\r\n          plugin: plugin\r\n        });\r\n        if(plugin.pluginInfo && plugin.pluginInfo.drawingTool) {\r\n          this._drawingTools.push(plugin);\r\n        }\r\n      },\r\n\r\n      /**\r\n       * Plugin  .\r\n       * @param {olleh.maps.Plugin} plugin\r\n       */\r\n      remove: function (plugin) {\r\n        if (plugin.active)\r\n          plugin.deactivate();\r\n        olleh.maps.util.removeFromArray(this._plugins, plugin);\r\n        olleh.maps.util.removeFromArray(this._drawingTools, plugin);\r\n        this.fireEvent('plugin_removed', {\r\n          plugin: plugin\r\n        });\r\n        plugin.pluginRegistry = null;\r\n      },\r\n      \r\n      /**\r\n       *  plugin  .\r\n       * @returns {Array.<olleh.maps.Plugin>} \r\n       */\r\n      getPlugins: function() {\r\n        return this._plugins;\r\n      },\r\n\r\n      /**\r\n       * label   plugin  group  .\r\n       * group    plugin  $nogroup  .\r\n       * @returns {Object} property: {String} group , value: {olleh.maps.Plugin[]} plugin \r\n       */\r\n      getLabeledPluginsByGroup: function () {\r\n        var plugins = this._plugins;\r\n        var pluginsByGroup = {};\r\n        for ( var i = 0 , len = plugins.length ; i < len ; i++) {\r\n          var p = plugins[i];\r\n          var pluginInfo = p.pluginInfo;\r\n          if(!pluginInfo || !pluginInfo.label)\r\n            continue;\r\n          var groupId = pluginInfo.group ? pluginInfo.group : '$nogroup';\r\n          var arrs = pluginsByGroup[groupId];\r\n          if (!arrs) {\r\n            arrs = [];\r\n            pluginsByGroup[groupId] = arrs;\r\n          }\r\n          arrs.push(p);\r\n        }\r\n        return pluginsByGroup;\r\n      },\r\n\r\n      /**\r\n       * drawingTool  active    plugin  .\r\n       * @param {olleh.maps.Plugin} plugin active  plugin \r\n       * @private\r\n       */\r\n      drawingToolActivate: function(plugin) {\r\n        for(var i = this._drawingTools.length - 1 ; i >= 0 ; i-- ) {\r\n          if(this._drawingTools[i] !== plugin) {\r\n            this._drawingTools[i].deactivate();\r\n          }\r\n        }\r\n      }\r\n      \r\n    });////////////////\r\n//  Map  //\r\n////////////////\r\n/**\r\n * Map \r\n * @typedef olleh.maps.MapOptions\r\n * @property {olleh.maps.Bounds} [maxExtent]    .      maxExtent    .\r\n *                                     restrictedExtent   . <br/>\r\n *                                 . <pre> Left: 171162, Bottom: 1214781, Right: 1744026, Top: 2787645 </pre>\r\n * @property {olleh.maps.Bounds} [restrictedExtent]       . restrictedExtent   panning   \r\n *                               maxExtent     maxExtent      . <br/>  \r\n *                                 . <pre> Left: 171162, Bottom: 1214781, Right: 1744026, Top: 2787645 </pre>\r\n * @property {Boolean} [trackWindowSize=true] true   window resize     . \r\n * @property {Number} [panAnimEaseLinearity1=0.5] pan animation   cubic bezier timing function  y1 .    .\r\n * @property {Number} [panAnimEaseLinearity2=0.25] pan animation   cubic bezier timing function  x2 .    . \r\n * @property {olleh.maps.Coord} center     \r\n * @property {Number} [zoom=7]    . \r\n * @property {Number} [minZoom=0]   . \r\n * @property {Number} [maxZoom=13]   =>15. \r\n * @property {Number} [panAnimDuration=1.0] panTo()/panBy()  animation  .  .\r\n * @property {Number} [zoomAnimDuration=0.3] zoomIn()/zoomOut()/zoomTo()  animation  .  .\r\n * @property {Boolean} [useCSSTransform=true] panning  CSS3 transform   . \r\n * @property {Boolean} [disableDefaultUI=false]    .\r\n * @property {Boolean} [copyrightControl=true] CopyrightControl  . \r\n * @property {olleh.maps.control.CopyrightControlOptions} [copyrightControlOptions] CopyrightControl \r\n * @property {Boolean} [logoControl=true] LogoControl  .\r\n * @property {olleh.maps.control.LogoControlOptions} [logoControlOptions] LogoControl \r\n * @property {Boolean} [mapTypeControl=true] MapTypeControl  . \r\n * @property {olleh.maps.control.ControlOptions} [mapTypeControlOptions] MapTypeControl  \r\n * @property {Boolean} [panControl=true] PanControl  . \r\n * @property {olleh.maps.control.ControlOptions} [panControlOptions] PanControl   \r\n * @property {Boolean} [scaleControl=true] ScaleControl  .\r\n * @property {olleh.maps.control.ControlOptions} [scaleControlOptions] ScaleControl \r\n * @property {Boolean} [zoomControl=true] ZoomControl  .\r\n * @property {olleh.maps.control.ZoomControlOptions} [zoomControlOptions] ZoomControl \r\n * @property {Number} [tileLayerBufferNum=0]     .\r\n * @property {Number} [tileLayerUpdateInterval=.1]      .  .\r\n * @property {Boolean} [tileFadeInDuration=.3]     .  . 0    .\r\n * @property {Boolean} [measureControl=true] MeasureControl  .\r\n * @property {olleh.maps.control.MeasureControlOptions} [measureControlOptions] MeasureControl \r\n * @property {Boolean} [dragInertia=true]    .\r\n * @property {Number} [dragInertiaThreshold]         delay .       .\r\n * @property {Number} [dragInertiaDeceleration]       \r\n * @property {Boolean} [disableDoubleClickZoom=false] true      .\r\n * @property {Boolean} [disableMultiTapZoom=false] true       .\r\n * @property {Boolean} [disablePinchZoom=false] true     . \r\n * @property {Boolean} [disableScrollWheelZoom=false] true      .\r\n * @property {Boolean} [disableShadow=false] true       .\r\n * @property {String} [mapTypeId]  MapType id\r\n * @property {Boolean} [useEngMap=false]   , true     , false   \r\n * @property {boolean} [disableDraggingCursor=true] true         .\r\n * @property {Number} [longpressThreshold=750]    (ms)   <code>longpress</code>  .\r\n * @property {string} [disableLoadingWhilePanning=false] true            . \r\n                                             true     false .\r\n * @group Map\r\n */\r\n\r\n//  HD      \r\n// * @property {Boolean} [hd=false] HD   . \r\n\r\n// JsDoc    map option.     \r\n// * @property {String} [draggingCursor]      CSS   URL. <p/> see: {@link olleh.maps.Map#setCursor}\r\n// * @property {String} [draggableCursor]   CSS   URL\r\n// * @property {olleh.maps.overlay.OverlayLayer} overlayLayer OverlayLayer instance. internal use only\r\n\r\n\r\n/**\r\n * Map \r\n */\r\n$class('olleh.maps.Map').mixin(olleh.maps.event.EventDelegator).define({\r\n  \r\n  $static: {\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_LEFT:171162,\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_BOTTOM:1214781,\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_RIGHT: 1744026,\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_TOP: 2787645,\r\n    /**\r\n     *  MapType id. ROADMAP\r\n     * @type String\r\n     */\r\n    ROADMAP: 'ROADMAP',\r\n    /**\r\n     *  MapType id. SATELLITE\r\n     * @type String\r\n     */\r\n    SATELLITE: 'SATELLITE',\r\n    /**\r\n     *  MapType id. HYBRID\r\n     * @type String\r\n     */\r\n    HYBRID: 'HYBRID',\r\n    /**\r\n     *  MapType id. ENGMAP\r\n     * @type String\r\n     */\r\n    ENGMAP: 'ENGMAP',\r\n    /**\r\n     *      \r\n     * @type Number\r\n     */\r\n    DEFAULT_NORMAL_MAX_ZOOM: 13\r\n  },\r\n  \r\n  defaultOpts: {\r\n    mapTypeId: 'ROADMAP',\r\n    maxExtent: new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(171162, 1214781), // leftBottom\r\n        new olleh.maps.UTMK(1744026, 2787645) // rightTop\r\n    ),\r\n    restrictedExtent: new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(171162, 1214781), // leftBottom\r\n        new olleh.maps.UTMK(1744026, 2787645) // rightTop  \r\n    ),\r\n    trackWindowSize: true,\r\n    panAnimEaseLinearity1: 0.5,\r\n    panAnimEaseLinearity2: olleh.maps.browser.isMobile ? 0.7 : 0.25,\r\n    disableDraggingCursor: true,\r\n    draggingCursor: 'url(' + olleh.maps.env.RESOURCE_URL + 'cursor/closedhand_8_8.cur), move',\r\n    draggableCursor: 'url(' + olleh.maps.env.RESOURCE_URL + 'cursor/openhand_8_8.cur), default',\r\n    disableLoadingWhilePanning: olleh.maps.browser.osName === 'Android',\r\n    useEngMap: false,\r\n  },\r\n  \r\n  /**\r\n   * ,  HTML elem, opts    .\r\n   * @param {HTMLElement|String} elem Map   HTML element   element  id\r\n   * @param {olleh.maps.MapOptions} opts Map \r\n   */\r\n  Map: function (elem, opts) {\r\n    if(!elem) {\r\n      throw Error('Map element must be specified.');\r\n    }\r\n    if(olleh.maps.isString(elem)) {\r\n      elem = document.getElementById(elem);\r\n    }\r\n    var skeleton = olleh.maps.$skeleton;\r\n    this._defaultOpts = olleh.maps.util.clone(this.defaultOpts);\r\n    this._opts = opts;\r\n    this._cursor = 'ollehmap-default';\r\n    olleh.maps.util.dom.addClass(elem, 'ollehmap');\r\n    this.elem = elem;\r\n    this._cursors = [];\r\n\r\n    // setting whether English Map \r\n    this._setUseEngMap(this._opts.useEngMap);\r\n    \r\n    /**\r\n     * hasMobileStylesheet   CSS   .\r\n     * @type Boolean\r\n     */\r\n    this.hasMobileStylesheet =  false;\r\n    /**\r\n     * Service registry.   service    .\r\n     * {@link olleh.maps.Adaptable}  mixin     {@link olleh.maps.Adaptable#serviceId} field  \r\n     *      serviceId    services  .   \r\n     * @type Object\r\n     */\r\n    this.services = {};\r\n    /**\r\n     * MapType   Registry.\r\n     *  , ,   Layer   MapType  .\r\n     * @type Object\r\n     */\r\n    this._mapTypeRegistry = {};\r\n    \r\n    /**\r\n     * Plugin Registry.   Plugin    .\r\n     * @type olleh.maps.PluginRegistry\r\n     */\r\n    this.pluginRegistry = new olleh.maps.PluginRegistry();\r\n    /**\r\n     * EventManager   .\r\n     * @type olleh.maps.event.EventManager\r\n     */\r\n    this.eventMgr = new olleh.maps.event.EventManager(this, elem);\r\n    /**\r\n     * LayerManager       .\r\n     * @type olleh.maps.layer.LayerManager\r\n     */\r\n    this.layerMgr = new olleh.maps.layer.LayerManager(this, elem);\r\n    /**\r\n     * ControlManager   .\r\n     * @type olleh.maps.control.ControlManager\r\n     */\r\n    this.controlMgr = new olleh.maps.control.ControlManager(this);\r\n    \r\n    for (var i = 0, len = skeleton.length; i < len; i++) {\r\n      new skeleton[i]().setMap(this);\r\n    }\r\n    \r\n    if(this._opts.center)\r\n      this.start();\r\n  },\r\n  \r\n  /**\r\n   * user option  default option  merge   manager  start .  \r\n   * @private\r\n   */\r\n  start: function () {\r\n    // merge default opts\r\n    this._opts = olleh.maps.mixin(this._opts, this._defaultOpts);\r\n\r\n    if(this._opts.mapTypeId) {\r\n      this.setMapTypeId(this._opts.mapTypeId);\r\n    }\r\n    this._started = true;\r\n    this.eventMgr.start();\r\n    this.layerMgr.start();\r\n    this.controlMgr.start();\r\n    this.fireEvent('started');\r\n    this.setCursor(null);\r\n    if(olleh.maps.browser.hasOrientationChange) {\r\n      this._orientation = window.orientation;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {Boolean}   \r\n   */\r\n  _setUseEngMap:function(useEngMap){\r\n    this._useEngMap = useEngMap;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Boolean}   \r\n   */\r\n  getUseEngMap:function(){\r\n    return this._useEngMap;\r\n  },\r\n\r\n  /**\r\n   * Map  stop .\r\n   * @private\r\n   */\r\n  stop: function () {\r\n    this._started = false;\r\n    this.fireEvent('stopped');\r\n  },\r\n\r\n  /**\r\n   * Map  start    .\r\n   * @returns {Boolean}\r\n   * @private\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n\r\n  /**\r\n   * MapType   Plugin  .\r\n   * \r\n   * @param {String} id map type id\r\n   * @param {olleh.maps.Plugin|String} mapTypePlugin map type   Plugin,Layer  layer name .\r\n   */\r\n  registerMapType: function(id, mapTypePlugin) {\r\n    if(id === olleh.maps.Map.ENGMAP && !this.getUseEngMap()) return;\r\n\r\n    if(olleh.maps.isString(mapTypePlugin)) {\r\n      mapTypePlugin = this.layerMgr.getLayer(mapTypePlugin);\r\n    }\r\n    this._mapTypeRegistry[id] = mapTypePlugin;\r\n    mapTypePlugin.setMap(this);\r\n    if(this._mapTypeId === id) {\r\n      this._mapTypeId = null;\r\n      this.setMapTypeId(id);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * MapType id   plugin   . \r\n   * @param id MapType Id\r\n   */\r\n  unregisterMapType: function(id) {\r\n    delete this._mapTypeRegistry[id];\r\n  },\r\n  \r\n  /**\r\n   * MapType registry  .\r\n   * @returns {Object} key: MapType id, value: MapType plugin\r\n   */\r\n  getMapTypeRegistry: function() {\r\n    return this._mapTypeRegistry;\r\n  },\r\n  \r\n  /**\r\n   * {@link olleh.maps.Map#setMapTypeId(id)}   MapType     \r\n   * @name event:maptypeid_changed\r\n   * @event\r\n   * @memberOf olleh.maps.Map.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} payload\r\n   * @param {String} payload.mapTypeId\r\n   */\r\n  /**\r\n   *  MapType id  .\r\n   * @param id MapType Id\r\n   */\r\n  setMapTypeId: function(id) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#setMapTypeId: ' + id);\r\n    \r\n    //   ,     id olleh.maps.Map.ROADMAP  \r\n    if(id === olleh.maps.Map.ENGMAP && !this.getUseEngMap()) id = olleh.maps.Map.ROADMAP;\r\n\r\n    if(this._mapTypeId !== id) {\r\n      var oldMapTypePlugin = this._mapTypeRegistry[this._mapTypeId];\r\n      oldMapTypePlugin && oldMapTypePlugin.deactivate();\r\n      this._mapTypeId = id;\r\n      var mapTypePlugin = this._mapTypeRegistry[id];\r\n      mapTypePlugin.activate();\r\n      this.fireEvent('maptypeid_changed', {\r\n        mapTypeId: id\r\n      });\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  MapType id  .\r\n   * @returns {String}\r\n   */\r\n  getMapTypeId: function() {\r\n    return this._mapTypeId;\r\n  },\r\n  \r\n  /**\r\n   *  layer name   Layer   .\r\n   * @param {String} layerName\r\n   */\r\n  getLayer: function(layerName) {\r\n    return this.layerMgr.getLayer(layerName);\r\n  },\r\n  \r\n  /**\r\n   *   base layer  .\r\n   * @returns {Array.<olleh.maps.layer.Layer>} Base Layer \r\n   */\r\n  getBaseLayers: function() {\r\n    return this.layerMgr.getBaseLayers();\r\n  },\r\n  \r\n  /**\r\n   *   ground layer  .\r\n   * @returns {Array.<olleh.maps.layer.Layer>} Ground Layer \r\n   */\r\n  getGroundLayers: function() {\r\n    return this.layerMgr.getGroundLayers();\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @param {olleh.maps.Bounds} bounds   \r\n   * @returns {Number}  \r\n   */\r\n  getZoomForBounds: function(bounds) {\r\n    return this.layerMgr.getZoomForBounds(bounds);\r\n  },\r\n  \r\n  /**\r\n   *  coord    (bounds)   .\r\n   * @param {olleh.maps.Coord} coord \r\n   * @returns {Boolean}   \r\n   * @see olleh.maps.Map#getBounds\r\n   */\r\n  isValidCoord: function(coord) {\r\n    return this.layerMgr.isValidCoord(coord);\r\n  },\r\n  \r\n  /**\r\n   * OverlayLayer  .\r\n   * @returns {olleh.maps.overlay.OverlayLayer} OverlayLayer\r\n   */\r\n  getOverlayLayer: function () {\r\n    return this.layerMgr.getOverlayLayer();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Coord} coord  \r\n   */\r\n  setCenter: function (coord) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#setCenter: ' + coord);\r\n    this.layerMgr.isZooming() && this._warnZooming('setCenter');\r\n    this.layerMgr.setCenter(coord);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @returns {olleh.maps.UTMK}  \r\n   */\r\n  getCenter: function () {\r\n    this.layerMgr.isZooming() && this._warnZooming('getCenter');\r\n    return this.layerMgr.getCenter();\r\n  },\r\n\r\n  /**\r\n   *     .<br/>\r\n   *          \r\n   *            .  \r\n   * @returns {Number}  \r\n   */\r\n  getZoom: function () {\r\n    this.layerMgr.isZooming() && this._warnZooming('getZoom');\r\n    return this.layerMgr.getZoom();\r\n  },\r\n\r\n  /**\r\n   *      UTMK  .\r\n   * @returns {olleh.maps.Bounds}  \r\n   */\r\n  getBounds: function() {\r\n    this.layerMgr.isZooming() && this._warnZooming('getBounds');\r\n    return this.layerMgr.getBounds();\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {Number}   \r\n   */\r\n  getMinZoom: function() {\r\n    return this.layerMgr.getMinZoom();\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {Number}   \r\n   */\r\n  getMaxZoom: function() {\r\n    return this.layerMgr.getMaxZoom();\r\n  },\r\n\r\n  /**\r\n   *      . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            . <br/>\r\n   * :    zoom    {@link #getCenter()}  {@link #getZoom()}    center,zoom \r\n   *     .\r\n   * @param {Number} zoom  \r\n   */\r\n  setZoom: function (zoom) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#setZoom: ' + zoom);\r\n    this.layerMgr.isZooming() && this._warnZooming('setZoom');\r\n    this.layerMgr.setZoom(zoom);\r\n  },\r\n\r\n  /**\r\n   *       . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            .\r\n   */\r\n  zoomIn: function () {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#zoomIn');\r\n    this.layerMgr.isZooming() && this._warnZooming('zoomIn');\r\n    this.layerMgr.zoomIn();\r\n  },\r\n\r\n  /**\r\n   *       . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            .\r\n   */\r\n  zoomOut: function () {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#zoomOut');\r\n    this.layerMgr.isZooming() && this._warnZooming('zoomOut');\r\n    this.layerMgr.zoomOut();\r\n  },\r\n\r\n  /**\r\n   *              / .\r\n   * panToBounds()       .\r\n   * @param {olleh.maps.Bounds} bounds   \r\n   */\r\n  fitBounds: function (bounds) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#fitBounds: ' + bounds);\r\n    this.layerMgr.isZooming() && this._warnZooming('fitBounds');\r\n    this.layerMgr.fitBounds(bounds);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *              / .\r\n   * fitBounds()       . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            . \r\n   * @param {olleh.maps.Bounds} bounds   \r\n   */\r\n  panToBounds: function (bounds) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#panToBounds: ' + bounds.leftBottom.x + ', '+ bounds.leftBottom.y + ', '+ bounds.rightTop.x + ', '+ bounds.rightTop.x + ', ');\r\n    this.layerMgr.isZooming() && this._warnZooming('panToBounds');\r\n    this.layerMgr.panToBounds(bounds);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *            / . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            . <br/>\r\n   * :    zoom    {@link #getCenter()}  {@link #getZoom()}    center,zoom \r\n   *     . \r\n   * @param {olleh.maps.Coord} coord  \r\n   * @param {Number} [zoom]  \r\n   * @param {String} [animation=auto] 'off'     .\r\n   *                             'auto'            . \r\n   */\r\n  panTo: function (coord, zoom, animation) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#panTo: coord: ' + coord + ', zoom: ' + zoom);\r\n    this.layerMgr.isZooming() && this._warnZooming('panTo');\r\n    this.layerMgr.panTo(coord, zoom, animation);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *         .\r\n   * @param {Number} dx   \r\n   * @param {Number} dy   \r\n   */\r\n  panBy: function (dx, dy) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#panBy: dx: ' + dx + ' ,dy:' + dy);\r\n    this.layerMgr.isZooming() && this._warnZooming('panBy');\r\n    this.layerMgr.panBy(dx, dy);\r\n  },\r\n  \r\n  _warnZooming: function(fnName) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info(':    ' +  fnName +  '      .    .');\r\n  },\r\n  \r\n  \r\n  /**\r\n   * Viewport size  .\r\n   * @returns {olleh.maps.Size} Viewport size\r\n   */\r\n  getViewportSize: function () {\r\n    return this.layerMgr.getViewportSize();\r\n  },\r\n  \r\n  /**\r\n   *   max extent (  )  .\r\n   * @returns {olleh.maps.Bounds} max extetnt\r\n   */\r\n  getMaxExtent: function () {\r\n    return this._opts.maxExtent;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @example \r\n   * map.setCursor('url(...)');\r\n   * map.setCursor('default');\r\n   * map.setCursor('draggable');\r\n   * map.setCursor('dragging');\r\n   * @param {String} cursor   'default', 'draggable', 'dragging', CSS  . null    ('default'  'draggable')  .\r\n   * @see http://www.w3.org/TR/CSS21/ui.html#propdef-cursor|CSS  \r\n   */\r\n  setCursor: function (cursor) {\r\n    if(olleh.maps.browser.isMobile)\r\n      return;\r\n    var elem = this.elem;\r\n    if (!elem) return;\r\n    \r\n    if(this._cursors[this._cursors.length - 1] === cursor) return;\r\n    \r\n    var opts = this._opts;\r\n    if(!cursor) {\r\n      cursor = opts.disableDraggingCursor ? 'default' : 'draggable';\r\n    }\r\n    switch (cursor) {\r\n    case 'draggable':\r\n      cursor = opts.draggableCursor;\r\n      break;\r\n    case 'dragging':\r\n      cursor = opts.draggingCursor;\r\n      break;\r\n    }\r\n    this._cursors.push(cursor);\r\n    elem.style.cursor = cursor;\r\n  },\r\n  \r\n  /**\r\n   * {@link #setCursor(cursor)}   cursor   cursor  . \r\n   */\r\n  resetCursor: function() {\r\n    if (this._cursors.length <= 1) return;\r\n    this._cursors.pop();\r\n    this.elem.style.cursor = this._cursors[this._cursors.length - 1];\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @private\r\n   */\r\n  _checkStart: function() {\r\n    if(!this.isStarted()) {\r\n      this.start();\r\n    }\r\n  }, \r\n  \r\n  /**\r\n   * Map   .\r\n   * @returns {olleh.maps.MapOptions}\r\n   * @private\r\n   */\r\n  getOptions: function() {\r\n    return this._opts;\r\n  },\r\n  \r\n  /**\r\n   * Control   .\r\n   * @param {String} ctrlName\r\n   * @returns {Boolean} control  \r\n   * @private\r\n   */\r\n  checkDefaultControl: function(ctrlName){\r\n    var ctrlOpt = this.getOption(ctrlName);\r\n    var disableDefaultUI = this.getOption('disableDefaultUI', false);\r\n    return (ctrlOpt === true || !disableDefaultUI && ctrlOpt !== false);\r\n  },\r\n\r\n  /**\r\n   * Map   . \r\n   * @param {String} name Map  \r\n   * @param {object} defaultValue     \r\n   * @private\r\n   */\r\n  getOption: function(name, defaultValue) {\r\n    var value = this._opts[name];\r\n    return value !== undefined ? value : defaultValue;\r\n  },\r\n\r\n  /**\r\n   * Map   default    . \r\n   * default       . \r\n   * @param {Object} opts\r\n   * @private\r\n   */\r\n  mergeDefaultOptions: function(opts) {\r\n    olleh.maps.mixin(this._defaultOpts, opts, true);\r\n  },\r\n\r\n  /**\r\n   * [event:resize]\r\n   * trackWindowSize  true  resize     .\r\n   * @private\r\n   */\r\n  $default_resize: function (event, payload) {\r\n    if(this._opts.trackWindowSize) {\r\n      var ref = 'left';\r\n      //  orientation    center  .\r\n      if(payload.orientation !== undefined && payload.orientation !== this._orientation) {\r\n        ref = 'center';\r\n        this._orientation = payload.orientation;\r\n      }\r\n      this.layerMgr.resize(ref);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * viewport size       . \r\n   * Map element     element      .\r\n   * @param {String} [horizontalRef=left] left,right,center      . left     right      center  .\r\n   *  center   center   . center    verticalRef   .\r\n   * @param {String} [verticalRef=top] top  bottom    . top     bottom      center  . \r\n   */\r\n  resize: function(horizontalRef, verticalRef) {\r\n    this.layerMgr.resize(horizontalRef, verticalRef);\r\n  },\r\n  \r\n  /**\r\n   * Map   tooltip  .\r\n   * @returns {olleh.maps.overlay.Tooltip} Tooltip  \r\n   * @private\r\n   */\r\n  getTooltip: function() {\r\n    if(!this._tooltip && olleh.maps.overlay.Tooltip) {\r\n      this._tooltip = new olleh.maps.overlay.Tooltip();\r\n    }\r\n    return this._tooltip;\r\n  }\r\n\r\n});\r\n/**\r\n *   \r\n */\r\n$class('olleh.maps.layer.Tile').mixin(olleh.maps.event.EventDelegator).define({\r\n\r\n  /**\r\n   * ,  layer    .\r\n   * @param {olleh.maps.layer.TileLayer} layer\r\n   */\r\n  Tile: function (layer) {\r\n    this.setLayer(layer);\r\n    this._animationPolicy = 'none';\r\n    this._loading = false;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @return {olleh.maps.layer.TileLayer} \r\n   */\r\n  getLayer: function () {\r\n    return this._layer;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.layer.TileLayer} layer \r\n   */\r\n  setLayer: function (layer) {\r\n    this._layer = layer;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @return {olleh.maps.layer.TileLayer} \r\n   */\r\n  getBubble: function () {\r\n    return this._layer;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  setEffectPolicy: function (animationPolicy) {\r\n    this._animationPolicy = animationPolicy;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @return {boolean}\r\n   */\r\n  isLoading: function () {\r\n    return this._loading;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  getPosition: function () {\r\n    return this._position;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  setPosition: function (position) {\r\n    this._position = position;\r\n    this._root && this._updatePosition();\r\n  },\r\n\r\n  /**\r\n   * modify r2fresh\r\n   * @private\r\n   */\r\n  _getTileSize: function(){\r\n    var normalMaxZoom = olleh.maps.Map.DEFAULT_NORMAL_MAX_ZOOM;\r\n    var tileSize = this._layer.tileSize;\r\n    var zoom = this._layer.layerMgr.getZoom();\r\n    var tileSizeW = (zoom > normalMaxZoom) ? tileSize.width * ( (zoom - normalMaxZoom) * 2 ) : tileSize.width;\r\n    var tileSizeH = (zoom > normalMaxZoom) ? tileSize.height * ( (zoom - normalMaxZoom) * 2 ) : tileSize.height;\r\n    return {'width':tileSizeW,'height':tileSizeH}\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _updatePosition: function () {\r\n    // add r2fresh\r\n    var tileSize = this._getTileSize();\r\n\r\n    this._root.setStyles({\r\n      left: this._position.x + 'px',\r\n      top: this._position.y + 'px',\r\n      // add r2fresh\r\n      'width': tileSize.width + 'px',\r\n      'height': tileSize.height + 'px'\r\n    });\r\n  },\r\n\r\n  \r\n\r\n  /**\r\n   * @private\r\n   */\r\n  getURL: function () {\r\n    return this._url;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  setPositionAndUrl: function (position, url, animationPolicy) {\r\n    this._position = position;\r\n    this._url = url;\r\n    animationPolicy && (this._animationPolicy = animationPolicy);\r\n    this._root && this._update();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _update: function () {\r\n    // tileSize add r2fresh\r\n    var tileSize = this._getTileSize(), root = this._root, img = this._img, animation = this._layer.tileAnimation;\r\n    \r\n    this.stopAnimator();\r\n    this._updatePosition();\r\n    \r\n    if (img.getProperty('src') != this._url) {\r\n      img.setStyle({\r\n        'visibility': 'hidden',\r\n        //add r2fresh\r\n        'width': tileSize.width + 'px',\r\n        'height': tileSize.height + 'px'\r\n      });\r\n      this._loading = true;\r\n\r\n      if (animation && (this._animationPolicy == 'always' ||\r\n          (this._animationPolicy == 'once' && !this._layer.cachedTileURLs[this._url]))) {\r\n        root.setStyles(animation.from);\r\n        this._animator = animation.newAnimator(root, {\r\n          callback: this._fadedin.bind(this)\r\n        });\r\n      }\r\n\r\n      img.setStyle('visibility', '').setProperty('src', this._url);\r\n    } else if (!this._loading) {\r\n      this.fireEvent('loaded');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {HTMLElement}\r\n   */\r\n  getElement: function () {\r\n    var browser = olleh.maps.browser;\r\n    // modify tileSize r2fresh\r\n    var tileSize = this._getTileSize(), root = this._root, img = this._img;\r\n    \r\n    if (!root) {\r\n      if (browser.has3D && !browser.use3DRootPane) {\r\n        root = this._root = olleh.maps.Element.create('div').setStyles({\r\n          position: 'absolute',\r\n          width: tileSize.width + 'px',\r\n          height: tileSize.height + 'px',\r\n          transform: 'translateZ(0)'\r\n        });\r\n        \r\n        img = this._img = olleh.maps.Element.create('img').setStyles({\r\n          width: tileSize.width + 'px',\r\n          height: tileSize.height + 'px'\r\n        });\r\n\r\n        root.appendChild(img);\r\n      } else {\r\n        root = img = this._root = this._img = olleh.maps.Element.create('img').setStyles({\r\n          position: 'absolute',\r\n          width: tileSize.width + 'px',\r\n          height: tileSize.height + 'px'\r\n        });\r\n        \r\n        if (browser.has3D && browser.osName == 'iOS') {\r\n          img.setStyle('transform', 'translate3d(0,0,0)');\r\n        }\r\n      }\r\n\r\n      this._bound_onload = this._onload.bind(this);\r\n      this._bound_onerror = this._onerror.bind(this);\r\n      \r\n      img.addEventListener('load', this._bound_onload);\r\n      img.addEventListener('error', this._bound_onerror);\r\n      \r\n      this._update();\r\n    }\r\n    \r\n    return root.elem;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  stopAnimator: function () {\r\n    if (this._animator) {\r\n      this._animator.stop();\r\n      this._animator = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  destroy: function () {\r\n    this.stopAnimator();\r\n    if (this._root) {\r\n      this._img.removeEventListener('load', this._bound_onload);\r\n      this._img.removeEventListener('error', this._bound_onerror);\r\n      this._root = this._img = null;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _onerror: function () {\r\n    if (this._loading) {\r\n      this.stopAnimator();\r\n      this._loading = false;\r\n      this._img.setProperty('src', this._layer.errorTileURL);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _onload: function () {\r\n    if (this._loading) {\r\n      this._layer.cachedTileURLs[this._url] = true;\r\n\r\n      if (this._animator) {\r\n        this._animator.start();\r\n      } else {\r\n        this._loading = false;\r\n        this.fireEvent('loaded');\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _fadedin: function (isFinished) {\r\n    if (isFinished) {\r\n      this._loading = false;\r\n      this.fireEvent('loaded');\r\n    }\r\n  }\r\n\r\n});\r\n/**\r\n * @typedef olleh.maps.layer.TileLayerOptions \r\n * @extends olleh.maps.layer.LayerOptions\r\n * @property {number} [tileSize=new olleh.maps.Size(256, 256)]  .  .\r\n * @property {number} [minZoom=0]      .\r\n * @property {number} [maxZoom=13]      =>15.\r\n * @property {string} [errorTileURL]        URL.\r\n * @property {number} [maxWaitTime=3] /   . -1  .  .\r\n */\r\n//<-             L             ->\r\n//<- -D -><-      V      ->\r\n//<-B->                     <-B->\r\n//+---+---------------------+---+\r\n//|   |                     |   |\r\n//+---+                     +---+\r\n//|                             |\r\n//|       +---------------+     |\r\n//|       |               |     |\r\n//|       |               |     |\r\n//|       |   viewport    |     |\r\n//|       |               |     |\r\n//|       |               |     |\r\n//|       +---------------+     |\r\n//|                             |\r\n//|         tile layer          |\r\n//+-----------------------------+\r\n//L = TileLayer#_getLayerSize()\r\n//D = -TileLayer#_getDisplayOffset()\r\n//B = TileLayer#bufferNum * TileLayer#tileSize\r\n//V = LayerManager#getVierportSize()\r\n//L / B = TileLayer#getGridNum()\r\n\r\n/**\r\n *    ()     .\r\n */\r\n$class('olleh.maps.layer.TileLayer').extend(olleh.maps.layer.Layer).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type string\r\n     */\r\n    ERROR_TILE_URL: olleh.maps.env.RESOURCE_URL + 'img/tile_transparent.png',\r\n\r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type olleh.maps.Size\r\n     */\r\n    DEFAULT_TILE_SIZE: new olleh.maps.Size(256, 256),\r\n\r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_MAX_WAIT_TIME: 3,\r\n    \r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_UPDATE_INTERVAL: .1,\r\n\r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_BUFFER_NUM: 0,\r\n    \r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_TILE_FADE_IN_DURATION: .2\r\n  },\r\n  \r\n  /**\r\n   * ,   .\r\n   * @param {olleh.maps.layer.TileLayerOptions} opts .\r\n   */\r\n  TileLayer: function (opts) {\r\n    var TileLayer = olleh.maps.layer.TileLayer;\r\n\r\n    this.Tile = olleh.maps.layer.Tile;\r\n    this.tileSize = TileLayer.DEFAULT_TILE_SIZE;\r\n    this.minZoom = 0;\r\n    // modify r2fresh\r\n    //      maxZoom \r\n    // 13() => 15()\r\n    this.maxZoom = 15;\r\n    this.errorTileURL = TileLayer.ERROR_TILE_URL;\r\n    this.maxWaitTime = TileLayer.DEFAULT_MAX_WAIT_TIME;\r\n    \r\n    this._tileQueue = new olleh.maps.fx.AnimationFrameQueue();\r\n    this._tileQueue.setEnabled(false);\r\n    this._tiles = [];\r\n    this._movingBuffer = [];\r\n    this._visible = true;\r\n\r\n    this._pane = olleh.maps.Element.create('div').addClass('ollehmap-noevent').setStyle('position', 'absolute');\r\n    \r\n    this._createGridDiv();\r\n  },\r\n  \r\n  init: function () {\r\n    olleh.maps.mixin(this, this._constructorOpts, true, [ 'tileSize', 'getTileSize', 'minZoom', 'maxZoom', 'errorTileURL', 'maxWaitTime' ]);\r\n    olleh.maps.layer.TileLayer.$super.init.apply(this, arguments);\r\n  },\r\n  \r\n  start: function () {\r\n    var TileLayer = olleh.maps.layer.TileLayer;\r\n    var tileFadeInDuration = this.map.getOption('tileFadeInDuration', TileLayer.DEFAULT_TILE_FADE_IN_DURATION);\r\n    if (olleh.maps.browser.style.opacity && tileFadeInDuration !== 0) {\r\n      this.tileAnimation = new olleh.maps.fx.Animation({\r\n        from: {\r\n          opacity: '0'\r\n        },\r\n        to: {\r\n          opacity: '1'\r\n        },\r\n        duration: tileFadeInDuration,\r\n        timing: olleh.maps.fx.timing.easeOut\r\n      });\r\n    }\r\n    this.bufferNum = this.map.getOption('tileLayerBufferNum', TileLayer.DEFAULT_BUFFER_NUM);\r\n    this._updateInterval = this.map.getOption('tileLayerUpdateInterval', TileLayer.DEFAULT_UPDATE_INTERVAL);\r\n    this._disableLoadingWhilePanning = this.map.getOption('disableLoadingWhilePanning', false);\r\n    \r\n    //        (add code r2fresh)\r\n    var mapMaxZoom = this.map.getOptions().maxZoom;\r\n    this.maxZoom = (mapMaxZoom && mapMaxZoom <= 15) ? mapMaxZoom : this.maxZoom;\r\n  },\r\n\r\n  /**\r\n   * pane .\r\n   * @returns {HTMLElement} pane .\r\n   */\r\n  getPane: function () {\r\n    return this._pane.elem;\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {number}  .\r\n   */\r\n  getTileSize: function () {\r\n    // modify r2fresh\r\n    //    \r\n    var normalMaxZoom = olleh.maps.Map.DEFAULT_NORMAL_MAX_ZOOM;\r\n    var zoom = this.layerMgr.getZoom();\r\n    var tileSize = ( zoom > normalMaxZoom ) ? this.tileSize.multiplyBy((zoom - normalMaxZoom) * 2) : this.tileSize;\r\n    return tileSize;\r\n   // return this.tileSize;\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>.\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible != visible) {\r\n      this._visible = visible;\r\n      this._updateVisibility();\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @return {boolean} <code>true</code>  ,    .\r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _updateVisibility: function () {\r\n    this._pane.setStyle('display', this._visible && this.isVisibleForZoom() ? 'block' : 'none');\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @return {boolean}\r\n   */\r\n  isVisibleForZoom: function () {\r\n    var zoom;\r\n    if (!this.map) {\r\n      return false;\r\n    }\r\n    zoom = this.map.getZoom();\r\n    return this.minZoom <= zoom && zoom <= this.maxZoom;\r\n  },\r\n\r\n  \r\n  ////////////////////////////////////////\r\n  // Internal\r\n  ////////////////////////////////////////\r\n  \r\n  /**\r\n   *      .    .\r\n   * @private\r\n   * @returns {olleh.maps.Size}     .\r\n   */\r\n  _getLayerSize: function () {\r\n    var gridNum = this._gridNum;\r\n\r\n    // FIXME- android chrome  (#30257)\r\n    if (!gridNum) {\r\n      return;\r\n    }\r\n    var tileSize = this.getTileSize();\r\n\r\n    return new olleh.maps.Size(tileSize.width * gridNum.x,\r\n        tileSize.height * gridNum.y);\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @private\r\n   * @returns {olleh.maps.Point}      .\r\n   */\r\n  _getDisplayOffset: function () {\r\n    var offset = this._offset;\r\n    var layerOffset = this.layerMgr.getLayerOffset();\r\n    return new olleh.maps.Point(offset.x + layerOffset.x,\r\n        offset.y + layerOffset.y);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  _getTilePosition: function (x, y) {\r\n    var offset = this._offset;\r\n    var tileSize = this.getTileSize();\r\n    return new olleh.maps.Point(offset.x + x * tileSize.width,\r\n        offset.y + (this._gridNum.y - 1 - y) * tileSize.height);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _createGridDiv: function () {\r\n    this._div = olleh.maps.Element.create('div')\r\n        .setStyle('position', 'absolute')\r\n        .addClass('ollehmap-noevent');\r\n    this._pane.appendChild(this._div);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {string} url\r\n   * @returns {olleh.maps.layer.Tile}\r\n   */\r\n  _removeTileFromArray: function (url, arr) {\r\n    var i, l;\r\n    for (i = 0, l = arr.length; i < l; i++) {\r\n      if (arr[i].getURL() == url) {\r\n        return arr.splice(i, 1)[0];\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _getGridNum: function () {\r\n    var viewportSize = this.layerMgr.getViewportSize()\r\n    var tileSize = this.getTileSize();\r\n    var bufferNum = this.bufferNum;\r\n    return {\r\n      x: Math.ceil(viewportSize.width / tileSize.height) + 1 + bufferNum * 2,\r\n      y: Math.ceil(viewportSize.height / tileSize.width) + 1 + bufferNum * 2\r\n    };\r\n  },\r\n  \r\n  ////////////////////////////////////////\r\n  // Drawing\r\n  ////////////////////////////////////////\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cleanup: function (dontCleanZoomingBuffer) {\r\n    this.cachedTileURLs = {};\r\n    this._loadedTileNum = 0;\r\n    this._unloadedTileNum = 0;\r\n    \r\n    this._updateVisibility();\r\n    \r\n    this._stopUpdateTimer();\r\n    this._stopZoomAnimation();\r\n    \r\n    if (!dontCleanZoomingBuffer) {\r\n      this._cleanZoomingBufferDiv();\r\n    }\r\n\r\n    //         .\r\n    this._tileQueue.clear();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _calculate: function () {\r\n    var tileSize = this.getTileSize();\r\n    var tileOrigin = this.tileOrigin;\r\n    var resolution = this.layerMgr.getResolution();\r\n    var origin = this.layerMgr.getBounds().leftBottom;\r\n\r\n    var tileCoordSize = {\r\n      width: tileSize.width * resolution,\r\n      height: tileSize.height * resolution\r\n    };\r\n\r\n    //   \r\n    var coordOffset = {\r\n      x: origin.x - tileOrigin.x,\r\n      y: origin.y - tileOrigin.y\r\n    };\r\n    \r\n    //    \r\n    var index = {\r\n      x: Math.floor(coordOffset.x / tileCoordSize.width),\r\n      y: Math.floor(coordOffset.y / tileCoordSize.height)\r\n    };\r\n    \r\n    //    lb\r\n    var tileLeftBottom = new olleh.maps.UTMK(\r\n        index.x * tileCoordSize.width + tileOrigin.x,\r\n        index.y * tileCoordSize.height + tileOrigin.y);\r\n    \r\n    this._gridNum = this._getGridNum();\r\n    \r\n    this.index = index;\r\n    \r\n    //    point\r\n    this._offset = this.layerMgr.getLayerPxFromCoord(tileLeftBottom)\r\n        ._subtract(0, tileSize.height * this._gridNum.y);\r\n  },\r\n  \r\n  \r\n  /**\r\n   * @param {boolean} dontCleanZoomingBuffer\r\n   * @private\r\n   */\r\n  draw: function (dontCleanZoomingBuffer) {\r\n    var Tile = this.Tile;\r\n    var x, y, tile, tileInfo, tilePosition, tileUrl, gridNum;\r\n    var oldTiles = this._tiles;\r\n    var tiles = [];\r\n    var later = [];\r\n    var unloadedTileNum = 0;\r\n    \r\n    this._cleanup(dontCleanZoomingBuffer);\r\n\r\n    //      .\r\n    if (!this.isVisible() || !this.isVisibleForZoom()) {\r\n      return;\r\n    }\r\n    \r\n    this._calculate();\r\n    \r\n    //    .\r\n    this._grid = [];\r\n    gridNum = this._gridNum;\r\n    for (x = 0; x < gridNum.x; x++) {\r\n      this._grid[x] = [];\r\n\r\n      for (y = 0; y < gridNum.y; y++) {\r\n        tileUrl = this.getTileURL(x, y);\r\n        if (!tileUrl) {\r\n          continue;\r\n        }\r\n        \r\n        tilePosition = this._getTilePosition(x, y);\r\n        \r\n        //   URL        .\r\n        //     unloadedTileNum  .\r\n        //     later   .\r\n        tile = this._removeTileFromArray(tileUrl, oldTiles);\r\n        if (tile) {\r\n          tile.setPosition(tilePosition);\r\n          tiles.push(tile);\r\n          this._grid[x][y] = tile;\r\n        } else {\r\n          later.push({\r\n            x: x,\r\n            y: y,\r\n            position: tilePosition,\r\n            url: tileUrl\r\n          });\r\n        }\r\n      }\r\n    }\r\n    \r\n    // later      .\r\n    //     URL   ,\r\n    //        .\r\n    while (tileInfo = later.pop()) {\r\n      tile = oldTiles.length ? oldTiles.pop() : new Tile(this);\r\n\r\n      tile.setPositionAndUrl(tileInfo.position, tileInfo.url, 'always');\r\n      unloadedTileNum++;\r\n      this._grid[tileInfo.x][tileInfo.y] = tile;\r\n      tiles.push(tile);\r\n      \r\n      //       .\r\n      if (!tile.getElement().parentNode) {\r\n        this._div.appendChild(tile.getElement());\r\n      }\r\n    }\r\n    \r\n    this._tiles = tiles;\r\n    \r\n    //       .\r\n    while (tile = oldTiles.pop()) {\r\n      if (tile.getElement().parentNode) {\r\n        this._div.removeChild(tile.getElement());\r\n      }\r\n      tile.destroy();\r\n    }\r\n    \r\n    // IE        src   \r\n    //    load  .   this._loadedTileNum\r\n    //      load  .\r\n    if (this._loadedTileNum == unloadedTileNum) {\r\n      olleh.maps.util.defer(this._onload, this);\r\n    } else {\r\n      this._unloadedTileNum = unloadedTileNum;\r\n    }\r\n  },\r\n  \r\n  \r\n  ////////////////////////////////////////\r\n  // Moving\r\n  ////////////////////////////////////////\r\n\r\n  /**\r\n   *    .\r\n   * @returns {boolean}    <code>true</code>,    <code>false</code>\r\n   */\r\n  isMoving: function () {\r\n    return this._tileQueue.isEnabled();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  move: function () {\r\n    if (!this._updateTimer) {\r\n      this._updateTimer = olleh.maps.util.delay(this._update, this._updateInterval * 1000, this);\r\n    }\r\n  },\r\n  \r\n  _stopUpdateTimer: function () {\r\n    if (this._updateTimer) {\r\n      window.clearTimeout(this._updateTimer);\r\n      this._updateTimer = null;\r\n    }\r\n  },\r\n  \r\n  _update: function () {\r\n    this._updateTimer = null;\r\n    this._tileQueue.setEnabled(false);\r\n    this._shiftGrid(false);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  moveStart: function () {\r\n    this._stopUpdateTimer();\r\n    if(!this._disableLoadingWhilePanning) {\r\n      this._tileQueue.setEnabled(true);\r\n      this._shiftGrid(true);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  moveEnd: function () {\r\n    if(this._disableLoadingWhilePanning) {\r\n      this._shiftGrid(false);\r\n    } else {\r\n      this._tileQueue.setEnabled(false);\r\n    }\r\n    this._cleanMovingBuffer();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {boolean} useBuffer\r\n   */\r\n  _shiftGrid: function (useBuffer) {\r\n    var isUpdated, viewportSize, layerSize, bufferSize, displayOffset;\r\n\r\n    //        \r\n    if (this.layerMgr.isZooming()) {\r\n      return;\r\n    }\r\n\r\n    //     \r\n    viewportSize = this.layerMgr.getViewportSize(); // V\r\n    layerSize = this._getLayerSize(); // L\r\n    bufferSize = this.getTileSize().multiplyBy(this.bufferNum); // B\r\n\r\n    // FIXME- android chrome  (#30257)\r\n    if (!layerSize) {\r\n      return;\r\n    }\r\n\r\n    // this._offset:     \r\n    do {\r\n      isUpdated = false;\r\n\r\n      //   \r\n      displayOffset = this._getDisplayOffset(); // D\r\n\r\n      // (case 1) -D < B :  (-) \r\n      //\r\n      // <-> -D\r\n      // <-B->                     shift\r\n      // +---*---------------------+---+\r\n      // |  +---------------+      |###|\r\n      // |  |               |      |###|\r\n      //\r\n      // (case 2) L + D - V < B :  (+) \r\n      // <-             L             ->\r\n      // <-   -D   -><-      V      ->\r\n      //                           <-B->\r\n      // +---+---------------------*---+\r\n      // |###|       +---------------+ |\r\n      // |###|       |               | |\r\n      // shift\r\n      \r\n      if (-displayOffset.x < bufferSize.width) {\r\n        this._shiftCol(-1, useBuffer);\r\n        isUpdated = true;\r\n      } else if (layerSize.width - (-displayOffset.x) - viewportSize.width < bufferSize.width) {\r\n        this._shiftCol(1, useBuffer);\r\n        isUpdated = true;\r\n      }\r\n\r\n      //    \r\n      if (-displayOffset.y < bufferSize.height) {\r\n        this._shiftRow(1, useBuffer);\r\n        isUpdated = true;\r\n      } else if (layerSize.height - (-displayOffset.y) - viewportSize.height < bufferSize.height) {\r\n        this._shiftRow(-1, useBuffer);\r\n        isUpdated = true;\r\n      }\r\n    } while (isUpdated);\r\n    \r\n    if (this._loadedTileNum == this._unloadedTileNum) {\r\n      olleh.maps.util.defer(this._onload, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    offset .\r\n   *            \r\n   *           .\r\n   *     _cleanMovingBuffer()    ,\r\n   *      moveEnd() .\r\n   * @private\r\n   * @param {number} offset   \r\n   */\r\n  _shiftCol: function (offset, useBuffer) {\r\n    var x, y, remove, add, tileCol;\r\n    var gridNum = this._gridNum;\r\n\r\n    if (offset < 0) {\r\n      x = 0;\r\n      remove = Array.prototype.pop;\r\n      add = Array.prototype.unshift;\r\n    } else {\r\n      x = gridNum.x - 1;\r\n      remove = Array.prototype.shift;\r\n      add = Array.prototype.push;\r\n    }\r\n\r\n    this.index.x = this.index.x + offset;\r\n    this._offset.x += offset * this.getTileSize().width;\r\n\r\n    tileCol = remove.call(this._grid);\r\n\r\n    for (y = 0; y < gridNum.y; y++) {\r\n      tileCol[y] = this._shiftTile(tileCol[y], x, y, useBuffer);\r\n    }\r\n\r\n    add.call(this._grid, tileCol);\r\n  },\r\n\r\n  /**\r\n   *    offset .   _shiftCol() .\r\n   * @private\r\n   * @param {number} offset   \r\n   */\r\n  _shiftRow: function (offset, useBuffer) {\r\n    var x, y, remove, add, oldTile, newTile;\r\n    var gridNum = this._gridNum;\r\n\r\n    if (offset < 0) {\r\n      y = 0;\r\n      remove = Array.prototype.pop;\r\n      add = Array.prototype.unshift;\r\n    } else {\r\n      y = gridNum.y - 1;\r\n      remove = Array.prototype.shift;\r\n      add = Array.prototype.push;\r\n    }\r\n\r\n    this.index.y = this.index.y + offset;\r\n    this._offset.y -= offset * this.getTileSize().height;\r\n\r\n    for (x = 0; x < gridNum.x; x++) {\r\n      oldTile = remove.call(this._grid[x]);\r\n      newTile = this._shiftTile(oldTile, x, y, useBuffer);\r\n      add.call(this._grid[x], newTile);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.layer.Tile} oldTile\r\n   * @param {number} x\r\n   * @param {number} y\r\n   * @param {boolean} useBuffer\r\n   * @return {olleh.maps.layer.Tile}\r\n   */\r\n  _shiftTile: function (oldTile, x, y, useBuffer) {\r\n    var tilePosition = this._getTilePosition(x, y);\r\n    var tileUrl = this.getTileURL(x, y);\r\n    var tile;\r\n    \r\n    if (useBuffer) {\r\n      this._movingBuffer.push(oldTile);\r\n      tile = this._removeTileFromArray(tileUrl, this._movingBuffer);\r\n      if (!tile) {\r\n        tile = new this.Tile(this);\r\n        this._appendTileLater(tile);\r\n      }\r\n    } else {\r\n      tile = oldTile;\r\n    }\r\n    \r\n    tile.setPositionAndUrl(tilePosition, tileUrl, 'once');\r\n    this._unloadedTileNum++;\r\n    \r\n    return tile;\r\n  },\r\n  \r\n  /**\r\n   *   pane . {@link olleh.maps.fx.AnimationFrameQueue} \r\n   *       .\r\n   * @private\r\n   * @param {olleh.maps.layer.Tile} tile pane  \r\n   */\r\n  _appendTileLater: function (tile) {\r\n    this._tileQueue.push(function () {\r\n      if (tile && !tile.getElement().parentNode) {\r\n        this._div.appendChild(tile.getElement());\r\n        this._tiles.push(tile);\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  /**\r\n   *   pane  .\r\n   * @private\r\n   */\r\n  _cleanMovingBuffer: function () {\r\n    var tile;\r\n    while (tile = this._movingBuffer.pop()) {\r\n      if (tile.getElement().parentNode) {\r\n        if (tile.isLoading() && this._unloadedTileNum > 0) {\r\n          this._unloadedTileNum--;\r\n        }\r\n        this._div.removeChild(tile.getElement());\r\n        olleh.maps.util.removeFromArray(this._tiles, tile);\r\n      }\r\n      tile.destroy();\r\n    }\r\n  },\r\n  \r\n  \r\n  ////////////////////////////////////////\r\n  // Zooming\r\n  ////////////////////////////////////////\r\n\r\n  /**\r\n   *     .\r\n   * @returns {boolean}     <code>true</code>,    <code>false</code>\r\n   */\r\n  isZooming: function () {\r\n    return !!this._zoomingScale;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   */\r\n  zoomStart: function (scale, origin, duration, pulse) {\r\n    var i, l, tile, zoomingTiles;\r\n\r\n    if (this._zoomingScale == scale) {\r\n      return;\r\n    }\r\n\r\n    this._stopCleanTimer();\r\n    this._stopUpdateTimer();\r\n    this._tileQueue.clear();\r\n    \r\n    if (!this.isZooming()) {\r\n      //         div   .\r\n      this._cleanZoomingBufferDiv();\r\n\r\n      zoomingTiles = this._zoomingTiles = this._tiles;\r\n      for (i = 0, l = zoomingTiles.length; i < l; i++) {\r\n        tile = zoomingTiles[i];\r\n        tile.setEffectPolicy('none');\r\n        if (tile.status == 'animating') {\r\n          tile.stopAnimator();\r\n        }\r\n      }\r\n      \r\n      this._tiles = [];\r\n      this._unloadedTileNum = 0;\r\n\r\n      this._zoomingBufferDiv = this._div.setStyle('zIndex', '-1');\r\n      this._createGridDiv();\r\n\r\n      //         zoomingBufferDiv  \r\n      // movingBuffer      \r\n      this._movingBuffer = [];\r\n    }\r\n\r\n    if (olleh.maps.browser.style.transform) {\r\n      this._zoomWithTransform(scale, origin, duration, pulse);\r\n    } else {\r\n      this._zoomWithoutTransform(scale, origin, duration, pulse);\r\n    }\r\n    \r\n    this._zoomingScale = scale;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   */\r\n  _zoomWithTransform: function (scale, origin, duration, pulse) {\r\n    var zoomingBufferDiv, from;\r\n    \r\n    if (this.isZooming()) {\r\n      zoomingBufferDiv = this._zoomingBufferDiv;\r\n      from = this._zoomAnimator.ignore();\r\n    } else {\r\n      zoomingBufferDiv = this._zoomingBufferDiv.setStyle('transformOrigin',\r\n          origin.x + 'px ' + origin.y + 'px');\r\n      from = {\r\n        transform: olleh.maps.util.dom.getScaleString(1)\r\n      };\r\n    }\r\n    \r\n    this._zoomAnimator = new olleh.maps.fx.Animation({\r\n      from: from,\r\n      to: {\r\n        transform: olleh.maps.util.dom.getScaleString(scale)\r\n      },\r\n      duration: duration,\r\n      pulse: pulse,\r\n      timing: olleh.maps.fx.timing.easeOut\r\n    }).animate(zoomingBufferDiv);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   */\r\n  _zoomWithoutTransform: function (scale, origin, duration, pulse) {\r\n    var x, y;\r\n    var tileSize = this.getTileSize();\r\n    var gridNum = this._gridNum;\r\n    var layerPx = origin.add(this._offset.subtract(origin).multiplyBy(scale));\r\n    \r\n    if (!this._zoomAnimators) {\r\n      this._zoomAnimators = [];\r\n    }\r\n    for (x = 0; x < gridNum.x; x++) {\r\n      if (!this._zoomAnimators[x]) {\r\n        this._zoomAnimators[x] = [];\r\n      }\r\n      for (y = 0; y < gridNum.y; y++) {\r\n        this._zoomAnimators[x][y] = new olleh.maps.fx.Animation({\r\n          from: this._zoomAnimators[x][y] ? this._zoomAnimators[x][y].ignore() : {\r\n            width: tileSize.width + 'px',\r\n            height: tileSize.height + 'px',\r\n            left: this._grid[x][y].getPosition().x + 'px',\r\n            top: this._grid[x][y].getPosition().y + 'px'\r\n          },\r\n          to: {\r\n            width: (tileSize.width * scale) + 'px',\r\n            height: (tileSize.height * scale) + 'px',\r\n            left: (layerPx.x + x * tileSize.width * scale) + 'px',\r\n            top: (layerPx.y + (gridNum.y - y - 1) * tileSize.height * scale) + 'px'\r\n          },\r\n          duration: duration,\r\n          timing: olleh.maps.fx.timing.easeOut,\r\n          pulse: pulse\r\n        }).animate(this._grid[x][y].getElement());\r\n      }\r\n    }\r\n  },\r\n  \r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n      if (this.maxWaitTime >= 0 && this.isVisibleForZoom()) {\r\n        this._cleanTimer = olleh.maps.util.delay(this._cleanZoomingBufferDiv, this.maxWaitTime * 1000, this);\r\n      } else {\r\n        this._cleanZoomingBufferDiv();\r\n      }\r\n      this.draw(true);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _stopCleanTimer: function() {\r\n    if (this._cleanTimer) {\r\n      window.clearTimeout(this._cleanTimer);\r\n      this._cleanTimer = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _stopZoomAnimation: function () {\r\n    var x, y;\r\n    \r\n    this._zoomingScale = null;\r\n    \r\n    if (this._zoomAnimator) {\r\n      this._zoomAnimator.stop();\r\n      this._zoomAnimator = null;\r\n    } else if (this._zoomAnimators) {\r\n      for (x = 0; x < this._zoomAnimators.length; x++) {\r\n        for (y = 0; y < this._zoomAnimators[x].length; y++) {\r\n          this._zoomAnimators[x][y].stop();\r\n        }\r\n      }\r\n      this._zoomAnimators = null;\r\n    }\r\n    \r\n    this._stopCleanTimer();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cleanZoomingBufferDiv: function () {\r\n    var i, l;\r\n    if (this._zoomingBufferDiv) {\r\n      this._pane.removeChild(this._zoomingBufferDiv);\r\n      this._zoomingBufferDiv = null;\r\n      \r\n      for (i = 0, l = this._zoomingTiles.length; i < l; i++) {\r\n        this._zoomingTiles[i].destroy();\r\n      }\r\n      this._zoomingTiles = null;\r\n    }\r\n\r\n    this._stopCleanTimer();\r\n  },\r\n  \r\n  ////////////////////////////////////////\r\n  // Event\r\n  ////////////////////////////////////////\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.event.Event} event\r\n   */\r\n  $capture_loaded: function (event) {\r\n    if (event.getSource() !== this) { // assume src === tile\r\n      event.stopPropagation();\r\n      this._loadedTileNum++;\r\n      if (this._loadedTileNum == this._unloadedTileNum) {\r\n        this._onload();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _onload: function () {\r\n    if (!this._zoomAnimator && !this._zoomAnimators) {\r\n      this._cleanZoomingBufferDiv();\r\n    }\r\n\r\n    this._loadedTileNum = 0;\r\n    this._unloadedTileNum = 0;\r\n    this.fireEvent('loaded');\r\n  }\r\n\r\n});\r\n/**\r\n * @typedef olleh.maps.layer.OllehTileLayerOptions \r\n * @extends olleh.maps.layer.TileLayerOptions\r\n * @property {string} tileURLTmpl  URL .\r\n */\r\n\r\n/**\r\n *  KT  .\r\n */\r\n$class('olleh.maps.layer.OllehTileLayer').extend(olleh.maps.layer.TileLayer).define({\r\n\r\n  /**\r\n   * Logo  . black  white .\r\n   * @type String\r\n   */\r\n  logoType: 'black',\r\n\r\n  /**\r\n   * @private\r\n   * @constant\r\n   * @type string\r\n   */\r\n  _OUT_OF_BOUND_TILE_URL: olleh.maps.env.RESOURCE_URL + 'img/tile_transparent.png',\r\n\r\n  /**\r\n   * @private\r\n   * @constant\r\n   * @type olleh.maps.UTMK\r\n   */\r\n  tileOrigin: new olleh.maps.UTMK(171162, 1214781),\r\n\r\n  /**\r\n   * @private\r\n   * @constant\r\n   * @type olleh.maps.Bounds\r\n   */\r\n  tileMaxBounds: new olleh.maps.Bounds(new olleh.maps.UTMK(171162, 1214781), new olleh.maps.UTMK(1744026, 2787645)),\r\n  \r\n  /**\r\n   * \r\n   * @param {olleh.maps.layer.OllehTileLayerOptions} opts .\r\n   */\r\n  OllehTileLayer: function (opts) {\r\n    this.errorTileURL = olleh.maps.layer.OllehTileLayer.OUT_OF_BOUND_TILE_URL;\r\n    this._maxTileIndex = [];\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  init: function () {\r\n    olleh.maps.mixin(this, this._constructorOpts, true, [ 'tileURLTmpl', 'logoType']);\r\n    olleh.maps.layer.OllehTileLayer.$super.init.apply(this, arguments);\r\n\r\n    // logoType     black \r\n    if(this.logoType !== 'black') {\r\n      this.logoType = 'white'\r\n    }\r\n\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  getMaxTileIndex: function () {\r\n    var zoom = this.layerMgr.getZoom();\r\n    var tileSize = this.getTileSize();\r\n    var maxTileIndex = this._maxTileIndex[zoom];\r\n    if (!maxTileIndex) {\r\n      var tileMaxBounds = this.tileMaxBounds;\r\n      var resolution = this.layerMgr.getResolution();\r\n      var tileCoordSize = {\r\n        width: tileSize.width * resolution,\r\n        height: tileSize.height * resolution\r\n      };\r\n      maxTileIndex = this._maxTileIndex[zoom] = {\r\n        x: Math.floor((tileMaxBounds.getRight() - tileMaxBounds.getLeft()) / tileCoordSize.width) - 1,\r\n        y: Math.floor((tileMaxBounds.getTop() - tileMaxBounds.getBottom()) / tileCoordSize.height) - 1\r\n      };\r\n    }\r\n    return maxTileIndex;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {Number} x\r\n   * @param {Number} y\r\n   * @returns {String}      (x, y)     URL\r\n   */\r\n  getTileURL: function (x, y) {\r\n    // modify r2fresh\r\n    //       \r\n    // () var zoom = this.layerMgr.getZoom();\r\n    var nomalMaxZoom = olleh.maps.Map.DEFAULT_NORMAL_MAX_ZOOM;\r\n    var zoom = ( this.layerMgr.getZoom() > nomalMaxZoom ) ? nomalMaxZoom : this.layerMgr.getZoom();\r\n    var maxIndex = this.getMaxTileIndex();\r\n    var tileX = this.index.x + x;\r\n    var tileY = maxIndex.y - (this.index.y + y);\r\n    if (tileX < 0 || tileX > maxIndex.x || tileY < 0 || tileY > maxIndex.y) {\r\n      return this._OUT_OF_BOUND_TILE_URL;\r\n    }\r\n\r\n    // modify r2fresh\r\n    // ktgis.com  => 16\r\n    // gis.kt.com  => 10\r\n    var tileOpt = (this.tileURLTmpl.indexOf('gis.kt.com') >= 0)?{\r\n      x: tileX,\r\n      y: tileY,\r\n      z: zoom\r\n    } : {\r\n      x: this._fillZero(tileX.toString(16), 8),\r\n      y: this._fillZero(tileY.toString(16), 8),\r\n      z: this._fillZero(zoom, 2)\r\n    }\r\n    \r\n    return olleh.maps.util.applyTemplate(this.tileURLTmpl, tileOpt);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {String} str\r\n   * @param {Number} len\r\n   * @returns {String}\r\n   */\r\n  _fillZero: function (str, len) {\r\n    return '00000000'.substr(0, len - (str + '').length) + str;\r\n  }\r\n\r\n});\r\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.DefaultComponents').extend(olleh.maps.Adaptable).define({\r\n  \r\n  attach: function () {\r\n    var useHD = this.map.getOption('hd', olleh.maps.browser.isHDTile) && olleh.maps.browser.isHDTile;\r\n    var env = olleh.maps.env;\r\n    var oBase = new olleh.maps.layer.OllehTileLayer({\r\n      name: 'OllehBase',\r\n      label: olleh.maps.msg(''),\r\n      layerType: 'base',\r\n      logoType: 'black',\r\n      tileSize: useHD ? new olleh.maps.Size(128, 128) : new olleh.maps.Size(256, 256),\r\n      tileURLTmpl: useHD ? env.TILE_URL.HD_BASE : env.TILE_URL.BASE,\r\n      errorTileURL: olleh.maps.env.RESOURCE_URL + 'img/tile_nodata.jpg',\r\n      copyright: useHD ? env.TILE_COPYRIGHT.HD_BASE : env.TILE_COPYRIGHT.BASE,\r\n\r\n      // 1  maxZoom   (modify r2fresh)\r\n      maxZoom:13\r\n    });\r\n    this.map.registerMapType('ROADMAP',oBase);\r\n  },\r\n  \r\n  detach: function () {\r\n    // ???\r\n  }\r\n  \r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.DefaultComponents);/**\n * @private\n */\n$class('olleh.maps.layer.OllehAirMapType').extend(olleh.maps.Plugin).define({\n\n  doActivate: function() {\n    this.map.getLayer('OllehAir').activate();\n\n    // 1  maxZoom   (modify r2fresh)\n    this.map.layerMgr.setMaxZoom(14);\n  }\n\n});\n\n/**\n * @private\n */\n$class('olleh.maps.layer.OllehEngMapType').extend(olleh.maps.Plugin).define({\n\n    doActivate: function() {\n      this.map.getLayer('OllehEng').activate();\n  \n      // 1  maxZoom   (modify r2fresh)\n      this.map.layerMgr.setMaxZoom(13);\n    }\n  \n  });\n\n/**\n * @private\n */\n$class('olleh.maps.layer.OllehHybridMapType').extend(olleh.maps.Plugin).define({\n  \n  doActivate: function() {\n    \n    // 1  maxZoom   (modify r2fresh)\n    this.map.layerMgr.setMaxZoom(13);\n    this.map.getLayer('OllehAir').activate();\n    this.map.getLayer('OllehAirLabel').activate();\n  },\n  \n  doDeactivate: function() {\n    this.map.getLayer('OllehAirLabel').deactivate();\n  }\n  \n});\n\n/**\n * @private\n */\n$class('olleh.maps.layer.OllehTilesPlugin').extend(olleh.maps.Adaptable).define({\n  \n  attach: function () {\n    this.env = olleh.maps.env;\n    this.useHD = this.map.getOption('hd', olleh.maps.browser.isHDTile) && olleh.maps.browser.isHDTile;\n\n    this.setAirMap();\n    this.setEngMap();\n    this.setHybridMap();\n  },\n\n  /**\n   *    \n   */\n  setHybridMap: function(){\n    var oHybrid = new olleh.maps.layer.OllehTileLayer({\n      name: 'OllehAirLabel',\n      label: olleh.maps.msg(' '),\n      layerType: 'ground',\n      zIndex: 0,\n      tileSize: this.useHD ? new olleh.maps.Size(128, 128) : new olleh.maps.Size(256, 256),\n      tileURLTmpl: this.useHD ? this.env.TILE_URL.HD_HYBRID : this.env.TILE_URL.HYBRID,\n      maxWaitTime: 0.7,\n\n      // 1  maxZoom   (modify r2fresh)\n      maxZoom : 13\n    });\n    oHybrid.setMap(this.map);\n    this.ollehHybridMapType = new olleh.maps.layer.OllehHybridMapType();\n    this.map.registerMapType('HYBRID', this.ollehHybridMapType);\n  },\n\n  /**\n   *    \n   */\n  setAirMap: function(){\n    var oAir = new olleh.maps.layer.OllehTileLayer({\n      name: 'OllehAir',\n      label: olleh.maps.msg(''),\n      layerType: 'base',\n      logoType: 'white',\n      tileURLTmpl: this.env.TILE_URL.AIR,\n      errorTileURL: this.env.RESOURCE_URL + 'img/tile_nodata.jpg',\n      copyright: this.env.TILE_COPYRIGHT.AIR,\n\n      // 1  maxZoom   (modify r2fresh)\n      maxZoom : 14\n    });\n    oAir.setMap(this.map);\n    this.ollehAirMapType = new olleh.maps.layer.OllehAirMapType();\n    this.map.registerMapType('SATELLITE', this.ollehAirMapType);\n  }, \n\n  /**\n   *     \n   */\n  setEngMap: function() {\n    var oEng = new olleh.maps.layer.OllehTileLayer({\n      name: 'OllehEng',\n      label: olleh.maps.msg(''),\n      layerType: 'base',\n      logoType: 'black',\n      tileURLTmpl: this.env.TILE_URL.ENG,\n      errorTileURL: this.env.RESOURCE_URL + 'img/tile_nodata.jpg',\n      copyright: this.env.TILE_COPYRIGHT.ENG,\n\n      // 1  maxZoom   (modify r2fresh)\n      maxZoom : 13\n    });\n    oEng.setMap(this.map);\n    this.ollehEngMapType = new olleh.maps.layer.OllehEngMapType();\n    this.map.registerMapType('ENGMAP', this.ollehEngMapType);\n  },\n  \n  detach: function () {\n    // ????\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.layer.OllehTilesPlugin);\n/**\r\n * 4 Ease-in    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseInQuad').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return t * t;\r\n    };\r\n  }\r\n\r\n});\r\n/**\r\n * 4 Ease-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseOutQuad').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return t * (2 - t);\r\n    };\r\n  }\r\n\r\n});\r\n/**\r\n * 4 Ease-in-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseInOutQuad').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return (t < .5) ? (2 * t * t) : (-1 + (4 - 2 * t) * t);\r\n    };\r\n  }\r\n\r\n});\r\n/**\n * TrafficInfoControl   Layer             . \n *    .\n */\n$class('olleh.maps.control.TrafficInfoControl').extend(olleh.maps.control.Control).define({\n  $static: {\n    /**\n     * @constant\n     * @type Object\n     */\n    SPEED_INFO: {\n      '': {\n        color: 'green',\n        loadSpeed: {\n          ',': '30/h',\n          '': '60/h',\n          '': '70/h'\n        }\n      },\n      '': {\n        color: 'yellow',\n        loadSpeed: {\n          ',': '20~30/h',\n          '': '40~60/h',\n          '': '50~70/h'\n        }\n      },\n      '': {\n        color: 'orange',\n        loadSpeed: {\n          ',': '10~20/h',\n          '': '20~40/h',\n          '': '30~50/h'\n        }\n      },\n      '': {\n        color: 'red',\n        loadSpeed: {\n          ',': '10/h',\n          '': '20/h',\n          '': '30/h'\n        }\n      }\n    }\n  },\n\n  /**\n   * ,  TrafficInfoControl  .\n   * @param {olleh.maps.control.ControlOptions} [opts] TrafficInfoControl   <br>\n   * opts.position  : {@link olleh.maps.control.Control.BOTTOM_LEFT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\n   */\n  TrafficInfoControl: function (opts) {\n    var _opts = olleh.maps.mixin({\n      position: olleh.maps.control.Control.BOTTOM_LEFT,\n      direction: olleh.maps.control.Control.VERTICAL\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    this.tooltips = {};\n    this.rdoms = [];\n    var left = 0;\n    var speedInfos = olleh.maps.control.TrafficInfoControl.SPEED_INFO;\n    var elem = olleh.maps.Element.create('div');\n    var title = document.createElement('h1');\n    var imgDiv = document.createElement('div');\n    var _closeTrafficInfo = function (domEvent, elem) {\n      olleh.maps.util.dom.addClass(elem, 'ollehmap-hidden');\n    };\n    var _openTrafficInfo = function (domEvent, elem) {\n      olleh.maps.util.dom.removeClass(elem, 'ollehmap-hidden');\n    };\n\n    title.innerHTML = olleh.maps.msg(' ');\n    this.registerEventDom(elem.elem);\n    elem.addClass('ollehmap-traffic-control');\n    elem.setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n    elem.appendChild(title);\n    elem.appendChild(imgDiv);\n    imgDiv.appendChild(document.createTextNode(' ' + olleh.maps.msg(\"\") + ' '));\n    olleh.maps.util.dom.addClass(imgDiv, 'imgDiv');\n    for ( var i in speedInfos) {\n      var speedInfo = speedInfos[i];\n      var trafficBar = olleh.maps.Element.create('div');\n      var loadInfos = speedInfo.loadSpeed;\n      trafficBar.addClass('trafficbar');\n      trafficBar.setStyles({\n        backgroundColor : speedInfo.color,\n        pointerEvents: 'auto'\n      });\n      imgDiv.appendChild(trafficBar.elem);\n\n      if (loadInfos) {\n        var tooltip = document.createElement('div');\n\n        var ul = document.createElement('ul');\n        for ( var j in loadInfos) {\n          var loadInfo = loadInfos[j];\n          var li = document.createElement('li');\n          li.innerHTML = '<span class=\"a1\">' + olleh.maps.msg(j) + '</span><span class=\"a2\">: ' + loadInfo\n              + '</span>';\n          ul.appendChild(li);\n        }\n        tooltip.appendChild(ul);\n        olleh.maps.util.dom.setStyle(tooltip, 'backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n        olleh.maps.util.dom.setStyle(tooltip, 'left', left + 'px');\n        left += 55;\n        olleh.maps.util.dom.addClass(tooltip, 'control-traffic-info');\n        olleh.maps.util.dom.addClass(tooltip, 'tooltip');\n        olleh.maps.util.dom.addClass(tooltip, 'ollehmap-hidden');\n        elem.appendChild(tooltip);\n        this.tooltips[i] = tooltip;\n\n        trafficBar.addEventListener('mouseout', olleh.maps.curry(_closeTrafficInfo, null, tooltip));\n        trafficBar.addEventListener('mouseover', olleh.maps.curry(_openTrafficInfo, null, tooltip));\n      }\n      this.rdoms.push(trafficBar);\n    }\n    imgDiv.appendChild(document.createTextNode(' ' + olleh.maps.msg('') + ' '));\n    var infoElem = document.createElement('ul');\n    infoElem.innerHTML = '<li>' + olleh.maps.msg('    ,    ') + '</li><li>' + \n      olleh.maps.msg('         ') + '</li>';\n    elem.appendChild(infoElem);\n    return elem;\n  }\n});\n/**\n * MobileTrafficInfoControl   Layer           \n *  .    .\n */\n$class('olleh.maps.control.MobileTrafficInfoControl').extend(olleh.maps.control.Control).define({\n\n  /**\n   * MobileTrafficInfoControl \n   * @param {olleh.maps.control.ControlOptions} [opts] MobileMapTypeControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n  MobileTrafficInfoControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    this.position = Control.TOP_RIGHT;\n    this.direction = Control.HORIZONTAL;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div').setStyles({\n      padding: this.padding + 'px'\n    });\n    var trafficImg = this._trafficImg = olleh.maps.Element.create('div').addClass('mobile-traffic-info');\n\n    if(olleh.maps.browser.isHD)\n      trafficImg.addClass('retina').setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/retinas.png)');\n    else\n      trafficImg.setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/mobiles.png)');\n    elem.appendChild(trafficImg);\n    return elem;\n  }\n\n});\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.TrafficInfoPlugin').mixin(olleh.maps.Plugin).define({\r\n\r\n  serviceId: 'trafficInfo',\r\n\r\n  pluginInfo: {\r\n    label: olleh.maps.msg(' '),\r\n    autoActivate: false,\r\n    group: 'ground'\r\n  },\r\n  /**\r\n   * TODO:\r\n   *   MobileTrafficInfoControl    TrafficInfoControl     \r\n   */\r\n  attach: function () {\r\n    this.trafficLayer = new olleh.maps.layer.OllehTileLayer({\r\n      name: 'OllehTraffic',\r\n      layerType: 'ground',\r\n      zIndex: 1,\r\n      tileURLTmpl: olleh.maps.env.TILE_URL.TRAFFIC,\r\n      maxWaitTime: 0.7,\r\n      map: this.map\r\n    });\r\n\r\n    if(!this.trafficInfoControl){\r\n      if (olleh.maps.browser.isMobile)\r\n        this.trafficInfoControl = new olleh.maps.control.MobileTrafficInfoControl();\r\n      else {\r\n        this.trafficInfoControl = new olleh.maps.control.TrafficInfoControl();\r\n      }\r\n    }\r\n  },\r\n\r\n  detach: function () {\r\n    this.trafficLayer.setMap(null);\r\n    this.trafficLayer = null;\r\n    this.trafficInfoControl.setMap(null);\r\n    this.trafficInfoControl = null;\r\n  },\r\n\r\n  doActivate: function () {\r\n    this.trafficLayer.activate();\r\n    this.trafficInfoControl.setMap(this.map);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    this.trafficLayer.deactivate();\r\n    this.trafficInfoControl.setMap(null);\r\n  }\r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.TrafficInfoPlugin);\r\n/**\r\n * OverlayOptions Object Specification\r\n * @typedef olleh.maps.overlay.OverlayOptions\r\n * @property {olleh.maps.Map} [map]    . null      .\r\n */\r\n\r\n/**\r\n *   interface\r\n */\r\n$class('olleh.maps.overlay.Overlay').extend(olleh.maps.Initializable).mixin(olleh.maps.event.EventDelegator, olleh.maps.Adaptable).define({\r\n  \r\n  /**\r\n   * position_changed . \r\n   *   Overlay       .\r\n   * @event olleh.maps.overlay.Overlay#event:position_changed\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} payload\r\n   * @param {olleh.maps.Coord} payload.from  \r\n   * @param {olleh.maps.Coord} payload.to  \r\n   */\r\n  /**\r\n   * bounds_changed .\r\n   *   Overlay         .\r\n   * @event olleh.maps.overlay.Overlay#event:bounds_changed\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {olleh.maps.Bounds} payload.from  Bounds\r\n   * @param {olleh.maps.Bounds} payload.to  Bounds\r\n   */\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.overlay.OverlayOptions} opts\r\n   */\r\n  Overlay: function (opts) {\r\n    this._constructorOpts = opts || {};\r\n    this._bubble = null;\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @private\r\n   */\r\n  init: function () {\r\n    this.setOptions(this._constructorOpts);\r\n    this._constructorOpts = null;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.OverlayOptions} opts .\r\n   */\r\n  setOptions: function (opts) {\r\n    opts.visible !== undefined && this.setVisible(opts.visible);\r\n    opts.map !== undefined && this.setMap(opts.map);\r\n  },\r\n  \r\n  /**\r\n   *      true  .\r\n   * @returns {Boolean}\r\n   * @private\r\n   */\r\n  isAdded: function () {\r\n    return !!this.layer;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   *   element  pane     .\r\n   *  {@link olleh.maps.event.EventDelegator#registerEventDom}  \r\n   *   element   .\r\n   *    element      .\r\n   * @param {Boolean} onAdd      draw()    true\r\n   * @private  \r\n   */\r\n  draw: function (onAdd) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * draw()    .\r\n   *    element  pane     .\r\n   *  {@link olleh.maps.event.EventDelegator#unregisterEvent} \r\n   * Overlay     .\r\n   *      erase()      draw()   \r\n   * element   reference     . \r\n   * @param {Boolean} onRemove     draw()    true\r\n   * @private \r\n   */\r\n  erase: function (onRemove) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {Boolean} visible true    false   . \r\n   */\r\n  setVisible: function (visible) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @returns {Boolean}\r\n   */\r\n  isVisible: function () {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * zoom animation    .    zoomEnd()  .\r\n   * @param {Number} scale / . zoomEnd()    zoomStart()   \r\n   *   zoomStart()    .\r\n   * @param {olleh.maps.Point} origin zoom animation  \r\n   * @param {Number} duration zoom animation   \r\n   * @param {olleh.maps.fx.Pulse} [pulse] .      .\r\n   * @private\r\n   */\r\n  zoomStart: function (scale, origin, duration, pulse) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * zoom animation    .\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   *        bounds  .\r\n   *    Marker         .\r\n   * @returns {olleh.maps.Bounds}\r\n   * @private\r\n   */\r\n  getBounds: function () {\r\n    // Sublcass may override this\r\n    return null;\r\n  },\r\n\r\n  /**\r\n   *        coord  .\r\n   *   GroundOverlay        .\r\n   * @returns {olleh.maps.Coord}\r\n   * @private\r\n   */\r\n  getPosition: function () {\r\n    // Sublcass may override this\r\n    return null;\r\n  },\r\n\r\n  /**\r\n   *  bubble target   .\r\n   *    {@link olleh.maps.layer.Layer}  bubble target  .\r\n   * @param bubble\r\n   * @private\r\n   */\r\n  setBubble: function (bubble) {\r\n    this._bubble = bubble;\r\n  },\r\n\r\n  /**\r\n   *  bubble target  .\r\n   * @private\r\n   */\r\n  getBubble: function () {\r\n    return this._bubble || this.layer;\r\n  },\r\n\r\n  /**\r\n   *   layer  .\r\n   * @returns {olleh.maps.layer.Layer} layer \r\n   */\r\n  getLayer: function () {\r\n    return this.layer;\r\n  },\n  \r\n  attach: function() {\r\n    this.map.getOverlayLayer().add(this);\n  },\r\n\r\n  detach: function() {\r\n    this.layer && this.layer.remove(this);\r\n  },\r\n  \r\n  /**\r\n   * OverlayLayer  Overlay       . \r\n   * @param {boolean} displayHint true    \r\n   * @private\r\n   */\r\n  setDisplayHint: function(displayHint) {\r\n    // Subclass should override this\r\n  }\r\n  \r\n});\r\n/**\n * @typedef olleh.maps.overlay.BaseOverlayOptions\n * BaseOverlayOptions Object Specification\n * @property {Boolean} [visible=true] . <code>true</code>  .\n * @property {Number|String} [zIndex=auto] z-index.     . <code>'auto'</code>   .\n * @extends olleh.maps.overlay.OverlayOptions\n */\n\n/**\n * HTML   .\n */\n$class('olleh.maps.overlay.BaseOverlay').extend(olleh.maps.overlay.Overlay).define({\n  \n  $static: {\n    /** \n     *   z-index\n     * @constant\n     * @type Number \n     */\n    MAX_ZINDEX: 357913940\n  },\n\n  /**\n   * ,   .\n   */\n  BaseOverlay: function () {\n    this._drawn = false;\n    this._visible = true;\n    this._zIndex = 'auto';\n    this._displayHint = true;\n    \n    this.elements = {};\n    this._moveAnimators = [];\n  },\n\n  /**\n   *  .\n   * @param {olleh.maps.overlay.BaseOverlayOptions} opts .\n   */\n  setOptions: function (opts) {\n    opts.zIndex !== undefined && this.setZIndex(opts.zIndex);\n    olleh.maps.overlay.BaseOverlay.$super.setOptions.apply(this, arguments);\n  },\n\n  /**\n   * HTML element     HTML element  .\n   * {@link olleh.maps.overlay.BaseOverlay#draw}    . \n   * @private\n   */\n  update: function () {\n    this._updateVisibility();\n    this._updateZIndex();\n  },\n  \n  /**\n   * @name getIndexObject\n   * @memberOf olleh.maps.overlay.BaseOverlay.prototype\n   * @returns {olleh.maps.Coord|olleh.maps.Bounds}\n   *             {@link olleh.maps.Coord} \n   *         {@link olleh.maps.Bounds}  .\n   */\n\n  /**\n   *  .\n   * @returns {Boolean}   <code>true</code>,    <code>false</code>.\n   */\n  isVisible: function () {\n    return this._visible;\n  },\n\n  /**\n   *  .\n   * @fires olleh.maps.overlay.BaseOverlay#event:visible_changed\n   * @param {Boolean} visible <code>true</code>  ,    .\n   */\n  setVisible: function (visible) {\n    if (this._visible === visible) {\n      return;\n    }\n    this._visible = visible;\n    this._drawn && this._updateVisibility();\n    \n    /**\n     *    .\n     * @event olleh.maps.overlay.BaseOverlay#event:visible_changed\n     * @param {olleh.maps.event.Event} event\n     */\n    \n    this.fireEvent('visible_changed');\n  },\n\n  /**\n   * @private\n   */\n  setDisplayHint: function(displayHint) {\n    if(this._displayHint !== displayHint) {\n      this._displayHint = displayHint;\n      this.isDrawn() && this._updateVisibility();\n    }\n  },\n\n  /**\n   * @private\n   */\n  _updateVisibility: function () {\n    var visible = this._visible && this._displayHint;\n    var display = visible ? 'block' : 'none';\n    if(this._display !== display) {\n      this._display = display;\n      this.forEachElement(function (paneId, elem) {\n        olleh.maps.util.dom.setStyle(elem, 'display', this._display);\n      });\n    }\n  },\n  \n  /**\n   *   z-index . {@link #bringToFront} \n   * z-index <code>'auto'</code>       z-index .\n   * @returns {Number}   z-index.\n   */\n  getCurrentZIndex: function () {\n    return this._currentZIndex;\n  },\n  \n  /**\n   *  z-index .\n   * @returns {Number|String} z-index.\n   */\n  getZIndex: function () {\n    return this._zIndex;\n  },\n\n  /**\n   * z-index . z-index         .\n   * @param {Number|String} zIndex z-index. <code>'auto'</code>   . \n   */\n  setZIndex: function (zIndex) {\n    this._zIndex = zIndex == 'auto' ? 'auto' : Math.min(olleh.maps.overlay.BaseOverlay.MAX_ZINDEX, zIndex);\n    this._drawn && this._updateZIndex();\n  },\n\n  /**\n   * @private\n   */\n  _updateZIndex: function () {\n    var zIndex;\n    \n    if (this._isFront) {\n      zIndex = olleh.maps.overlay.BaseOverlay.MAX_ZINDEX;\n    } else if (this._zIndex == 'auto') {\n      zIndex = this.getAutoZIndex();\n    } else {\n      zIndex = this._zIndex;\n    }\n    //TODO : ContentOverlay setContnet root pane     \n    //if(this._currentZIndex !== zIndex) {\n    this._currentZIndex = zIndex;\n    this.forEachElement(function (paneId, elem) {\n      olleh.maps.util.dom.setStyle(elem, 'zIndex', zIndex);\n    });\n    //}\n  },\n\n  /**\n   *     .\n   */\n  bringToFront: function () {\n    if (!this._isFront) {\n      this._isFront = true;\n      this._drawn && this._updateZIndex();\n    }\n  },\n\n  /**\n   * {@link olleh.maps.overlay.BaseOverlay#bringToFront()}   z-index   .\n   */\n  resetZIndex: function () {\n    if (this._isFront) {\n      this._isFront = false;\n      this._drawn && this._updateZIndex();\n    }\n  },\n\n  /**\n   *  pane   .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @returns {Boolean}  pane    <code>true</code>,    <code>false</code>.\n   * @private\n   */\n  isRegistered: function (paneId, elem) {\n    return this.elements[paneId] && olleh.maps.util.indexOf(this.elements[paneId], elem) > -1;\n  },\n\n  /**\n   *  pane .       ,\n   *       /    .\n   *    {@link olleh.maps.overlay.Overlay#setMap()}     .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  registerElement: function (paneId, elem) {\n    if (!this.isRegistered(paneId, elem)) {\n      if (!this.elements[paneId]) {\n        this.elements[paneId] = [elem];\n      } else {\n        this.elements[paneId].push(elem);\n      }\n      this.appendElement(paneId, elem);\n    }\n  },\n\n  /**\n   *  pane  .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  unregisterElement: function (paneId, elem) {\n    if (this.isRegistered(paneId, elem)) {\n      olleh.maps.util.removeFromArray(this.elements[paneId], elem);\n      this.removeElement(paneId, elem);\n    }\n  },\n  \n  /**\n   *    pane .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  appendElement: function (paneId, elem) {\n    if (this._drawn) {\n      var pane = this.getLayer().getPane(paneId);\n      if (!elem.parentNode || elem.parentNode != pane) {\n        olleh.maps.util.dom.setStyles(elem, this._currentStyles);\n        pane.appendChild(elem);\n      }\n    }\n  },\n\n  /**\n   *    pane .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  removeElement: function (paneId, elem) {\n    elem.parentNode && elem.parentNode.removeChild(elem);\n  },\n  \n  /**\n   * {@link #registerElement()}      pane .\n   * @private\n   */\n  appendElements: function () {\n    this.forEachElement(this.appendElement);\n  },\n\n  /**\n   * {@link #registerElement()}      pane .\n   * @private\n   */\n  removeElements: function () {\n    this.forEachElement(this.removeElement);\n  },\n\n  /**\n   *       .\n   * @returns {Boolean}    <code>true</code>,    <code>false</code>\n   * @private\n   */\n  isDrawn: function () {\n    return this._drawn;\n  },\n  \n  /**\n   *   .\n   * {@link olleh.maps.overlay.OverlayLayer}    .\n   * @param {Boolean} onAdd   .\n   * @private\n   */\n  draw: function (onAdd) {\n    if (this.layer) {\n      this.update();\n      this._drawn = true;\n      this.appendElements();\n      if (onAdd) {\n        this.onAdd();\n      } else {\n        this.ready();\n      }\n      this.registerEvent();\n    }\n  },\n\n  /**\n   *   .\n   * {@link olleh.maps.overlay.OverlayLayer}    .\n   * @param {Boolean} onRemove   .\n   * @private\n   */\n  erase: function (onRemove) {\n    if (this._drawn) {\n      this._drawn = false;\n      if (onRemove) {\n        this.onRemove();\n      } else {\n        this.cleanup();\n      }\n      this.unregisterEvent();\n    }\n  },\n  \n  /**\n   * @private\n   * @fires olleh.maps.overlay.BaseOverlay#event:ready\n   */\n  ready: function () {\n    /**\n     * Overlay        .\n     * DOM       .\n     * @name event:ready\n     * @event\n     * @memberof olleh.maps.overlay.BaseOverlay.prototype\n     * @param {olleh.maps.event.Event} event\n     */\n    this.fireEvent('ready');\n  },\n\n  /**\n   * @private\n   * @fires olleh.maps.overlay.BaseOverlay#event:erased\n   */\n  erased: function () {\n    /**\n     * Overlay    .\n     *    DOM   .\n     * @name event:erased\n     * @event\n     * @memberof olleh.maps.overlay.BaseOverlay.prototype\n     * @param {olleh.maps.event.Event} event\n     */\n    this.fireEvent('erased');\n  },\n  \n  /**\n   * @private\n   */\n  cleanup: function () {\n    this.removeElements();\n    this.erased();\n  },\n  \n  /**\n   * @private\n   */\n  onAdd: function () {\n    this._fadeInAnimation = this.getFadeInAnimation();\n    if (this._fadeInAnimation) {\n      this._fadeInRequested = 0;\n      this._fadeInFinished = 0;\n      this.forEachElement(this._fadeInElement);\n    } else {\n      this.ready();\n    }\n  },\n\n  /**\n   * @private\n   */\n  onRemove: function () {\n    this._fadeOutAnimation = this.getFadeOutAnimation();\n    if (this._fadeOutAnimation) {\n      this._removeRequested = 0;\n      this._removeFinished = 0;\n      this.forEachElement(this._fadeOutElement);\n    } else {\n      this.cleanup();\n    }\n  },\n\n  /**\n   * @private\n   */\n  getFadeInAnimation: function () {\n    return null;\n  },\n\n  /**\n   * @private\n   */\n  getFadeOutAnimation: function () {\n    return null;\n  },\n\n  /**\n   * @private\n   */\n  _fadeInElement: function (paneId, elem) {\n    olleh.maps.util.dom.setStyles(elem, this._fadeInAnimation.from);\n    this._fadeInRequested++;\n    this._fadeInAnimation.animate(elem, {\n      callback: this._onFadeInFinished,\n      ctx: this\n    });\n  },\n\n  /**\n   * @private\n   */\n  _fadeOutElement: function (paneId, elem) {\n    var overlay = this;\n    this._removeRequested++;\n    this._fadeOutAnimation.animate(elem, {\n      callback: function () {\n        this.parentNode && this.parentNode.removeChild(this);\n        overlay._onElementRemoved();\n      }\n    });\n  },\n\n  /**\n   * @private\n   */\n  _onFadeInFinished: function () {\n    this._fadeInFinished++;\n    if (this._fadeInFinished == this._fadeInRequested) {\n      this.ready();\n    }\n  },\n\n  /**\n   * @private\n   */\n  _onElementRemoved: function () {\n    this._removeFinished++;\n    if (this._removeFinished == this._removeRequested) {\n      this.erased();\n    }\n  },\n  \n  /**\n   *     .\n   * @return {Boolean}    <code>true</code>,    <code>false</code>\n   * @private\n   */\n  isMoving: function () {\n    return !!this._moveAnimators.length && this._moveAnimators[0].status != 'finished';\n  },\n  \n  /**\n   *    .\n   * @see olleh.maps.fx.Animator#stop()\n   * @private\n   */\n  stopAnimators: function () {\n    var i, l, moveAnimators = this._moveAnimators;\n    for (i = 0, l = moveAnimators.length; i < l; i++) {\n      if (moveAnimators[i].status != 'finished') {\n        moveAnimators[i].stop();\n      }\n    }\n    this._moveAnimators = [];\n  },\n\n  /**\n   *     .\n   *       .\n   * @param {Object} styles key-value    .\n   * @private\n   */\n  updatePositioningStyles: function (styles) {\n    this._currentStyles = styles;\n    this.forEachElement(function (paneId, elem) {\n      olleh.maps.util.dom.setStyles(elem, this._currentStyles);\n    });\n  },\n\n  /**\n   *     .\n   *       .\n   * @param {Object} to key-value    .\n   * @param {Number} [duration=0]  .   . \n   * @param {olleh.maps.fx.Pulse} [pulse]  .    .\n   * @param {Function} [callback]     .\n   * @param {Object} [ctx=this]   .    .\n   * @private\n   */\n  animateTo: function (to, duration, pulse, callback, ctx) {\n    var from = this._currentStyles;\n    \n    this.stopAnimators();\n    \n    if (duration > 0) {\n\n      this._finishedAnimation = 0;\n      this._animationCallback = callback;\n      this._animationCallbackCtx = ctx;\n\n      this.forEachElement(function (paneId, elem) {\n        this._moveAnimators.push(new olleh.maps.fx.Animation({\n          from: from,\n          to: to,\n          duration: duration,\n          pulse: pulse,\n          timing: olleh.maps.fx.timing.easeOut,\n          callback: this._animationFinished,\n          ctx: this\n        }).animate(elem));\n      });\n\n      this._currentStyles = to;\n      \n    } else {\n    \n      this.updatePositioningStyles(to);\n      if (callback) {\n        callback.call(ctx || this);\n      }\n      \n    }\n    \n  },\n  \n  /**\n   * @private\n   */\n  _animationFinished: function () {\n    this._finishedAnimation++;\n    if (this._finishedAnimation == this._moveAnimators.length) {\n      this._moveAnimators = [];\n      if (this._animationCallback) {\n        this._animationCallback.call(this._animationCallbackCtx || this);\n      }\n    }\n  },\n\n  /**\n   *     <code>fn</code>  .\n   * fn     pane ID,      .  \n   * @param {Function} fn     .\n   * @private\n   */\n  forEachElement: function (fn) {\n    var paneId, i, l, elems;\n    for (paneId in this.elements) {\n      elems = this.elements[paneId];\n      if (elems) {\n        for (i = 0, l = elems.length; i < l; i++) {\n          fn.apply(this, [paneId, elems[i]]);\n        }  \n      }\n    }\n  },\n  \n  detach: function() {\n    this.stopAnimators();\n    olleh.maps.overlay.BaseOverlay.$super.detach.apply(this, arguments);\n  }\n  \n});\n/**\r\n *  overlay     \r\n */\r\n$class('olleh.maps.overlay.OverlayGroup').mixin(olleh.maps.event.EventDelegator, olleh.maps.Adaptable).define({\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {Object} opts  \r\n   * @param {olleh.maps.Map} opts.map OverlayGroup   map \r\n   * @param {boolean} opts.visible  visibility \r\n   */\r\n  OverlayGroup: function (opts) {\r\n    this._overlays = [];\r\n    this.layer = null;\r\n    this._visible = true;\r\n    opts && opts.visible === false && (this._visible = false); \r\n    if(opts && opts.map) {\r\n      this.setMap(opts.map);\r\n    }\r\n  },\r\n  \r\n  attach: function() {\r\n    var i, len, o;\r\n    for(i = 0 , len = this._overlays.length ; i < len ; i++ ) {\r\n      o = this._overlays[i];\r\n      o.setMap(this.map);\r\n    }\r\n  },\r\n  \r\n  detach: function() {\r\n    var i, len, o;\r\n    for(i = 0 , len = this._overlays.length ; i < len ; i++ ) {\r\n      o = this._overlays[i];\r\n      o.setMap(null);\r\n    }\r\n  },\r\n    \r\n  /**\r\n   * @see olleh.maps.event.EventDelegator#getBubble()\r\n   */\r\n  getBubble: function() {\r\n    return this.map.getOverlayLayer();\r\n  },\r\n\r\n  /**\r\n   * Overlay  OverlayGroup  . \r\n   * <code>setMap(map)</code>   OverlayGroup    \r\n   *  overlay   . \r\n   * @param overlay\r\n   */\r\n  add: function (overlay) {\r\n    this._overlays.push(overlay);\r\n    overlay.setVisible(this._visible);\r\n    this.map && overlay.setMap(this.map);\r\n    overlay.setBubble(this);\r\n  },\r\n\r\n  /**\r\n   * Overlay  OverlayGroup  . \r\n   * <code>setMap(map)</code>   OverlayGroup    \r\n   *  overlay   . \r\n   * @param overlay\r\n   */\r\n  remove: function (overlay) {\r\n    olleh.maps.util.removeFromArray(this._overlays, overlay);\r\n    this.map && overlay.setMap(null);\r\n    overlay.setBubble(null);\r\n  },\r\n\r\n  /**\r\n   *  overlay  visiblity  .\r\n   * @param {Boolean} visible\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible !== visible) {\r\n      var o, i = this._overlays.length;\r\n      this._visible = visible;\r\n      while(i--) {\r\n        o = this._overlays[i];\r\n        o.setVisible(visible);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * <code>setVisible(visible)</code>   visible  .\r\n   * @returns {Boolean}\r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  }\r\n});\r\n/**\n * @private\n */\n$class('olleh.maps.plugin.Overlay').extend(olleh.maps.Adaptable).define({\n  \n  attach: function () {\n    this.map._opts = olleh.maps.mixin(this.map._opts, {\n      overlayLayer: new olleh.maps.overlay.OverlayLayer()}, true);\n  },\n\n  detach: function () {\n  }\n\n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.Overlay);/**\n * PointedOverlayOptions Object Specification\n * @typedef olleh.maps.overlay.PointedOverlayOptions\n * @extends olleh.maps.overlay.BaseOverlayOptions \n * @property {olleh.maps.Coord} position  .\n */\n\n/**\n *       .\n */\n$class('olleh.maps.overlay.PointedOverlay').extend(olleh.maps.overlay.BaseOverlay).define({\n\n  /**\n   * ,  opts    .\n   * @param {olleh.maps.overlay.PointedOverlayOptions} opts .\n   */\n  PointedOverlay: function () {\n  },\n\n  /**\n   *  .\n   * @param {olleh.maps.overlay.PointedOverlayOptions} opts .\n   */\n  setOptions: function (opts) {\n    opts.position && this.setPosition(opts.position);\n    olleh.maps.overlay.PointedOverlay.$super.setOptions.apply(this, arguments);\n  },\n\n  /**\n   * @private\n   * @see olleh.maps.overlay.BaseOverlay#update\n   */\n  update: function () {\n    this._updatePosition();\n    olleh.maps.overlay.PointedOverlay.$super.update.apply(this, arguments);\n  },\n  \n  /**\n   * @private\n   * @returns {olleh.maps.Coord}\n   */\n  getIndexObject: function () {\n    return this.getPosition();\n  },\n  \n  /**\n   * @private\n   * @returns {number}\n   */\n  getAutoZIndex: function () {\n    var coord = this._position.asDefault();\n      // Chrome Bug : zIndex      \n    var maxTopCoord = this.layer.layerMgr.getMaxExtent().getTop();\n    return Math.round(maxTopCoord - coord.y);\n  },\n\n  /**\n   *   .\n   * @returns {olleh.maps.Coord}  .\n   */\n  getPosition: function () {\n    return this._position;\n  },\n  \n  /**\n   *   .\n   * @fires olleh.maps.overlay.PointedOverlay#event:position_changed\n   * @param {olleh.maps.Coord} position  .\n   */\n  setPosition: function (position) {\n    var before = this._position;\n    position = olleh.maps.UTMK.valueOf(position);\n    this._position = position;\n    if(this.isDrawn()) {\n      this._updatePosition();\n    }\n    this.fireEvent('position_changed',{from: before, to: position});\n  },\n\n  /**\n   * @private\n   */\n  _updatePosition: function () {\n    if (!this._position) {\n      throw new Error(\"Position is not set.\");\n    }\n    this._currentLayerPx = this.getOriginalLayerPx();\n    this.updatePositioningStyles(olleh.maps.util.dom.getPositionStyles(this._currentLayerPx.x, this._currentLayerPx.y));\n  },\n\n  /**\n   * @param {Number} scale\n   * @param {olleh.maps.Point} origin\n   * @param {Number} duration\n   * @param {olleh.maps.fx.Pulse} [pulse]\n   * @private\n   */\n  zoomStart: function (scale, origin, duration, pulse) {\n    //var originalLayerPx = this.getOriginalLayerPx();\n    //var newPx = origin.add(originalLayerPx.subtract(origin).multiplyBy(scale)).round();\n    var layerMgr = this.layer.layerMgr;\n    var newPx = layerMgr.getLayerPxFromCoord(this._position, true);\n    this.moveTo(newPx, duration, pulse);\n  },\n\n  /**\n   * @private\n   */\n  zoomEnd: function () {\n    this.stopAnimators();\n  },\n\n  /**\n   *    .\n   *  (position)      draw()      . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   * @private\n   */\n  moveTo: function (px, duration, pulse, callback) {\n    this.animateTo(olleh.maps.util.dom.getPositionStyles(px.x, px.y), duration, pulse, callback);\n    this._currentLayerPx = px;\n  },\n\n  /**\n   *      .\n   *        draw()       . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   * @private\n   */\n  move: function (px, duration, pulse, callback) {\n    this.moveTo(this._currentLayerPx.add(px), duration, pulse, callback);\n  },\n\n  /**\n   *       .\n   * @returns {olleh.maps.Point}   \n   * @private\n   */\n  getOriginalLayerPx: function () {\n    return this.layer.layerMgr.getLayerPxFromCoord(this._position);\n  },\n\n  /**\n   *    .\n   *   {@link olleh.maps.overlay.PointedOverlay#getOriginalLayerPx()}  \n   * {@link olleh.maps.overlay.PointedOverlay#moveTo()} \n   * {@link olleh.maps.overlay.PointedOverlay#move()}     .\n   * @returns {olleh.maps.Point}   .\n   * @private\n   */\n  getCurrentLayerPx: function () {\n    return this._currentLayerPx;\n  },\n\n  /**\n   * @param {olleh.maps.event.Event}\n   * @param {Object} payload\n   * @private\n   */\n  $default_mouseover: function (event, payload) {\n    event.preventDefault();\n    this.bringToFront();\n  },\n\n  /**\n   * @param {olleh.maps.event.Event}\n   * @param {Object} payload\n   * @private\n   */\n  $default_mouseout: function (event, payload) {\n    event.preventDefault();\n    this.resetZIndex();\n  },\n\n  /**\n   * @param {olleh.maps.event.Event}\n   * @param {Object} payload\n   * @private\n   */\n  $current_position_changed: function (event, payload) {\n    this.isAdded() && this._updateZIndex();\n  }\n});\n/**\r\n *      .\r\n */\r\n$class('olleh.maps.overlay.DropTiming').extend(olleh.maps.fx.timing.Timing).define({\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return (t < .5) ? 2 * t * t : t * (t - 1.5) + 1.5;\r\n    };\r\n  }\r\n});\r\n///////////////////////////\n//  Marker     //\n///////////////////////////\n/**\n * MarkerOptions Object Specification\n * @typedef olleh.maps.overlay.MarkerOptions\n * @property {String|Object} [icon=olleh.maps.overlay.Marker.DEFAULT_ICON]   . <code>String</code>   \n *           url   \n * @property {String|Object} [shadow=olleh.maps.overlay.Marker.DEFAULT_SHADOW]  . <code>String</code>   \n *           url   \n * @property {String|Object} [caption]  . <code>String</code>   \n *              \n * @property {Number} [angle]   \n * @property {String} [cursor]     \n * @property {String} [title]  \n * @property {Boolean} [draggable=false]    . <code>true</code>  drag    \n * @property {Boolean} [flat=false]  . <code>true</code>    \n * @extends olleh.maps.overlay.PointedOverlayOptions\n */\n\n///////////////////////////\n//  MarkerIconOptions    //\n///////////////////////////\n/**\n * MarkerIconOptions Object Specification\n * @typedef olleh.maps.overlay.MarkerIconOptions\n * @property {String} url icon   URL\n * @property {olleh.maps.Size} [size] icon \n * @property {olleh.maps.Point} [anchor] icon anchor    <code>olleh.maps.Point(icon.size.width / 2, icon.size.height)</code> \n * @property {olleh.maps.Point} [origin]     \n * @property {olleh.maps.Size} [scaledSize]      \n */\n\n///////////////////////////\n//  MarkerCaptionOptions //\n///////////////////////////\n/**\n * MarkerCaptionOptions Object Specification\n * @typedef olleh.maps.overlay.MarkerCaptionOptions\n * @property {String} title  \n * @property {String} [color='#000000']  \n * @property {String} [backgroundColor='transparent'] caption \n * @property {Number} [size=9]  (pt )\n */\n\n/**\n * Marker     ,      . \n * <p/>\n * <h5> </h5>\n * <ul>\n * <li>{@link olleh.maps.overlay.BaseOverlay#event:visible_changed|visible_changed}</li>\n * <li>{@link olleh.maps.overlay.PointedOverlay#event:position_changed|position_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:animation_changed|animation_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:cursor_changed|cursor_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:draggable_changed|draggable_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:flat_changed|flat_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:icon_changed|icon_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:shadow_changed|shadow_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:title_changed|title_changed}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\n * </ul>\n * <p/>  \n * \n * @example\n * marker = new olleh.maps.overlay.Marker({\n *   position: new olleh.maps.UTMK(958094, 1942790),\n *   title: \"IC\",\n *   caption: \"Center(bounce)\",\n *   animation: olleh.maps.overlay.Marker.BOUNCE,\n *   draggable: true\n * });\n * marker.setMap(map);\n * marker.onEvent('position_changed', function () {alert(\"\")});\n */\n$class('olleh.maps.overlay.Marker').extend(olleh.maps.overlay.PointedOverlay).define({\n\n  $static: {\n\n    /**\n     *           Object\n     * @type Object\n     */\n    DEFAULT_ICON: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/markers.png',\n      size: new olleh.maps.Size(28, 40),\n      origin: new olleh.maps.Point(0, 1107)\n    },\n\n    /**\n     *            Object\n     * @type Object\n     */\n    DEFAULT_MOBILE_ICON: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/mobiles.png',\n      size: new olleh.maps.Size(25, 37),\n      origin: new olleh.maps.Point(78, 80)\n    },\n\n    // /**\n    //  *         HD   Object\n    //  * @type Object\n    //  */\n    DEFAULT_HD_ICON: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/retinas.png',\n      size: new olleh.maps.Size(26, 35),\n      origin: new olleh.maps.Point(78, 81),\n      scaledSize: new olleh.maps.Size(170, 155)\n    },\n\n    /**\n     *           Object\n     * @type Object\n     */\n    DEFAULT_SHADOW: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/markers.png',\n      size: new olleh.maps.Size(34, 27),\n      anchor: new olleh.maps.Point(6, 27),\n      origin: new olleh.maps.Point(0, 1147)\n    },\n\n    /**\n    *            Object\n    * @type Object\n    */\n    DEFAULT_MOBILE_SHADOW: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/mobiles.png',\n      size: new olleh.maps.Size(27, 20),\n      origin: new olleh.maps.Point(128, 80),\n      anchor: new olleh.maps.Point(4, 20)\n    },\n\n    ///**\n    // *         HD   Object\n    // * @type Object\n    // */\n    DEFAULT_HD_SHADOW: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/retinas.png',\n      size: new olleh.maps.Size(27, 20),\n      origin: new olleh.maps.Point(126, 80),\n      anchor: new olleh.maps.Point(5, 20),\n      scaledSize: new olleh.maps.Size(170, 155)\n    },\n\n    DRAG_POINT: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/markers.png',\n      size: new olleh.maps.Size(20, 13),\n      anchor: new olleh.maps.Point(10, 5),\n      origin: new olleh.maps.Point(0, 1092)\n    },\n\n    DRAG_FLOATING_PX: 10,\n\n    /**\n     *     animation type\n     * @type String\n     */\n    BOUNCE: 'bounce',\n\n    /**\n     *    animation type\n     * @type String\n     */\n    DROP: 'drop',\n\n    bouncePulse: new olleh.maps.fx.Pulse(1),\n\n    dropTiming: new olleh.maps.overlay.DropTiming(),\n\n    getBounceAnimator: function (anchor, isShadow) {\n      var dx, dy, distance = 10;\n\n      if (isShadow) {\n        dy = distance * Math.SQRT1_2;\n        dx = -dy;\n      } else {\n        dy = distance;\n        dx = 0;\n      }\n      return new olleh.maps.fx.Animation({\n        from: {\n          marginLeft: -anchor.x + 'px',\n          marginTop: -anchor.y + 'px'\n        },\n        to: {\n          marginLeft: -(anchor.x + dx)+ 'px',\n          marginTop: -(anchor.y + dy) + 'px'\n        },\n        timing: olleh.maps.fx.timing.easeOut,\n        comeback: true,\n        repeat: -1,\n        duration: 1,\n        pulse: olleh.maps.overlay.Marker.bouncePulse\n      });\n    },\n    \n    getDropAnimator: function (anchor, isShadow) {\n      var dx, dy, distance = 200;\n\n      if (isShadow) {\n        dy = distance * Math.SQRT1_2;\n        dx = -dy;\n      } else {\n        dy = distance;\n        dx = 0;\n      }\n      return new olleh.maps.fx.Animation({\n        from: {\n          marginLeft: -(anchor.x + dx)+ 'px',\n          marginTop: -(anchor.y + dy) + 'px'\n        },\n        to: {\n          marginLeft: -anchor.x + 'px',\n          marginTop: -anchor.y + 'px'\n        },\n        timing: olleh.maps.overlay.Marker.dropTiming,\n        duration: 0.5\n      });\n    }\n  },\n\n  /**\n   * ,  opts    .\n   * @param {olleh.maps.overlay.MarkerOptions} opts MarkerOptions\n   */\n  Marker: function (opts) {\n    this._cursor = 'pointer';\n    this._title = '';\n    this._flat = false;\n    this._draggable = false;\n    this._angle = 0;\n  },\n\n  /**\n   *  .\n   * \n   * @example \n   * marker.setOptions({\n   *   icon: {\n   *     url: 'marker.png',\n   *     size: new olleh.maps.Size(20, 20)\n   *   },\n   *   position: new olleh.maps.UTMK(958094, 1942790),\n   *   title: 'IC',\n   *   draggable: true\n   * });\n   * @param {olleh.maps.overlay.MarkerOptions} opts  \n   * @see olleh.maps.overlay.PointedOverlay#setOptions\n   */\n  setOptions: function (opts) {\n    opts.icon && this.setIcon(opts.icon);\n    opts.angle && this.setAngle(opts.angle);\n    opts.shadow && this.setShadow(opts.shadow);\n    opts.caption && this.setCaption(opts.caption);\n    opts.cursor && this.setCursor(opts.cursor);\n    opts.title && this.setTitle(opts.title);\n    opts.draggable && this.setDraggable(opts.draggable);\n    opts.flat && this.setFlat(opts.flat);\n    opts.animation && this.setAnimation(opts.animation);\n    olleh.maps.overlay.Marker.$super.setOptions.apply(this, arguments);\n  },\n\n  /**\n   * @see olleh.maps.overlay.PointedOverlay#update\n   */\n  update: function () {\n    this._updateIcon();\n    this._updateAngle();\n    this._updateCursor();\n    this._updateShadow();\n    this._updateCaption();\n    this._updateAnimation();\n    olleh.maps.overlay.Marker.$super.update.apply(this, arguments);\n  },\n\n  /**\n   * draw    .\n   * @see olleh.maps.overlay.BaseOverlay#erase\n   */\n  erase: function () {\n    olleh.maps.overlay.Marker.$super.erase.apply(this, arguments);\n    this._infoWin && this._infoWin.erase();\n    if (this._tooltip) {\n      this._tooltip.close();\n      delete this._tooltip;\n    }\n  },\n  \n  /**\n   *   .\n   * @returns {Object} icon   Object\n   */\n  getIcon: function () {\n    return this._icon;\n  },\n  \n  /**\n   *   .\n   * @example \n   * var icon = {\n   *   url:'mark.png', \n   *   size: new olleh.maps.Size(21, 30), \n   *   anchor: new olleh.maps.Point(10, 30)};\n   * marker.setIcon(icon);\n   * marker2.setIcon('marker.png');\n   * @fires olleh.maps.overlay.Marker#event:icon_changed\n   * @param {String|olleh.maps.overlay.MarkerIconOptions} icon   URL  MarkerImage   Obect\n   */\n  setIcon: function (icon) {\n    if (olleh.maps.isString(icon)) {\n      icon = {\n        url: icon\n      };\n    } else if (!olleh.maps.isObject(icon)) {\n      throw new TypeError('Icon must be String or Object');\n    }\n\n    if (!icon.url) {\n      throw new TypeError('Icon url is undefined');\n    }\n\n    icon.size || (icon.size = olleh.maps.overlay.Marker.DEFAULT_ICON.size);\n    icon.anchor || (icon.anchor = new olleh.maps.Point(icon.size.width / 2, icon.size.height));\n\n    if (this._icon != icon) {\n      this._icon = icon;\n      if (this.isDrawn()) {\n        this._updateIcon();\n        /**\n         * icon_changed .    .\n         * <p/>\n         * @name event:icon_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('icon_changed');\n      }\n    }\n  },\n\n  _updateIcon: function () {\n    var icon = this._icon; // iconOption\n    var img = this._iconImg; // iconImgDom\n\n    if (!icon) { //     .\n      var Marker = olleh.maps.overlay.Marker;\n \n      icon = olleh.maps.browser.isHD ? Marker.DEFAULT_HD_ICON : \n        olleh.maps.browser.isMobile ? Marker.DEFAULT_MOBILE_ICON : Marker.DEFAULT_ICON;\n\n      this._icon = icon; // _icon   setIcon event  .\n      this.setIcon(icon);\n    }\n\n    if (!img) {\n      var iconDiv = olleh.maps.Element.create('div').setStyle('position', 'absolute');\n      img = this._iconImg = new olleh.maps.SpritedImage();\n      iconDiv.appendChild(img);\n      this._updateCursor();\n      this.registerElement('upper_overlay_pane', iconDiv.elem);\n      this.registerEventDom(this._iconImg.elem);\n    }\n\n    if (this._currentIcon != icon) {\n      img.setStyles({\n        width: icon.size.width + 'px',\n        height: icon.size.height + 'px',\n        marginLeft: -icon.anchor.x + 'px',\n        marginTop: -icon.anchor.y + 'px'\n      }).setImage(icon.url, icon.origin, icon.scaledSize);\n      this._currentIcon = icon;\n    }\n    //    \n    var origin = (100 - 100 * (icon.size.width - icon.anchor.x)\n        / icon.size.width) + \"% \"\n        + (100 - 100 * (icon.size.height - icon.anchor.y)/ icon.size.height) + \"%\";\n    img.setStyle('transformOrigin', origin);\n  },\n\n  /**\n   *    .\n   * @example marker.setAngle(45);\n   * @fires olleh.maps.overlay.Marker#event:angle_changed\n   * @param {Number} angle   \n   */\n  setAngle: function(angle){\n    this._angle = angle;\n      if (this.isDrawn()) {\n        this._updateAngle();\n        /**\n         * angle_changed .     .\n         * <p/>\n         * @name event:angle_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('angle_changed');\n      }\n  },\n\n  _updateAngle: function () {\n    var img = this._iconImg;\n    img.setStyles({\n      transform: \"rotate(\" + this._angle + \"deg)\"\n    });\n  },\n\n  /**\n   *    .\n   * @returns {Number} angle\n   */\n  getAngle: function(){\n    return this._angle;\n  },\n  \n  /**\n   *    .\n   * @returns {String} title\n   */\n  getTitle: function () {\n    return this._title;\n  },\n  \n  /**\n   *    .\n   * @example marker.setTitle('');\n   * @fires olleh.maps.overlay.Marker#event:title_changed\n   * @param {String} title   \n   */\n  setTitle: function (title) {\n    this._title = title;\n    /**\n     * title_changed . marker    .\n     * <p/>\n     * @name event:title_changed\n     * @event\n     * @memberOf olleh.maps.overlay.Marker.prototype\n     * @param {olleh.maps.event.Event} event\n     */\n      this.isAdded() && this.fireEvent('title_changed');\n  },\n\n  /**\n   *   .\n   * @returns {String} cursor  \n   */\n  getCursor: function () {\n    return this._cursor;\n  },\n\n  /**\n   *      .\n   * @example marker.setCursor('point');\n   * @fires olleh.maps.overlay.Marker#event:cursor_changed\n   * @param {String} cursor\n   */\n  setCursor: function (cursor) {\n    this._cursor = cursor;\n    if (this.isDrawn()) {\n      this._updateCursor();\n      /**\n       * cursor_changed . marker    .\n       * @name event:cursor_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('cursor_changed');\n    }\n  },\n\n  _updateCursor: function () {\n    this._iconImg.setStyle('cursor', this._cursor);\n  },\n  \n  /**\n   *   Object .\n   * @returns {Object}   Object\n   */\n  getShadow: function () {\n    // TODO \n    return this._shadowImg ? this._shadow : null;\n  },\n\n  /**\n   *    .\n   * @example \n   * var shadow = {\n   *   url:'shadow.png', \n   *   size: new olleh.maps.Size(21, 30), \n   *   anchor: new olleh.maps.Point(10, 30)};\n   * marker.setShadow(shadow);\n   * marker2.setShadow('shadow.png');\n   * @fires olleh.maps.overlay.Marker#event:shadow_changed\n   * @param {String|olleh.maps.overlay.MarkerIconOptions} shadow   URL     Obect\n   */\n  setShadow: function (shadow) {\n    if (olleh.maps.isString(shadow)) {\n      shadow = {\n        url: shadow\n      };\n    } else if (!olleh.maps.isObject(shadow)) {\n      throw new TypeError('Shadow must be String or Object');\n    }\n\n    if (!shadow.url) {\n      throw new TypeError('Shadow url is undefined');\n    }\n\n    shadow.size || (shadow.size = olleh.maps.overlay.Marker.DEFAULT_SHADOW.size);\n    shadow.anchor || (shadow.anchor = new olleh.maps.Point(0, shadow.size.height));\n\n    if (this._shadow != shadow) {\n      this._shadow = shadow;\n      if (this.isDrawn()) {\n        this._updateShadow();\n        /**\n         * shadow_changed . marker    .\n         * <p/>\n         * @name event:shadow_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('shadow_changed');\n      }\n    }\n  },\n\n  _updateShadow: function () {\n    var shadow = this._shadow, img = this._shadowImg;\n    var disableShadow = this.getLayer().disableShadow;\n    \n    if (!shadow) {\n      if(olleh.maps.browser.isHD) this._shadow = olleh.maps.overlay.Marker.DEFAULT_HD_SHADOW;\n      else if(olleh.maps.browser.isMobile) this._shadow = olleh.maps.overlay.Marker.DEFAULT_MOBILE_SHADOW ;\n      else this._shadow = olleh.maps.overlay.Marker.DEFAULT_SHADOW;\n      this.setShadow(this._shadow);\n      shadow = this._shadow;\n    }\n\n    if (!disableShadow && !this._flat) {\n      if (!img) {\n        img = this._shadowImg = new olleh.maps.SpritedImage();\n        this.registerElement('overlay_shadow_pane', img.elem);\n      }\n      if (this._currentShadow != shadow) {\n        img.setStyles({\n          width: shadow.size.width + 'px',\n          height: shadow.size.height + 'px',\n          marginLeft: -shadow.anchor.x + 'px',\n          marginTop: -shadow.anchor.y + 'px'\n        }).setImage(shadow.url, shadow.origin, shadow.scaledSize);\n        this._currentShadow = shadow;\n      }\n    } else {\n      if (img) {\n        this.unregisterElement('overlay_shadow_pane', img.elem);\n        this._shadowAnimator && this._shadowAnimator.stop();\n        this._shadowAnimator = null;\n        this._currentShadow = null;\n        this._shadowImg = null;\n      }\n    }\n  },\n\n  /**\n   * Marker caption .\n   * @returns {olleh.maps.overlay.MarkerCaptionOptions} captionOptions\n   */\n  getCaption: function () {\n    return this._caption;\n  },\n\n  /**\n   * marker Caption  .\n   * @example\n   * marker.setCaption('');\n   * marker.setCaption({\n   *   title: '',\n   *   backgroundColor: '#ffffff'\n   * });\n   * @fires olleh.maps.overlay.Marker#event:caption_changed\n   * @param {String|olleh.maps.overlay.MarkerCaptionOptions} captionOptions  caption \n   */\n  setCaption: function (caption) {\n    if (olleh.maps.isString(caption)) {\n      caption = {\n        title: caption\n      };\n    } else if (!olleh.maps.isObject(caption)) {\n      throw new TypeError('Caption must be String or Object');\n    }\n\n    // caption.title 0  empty string   \n    // icon.url shadow.url !caption.title   .\n    if (caption.title === null || caption.title === undefined) {\n      throw new TypeError('Caption title is undefined');\n    }\n\n    this._caption = caption;\n\n    if (this.isDrawn()) {\n      this._updateCaption();\n      /**\n       * caption_changed . marker    .\n       * <p/>\n       * @name event:caption_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('caption_changed');\n    }\n  },\n  \n  _updateCaption: function() {\n    var span, div = this._captionDiv;\n    var caption = this._caption;\n\n    if (caption) {\n      caption.size = caption.size || 9;\n      caption.backgroundColor = caption.backgroundColor || \"\";\n      caption.color = caption.color || '#000000';\n      \n      if (!div) {\n        div = this._captionDiv = olleh.maps.Element.create('div').setStyles({\n          position: 'absolute',\n          marginLeft: '-100px',\n          width: '200px',\n          textAlign: 'center'\n        });\n        span = olleh.maps.Element.create('span');\n        div.appendChild(span);\n        this.registerElement('lower_overlay_pane', div.elem);\n      } else{\n        span = new olleh.maps.Element(div.elem.firstChild);\n      }\n      span.setStyles({\n        backgroundColor: caption.backgroundColor,\n        color: caption.color,\n        fontSize: caption.size + 'pt',\n        fontWeight: 'bold',\n        padding: '2px'\n      });\n      span.elem.innerHTML = '' + caption.title;\n    } else {\n      if (div) {\n        this.unregisterElement('lower_overlay_pane', div.elem);\n        this._captionDiv = null;\n      }\n    }\n  },\n\n  /**\n   *  flat \n   * @returns {Boolean} flat\n   */\n  isFlat: function () {\n    return this._flat;\n  },\n\n  /**\n   *  flat  .\n   * @example marker.setFlat(true);\n   * @fires olleh.maps.overlay.Marker#event:flat_changed\n   * @param {boolean} flat <code>true</code>  shadow  .\n   */\n  setFlat: function (flat) {\n    this._flat = flat;\n    if (this.isDrawn()) {\n      this._updateShadow();\n      /**\n       * flat_changed . marker flat    .\n       * <p/>\n       * @name event:flat_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('flat_changed');\n    }\n  },\n\n  /**\n   *  drag   .\n   * @returns {boolean} draggable\n   */\n  isDraggable: function () {\n    return this._draggable;\n  },\n\n  isDragging: function () {\n    return this._isDragging && this._draggable;\n  },\n\n  /**\n   *  drag   .\n   * @fires olleh.maps.overlay.Marker#event:draggable_changed\n   * @param {boolean} draggable <code>true</code>  marker drag .\n   */\n  setDraggable: function (draggable) {\n\n    if (this._draggable != draggable) {\n      this._draggable = draggable;\n      /**\n       * draggable_changed . marker drag     .\n       * <p/>\n       * @name event:draggable_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('draggable_changed');\n    }\n  },\n\n  /**\n   * @private\n   * @param event\n   * @param payload\n   */\n  $capture_dragstart: function (event, payload) {\n    if(!this._draggable) return;\n\n    var dragImg = this._dragImg;\n    var DRAG_FLOATING_PX = olleh.maps.overlay.Marker.DRAG_FLOATING_PX;\n\n    event.preventDefault();\n    this._isDragging = true;\n\n    if (!dragImg) {\n      // drag Pointer Image \n      var DRAG_POINT = olleh.maps.overlay.Marker.DRAG_POINT;\n      var size = DRAG_POINT.size;\n      var anchor = DRAG_POINT.anchor || new olleh.maps.Point(size.width / 2, size.height);\n      dragImg = this._dragImg = new olleh.maps.SpritedImage().setStyles({\n        width: size.width + 'px',\n        height: size.height + 'px',\n        marginLeft: -anchor.x + 'px',\n        marginTop: -anchor.y + 'px',\n        zIndex: olleh.maps.overlay.BaseOverlay.MAX_ZINDEX\n      }).setImage(DRAG_POINT.url, DRAG_POINT.origin);\n    }\n    if (this._tooltip) {\n      this._tooltip.close();\n      delete this._tooltip;\n    }\n    this._iconImg.addClass('ollehmap-dragging');\n    this.registerElement('upper_overlay_pane', dragImg.elem);\n    this._float(DRAG_FLOATING_PX);\n    this._infoWin && this._infoWin._dragStart(new olleh.maps.Point(0, -DRAG_FLOATING_PX), new olleh.maps.Point(DRAG_FLOATING_PX, -DRAG_FLOATING_PX));\n  },\n\n  /**\n   * @private\n   * @param event\n   * @param payload\n   */\n  $capture_drag: function (event, payload) {\n    if (this.isDragging()) {\n      event.preventDefault();\n      this.move(payload.movementXY);\n      this._infoWin && this._infoWin._drag(payload.movementXY);\n    }\n  },\n\n  /**\n   * @private\n   * @param event\n   * @param payload\n   */\n  $capture_dragend : function (event, payload) {\n    if (this.isDragging()) {\n      var coord;\n      event.preventDefault();\n\n      this.unregisterElement('upper_overlay_pane', this._dragImg.elem);\n      this._sink(olleh.maps.overlay.Marker.DRAG_FLOATING_PX);\n\n      coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\n      this.setPosition(coord);\n      this._infoWin && this._infoWin._dragEnd(coord);\n      this._iconImg.removeClass('ollehmap-dragging');\n      this._isDragging = false;\n    }\n  },\n\n  /**\n   *  px marker  .\n   * @param {Number} distance \n   * @private\n   */\n  _float: function (distance) {\n    var o, anchor, shadowD;\n\n    if (this._animation != olleh.maps.overlay.Marker.BOUNCE) {\n      o = this._icon;\n      anchor = o.anchor || new olleh.maps.Point(o.size.width / 2, o.size.height);\n      this._iconImg.setStyles({\n        marginTop: -(anchor.y + distance) + 'px'\n      });\n      if (this._shadowImg) {\n        o = this._shadow;\n        anchor = o.anchor || new olleh.maps.Point(0, o.size.height);\n        shadowD = distance * Math.SQRT1_2;\n        this._shadowImg.setStyles({\n          marginTop: -(anchor.y + shadowD) + 'px',\n          marginLeft: -(anchor.x - shadowD) + 'px'\n        });\n      } \n    }\n  },\n\n  /**\n   *  px marker .\n   * @param distance \n   * @private\n   */\n  _sink: function (distance) {\n    var o, anchor;\n\n    if (this._animation != olleh.maps.overlay.Marker.BOUNCE) {\n      o = this._icon;\n      anchor = o.anchor || new olleh.maps.Point(o.size.width / 2, o.size.height);\n      this._iconImg.setStyles({\n        marginTop: -anchor.y + 'px'\n      });\n      if (this._shadowImg) {\n        o = this._shadow;\n        anchor = o.anchor || new olleh.maps.Point(0, o.size.height);\n        this._shadowImg.setStyles({\n          marginTop: -anchor.y + 'px',\n          marginLeft: -anchor.x + 'px'\n        });\n      }\n    }\n  },\n\n  /**\n   *    animation .\n   * @returns {String}  .\n   *  : {@link olleh.maps.overlay.Marker.BOUNCE} | {@link olleh.maps.overlay.Marker.DROP}\n   */\n  getAnimation: function () {\n    return this._animation;\n  },\n\n  /**\n   *  animation .\n   * @example marker.setAnimation(olleh.maps.overlay.Marker.BOUNCE);\n   * @fires olleh.maps.overlay.Marker#event:animation_changed\n   * @param {String} animation . <p/>\n   *  :\n   * <ul>\n   * <li>{@link olleh.maps.overlay.Marker.BOUNCE}</li>\n   * <li>{@link olleh.maps.overlay.Marker.DROP}</li>\n   * </ul>\n   */\n  setAnimation: function (animation) {\n    if (this._animation != animation) {\n      this._animation = animation;\n      if (this.isDrawn()) {\n        this._updateAnimation();\n        /**\n         * animation_changed . marker    .\n         * <p/>\n         * @name event:animation_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('animation_changed');\n      }\n    }\n  },\n  \n  _updateAnimation: function () {\n    var anchor;\n\n    if (!this._animation) {\n      this.stopAnimation();\n    } else if (this._animation === olleh.maps.overlay.Marker.BOUNCE) {\n      this.stopAnimationImmediately();\n      \n      anchor = this._icon.anchor || new olleh.maps.Point(this._icon.size.width / 2, this._icon.size.height);\n      this._iconAnimator = olleh.maps.overlay.Marker.getBounceAnimator(anchor).animate(this._iconImg.elem);\n      \n      if (this._shadowImg) {\n        anchor = this._shadow.anchor || new olleh.maps.Point(0, this._shadow.size.height);\n        this._shadowAnimator = olleh.maps.overlay.Marker.getBounceAnimator(anchor, true).animate(this._shadowImg.elem);\n      }\n    }\n  },\n\n  /**\n   *     .\n   * @private\n   */\n  stopAnimation: function () {\n    this._iconAnimator && this._iconAnimator.stopRepeat();\n    this._shadowAnimator && this._shadowAnimator.stopRepeat();\n  },\n\n  stopAnimationImmediately: function () {\n    this._iconAnimator && this._iconAnimator.stop();\n    this._shadowAnimator && this._shadowAnimator.stop();\n  },\n  \n  onAdd: function () {\n    var anchor, animator;\n\n    if (this._animation === olleh.maps.overlay.Marker.DROP) {\n      anchor = this._icon.anchor || new olleh.maps.Point(this._icon.size.width / 2, this._icon.size.height);\n      animator = olleh.maps.overlay.Marker.getDropAnimator(anchor);\n      this._iconImg.setStyles(animator.from);\n      animator.animate(this._iconImg.elem, {\n        callback: this.ready,\n        ctx: this\n      });\n      if (this._shadowImg) {\n        anchor = this._shadow.anchor || new olleh.maps.Point(0, this._shadow.size.height);\n        animator = olleh.maps.overlay.Marker.getDropAnimator(anchor, true);\n        this._shadowImg.setStyles(animator.from);\n        animator.animate(this._shadowImg.elem);\n      }\n    } else {\n      this.ready();\n    }\n  },\n\n  getBounds: function () {\n    return this._infoWin ? this._infoWin.getBounds().union(this._position): null;\n  },\n\n  /**\n   *  infowindow .\n   * @param {olleh.maps.overlay.BaseInfoWindow} infowindow\n   * @private\n   */\n  setInfoWindow: function (infoWin) {\n    if(infoWin == null)\n      this.resetZIndex();\n    this._infoWin = infoWin;\n  },\n\n  /**\n   *   .\n   * @example \n   * var position = new olleh.maps.UTMK(958094.06, 1942790.82);\n   * marker.setPosition(position);\n   * @param {olleh.maps.Coord} pos Coord\n   */\n  setPosition: function (pos) {\n    olleh.maps.overlay.Marker.$super.setPosition.apply(this, arguments);\n    this._infoWin && this._infoWin.setPosition(pos);\n  },\n\n  detach: function() {\n    this.stopAnimationImmediately();\n    if (this._infoWin) {\n      this._infoWin.close();\n      this._infoWin = null;\n    }\n    olleh.maps.overlay.Marker.$super.detach.apply(this, arguments);\n  },\n\n  $default_mouseover: function (event, payload) {\n    if(!this.isDragging() && this._title) {\n      var tooltip = this.map.getTooltip();\n      if (tooltip) {\n        tooltip.setContent(this._title);\n        tooltip.setPixelOffset(new olleh.maps.Point(0, 0));\n        tooltip.open(this.map, this);\n        this._tooltip = tooltip;\n      }\n    }\n    olleh.maps.overlay.Marker.$super.$default_mouseover.apply(this, arguments);\n  },\n\n  $default_mouseout: function (event, payload) {\n    if(this._tooltip) {\n      this._tooltip.close();\n      delete this._tooltip;\n    }\n    if(!this._infoWin)\n      olleh.maps.overlay.Marker.$super.$default_mouseout.apply(this, arguments);\n  },\n\n  zoomStart: function (scale, origin, duration) {\n    if (!this.isDragging()) {\n      olleh.maps.overlay.Marker.$super.zoomStart.apply(this, arguments);\n    }\n  },\n\n  zoomEnd: function () {\n    if (this.isDragging()) {\n      this.moveTo(this.getCurrentLayerPx());\n    } else {\n      olleh.maps.overlay.Marker.$super.zoomEnd.apply(this, arguments);\n    }\n  }\n\n});\n/**\r\n * ContentOverlayOptions Object Specification\r\n * @typedef olleh.maps.overlay.ContentOverlayOptions\r\n * @extends olleh.maps.overlay.PointedOverlayOptions\r\n * @property {String|Node} content ContentOverlay  content .\r\n * HTML element , plain-text string, HTML  string   . ContentOverlay content  size .\r\n * @property {olleh.maps.Point} [pixelOffset] position offset \r\n * @property {Number} [padding] content padding .\r\n */\r\n\r\n/**\r\n *        \r\n */\r\n$class('olleh.maps.overlay.ContentOverlay').extend(olleh.maps.overlay.PointedOverlay).define({\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.overlay.ContentOverlayOptions} opts \r\n   */\r\n  ContentOverlay: function (opts) {\r\n    this.name = 'olleh.maps.overlay.ContentOverlay';\r\n    this._defaultCss = null;\r\n    this._defaultPadding = 0;\r\n    this._body = null;\r\n    this._shadow = null;\r\n    this._marginPx = null;\r\n    this._topleftPx = null;\r\n    this._bounds = null;\r\n    this._opts = {};\r\n    this._opts.pixelOffset = new olleh.maps.Point(0,0);\r\n    this._contentAttacted = false;\r\n    this.contentSize = {\r\n        minWidth : 10,\r\n        minHeight : 10,\r\n        maxWidth : 800,\r\n        maxHeight : 800\r\n    };\r\n  },\r\n  \r\n  /**\r\n   *    \r\n   * @param event\r\n   * @param payload\r\n   * @private\r\n   */\r\n  $default_detached: function (event, payload) {\r\n    this._eliminateElements();\r\n    event.preventDefault();\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.ContentOverlayOptions} opts \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: false,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *    info.setOptions({content: WlongCnt,maxWidth: 300});\r\n   * });  \r\n   */\r\n  setOptions: function (opts) {\r\n    if (opts.maxWidth) {\r\n      var maxWidth = parseInt(opts.maxWidth);\r\n      opts.maxWidth = Math.min(maxWidth, this.contentSize.maxWidth);\r\n    } else if (this._opts.maxWidth) {\r\n      opts.maxWidth = this._opts.maxWidth;\r\n    } else {\r\n      opts.maxWidth = this.contentSize.maxWidth;\r\n    }\r\n    this._setMaxWidth(opts.maxWidth);\r\n    \r\n    if (opts.padding) {\r\n      opts.padding = parseInt(opts.padding);\r\n      this._setPadding(opts.padding);\r\n    }\r\n    \r\n    opts.pixelOffset && this.setPixelOffset(opts.pixelOffset);\r\n    olleh.maps.mixin(this._opts, opts, true);\r\n    if (opts.content){\r\n      this.setContent(opts.content);\r\n    } else if (opts.padding != undefined || opts.maxWidth != undefined) {\r\n      //padding  , maxWidth   content update.\r\n      // content  .\r\n      if (this._body) {\r\n        this._updateContent(this._body.contentElem.children[0]);\r\n      }\r\n      \r\n    }\r\n    olleh.maps.overlay.ContentOverlay.$super.setOptions.call(this, this._opts);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @see olleh.maps.overlay.PointedOverlay#update\r\n   */\r\n  update: function () {\r\n    if (!this._body) this._updateElements();\r\n    olleh.maps.overlay.ContentOverlay.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   * @see olleh.maps.overlay.BaseOverlay#draw\r\n   * @override\r\n   * @param onAdd\r\n   * @private\r\n   */\r\n  draw: function (onAdd) {\r\n    olleh.maps.overlay.ContentOverlay.$super.draw.apply(this, arguments);\r\n    if (!this._contentAttacted) {\r\n      this._contentAttacted = true;\r\n      this.fireEvent('domready');\r\n    } \r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay Content .\r\n   * @fires olleh.maps.overlay.ContentOverlay#event:content_changed\r\n   * @param {String|Node} content ContentOverlay  content . \r\n   * HTML element , plain-text string, HTML  string   . ContentOverlay content  size .\r\n   *  size   HTML style size . \r\n   *  ContentOverlay ,  width, height  . \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   *  \r\n   * marker.onEvent('click', function () { info.setContent('Hello World'); });  \r\n   */\r\n  setContent: function (content) {\r\n    this._opts.content = content;\r\n    this._contentAttacted = false;\r\n    if (this.isAdded()) {\r\n      this._updateContent();\r\n      if (this.isDrawn()) {\r\n        this._contentAttacted = true;\r\n        this.fireEvent('domready');\r\n      }\r\n      this.fireEvent('content_changed');\r\n    }\r\n  },\r\n  /**\r\n   * 'domread' content_changed    content .\r\n   * setMaxWidth, setPadding .\r\n   * @private \r\n   */\r\n  _updateContent: function (beforeContent) {\r\n    if (this.isAdded()) {\r\n      this._eliminateElements();\r\n      this._updateElements(beforeContent);\r\n      olleh.maps.overlay.ContentOverlay.$super.update.apply(this, arguments);\r\n    }\r\n  },\r\n  /**\r\n   * ContentOverlay content .\r\n   * @returns {String|Node} content ContentOverlay  Content \r\n   */\r\n  getContent: function (content) {\r\n    return this._opts.content;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay position .\r\n   * @fires olleh.maps.overlay.ContentOverlay#event:position_changed\r\n   * @param {olleh.maps.Coord} coord ContentOverlay   \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *   info.setPosition(new olleh.maps.UTMK(953795.70, 1969715.52));\r\n   * }); \r\n   */\r\n  setPosition: function (coord) {\r\n    var from = this._position;\r\n    this._opts.position = coord;\r\n    this._position = coord;\r\n    if (this.isAdded()) {\r\n      this._updateMargin();\r\n      this._updateBounds();\r\n      //position  margin   .\r\n      if (this.isDrawn()) {\r\n        this._updatePosition();\r\n      }\r\n      this.fireEvent('position_changed',{from: from, to: coord});\r\n    }\r\n    \r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay Position .\r\n   * @returns {olleh.maps.Coord} coord ContentOverlay  \r\n   */\r\n  getPosition: function () {\r\n    return this._opts.position;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay pixelOffset .\r\n   * @param {olleh.maps.Point} offset ContentOverlay pixelOffset \r\n   */\r\n  setPixelOffset: function (offset) {\r\n    this._opts.pixelOffset = offset;\r\n    if (this.isAdded()) {\r\n      this._updateMargin();\r\n      this._updateBounds();\r\n      if (this.isDrawn()) {\r\n        this._updatePosition();\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay pixelOffset .\r\n   * @returns {olleh.maps.Point} pixelOffset\r\n   */\r\n  getPixelOffset: function () {\r\n    return this._opts.pixelOffset;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay body .\r\n   *\r\n   * @param {olleh.maps.Size} contentSize   \r\n   * @param {olleh.maps.Point} point ContentOverlay  , layerPixel \r\n   * @return {Element}          [rootElem] ContentOverlay body root element\r\n   *         {Element}          [contentElem] ContentOverlay body content element\r\n   *         {Element}          [closeElem] ContentOverlay body close element\r\n   *         {olleh.maps.Size}  [size] ContentOverlay size\r\n   *         {olleh.maps.Point} [topLeftPoint] ContentOverlay top left Point. \r\n   *                                  point   top, left   .\r\n   *@private\r\n   */\r\n  createBodyElem: function (contentSize, point) {},\r\n  \r\n  /**\r\n   * ContentOverlay shadow . \r\n   * \r\n   * @param {olleh.maps.Size} contentSize   \r\n   * @param  {olleh.maps.Point} point ContentOverlay   , layerPixel \r\n   * @return {Element}          [rootElem] ContentOverlay  root element\r\n   *         {olleh.maps.Size}  [size] ContentOverlay size\r\n   *         {olleh.maps.Point} [topLeftPoint] ContentOverlay top left Point. \r\n   *                                  point   top, left   .\r\n   *@private\r\n   */\r\n  createShadowElem: function (contentSize, point) {},\r\n  \r\n  _setMaxWidth: function (width) {\r\n    this._opts.maxWidth = width;\r\n  },\r\n  \r\n  _setPadding: function (padding) {\r\n    if (padding*2 >= this.contentSize.maxWidth) {\r\n      throw new RangeError('padding   .' \r\n          +this.contentSize.maxWidth/2+'  .');\r\n    }\r\n    this._opts.padding = padding;\r\n  },\r\n  /**\r\n   * ContentOverlay elements(body, shadow) ,  .\r\n   * @private\r\n   */\r\n  _updateElements: function (beforeContent) {\r\n    var domutil = olleh.maps.util.dom;\r\n    var opts = this._opts;\r\n    var size = this._checkContentSize(beforeContent);\r\n    var pos = opts.position;\r\n    var layerMgr = this.layer.layerMgr;\r\n    \r\n    var layerPx = layerMgr.getLayerPxFromCoord(pos);\r\n    layerPx = new olleh.maps.Point(Math.round(layerPx.x), Math.round(layerPx.y));    \r\n    \r\n    this._body = this.createBodyElem(size, layerPx);\r\n    this._topLeftPx = { body: this._body.topLeftPoint.subtract(layerPx)};\r\n    \r\n    if (beforeContent == undefined) {\r\n      var optsContent = opts.content;\r\n      var div = document.createElement('div');\r\n     \r\n      if (olleh.maps.isString(optsContent)) {\r\n        div.innerHTML = optsContent;\r\n      } else {\r\n        domutil.pushElement(div, optsContent);\r\n      }\r\n      domutil.addClass(div,this._defaultCss);\r\n      domutil.pushElement(this._body.contentElem, div);\r\n    } else {\r\n      //  content  .\r\n      domutil.pushElement(this._body.contentElem, beforeContent);\r\n    }\r\n    this.registerElement('infowindow_pane', this._body.rootElem);\r\n    \r\n    if (!this.layer.disableShadow) {\r\n      this._shadow = this.createShadowElem(size, layerPx);\r\n      if (this._shadow) {\r\n        this.registerElement('infowindow_shadow_pane', this._shadow.rootElem);\r\n        this._topLeftPx.shadow = this._shadow.topLeftPoint.subtract(layerPx);\r\n      }\r\n    }\r\n    //Event .\r\n    this._appendEvent();\r\n    //margin .\r\n    this._updateMargin();\r\n    //bound .\r\n    this._updateBounds();\r\n  },\r\n  \r\n  /**\r\n   * margin offset  . ContentOverlay top, left Margin .\r\n   *  margin option  pixelOffset .\r\n   * @private\r\n   */\r\n  _updateMargin: function () {\r\n    var offset = this._opts.pixelOffset;\r\n    this._marginPx = { body : this._topLeftPx.body.add(offset)};\r\n    if (this._shadow) {\r\n        this._marginPx.shadow = this._topLeftPx.shadow.add(offset);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay bounds  .\r\n   * @private\r\n   */\r\n  _updateBounds: function () {\r\n    var oldBounds = this._bounds;\r\n    var layerMgr = this.layer.layerMgr;\r\n    var pos = this._opts.position;\r\n    var layerPx = layerMgr.getLayerPxFromCoord(pos);\r\n    var topleft = this._marginPx.body.add(layerPx);\r\n    var leftBottom = \r\n      layerMgr.getCoordFromLayerPx(new olleh.maps.Point(topleft.x, topleft.y + this._body.size.height));\r\n    var rightTop = \r\n      layerMgr.getCoordFromLayerPx(new olleh.maps.Point(topleft.x + this._body.size.width, topleft.y));\r\n    this._bounds = new olleh.maps.Bounds(leftBottom, rightTop);\r\n    if (this._shadow) {\r\n      var s_topleft = this._marginPx.shadow.add(layerPx);\r\n      var s_leftBottom = \r\n        layerMgr.getCoordFromLayerPx(new olleh.maps.Point(s_topleft.x, s_topleft.y + this._shadow.size.height));\r\n      var s_rightTop = \r\n        layerMgr.getCoordFromLayerPx(new olleh.maps.Point(s_topleft.x + this._shadow.size.width, s_topleft.y));\r\n      var shadowBounds = new olleh.maps.Bounds(s_leftBottom, s_rightTop);\r\n      this._bounds = this._bounds.union(shadowBounds);\r\n    }\r\n    this.fireEvent('bounds_changed', {from: oldBounds, to: this._bounds});\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay   .\r\n   * @override\r\n   * @see olleh.maps.overlay.PointedOverlay#_updatePosition}\r\n   * @private\r\n   */\r\n  _updatePosition: function () {\r\n    var body = this._body;\r\n    var bm = this._marginPx.body;\r\n    body.rootElem.style.marginTop = bm.y + 'px';\r\n    body.rootElem.style.marginLeft = bm.x + 'px';\r\n    \r\n    if (this._shadow) {\r\n      var shadow = this._shadow;\r\n      var sm = this._marginPx.shadow;\r\n      shadow.rootElem.style.marginTop = sm.y + 'px';\r\n      shadow.rootElem.style.marginLeft = sm.x + 'px';\r\n    } \r\n    olleh.maps.overlay.ContentOverlay.$super._updatePosition.apply(this);\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay  .\r\n   *  @returns {olleh.maps.Bounds} bounds ContentOverlay \r\n   */\r\n  getBounds: function () {\r\n    if (!this._body) { //element    .\r\n      this._updateElements();\r\n    }\r\n    return this._bounds;\r\n  },\r\n  \r\n  /**\r\n   * @override\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n    this._updateBounds();\r\n    olleh.maps.overlay.ContentOverlay.$super.zoomEnd.apply(this);\r\n  },\r\n  \r\n  /**\r\n   * content size  .\r\n   * @returns {olleh.maps.Size} size\r\n   * @private \r\n   */\r\n  _checkContentSize: function (beforeContent) {\r\n    var pDiv = document.createElement('div');\r\n    var iDiv = document.createElement('div');\r\n    var domutil = olleh.maps.util.dom;\r\n    var maxWidth = (this._opts.maxWidth? this._opts.maxWidth : this.contentSize.maxWidth);\r\n    var contentPadding = this._opts.padding == undefined ? this._defaultPadding : this._opts.padding;\r\n    var dbContentPadding = contentPadding*2;\r\n    domutil.setStyles(pDiv, {\r\n      position: 'absolute',\r\n      left: '10000px',\r\n      top: '0px',\r\n      width : maxWidth - dbContentPadding +'px',\r\n      height :this.contentSize.maxHeight - dbContentPadding + 'px',\r\n      margin: '0px',\r\n      padding: '0px',\r\n      opacity: 0\r\n    });\r\n    domutil.setStyles(iDiv, {\r\n      position: 'absolute',\r\n      overflow: 'auto',\r\n      minWidth: Math.max(0,this.contentSize.minWidth - dbContentPadding)+ 'px',\r\n      minHeight: Math.max(0,this.contentSize.minHeight - dbContentPadding)+ 'px',\r\n      maxWidth: maxWidth - dbContentPadding+'px',\r\n      maxHeight: this.contentSize.maxHeight - dbContentPadding+ 'px'\r\n    });\r\n    domutil.addClass(iDiv,this._defaultCss);\r\n    pDiv.appendChild(iDiv);\r\n    if (beforeContent == undefined) {\r\n      var content = this._opts.content;\r\n      if (olleh.maps.isString(content)) {\r\n        iDiv.innerHTML = content;\r\n      } else {\r\n        domutil.pushElement(iDiv,content);\r\n      }\r\n    } else {\r\n      domutil.pushElement(iDiv,beforeContent);\r\n    }\r\n    \r\n    \r\n    var infopane = this.layer.getPane('infowindow_pane');\r\n    \r\n    domutil.pushElement(infopane, pDiv);\r\n    var size = new olleh.maps.Size(\r\n        iDiv.offsetWidth, \r\n        iDiv.offsetHeight\r\n    );\r\n    domutil.popElement(infopane, pDiv);\r\n    return size;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay  .\r\n   * @private\r\n   */\r\n  _appendEvent: function () {\r\n    var body = this._body;\r\n    this.registerEventDom(body.contentElem);\r\n    if (!this._opts.disableCloseButton && body.closeElem) {\r\n      this.registerEventDom(body.closeElem);\r\n    } \r\n  },\r\n  \r\n\r\n  /**\r\n   *  pane  element .\r\n   * @private\r\n   */\r\n  _eliminateElements: function () {\r\n    this.unregisterElement('infowindow_pane',this._body.rootElem);\r\n    this._shadow && this.unregisterElement('infowindow_shadow_pane',this._shadow.rootElem);\r\n    this._topleftPx = null;\r\n    this._body = null;\r\n    this._shadow = null;\r\n    this._marginPx = null;\r\n    this._contentAttacted = false;\r\n  }\r\n});\n/////////////////////////\r\n//  InfoWindowOptions  //\r\n/////////////////////////\r\n/**\r\n * InfoWindowOptions Object Specification\r\n * @typedef olleh.maps.overlay.InfoWindowOptions\r\n * @extends olleh.maps.overlay.ContentOverlayOptions\r\n * @property {olleh.maps.Point} [pixelOffset=(0,0)] InfoWindow position offset \r\n * @property {Number} [zIndex] InfoWindow zIndex\r\n * @property {Number} [maxWidth=600] infowindow  width\r\n * @property {Boolean} [disableAutoPan=false] map  InfoWindow   \r\n * @property {Boolean} [disableCloseButton=false] InfoWindow closeButton   .\r\n * @property {Number} [padding=18] content padding .\r\n * @property {String|Node} content InfoWindow  content . \r\n * HTML element , plain-text string, HTML  string   . InfoWindow content  size .\r\n *  size   HTML style size .  InfoWindow size ,  width, height  .\r\n */\r\n\r\n/**\r\n *  BaseInfoWindow InfoWindow    .  InfoWindow  \r\n *  {@link olleh.maps.overlay.InfoWindow} .\r\n *  BaseInfoWindow  InfoWindow      createBodyElem,\r\n *  createShadowElem  InfoWindow   .\r\n *  createBodyElem Tip Body  DOM   createShadowElem\r\n *   shadow  DOM  .<p/>\r\n *  BaseInfoWindow  InfoWindow  ()      Overlay.\r\n *  InfoWindow UI    , UI  body, shadow, tip . \r\n *  tip (tip  )  tip      . \r\n *  body tip         .\r\n *  shadow InfoWindow tip body     .\r\n *  InfoWindow Marker  Overlay    . \r\n *    InfoWindow option   {@link olleh.maps.overlay.BaseInfoWindow#open}  InfoWindow  .\r\n *   close    , {@link olleh.maps.overlay.BaseInfoWindow#close}     .\r\n *     InfoWindow     DOM       .  \r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:close_click|close_click}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:content_changed|content_changed}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:domready|domready}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:position_changed|position_changed}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:zIndex_changed|zIndex_changed}</li>\r\n * </ul>\r\n * \r\n * @summary InfoWindow  ()      Overlay.\r\n */\r\n$class('olleh.maps.overlay.BaseInfoWindow').extend(olleh.maps.overlay.ContentOverlay).define({\r\n  \r\n  $static: { \r\n    AUTO_PAN_MARGIN : 10\r\n  },\r\n  /**\r\n   * close_click <p/>\r\n   *        .\r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.onEvent('close_click', \r\n   *   function (event) { console.log('close_click');}\r\n   * );\r\n   * info.open(map, marker);\r\n   * @name event:close_click\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   * \r\n   **/\r\n  /**\r\n  * content_changed <p/>\r\n  * InfoWindow Content     .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('content_changed', \r\n  *   function (event) { console.log('content_changed');}\r\n  * );\r\n  * info.open(map, marker); \r\n  * @name event:content_changed\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n /**\r\n  * domready <p/>\r\n  * InfoWindow DOM Tree  append     . \r\n  * InfoWindow DOM Tree append       . \r\n  *   InfoWindow DOM Tree append  append     .\r\n  *  InfoWindow DOM Tree append  InfoWindow       \r\n  * InfoWindow DOM Tree  .  InfoWindow      InfoWindow DOM Tree . \r\n  *  domready  .  DOM Tree  append   domready  .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('domready', \r\n  *   function (event) { console.log('domready');}\r\n  * );\r\n  * info.open(map, marker); \r\n  * @name event:domready\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n  /**\r\n  * position_changed <p/>\r\n  * InfoWindow position     .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('position_changed', \r\n  *   function (event) { console.log('position_changed');}\r\n  * );\r\n  * info.open(map, marker);\r\n  * @name event:position_changed\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n  /**\r\n  * zIndex_changed <p/>\r\n  * InfoWindow zIndex     .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('zIndex_changed', \r\n  *   function (event) { console.log('zIndex_changed');}\r\n  * );\r\n  * info.open(map, marker);\r\n  * @name event:zIndex_changed\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.overlay.InfoWindowOptions} opts InfoWindowOptions\r\n   */\r\n  BaseInfoWindow: function (opts) {\r\n    this.name = 'olleh.maps.overlay.BaseInfoWindow';\r\n    //content   css\r\n    this._defaultCss = 'ollehmap-info-defaultStyle';\r\n    //content   padding\r\n    this._defaultPadding = 18;\r\n    this._anchor = null;\r\n    this._body =  null;\r\n    this._shadow =  null;\r\n    this._anchorOffset =  null;\r\n    \r\n    this.contentSize = {\r\n    //minWidth = maxHeight/2 - topShadowImageHeight + bottomShadowImageHeight + SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP\r\n    //   css ollehmap-info-content   .\r\n    //minHeight = 60(   :SHADOW_IMG_TOP_HEIGHT : 10 + SHADOW_IMG_BOTTOM_HEIGHT : 30) / cos45\r\n        minWidth : 300,\r\n        minHeight : 60,\r\n        maxWidth : 600,\r\n        maxHeight : 500 \r\n    };\r\n  },\r\n \r\n  /**\r\n   * auto-pan    InfoWindow elements  auto-pan .\r\n   * @private\r\n   */\r\n  $default_attached: function (event, payload) {\r\n    event.preventDefault();\r\n    if (!this._opts.disableAutoPan) {\r\n      if (!this._body) this._updateElements();\r\n      this._autoPan();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow content  \r\n   * close       \r\n   *   .\r\n   * @override\r\n   * @param event\r\n   * @param payload\r\n   * @private\r\n   */\r\n  propagateEvent: function (event, payload) {\r\n    try {\r\n      switch (event.getName()) {\r\n      case 'attached':\r\n      case 'detached':\r\n      case 'position_changed':\r\n      case 'bounds_changed':\r\n      case 'click':\r\n        break;\r\n      default:\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      }\r\n    } finally {\r\n      olleh.maps.overlay.BaseInfoWindow.$super.propagateEvent.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  $capture_click: function (event, payload) {\r\n    event.stopPropagation();\r\n    if (this._opts.disableCloseButton || this._body.closeElem !== event.targetDOM) {\r\n      event.preventDefault();\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  : close      .\r\n   * @private\r\n   */\r\n  $default_click: function (event, payload) {\r\n    event.preventDefault();\r\n    if (!this._opts.disableCloseButton && this._body.closeElem === event.targetDOM) {\r\n      this.fireEvent('close_click');\r\n      this.close();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow open . anchor  anchor position  \r\n   * InfoWindow . anchor  {@link olleh.maps.overlay.Marker}  marker anchor marker  \r\n   *  marker   . anchor marker   getPosition  \r\n   *  InfoWindow  . marker     \r\n   * {@link olleh.maps.overlay.InfoWindowOptions.pixelOffset}   . \r\n   * \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map, marker);\r\n   * @see olleh.maps.overlay.BaseInfoWindow#close\r\n   * @param {olleh.maps.Map} map Overlay  Map  \r\n   * @param anchor {olleh.maps.Coord | olleh.maps.Point | olleh.maps.overlay.Overlay} anchor {@link olleh.maps.Coord}  {@link olleh.maps.Point}  \r\n   * {@link olleh.maps.overlay.Overlay} (Marker ). Point  viewport  .\r\n   */\r\n  open: function (map, anchor) {\r\n    if (this._anchor instanceof olleh.maps.overlay.Marker) {\r\n      // anchor marker   .\r\n      this._anchor.setInfoWindow(null);\r\n    }\r\n    \r\n    if (anchor) {\r\n      //anchor open    opts Position  .\r\n      if (!this._anchor) {\r\n        this._optsPosition = this._opts.position;\r\n      }\r\n      \r\n      var coord = null;\r\n      if(anchor instanceof olleh.maps.Coord) {\r\n        coord = anchor;\r\n      } else if (anchor instanceof olleh.maps.Point) {\r\n        coord = map.layerMgr.getCoordFromViewportPx(anchor);\r\n      } else if (anchor instanceof olleh.maps.overlay.Marker) {\r\n        anchor.setInfoWindow(this);\r\n        var markerIcon = anchor.getIcon();\r\n        var markerShadow = anchor.getShadow();\r\n        this._anchorOffset = {};\r\n        this._anchorOffset.body =\r\n            new olleh.maps.Point(\r\n                Math.round(markerIcon.size.width/2 - markerIcon.anchor.x),\r\n                -markerIcon.size.height\r\n            );\r\n        if (markerShadow) {\r\n          this._anchorOffset.shadow = \r\n            new olleh.maps.Point(\r\n                Math.round(markerShadow.size.width - markerShadow.anchor.x),\r\n                -markerShadow.size.height\r\n            );\r\n        } else {\r\n          this._anchorOffset.shadow = \r\n            new olleh.maps.Point(\r\n                Math.round(markerIcon.size.width/2 - markerIcon.anchor.x),\r\n                -markerIcon.size.height\r\n            );\r\n        }\r\n        coord = anchor.getPosition();\r\n      } else if (anchor instanceof olleh.maps.overlay.Overlay) {\r\n        if (anchor.getPosition()) {\r\n          coord = anchor.getPosition();\r\n        } else if (anchor.getBounds()) {\r\n          coord = anchor.getBounds().getCenter();\r\n        } else {\r\n          throw new TypeError(\"anchor parameter must have a position\");\r\n        }\r\n      } else {\r\n        throw new TypeError(\"anchor parameter is incorrect\");\r\n      }\r\n      this._anchor = anchor;\r\n      this._setPosition(coord);\r\n    } else if (this._anchor  && this.isAdded()) {\r\n      // anchor   anchor   open .\r\n      this._anchor = null;\r\n      this._anchorOffset = null;\r\n      if (this._optsPosition) {//option   .\r\n        this._setPosition(this._optsPosition);\r\n        this._optsPosition = null;\r\n      } else {\r\n        throw new Error(\"Option's Position value is not exist\");\r\n      }\n    }\r\n    if (!this.isAdded()) {\r\n      \r\n      this.setMap(map);\r\n      \r\n    } else if (!this._opts.disableAutoPan) {\r\n      //infowindow   open  autopan\r\n      this._autoPan();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * DOM Tree InfoWindow elements  InfoWindow .\r\n   * @fires olleh.maps.overlay.BaseInfoWindow#event:close_click\r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: true,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   *\r\n   * marker.onEvent('click', function () { info.close(); });\r\n   */\r\n  close: function () {\r\n    if (this.isAdded()) {\r\n      if (this._anchor instanceof olleh.maps.overlay.Marker) {\r\n        this._anchor.setInfoWindow(null);\r\n      }\r\n      this.setMap(null);\r\n    } \r\n  },\r\n  \n  /**\r\n   * InfoWindow . \r\n   * @private\r\n   */\r\n  $default_detached: function(event, payload) {\r\n    olleh.maps.overlay.BaseInfoWindow.$super.$default_detached.apply(this, arguments);\n    this._anchor = null;\r\n    this._anchorOffset = null;\r\n    this._optsPosition = null;\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow zIndex .\r\n   * @param {Number} zIndex InfoWindow zIndex  , default . \r\n   * zIndex       .\r\n   * @fires olleh.maps.overlay.BaseInfoWindow#event:zIndex_changed\r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: true,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   *          \r\n   * marker.onEvent('click', function () { \r\n   *   info.setZIndex(olleh.maps.overlay.BaseOverlay.MAX_ZINDEX); \r\n   * }); \r\n   */\r\n  setZIndex: function (zIndex) {\r\n    this._opts.zIndex = zIndex;\r\n    olleh.maps.overlay.BaseInfoWindow.$super.setZIndex.call(this, zIndex);\r\n    this.fireEvent('zIndex_changed');\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow option .\r\n   * @param {olleh.maps.overlay.InfoWindowOptions} opts  InfoWindowOptions \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: false,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *    info.setOptions({content: WlongCnt,maxWidth: 300});\r\n   * });  \r\n   */\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _setPosition: function (position) {\r\n    olleh.maps.overlay.BaseInfoWindow.$super.setPosition.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow position .\r\n   * @fires olleh.maps.overlay.ContentOverlay#event:position_changed\r\n   * @param {olleh.maps.Coord} coord InfoWindow   \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *   info.setPosition(new olleh.maps.UTMK(953795.70, 1969715.52));\r\n   * }); \r\n   */\r\n  setPosition: function (position) {\r\n    if (this._optsPosition) {\r\n      this._optsPosition = position;\r\n    }\r\n    olleh.maps.overlay.BaseInfoWindow.$super.setPosition.apply(this, arguments);\r\n  },\r\n  \r\n  \r\n  /**\r\n   * drag     . Marker . \r\n   * @param {olleh.maps.Point} bodyUpPoint   body   point\r\n   * @param {olleh.maps.Point} shadoWUpPoint   shadow   point\r\n   * @private\r\n   */\r\n  _dragStart: function (bodyUpPoint, shadowUpPoint) {\r\n    this.bringToFront();\r\n    this._dragUpPoint =  {\r\n        body : bodyUpPoint,\r\n        shadow : shadowUpPoint\r\n    };\r\n    this._marginPx.body = this._marginPx.body.add(this._dragUpPoint.body);\r\n    this._shadow && (this._marginPx.shadow = this._marginPx.shadow.add(this._dragUpPoint.shadow));\r\n    this._updatePosition();\r\n  },\r\n  \r\n  /**\r\n   * drag     . \r\n   * @param dragDelta\r\n   * @private\r\n   */\r\n  _drag: function (deltaPoint) {\r\n    this.move(deltaPoint);\r\n  },\r\n  \r\n  /**\r\n   * drag     . \r\n   * @param {olleh.maps.Coord} coord   Coord\r\n   * @private\r\n   */\r\n  _dragEnd: function (coord) {\r\n    this.resetZIndex();\r\n    this._marginPx.body = this._marginPx.body.subtract(this._dragUpPoint.body);\r\n    this._shadow && (this._marginPx.shadow = this._marginPx.shadow.subtract(this._dragUpPoint.shadow));\r\n    this._updatePosition();\r\n    this.setPosition(coord);\r\n  },\r\n \r\n  /**\r\n   * margin offset  . InfoWindow top, left Margin .\r\n   *  margin option  offset open  marker offset .\r\n   * @private\r\n   * @override\r\n   */\n  _updateMargin: function () {\r\n    var offset = this._opts.pixelOffset;\r\n    if (this._anchor instanceof olleh.maps.overlay.Marker) {\r\n      this._marginPx = { body: this._topLeftPx.body.add(offset.add(this._anchorOffset.body)) };\r\n      if (this._shadow) {\r\n        this._marginPx.shadow = this._topLeftPx.shadow.add(offset.add(this._anchorOffset.shadow));\r\n      }\r\n    } else {\r\n      olleh.maps.overlay.BaseInfoWindow.$super._updateMargin.apply(this, arguments);\n    }\r\n  },\r\n  \r\n  /**\r\n   *    InfoWindow  .\r\n   * @private\r\n   */\r\n  _autoPan: function () {\r\n    var layerMgr = this.getMap().getOverlayLayer().layerMgr;\r\n    var BaseInfo = olleh.maps.overlay.BaseInfoWindow;\r\n    var tPoint = layerMgr.getLayerPxFromCoord(layerMgr.getCenter());\r\n    var centerPoint = new olleh.maps.Point(Math.round(tPoint.x), Math.round(tPoint.y));\r\n    var viewSize = layerMgr.getViewportSize();\r\n    var viewHalfOfWidth = Math.round(viewSize.width/2);\r\n    var viewHalfOfHeight = Math.round(viewSize.height/2);\r\n    var viewTopLeft = layerMgr.getLayerPxFromViewportPx(new olleh.maps.Point(0,0));\r\n    var viewBottomRight = layerMgr.getLayerPxFromViewportPx(layerMgr.getViewportSize().asPoint());\r\n    \r\n    var infoData = this._calInfoData();\r\n    var infoPos = this.getOriginalLayerPx();\r\n    var infoSize = infoData.size;\r\n    var infoTopLeft = infoData.topLeft;\r\n    var infoBottomRight = infoData.bottomRight;\r\n    \r\n    var moveX = infoPos.x , moveY =  infoPos.y;\r\n    \r\n    //  INFOWINDOW  \r\n    var infoTopTypePoint = infoTopLeft.subtract(viewTopLeft);\r\n    var infoBottomTypePoint = viewBottomRight.subtract(infoBottomRight);\r\n    var isMoveX = true, isMoveY = true;\r\n    if (infoTopTypePoint.x > 0 && infoBottomTypePoint.x > 0) {\r\n      //infowindow X  .\r\n      isMoveX = false;\r\n      moveX = centerPoint.x;\r\n    }\r\n    \r\n    if (infoTopTypePoint.y > 0 && infoBottomTypePoint.y > 0) {\r\n      //infowindow Y  .\r\n      isMoveY = false;\r\n      moveY = centerPoint.y;\r\n    }\r\n    \r\n    if (!isMoveX && !isMoveY) { //infowindow  .\r\n      return; \r\n    }\r\n     \r\n    \r\n    var checkInfoSize = viewSize.subtract(infoSize);\r\n    var isLongerThanView = checkInfoSize.width < 0;\r\n    var isHigherThanView = checkInfoSize.height < 0;\r\n    var checkInfoPos = centerPoint.subtract(infoPos);\r\n    var isLeftOfCenter = checkInfoPos.x > 0;\r\n    var isTopOfCenter = checkInfoPos.y > 0;\r\n    \r\n    //move X     \r\n    if (isMoveX) {\r\n      if (isLongerThanView) {\r\n        //    \r\n        moveX = infoTopLeft.x - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfWidth;        \r\n      } else if (isLeftOfCenter) {\r\n        //  \r\n        moveX = infoTopLeft.x - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfWidth;\r\n      } else {\r\n        //  \r\n        moveX = infoTopLeft.x + infoSize.width + BaseInfo.AUTO_PAN_MARGIN - viewHalfOfWidth;\r\n      }\r\n    }\r\n    \r\n    //move Y \r\n    // view    \r\n    if (isMoveY) {\r\n      if(isHigherThanView) {\r\n        //    \r\n        moveY = infoTopLeft.y - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfHeight;\r\n      } else if (isTopOfCenter) {\r\n        //  \r\n        moveY = infoTopLeft.y - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfHeight;\r\n      } else {\r\n        //  \r\n        if (viewHalfOfHeight < infoSize.height && infoBottomTypePoint.y > 0) {\r\n          //point    ,  View   \r\n          moveY = infoTopLeft.y - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfHeight;\r\n        } else {\r\n          moveY = infoBottomRight.y + BaseInfo.AUTO_PAN_MARGIN - viewHalfOfHeight;\r\n        }\r\n      }\r\n    }   \r\n      \r\n    var coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(moveX, moveY));\r\n    layerMgr.panTo(coord);\r\n  },\r\n\r\n  /**\r\n   * offset  autopan  InfoWindow size .\r\n   * @private\r\n   */\r\n  _calInfoData: function () {\r\n    var layerPx = this.getOriginalLayerPx();\r\n    var infoSize = this._body.size;\r\n    var infoTopLeft = layerPx.add(this._marginPx.body);\r\n    var infoBottomRight = infoTopLeft.add(new olleh.maps.Point(infoSize.width, infoSize.height));\r\n    var topleft = infoTopLeft.clone();\r\n    var bottomRight = infoBottomRight.clone();\r\n\r\n    if (layerPx.x < infoTopLeft.x) {\r\n      //pos.x  topleft.x    pos.x topleft.x  .\r\n      topleft.x = layerPx.x;\r\n    } else if (layerPx.x > infoBottomRight.x) {\r\n      //pos.x  bottomRight.x  \r\n      bottomRight.x = layerPx.x;\r\n    }\r\n    \r\n    if (layerPx.y < infoTopLeft.y) {\r\n      //pos.y  topleft.y  \r\n      topleft.y = layerPx.y;\r\n    } else if (layerPx.y > infoBottomRight.y) {\r\n      //pos.y  bottomRight.y  \r\n      bottomRight.y = layerPx.y;\r\n    }\r\n    var size = bottomRight.subtract(topleft);\r\n    \r\n    return {\r\n      topLeft: topleft,\r\n      bottomRight: bottomRight,\r\n      size: new olleh.maps.Size(size.x, size.y) \r\n    };\r\n  }\r\n});\r\n/**\n *  InfoWindow UI    , UI  body, shadow, tip . \n *  tip (tip  )  tip      . \n *  body tip         .\n *  shadow InfoWindow tip body     .\n *  InfoWindow Marker  Overlay    . \n *    InfoWindow option   {@link olleh.maps.overlay.BaseInfoWindow#open}  InfoWindow  .\n *   close    , {@link olleh.maps.overlay.BaseInfoWindow#close}     .\n *  InfoWindow    .     . minWidth : 300, minHeight : 60, maxWidth : 600, maxHeight : 500\n * <h5> </h5>  \n * <ul>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:close_click|close_click}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:content_changed|content_changed}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:domready|domready}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:position_changed|position_changed}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:zIndex_changed|zIndex_changed}</li>\n * </ul>\n * \n * @summary InfoWindow  ()      Overlay.\n */\n$class('olleh.maps.overlay.InfoWindow').extend(olleh.maps.overlay.BaseInfoWindow).define({\n  \n  $static: {\n    URL: olleh.maps.env.RESOURCE_URL,\n    SHADOW_URL : 'img/infowins.png',\n    INFO_URL : 'img/infowins.png',\n    CLOSE_URL : 'img/infowins.png',\n    //body border\n    BORDER : 2,\n    //content  Tip(infowindow  )   \n    TIP_POS_RATE : 0,\n    //TIP  left     \n    TIP_POS_MAXLEFT : 45,\n    TIP_HEIGHT : 26,\n    TIP_NOVIEW_HEIGHT : 2,\n    /*    */\n    //    \n    SHADOW_LEFT_HYPOTENUSE : -366, \n    //    \n    SHADOW_RIGHT_HYPOTENUSE : -1106, \n    //shadowCenterImage width height  (px),  centerLeft width  .\n    //shadow_img_top_width  , \n    SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP : 70, \n    //Shadow Tip  tip  px  \n    SHADOW_IMG_TIP_GAP : 18, //tip  * tan45, body   shadow     \n    /*  (  ) */\n    SHADOW_IMG_TIP_WIDTH : 40,\n    SHADOW_IMG_TOP_HEIGHT : 10,\n    SHADOW_IMG_TOP_WIDTH : 70,\n    SHADOW_IMG_BOTTOM_HEIGHT : 30,\n    SHADOW_IMG_BOTTOM_WIDTH : 70,\n    /*      ( px) */\n    SHADOW_IMG_LEFTTOP_WIDTH : 40,\n    SHADOW_IMG_RIGHTTOP_WIDTH : 30,\n    SHADOW_IMG_LEFTBOTTOM_WIDTH : 52,//tip  * cos45 \n    SHADOW_IMG_RIGHTBOTTOM_WIDTH : 30,\n    //top, center shadow bottom shadow   \n    SHADOW_IMG_LEFTBOTTOM_W_PADDING : 3,\n\n    /*\n     * infoWindow template\n     * <pre>\n     * template property : \n     *  infoBodyWidth: Number,\n     *  infoBodyHeight: Number,\n     *  closeUrl: String,\n     *  contentMaxWidth: Number,\n     *  contentWidth: Number,\n     *  contentHeight: Number,\n     *  content: String,\n     *  infoTipTop: Number,\n     *  infoleftofTip: Number,\n     *  infoUrl: String,\n     *  infoBottomWidth: Number,\n     *  infoBottomHeight: Number\n     * </pre>\n     * @type String\n     */\n    INFO_TMPL: [\n      '<div class=\"ollehmap-info-area\" style=\"width:#{infoBodyWidth}px;height:#{infoBodyHeight}px;\">',\n        '<div class=\"ollehmap-info-content\" style=\"max-width:#{contentMaxWidth}px;\">',\n          '<div class=\"ollehmap-info-content-overflow\" style=\"padding:#{contentPadding}px;width:#{contentWidth}px;height:#{contentHeight}px;\"></div>',\n        '</div>',\n        '<div class=\"ollehmap-info-close\">',\n          '<img class=\"ollehmap-info-close-img\" src=\"#{closeUrl}\" draggable=\"false\"></img>',\n        '</div>',\n      '</div>',\n      '<div class=\"ollehmap-info-tip\" style=\"top:#{infoTopofTip}px;left:#{infoleftofTip}px;\">',\n        '<img class=\"ollehmap-info-tip-img\" src=\"#{infoUrl}\"></img>',\n      '</div>'].join(''),\n      /*'<div class=\"ollehmap-info-bottom\" style=\"width:#{infoBottomWidth}px;height:#{infoBottomHeight}px;\"></div>'].join(''),*/\n    \n    /*\n     * infoWindow shadow template\n     * TODO :    background-position, background-size img tag   .\n     * <pre>\n     * template property :\n     *  topLeftPoint: Number,\n     *  topRightPoint: Number,\n     *  bottomLeftPointX: String,\n     *  bottomLeftPointY: Number,\n     *  bottomRightPointX: Number,\n     *  bottomRightPointY: Number,\n     *  bottomTipPointX: String,\n     *  bottomTipPointY: Number,\n     *  topCenterPointX: Number,\n     *  topCenterPointY: String,\n     *  topCenterWidth: Number,\n     *  middleLeftPointX: Number,\n     *  middleLeftWidth: Number,\n     *  middleLeftHeight: Number,\n     *  middleLeftImgLeftPx: Number,\n     *  middleRightPointX: Number,\n     *  middleRightPointY: Number,\n     *  middleRightWidth: Number,\n     *  middleRightHeight: Number,\n     *  middleRightImgLeftPx: Number,\n     *  bottomLeftOfTipPointX: Number,\n     *  bottomLeftOfTipPointY: Number,\n     *  bottomLeftOfTipWidth: Number,\n     *  bottomRightOfTipPointX: Number,\n     *  bottomRightOfTipPointY: Number,\n     *  bottomRightOfTipRightWidth: Number,\n     *  middlePointX: Number,\n     *  middlePointY: Number,\n     *  middleWidth: Number,\n     *  middleHeight: Number,\n     *  url: String\n     * </pre>\n     * @type String\n     */\n    INFO_SHADOW_TMPL: [\n      '<div class=\"ollehmap-info-shadow-topleft\" style=\"left:#{topLeftPoint}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-topright\" style=\"left:#{topRightPoint}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-bottomleft\" style=\"left:#{bottomLeftPointX}px; top:#{bottomLeftPointY}px; \">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-bottomright\" style=\"left:#{bottomRightPointX}px; top:#{bottomRightPointY}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-bottomtip\" style=\"left:#{bottomTipPointX}px; top:#{bottomTipPointY}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">', \n      '</div>', //centerTop TopCenter\n      '<div class=\"ollehmap-info-shadow-topcenter\" style=\"left:#{topCenterPointX}px; top:#{topCenterPointY}px; width:#{topCenterWidth}px; \">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>', //centerLeft img\n      '<div class=\"ollehmap-info-shadow-centerleft\" style=\"left:#{middleLeftPointX}px; top:#{middleLeftPointY}px; width:#{middleLeftWidth}px; height:#{middleLeftHeight}px;\">',\n        '<img style=\"left:#{middleLeftImgLeftPx}px;\" src=\"#{url}\" draggable=\"false\">',\n      '</div>', //centerRight img\n      '<div class=\"ollehmap-info-shadow-centerright\" style=\"left:#{middleRightPointX}px; top:#{middleRightPointY}px; width:#{middleRightWidth}px; height:#{middleRightHeight}px;\">',\n        '<img style=\"left:#{middleRightImgLeftPx}px;\" src=\"#{url}\" draggable=\"false\">',\n      '</div>', //leftTip\n      '<div class=\"ollehmap-info-shadow-bottomleftoftip\" style=\"left:#{bottomLeftOfTipPointX}px; top:#{bottomLeftOfTipPointY}px; width:#{bottomLeftOfTipWidth}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>', //rightTip\n      '<div class=\"ollehmap-info-shadow-bottomrightoftip\" style=\"left:#{bottomRightOfTipPointX}px; top:#{bottomRightOfTipPointY}px; width:#{bottomRightOfTipRightWidth}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>', //center\n      '<div class=\"ollehmap-info-shadow-center\" style=\"left:#{middlePointX}px; top:#{middlePointY}px; width:#{middleWidth}px; height:#{middleHeight}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>'].join('')\n  },\n  \n  /**\n   * @name olleh.maps.overlay.InfoWindow#InfoWindow\n   * @param {olleh.maps.overlay.InfoWindowOptions} opts InfoWindowOptions\n   * @see olleh.maps.overlay.PointedOverlay#PointedOverlay\n   * @see olleh.maps.overlay.BaseInfoWindow\n   * @see olleh.maps.overlay.BaseInfoWindow#open\n   * @constructs\n   */\n  \n  /**\n   * InfoWindow body .\n   * @override {@link olleh.maps.overlay.BaseInfoWindow#createBodyElem}\n   * @param {olleh.maps.Size} contentSize   \n   * @param {olleh.maps.Point} point InfoWindow  , layerPixel \n   * @return {Element}          [rootElem] InfoWindow body root element\n   *         {Element}          [contentElem] InfoWindow body content element\n   *         {Element}          [closeElem] InfoWindow body close element\n   *         {olleh.maps.Size}  [size] InfoWindow size\n   *         {olleh.maps.Point} [topLeftPoint] InfoWindow top left Point. \n   *                                  point   top, left   .\n   *@private\n   */\n  createBodyElem: function (contentSize, point) {\n    var InfoWindow = olleh.maps.overlay.InfoWindow;\n    var domutil = olleh.maps.util.dom;\n    var contentPadding = this._opts.padding == undefined ? this._defaultPadding : this._opts.padding;\n    var infoBodyWidth = contentSize.width  + 2*contentPadding; //  padding  body  \n    var infoBodyHeight = contentSize.height  + 2*contentPadding;\n    //infowindow area width   border   \n    var infoWidth = infoBodyWidth + 2*InfoWindow.BORDER;\n    //infowindow area top   border   \n    var infoHeight = infoBodyHeight + InfoWindow.TIP_HEIGHT + 2*InfoWindow.BORDER;\n    var infoPosY = point.y - infoHeight;\n    \n    var tipleftPos = InfoWindow.TIP_POS_RATE * contentSize.width;\n    if (tipleftPos > InfoWindow.TIP_POS_MAXLEFT) {\n      tipleftPos = 0;\n    }     \n    var infoleftofTip = contentPadding + InfoWindow.BORDER\n            + Math.ceil(contentSize.width/2 - tipleftPos);\n    var infoPosX = point.x - infoleftofTip - InfoWindow.BORDER; //infowindow area left  border   left\n    \n    //tip  border  infoBodyHeight(infowindow area ) tip  content    .  \n    var infoTopofTip = infoBodyHeight + 2*InfoWindow.BORDER - InfoWindow.TIP_NOVIEW_HEIGHT;\n    \n    var infoDiv = document.createElement('div');\n    var data = {\n        infoBodyWidth: infoBodyWidth, //border \n        infoBodyHeight: infoBodyHeight,//border \n        contentPadding: contentPadding,\n        closeUrl: InfoWindow.URL + InfoWindow.CLOSE_URL,\n        infoUrl: InfoWindow.URL+ InfoWindow.INFO_URL,\n        contentMaxWidth: this._opts.maxWidth,\n        contentWidth: contentSize.width,\n        contentHeight: contentSize.height,\n        infoTopofTip: infoTopofTip,\n        infoleftofTip: infoleftofTip\n      };\n    \n    domutil.addClass(infoDiv, 'ollehmap-info');\n    infoDiv.innerHTML = olleh.maps.util.applyTemplate(InfoWindow.INFO_TMPL, data);\n    var closeElem = infoDiv.childNodes[0].childNodes[1];\n    if (this._opts.disableCloseButton) {\n      domutil.removeElements(closeElem);\n      closeElem = null;\n    }\n    return {\n      rootElem : infoDiv,\n      contentElem : infoDiv.childNodes[0].childNodes[0].children[0],\n      closeElem : closeElem,\n      size : new olleh.maps.Size(infoWidth, infoHeight),\n      topLeftPoint : new olleh.maps.Point(infoPosX, infoPosY)\n    };\n    \n  },\n  \n  /**\n   * InfoWindow shadow . \n   * @override {@link olleh.maps.overlay.BaseInfoWindow#createBodyElem}\n   * @param {olleh.maps.Size} contentSize   \n   * @param  {olleh.maps.Point} point InfoWindow   , layerPixel \n   * @return {Element}          [rootElem] InfoWindow  root element\n   *         {olleh.maps.Size}  [size] InfoWindow size\n   *         {olleh.maps.Point} [topLeftPoint] InfoWindow top left Point. \n   *                                  point   top, left   .\n   *@private\n   */\n  createShadowElem: function (contentSize, point) {\n    var domutil = olleh.maps.util.dom;\n    var InfoWindow = olleh.maps.overlay.InfoWindow;\n    var contentPadding = this._opts.padding == undefined ?  this._defaultPadding : this._opts.padding;\n    var bodyWidth = contentSize.width + 2*InfoWindow.BORDER + 2*contentPadding;\n    var bodyHeight = contentSize.height + 2*InfoWindow.BORDER + 2*contentPadding;\n    var infoHeight = bodyHeight + InfoWindow.TIP_HEIGHT;\n    \n    var tipleftPos = InfoWindow.TIP_POS_RATE * contentSize.width;\n    if (tipleftPos > InfoWindow.TIP_POS_MAXLEFT) {//??\n      tipleftPos = 0;\n    }\n    var infoleftofTip = contentPadding \n            + Math.ceil(contentSize.width/2 - tipleftPos);\n    \n    var shadowHeight =  Math.round(\n        (infoHeight)/2);\n    var shadowWidth = bodyWidth;\n    \n    \n    var shadowInfoLeftofTip = infoleftofTip\n    - InfoWindow.SHADOW_IMG_TIP_GAP;\n    \n    var shadowPosY = point.y - shadowHeight;\n    var shadowPosX = point.x - infoleftofTip;\n    \n    \n    var infoShadowDiv = document.createElement('div');\n    domutil.addClass(infoShadowDiv, 'ollehmap-info-shadow');\n    domutil.addClass(infoShadowDiv, 'ollehmap-noevent');\n    \n    var middleLeftHSize = shadowHeight \n    - InfoWindow.SHADOW_IMG_TOP_HEIGHT - InfoWindow.SHADOW_IMG_BOTTOM_HEIGHT;\n    var topCenterWSize = shadowWidth\n    - InfoWindow.SHADOW_IMG_LEFTTOP_WIDTH - InfoWindow.SHADOW_IMG_RIGHTTOP_WIDTH;\n    var bottomLeftTipWSize = shadowInfoLeftofTip - InfoWindow.SHADOW_IMG_LEFTBOTTOM_WIDTH;\n    var bottomRightTipWSize = shadowWidth - shadowInfoLeftofTip \n    - InfoWindow.SHADOW_IMG_TIP_WIDTH - InfoWindow.SHADOW_IMG_RIGHTBOTTOM_WIDTH;\n    \n    var left =  InfoWindow.SHADOW_IMG_BOTTOM_WIDTH;\n    var top = InfoWindow.SHADOW_IMG_TOP_HEIGHT + middleLeftHSize;\n    var bottomLeftPoint = new olleh.maps.Point(0, top);\n    //cal position and size of Tip'left  shadow\n    var bottomLeftOfTipPoint = new olleh.maps.Point(left, top);\n    var bottomLeftOfTipWidth = bottomLeftTipWSize;\n    //cal position of Tip shadow\n    left += bottomLeftTipWSize;\n    var bottomTipPoint = new olleh.maps.Point(left, top);\n    //cal position of Tip'right  shadow\n    left += InfoWindow.SHADOW_IMG_TIP_WIDTH;\n    var bottomRightOfTipPoint = new olleh.maps.Point(left, top); \n    var bottomRightOfTipRightWidth = bottomRightTipWSize;\n    //cal position of rightBottom shadow\n    left += bottomRightTipWSize;    \n    var bottomRightPoint = new olleh.maps.Point(left, top);\n    \n    //cal position and size of middle left shadow\n    var middleLeftWidth = middleLeftHSize + InfoWindow.SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP;\n    left = InfoWindow.SHADOW_IMG_LEFTBOTTOM_W_PADDING;\n    top = InfoWindow.SHADOW_IMG_TOP_HEIGHT;\n    var middleLeftPoint = new olleh.maps.Point(left, top);\n    var middleLeftSize = new olleh.maps.Size(middleLeftWidth, middleLeftHSize);\n    var middleLeftImgLeftPx = InfoWindow.SHADOW_LEFT_HYPOTENUSE + middleLeftWidth;\n    //cal position and size of middle shadow\n    left += middleLeftWidth;\n    var middlePoint = new olleh.maps.Point(left, top);\n    var middleSize = new olleh.maps.Size(Math.max(shadowWidth - middleLeftWidth,0), middleLeftHSize);\n    //cal position of middleRight shadow\n    left += parseFloat(middleSize.width);\n    var middleRightPoint = new olleh.maps.Point(left, top);\n    var middleRightSize = new olleh.maps.Size(middleLeftWidth, middleLeftHSize);\n    var middleRightImgLeftPx = InfoWindow.SHADOW_RIGHT_HYPOTENUSE + middleLeftWidth;\n    \n    //cal position of Top's left shadow\n    left = InfoWindow.SHADOW_IMG_LEFTBOTTOM_W_PADDING + middleLeftWidth - InfoWindow.SHADOW_IMG_TOP_WIDTH;\n    var topLeftPoint = new olleh.maps.Point(left, 0);\n    //cal position of Top's center shadow\n    left += InfoWindow.SHADOW_IMG_TOP_WIDTH;\n    var topCenterPoint = new olleh.maps.Point(left, 0);\n    var topCenterWidth = topCenterWSize;\n    //cal position of Top's right shadow\n    left += topCenterWSize;\n    var topRightPoint = new olleh.maps.Point(left, 0);\n    var data = {\n        topLeftPoint: topLeftPoint.x,\n        topRightPoint: topRightPoint.x,\n        bottomLeftPointX: bottomLeftPoint.x,\n        bottomLeftPointY: bottomLeftPoint.y,\n        bottomRightPointX: bottomRightPoint.x,\n        bottomRightPointY: bottomRightPoint.y,\n        bottomTipPointX: bottomTipPoint.x,\n        bottomTipPointY: bottomTipPoint.y,\n        topCenterPointX: topCenterPoint.x,\n        topCenterPointY: topCenterPoint.y,\n        topCenterWidth: topCenterWidth,\n        middleLeftPointX: middleLeftPoint.x,\n        middleLeftPointY: middleLeftPoint.y,\n        middleLeftWidth: middleLeftSize.width,\n        middleLeftHeight: middleLeftSize.height,\n        middleRightPointX: middleRightPoint.x,\n        middleRightPointY: middleRightPoint.y,\n        middleRightWidth: middleRightSize.width,\n        middleRightHeight: middleRightSize.height,\n        bottomLeftOfTipPointX: bottomLeftOfTipPoint.x,\n        bottomLeftOfTipPointY: bottomLeftOfTipPoint.y,\n        bottomLeftOfTipWidth: bottomLeftOfTipWidth,\n        bottomRightOfTipPointX: bottomRightOfTipPoint.x,\n        bottomRightOfTipPointY: bottomRightOfTipPoint.y,\n        bottomRightOfTipRightWidth: bottomRightOfTipRightWidth,\n        middlePointX: middlePoint.x,\n        middlePointY: middlePoint.y,\n        middleWidth: middleSize.width,\n        middleHeight: middleSize.height,\n        middleLeftImgLeftPx: middleLeftImgLeftPx,\n        middleRightImgLeftPx: middleRightImgLeftPx,\n        url: InfoWindow.URL + InfoWindow.SHADOW_URL\n      };\n\n    infoShadowDiv.innerHTML = olleh.maps.util.applyTemplate(InfoWindow.INFO_SHADOW_TMPL, data);\n        \n    return {\n      rootElem : infoShadowDiv,\n      size : new olleh.maps.Size(shadowWidth + shadowHeight*Math.tan(Math.PI/4), shadowHeight),\n      topLeftPoint : new olleh.maps.Point(shadowPosX, shadowPosY)\n    };\n  }\n  \n});\n/////////////////////////\r\n//   TooltipOptions    //\r\n/////////////////////////\r\n/**\r\n * TooltipOptions Object Specification\r\n * @typedef olleh.maps.overlay.TooltipOptions\r\n * @extends olleh.maps.overlay.ContentOverlayOptions\r\n * @property {olleh.maps.Point} [pixelOffset=(0,0)] Tooltip position offset, tooltip    .\r\n * @property {Number} [zIndex] Tooltip zIndex\r\n * @property {Number} [maxWidth=800] Tooltip  width\r\n * @property {Number} [padding=4] content padding .\r\n * @property {String|Node} content Tooltip  content .\r\n * HTML element , plain-text string, HTML  string   . Tooltip content  size .\r\n */\r\n\r\n/**\r\n * Tooltip  overlay      Overlay. UI    .\r\n * Tooltip    ,  ,  ,   4 \r\n * Tooltip   4          .\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:close|close}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:content_changed|content_changed}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:domready|domready}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:position_changed|position_changed}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:zIndex_changed|zIndex_changed}</li>\r\n * <ul>\r\n * \r\n * @summary Tooltip  ()      Overlay\r\n */\r\n$class('olleh.maps.overlay.Tooltip').extend(olleh.maps.overlay.ContentOverlay).define({\r\n  \r\n  $static: {\r\n    BORDER : 1,\r\n    TOOLTIP_TMPL: [\r\n      '<div class=\"ollehmap-info-tooltip-area\" style=\"width:#{bodyWidth}px;height: #{bodyHeight}px;\">',\r\n        '<div class=\"ollehmap-info-tooltip-content\" style=\"max-width:#{contentMaxWidth}px;max-height:#{contentMaxHeight}px\">',\r\n          '<div class=\"ollehmap-info-content-overflow\" style=\"padding:#{contentPadding}px;width:#{contentWidth}px;height:#{contentHeight}px;\"></div>',\r\n        '</div>',\r\n      '</div>'].join('')\r\n  },\r\n  /**\r\n   * close <p/>\r\n   * Tooltip     .\r\n   * @example \r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('close', \r\n   *   function (event) { console.log('close');}\r\n   * );\r\n   * tooltip.open(map, marker);\r\n   * @name event:close\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   * \r\n   **/\r\n   /**\r\n   * content_changed <p/>\r\n   * Tooltip Content     .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('content_changed', \r\n   *   function (event) { console.log('content_changed');}\r\n   * );\r\n   * tooltip.open(map, marker); \r\n   * @name event:content_changed\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n  /**\r\n   * domready <p/>\r\n   * Tooltip DOM Tree  append     . \r\n   * Tooltip DOM Tree append       . \r\n   *   Tooltip DOM Tree append  append     .\r\n   *  Tooltip DOM Tree append  Tooltip       \r\n   * Tooltip DOM Tree  .  Tooltip      Tooltip DOM Tree . \r\n   *  domready  .  DOM Tree  append   domready  .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('domready', \r\n   *   function (event) { console.log('domready');}\r\n   * );\r\n   * tooltip.open(map, marker); \r\n   * @name event:domready\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n   /**\r\n   * position_changed <p/>\r\n   * Tooltip position     .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('position_changed', \r\n   *   function (event) { console.log('position_changed');}\r\n   * );\r\n   * tooltip.open(map, marker);\r\n   * @name event:position_changed\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n   /**\r\n   * zIndex_changed <p/>\r\n   * Tooltip zIndex     .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('zIndex_changed', \r\n   *   function (event) { console.log('zIndex_changed');}\r\n   * );\r\n   * tooltip.open(map, marker);\r\n   * @name event:zIndex_changed\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n   \r\n   /**\r\n    * ,  opts    .\r\n    * @param {olleh.maps.overlay.TooltipOptions} opts TooltipOptions\r\n    */\r\n  Tooltip: function (opts) {\r\n    //content   css\r\n    this._defaultCss = 'ollehmap-info-tooltip-data';\r\n    //content   padding\r\n    this._defaultPadding = 4;\r\n  },\r\n  \r\n  /**\r\n   *  \r\n   * @param {olleh.maps.overlay.TooltipOptions} opts \r\n   */\r\n  setOptions: function (opts) {\r\n    if (opts.zIndex == undefined) {\r\n      opts.zIndex = olleh.maps.overlay.BaseOverlay.MAX_ZINDEX;\r\n    }\r\n    olleh.maps.overlay.Tooltip.$super.setOptions.call(this, opts);\r\n  },\r\n  \r\n  /**\r\n   * Tooltip Infowindow body .\r\n   * @override\r\n   * @param contentSize\r\n   * @param point\r\n   * @private\r\n   */\r\n  createBodyElem: function (contentSize, point) {\r\n    var tooltip = olleh.maps.overlay.Tooltip;\r\n    //TODO: chrome bug fix   \r\n    contentSize.width +=1;\r\n    var contentPadding = this._opts.padding == undefined ? this._defaultPadding : this._opts.padding;\r\n    var bodyWidth = contentSize.width + 2*contentPadding;\r\n    var bodyHeight = contentSize.height + 2*contentPadding;\r\n    var infoHeight = bodyHeight + 2*tooltip.BORDER;\r\n    var infoWidth = bodyWidth + 2*tooltip.BORDER;\r\n    var domutil = olleh.maps.util.dom;\r\n    var infoDiv = document.createElement('div');\r\n    domutil.addClass(infoDiv, 'ollehmap-info');\r\n    var data = {\r\n        bodyWidth : bodyWidth,\r\n        bodyHeight : bodyHeight,\r\n        contentPadding : contentPadding,\r\n        contentMaxWidth: this._opts.maxWidth,\r\n        contentMaxHeight: this.contentSize.maxHeight,\r\n        contentWidth : contentSize.width,\r\n        contentHeight : contentSize.height\r\n    };\r\n     \r\n    infoDiv.innerHTML = olleh.maps.util.applyTemplate(tooltip.TOOLTIP_TMPL, data);\r\n    \r\n    return {\r\n      rootElem : infoDiv,\r\n      contentElem : infoDiv.childNodes[0].childNodes[0].childNodes[0],\r\n      closeElem : null,\r\n      size : new olleh.maps.Size(infoWidth, infoHeight),\r\n      topLeftPoint : point\r\n    };\r\n    \r\n  },\r\n  \r\n  /**\r\n   * tooltip  point  4     \r\n   *  margin  . 4   bottomRight\r\n   * , bottomLeft, topRight, topLeft .\r\n   * @return {olleh.maps.Point} point margin\r\n   * @private\r\n   */\r\n  _calTooltipPosition: function () {\r\n    var layerMgr = this.getMap().getOverlayLayer().layerMgr;\r\n    var size = this._body.size;\r\n    var offset = this._opts.pixelOffset;\r\n    var viewBounds = layerMgr.getBounds();\r\n    var layerPx = this.getOriginalLayerPx();\r\n    var radius = this._calRadiusOfAnchor();\r\n    \r\n    //bottomRight\r\n    var point = new olleh.maps.Point(\r\n        layerPx.x + offset.x + radius.right, \r\n        layerPx.y + offset.y + radius.bottom);\r\n    \r\n    var coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x + size.width, point.y + size.height));\r\n    if (viewBounds.contains(coord)) {\r\n      return  point.subtract(layerPx);\r\n    }\r\n    \r\n    //bottomLeft\r\n    point = new olleh.maps.Point(\r\n        layerPx.x - size.width - offset.x - radius.left, \r\n        layerPx.y + offset.y + radius.bottom);\r\n    coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x, point.y + size.height));\r\n    if (viewBounds.contains(coord)) {\r\n      return  point.subtract(layerPx);\r\n    }\r\n    \r\n    //topRight\r\n    point = new olleh.maps.Point(\r\n        layerPx.x + offset.x + radius.right,\r\n        layerPx.y - size.height - offset.y - radius.top);\r\n    coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x + size.width, point.y));\r\n    if (viewBounds.contains(coord)) {\r\n      return  point.subtract(layerPx);\r\n    }\r\n    \r\n    //topLeft\r\n    point = new olleh.maps.Point(\r\n        layerPx.x - size.width - offset.x - radius.left, \r\n        layerPx.y - size.height - offset.y - radius.top);\r\n    coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x, point.y));\r\n    return  point.subtract(layerPx);\r\n  },\r\n  \r\n  /**\r\n   * @override\r\n   * @private\r\n   */\r\n  _updateMargin: function () {\r\n    //  margin .\r\n    this._marginPx = {body : this._calTooltipPosition()};\r\n  },\r\n  /**\r\n   * Marker   Marker anchor        .\r\n   * @private\r\n   */\r\n  _calRadiusOfAnchor: function () {\r\n    var radius = {\r\n        top : 0,\r\n        bottom : 0,\r\n        left : 0,\r\n        right : 0\r\n    };\r\n    if (olleh.maps.overlay.Marker && this._anchor instanceof olleh.maps.overlay.Marker) {\r\n      var mIcon = this._anchor.getIcon();\r\n      var size = mIcon.size;\r\n      var point = mIcon.anchor;\r\n      radius.left = point.x;\r\n      radius.right = size.width - point.x;\r\n      radius.top = point.y;\r\n      radius.bottom = size.height - point.y;\r\n    }    \r\n    return radius;\r\n  },\r\n  \r\n  _setPosition: function (position) {\r\n    olleh.maps.overlay.Tooltip.$super.setPosition.apply(this, arguments);\r\n  },\r\n  \r\n  setPosition: function (position) {\r\n    if (this._optsPosition) {\r\n      this._optsPosition = position;\r\n    }\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.position = position;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setPosition.apply(this, arguments);\r\n    }\r\n    \r\n  },\r\n  \r\n  setPixelOffset: function (offset) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.pixelOffset = offset;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setPixelOffset.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  setContent: function (content) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.content = content;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setContent.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  setZIndex: function (zIndex) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.zIndex = zIndex;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setZIndex.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  _setMaxWidth: function (width) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.maxWidth = width;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super._setMaxWidth.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * Tooltip open.\r\n   * anchor {@link olleh.maps.overlay.Marker}  marker position marker  \r\n   *  Tooltip .       \r\n   * {@link olleh.maps.overlay.TooltipOptions.pixelOffset}   . \r\n   * @param map {olleh.maps.Map} map Overlay  Map  \r\n   * @param anchor {olleh.maps.Coord | olleh.maps.overlay.Overlay} anchor {@link olleh.maps.Coord}  \r\n   * {@link olleh.maps.overlay.Overlay}  (Marker ), getPosition   .\r\n   * @param options {olleh.maps.overlay.TooltipOptions} options open  options,open options    options . \r\n   *  open  options     options  open .\r\n   * <p>\r\n   * ()\r\n   * 1. open options   position, pixelOffset, zIndex, content, maxWidth 5 .\r\n   * 2. options   open setPosition, setPixelOffset, setPixelOffset, setZIndex, setOptions       .\r\n   *  options   open tooltip option  . options   open tooltip     options \r\n   *  open  . \r\n   * </p> \r\n   */\r\n  open: function (map, anchor, options) {\r\n    if (options) {\r\n      //option    .\r\n      if (!this._isOpenOptions) {\r\n        var opts = this._opts;\r\n        var o = {};\r\n        if (opts.position) {\r\n          o.position = this._optsPosition? this._optsPosition:opts.position;\r\n        }\r\n        if (opts.pixelOffset) {\r\n          o.pixelOffset = opts.pixelOffset;\r\n        } else {\r\n          o.pixelOffset = new olleh.maps.Point(0,0);\r\n        }\r\n        if (opts.content) {\r\n          o.content = opts.content;\r\n        }\r\n        if (opts.zIndex) {\r\n          o.zIndex = opts.zIndex;\r\n        } else {\r\n          o.zIndex = 'auto';\r\n        }\r\n        if (opts.maxWidth) {\r\n          o.maxWidth = opts.maxWidth;\r\n        } else {\r\n          o.maxWidth = this.contentSize.maxWidth;\r\n        }\r\n        \r\n        this._openOptions = o;\r\n      }\r\n      this.setOptions(options);\r\n      this._isOpenOptions = true;\r\n    } else if (this._isOpenOptions){\r\n      //option    option  .\r\n      this._isOpenOptions = false;\r\n      this.setOptions(this._openOptions);\r\n    }\r\n    \r\n    if (anchor) {\r\n      //anchor open    opts Position  .\r\n      if (!this._anchor) {\r\n        // anchor   position  .\r\n        this._optsPosition = this._opts.position;\r\n      }\r\n      \r\n      var coord = null;\r\n      if(anchor instanceof olleh.maps.Coord) {\r\n        coord = anchor;\r\n      } else if (anchor instanceof olleh.maps.Point) {\r\n        coord = map.layerMgr.getCoordFromViewportPx(anchor);\r\n      } else if (olleh.maps.overlay.Marker && anchor instanceof olleh.maps.overlay.Marker) {\r\n        coord = anchor.getPosition();\r\n      } else if (anchor instanceof olleh.maps.overlay.Overlay) {\r\n        \r\n        if (anchor.getPosition()) {\r\n          coord = anchor.getPosition();\r\n        } else if (anchor.getBounds()) {\r\n          coord = anchor.getBounds().getCenter();\r\n        } else {\r\n          throw new TypeError(\"anchor parameter must have a position\");\r\n        }\r\n      } else {\r\n        throw new TypeError(\"anchor parameter must have a position\");\r\n      }\r\n      this._anchor = anchor;\r\n      this._setPosition(coord);\r\n    } else if (this._anchor && this.isAdded()){\r\n      // anchor   anchor   open .\r\n      this._anchor = null;\r\n      if (this._optsPosition) {//option   .\r\n        this._setPosition(this._optsPosition);\r\n        this._optsPosition = null;\r\n      } else {\r\n        throw new Error(\"Option's Position value is not exist\");\r\n      }\r\n    } else if (this.isAdded()){\r\n      //option .\r\n      this.setPosition(this._opts.position);\r\n    }\r\n    if (!this.isAdded()) {\r\n      this.setMap(map);\r\n    } \r\n  },\r\n  \r\n  /**\r\n   * DOM Tree Tooltip elements  Tooltip .\r\n   * @fires olleh.maps.overlay.Tooltip#event:close\r\n   */\r\n  close: function () {\r\n    if (this._isOpenOptions) {\r\n      this.setOptions(this._openOptions);\r\n    }\r\n    this._anchor = null;\r\n    this._isOpenOptions = null;\r\n    this._optsPosition = null;\r\n    this._openOptions = null;\r\n    this.setMap(null);\r\n    if (this.isAdded()) {\r\n      this.fireEvent('close');\r\n    }\r\n  }\r\n});/**\n * ProjectedOverlayOptions Object Specification\n * @typedef olleh.maps.overlay.ProjectedOverlayOptions\n * @extends olleh.maps.overlay.BaseOverlayOptions\n * @property {olleh.maps.Bounds} bounds  .\n * @property {Number} [opacity=1] . <code>0</code>  0%, <code>1</code>  100%.\n * @property {Boolean} [fadeIn=false]   . <code>true</code>    .\n * @property {Boolean} [fadeOut=false]   . <code>true</code>    .\n */\n\n\n/**\n *       .\n */\n$class('olleh.maps.overlay.ProjectedOverlay').extend(olleh.maps.overlay.BaseOverlay).define({\n\n  /**\n   * ,  opts    .\n   * @param {olleh.maps.overlay.ProjectedOverlayOptions} opts .\n   */\n  ProjectedOverlay: function (opts) {\n    this._opacity = 1;\n    this._fadeIn = true;\n    this._fadeOut = true;\n  },\n\n  /**\n   *  .\n   * @param {olleh.maps.overlay.ProjectedOverlayOptions} opts .\n   */\n  setOptions: function (opts) {\n    opts.bounds && this.setBounds(opts.bounds);\n    opts.opacity && this.setOpacity(opts.opacity);\n    opts.fadeIn !== undefined && this.setFadeIn(opts.fadeIn);\n    opts.fadeOut !== undefined && this.setFadeOut(opts.fadeOut);\n    olleh.maps.overlay.ProjectedOverlay.$super.setOptions.apply(this, arguments);\n  },\n\n  update: function () {\n    this._updateBounds();\n    this._updateOpacity();\n    olleh.maps.overlay.ProjectedOverlay.$super.update.apply(this, arguments);\n  },\n  \n  /**\n   * @private\n   * @returns {olleh.maps.Bounds}\n   */\n  getIndexObject: function () {\n    return this.getBounds();\n  },\n  \n  /**\n   * @private\n   * @returns {number}\n   */\n  getAutoZIndex: function () {\n    return 0;\n  },\n\n  /**\n   *   .\n   * @returns {olleh.maps.Bounds}  .\n   */\n  getBounds: function () {\n    return this._bounds;\n  },\n\n  /**\n   *   .\n   * @param {olleh.maps.Bounds} bounds  .\n   */\n  setBounds: function (bounds) {\n    var from = this._bounds;\n    this._bounds = bounds;\n    if(this.isDrawn()) {\n      this._updateBounds();\n    }\n    this.fireEvent('bounds_changed', {from: from, to: bounds});\n  },\n\n  /**\n   * @private\n   */\n  _updateBounds: function () {\n    var size, styles;\n    if (!this._bounds) {\n      throw new Error('Bounds is not set.');\n    }\n    this._currentLayerPx = this.getOriginalLayerPx();\n    this._currentScale = 1;\n    size = this.getOriginalSize();\n    styles = olleh.maps.util.dom.getPositionStyles(this._currentLayerPx.x, this._currentLayerPx.y);\n    if (styles.transform) {\n      styles.transform += ' ' + olleh.maps.util.dom.getScaleString(1);\n    }\n    styles.width = size.width + 'px';\n    styles.height = size.height + 'px';\n    this.updatePositioningStyles(styles);\n  },\n\n  /**\n   *  .\n   * @returns {Number} . 0  0%, 1  100%.\n   */\n  getOpacity: function () {\n    return this._opacity;\n  },\n\n  /**\n   *  .\n   * @param {Number} opacity . <code>0</code>  0%, <code>1</code>  100%.\n   */\n  setOpacity: function (opacity) {\n    this._opacity = opacity;\n    this._drawn && this._updateOpacity();\n  },\n\n  /**\n   *    .\n   * @returns {Boolean}     <code>true</code>,    <code>false</code>.\n   */\n  isFadeIn: function () {\n    return this._fadeIn;\n  },\n\n  /**\n   *    .\n   * @param {Boolean} fadeIn   . <code>true</code>    .\n   */\n  setFadeIn: function (fadeIn) {\n    this._fadeIn = fadeIn;\n  },\n\n  /**\n   *    .\n   * @returns {Boolean}     <code>true</code>,    <code>false</code>.\n   */\n  isFadeOut: function () {\n    return this._fadeOut;\n  },\n\n  /**\n   *    .\n   * @param {Boolean} fadeOut   . <code>true</code>    .\n   */\n  setFadeOut: function (fadeOut) {\n    this._fadeOut = fadeOut;\n  },\n\n  /**\n   * @private\n   */\n  _updateOpacity: function () {\n    this.forEachElement(function (paneId, elem) {\n      olleh.maps.util.dom.setStyle(elem, 'opacity', this._opacity);\n    });\n  },\n\n  /**\n   * @param {Number} scale\n   * @param {olleh.maps.Point} origin\n   * @param {Number} duration\n   * @param {olleh.maps.fx.Pulse} [pulse]\n   * @private\n   */\n  zoomStart: function (scale, origin, duration, pulse) {\n    var originalSize, center, newCenter, newPx;\n    var originalLayerPx = this.getOriginalLayerPx();\n\n    if (olleh.maps.browser.style.transform) {\n      originalSize = this.getOriginalSize();\n      center = originalLayerPx.clone()._add(originalSize.width / 2, originalSize.height / 2);\n      newCenter = origin.add(center.subtract(origin).multiplyBy(scale));\n      newPx = newCenter.clone()._subtract(originalSize.width / 2, originalSize.height / 2).round();\n    } else {\n      newPx = origin.add(originalLayerPx.subtract(origin).multiplyBy(scale)).round();\n    }\n    \n    this.moveTo(newPx, scale, duration, pulse);\n  },\n\n  /**\n   * @private\n   */\n  zoomEnd: function () {\n    this.stopAnimators();\n    this._updateBounds();\n  },\n\n  /**\n   *           . \n   *  (bounds)    draw()       . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [scale]  .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   */\n  moveTo: function (px, scale, duration, pulse, callback) {\n    var styles, originalSize;\n    \n    scale || (scale = this._currentScale);\n\n    styles = olleh.maps.util.dom.getPositionStyles(px.x, px.y);\n    if (styles.transform) {\n      styles.transform += ' ' + olleh.maps.util.dom.getScaleString(scale);\n    } else {\n      originalSize = this.getOriginalSize();\n      styles.width = Math.round(originalSize.width * scale) + 'px';\n      styles.height = Math.round(originalSize.height * scale) + 'px';\n    }\n    \n    this.animateTo(styles, duration, pulse, callback);\n\n    this._currentLayerPx = px;\n    this._currentScale = scale;\n  },\n\n  /**\n   *           . \n   *  (bounds)    draw()       . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [scale]  .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   */\n  move: function (px, scale, duration, pulse, callback) {\n    this.moveTo(this._currentLayerPx.add(px), this._currentScale, duration, pulse, callback);\n  },\n\n  /**\n   *           .\n   * @returns {olleh.maps.Point}   \n   */\n  getOriginalLayerPx: function () {\n    var layerMgr = this.layer.layerMgr;\n    var leftBottomPx = layerMgr.getLayerPxFromCoord(this._bounds.leftBottom, false);\n    var rightTopPx = layerMgr.getLayerPxFromCoord(this._bounds.rightTop, false);\n    return new olleh.maps.Point(leftBottomPx.x, rightTopPx.y);\n  },\n\n  /**\n   *       .\n   * @returns {olleh.maps.Size}   \n   */\n  getOriginalSize: function () {\n    var layerMgr = this.layer.layerMgr;\n    var leftBottomPx = layerMgr.getLayerPxFromCoord(this._bounds.leftBottom, false);\n    var rightTopPx = layerMgr.getLayerPxFromCoord(this._bounds.rightTop, false);\n    return new olleh.maps.Size(rightTopPx.x - leftBottomPx.x, leftBottomPx.y - rightTopPx.y);\n  },\n\n  /**\n   *    .\n   *   {@link olleh.maps.overlay.ProjectedOverlay#getOriginalLayerPx()}  \n   * {@link olleh.maps.overlay.ProjectedOverlay#moveTo()} \n   * {@link olleh.maps.overlay.ProjectedOverlay#move()}     .\n   * @returns {olleh.maps.Point}   .\n   */\n  getCurrentLayerPx: function () {\n    return this._currentLayerPx;\n  },\n\n  /**\n   *    .   1\n   * {@link olleh.maps.overlay.ProjectedOverlay#moveTo()} \n   * {@link olleh.maps.overlay.ProjectedOverlay#move()}     .\n   * @returns {olleh.maps.Point}   .\n   */\n  getCurrentScale: function () {\n    return this._currentScale;\n  },\n  \n  getFadeInAnimation: function () {\n    return this._fadeIn ? new olleh.maps.fx.Animation({\n      from: {\n        opacity: '0'\n      },\n      to: {\n        opacity: this._opacity\n      },\n      duration: .5,\n      timing: olleh.maps.fx.timing.easeOut\n    }) : null;\n  },\n\n  getFadeOutAnimation: function () {\n    return this._fadeOut ? new olleh.maps.fx.Animation({\n      from: {\n        opacity: this._opacity\n      },\n      to: {\n        opacity: '0'\n      },\n      duration: .5,\n      timing: olleh.maps.fx.timing.easeOut\n    }) : null;\n  }\n\n});\n/**\r\n * GroundOverlayOptions Object Specification\r\n * @typedef olleh.maps.overlay.GroundOverlayOptions \r\n * @property {String} url  URL.\r\n * @extends olleh.maps.overlay.ProjectedOverlayOptions\r\n */\r\n\r\n/**\r\n *      .\r\n */\r\n$class('olleh.maps.overlay.GroundOverlay').extend(olleh.maps.overlay.ProjectedOverlay).define({\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @name GroundOverlay\r\n   * @param {olleh.maps.overlay.GroundOverlayOptions} opts .\r\n   * @constructor\r\n   * @memberof olleh.maps.overlay.GroundOverlay.prototype\r\n   */\r\n\r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.GroundOverlayOptions} opts .\r\n   */\r\n  setOptions: function (opts) {\r\n    opts.url && this.setURL(opts.url);\r\n    opts.title && this.setTitle(opts.title);\r\n    olleh.maps.overlay.GroundOverlay.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  update: function () {\r\n    this._updateURL();\r\n    olleh.maps.overlay.GroundOverlay.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   *  URL .\r\n   * @returns {String}  URL.\r\n   */\r\n  getURL: function () {\r\n    return this._url;\r\n  },\r\n  \r\n  /**\r\n   *  URL .\r\n   * @param {String} url  URL.\r\n   */\r\n  setURL: function (url) {\r\n    this._url = url;\r\n    this._drawn && this._updateURL();\r\n  },\r\n  \r\n  /**\r\n   * GroundOverlay   .\r\n   * @returns {String} title\r\n   */\r\n  getTitle: function () {\r\n    return this._title;\r\n  },\r\n  \r\n  /**\r\n   * GroundOverlay   .\r\n   * @example groundOverlay.setTitle('');\r\n   * @fires olleh.maps.overlay.GroundOverlay#event:title_changed\r\n   * @param {String} title GroundOverlay  \r\n   */\r\n  setTitle: function (title) {\r\n    if(this._title !== title) {\r\n      this._title = title;\r\n      /**\r\n       * title_changed . GroundOverlay    .\r\n       * <p/>\r\n       * @name event:title_changed\r\n       * @event\r\n       * @memberOf olleh.maps.overlay.GroundOverlay.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n       this.isAdded() && this.fireEvent('title_changed');\r\n    }\r\n  },\r\n  \r\n  $default_mouseover: function (event, payload) {\r\n    if(this._title) {\r\n      var tooltip = this.map.getTooltip();\r\n      if (tooltip) {\r\n        tooltip.setContent(this._title);\r\n        tooltip.setPixelOffset(new olleh.maps.Point(20, 0));\r\n        tooltip.open(this.map, event.getCoord());\r\n        this._tooltip = tooltip;\r\n      }\r\n    }\r\n    var $default_mouseover= olleh.maps.overlay.GroundOverlay.$super.$default_mouseover;\r\n    $default_mouseover && $default_mouseover.apply(this, arguments);\r\n  },\r\n  \r\n  $default_mousemove: function (event, payload) {\r\n    if(this._tooltip) {\r\n      this._tooltip.setPosition(event.getCoord());\r\n    }\r\n    var  $default_mousemove= olleh.maps.overlay.GroundOverlay.$super.$default_mousemove;\r\n    $default_mousemove && $default_mousemove.apply(this, arguments);\r\n  },\r\n\r\n  $default_mouseout: function (event, payload) {\r\n    if(this._tooltip) {\r\n      this._tooltip.setPixelOffset(new olleh.maps.Point(0, 0));\r\n      this._tooltip.close();\r\n      this._tooltip = null;\r\n    }\r\n    var $default_mouseout = olleh.maps.overlay.GroundOverlay.$super.$default_mouseout;\r\n    $default_mouseout && $default_mouseout.apply(this, arguments);\r\n  },\r\n  \r\n  _updateURL: function () {\r\n    var img = this._img;\r\n    if (!this._url) {\r\n      throw new Error('URL is not set.');\r\n    }\r\n\r\n    if (!img) {\r\n      img = this._img = new olleh.maps.SpritedImage();\r\n      this.registerElement('lower_overlay_pane', img.elem);\r\n      this.registerEventDom(img.elem);\r\n    }\r\n    \r\n    img.setImage(this._url, olleh.maps.Point.zero(), olleh.maps.Size.full());\r\n  }\r\n\r\n});/**\r\n * @private\r\n * @typedef olleh.maps.vector.VectorOptions\r\n * @property {Boolean} [editable=false]    .\r\n * @property {Boolean} [visible=true]   .\r\n * @extends olleh.maps.overlay.OverlayOptions\r\n */\r\n\r\n/**\r\n * Vector   base class.  class   class       .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.Vector').extend(olleh.maps.overlay.Overlay).define({\r\n  /**\r\n   * Vector   Renderer \r\n   * @private\r\n   */\r\n  rendererName: null,\r\n  \r\n  /**\r\n   * Vector   {@link olleh.maps.vector.EditHandler}   registry .  plugin  <br>\r\n   * <code>\r\n   *  olleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Polyline'] = example.PolylineEditHandler \r\n   * </code> \r\n   *   EditHandler class   .\r\n   * @private\r\n   */\r\n  editHandlerRegistry: {},\r\n\r\n  /**\r\n   * ,  opts    .\r\n   */\r\n  Vector: function (opts) {\r\n    if (this.$classname === 'olleh.maps.vector.Vector') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.vector.Vector directly.');\r\n    }\r\n    this._drawn = false;\r\n    this._visible = true;\r\n    this._editable = false;\r\n    this._element = null; // olleh.maps.Element\r\n    this._eventDom = null; // DOM Element\r\n    this.layer = null;\r\n    this._renderer = null; // olleh.maps.vector.BaseRenderer\r\n    this._opts = this._getDefaultOptions();\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @returns {Boolean}   <code>true</code>,   \r\n   *          <code>false</code>.\r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @fires olleh.maps.vector.Vector#event:visible_changed\r\n   * @param {Boolean} visible <code>true</code>  ,    .\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible === visible) {\r\n      return;\r\n    }\r\n    this._visible = visible;\r\n    if(this._drawn) {\r\n      this._updateVisiblity();\r\n    }\r\n    if(this.isAdded() && visible){\r\n      this.draw();\r\n    }\r\n    /**\r\n     *    .\r\n     * @event olleh.maps.vector.Vector#event:visible_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('visible_changed');\r\n  },\r\n\r\n  /**\r\n   * z-index         .\r\n   */\r\n  bringToFront: function () {\r\n    if (!this._isFront) {\r\n      this._isFront = true;\r\n      if (this._drawn) {\r\n        var vector = olleh.maps.browser.vector;\r\n        if (vector === 'VML') {\r\n          this._updateZIndex();\r\n        } else if (vector === 'SVG') {\r\n          var elem = this._element.elem;\r\n          elem.parentNode && elem.parentNode.appendChild(elem);\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  _updateVisiblity: function () {\r\n    olleh.maps.util.dom.setStyle(this._element.elem, 'display', this._visible ? 'block' : 'none');\r\n  },\r\n\r\n  _updateZIndex: function () {\r\n    var zIndex = this._isFront ? olleh.maps.overlay.BaseOverlay.MAX_ZINDEX : this._zIndex;\r\n    if (olleh.maps.isNumber(zIndex)) {\r\n      olleh.maps.util.dom.setStyle(this._element.elem, 'zIndex', zIndex);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link #bringToFront}  z-index   .\r\n   */\r\n  resetZIndex: function () {\r\n    if (this._isFront) {\r\n      this._isFront = false;\r\n      if (this._drawn && olleh.maps.browser.vector === 'VML') {\r\n        this._updateZIndex();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Vector  layer    .\r\n   * @private\r\n   */\r\n  onAdd: function (layer) {\r\n    this.isVisible() && this.draw();\r\n  },\r\n\r\n  /**\r\n   * Vector   Renderer  . rendererName   renderer  {@link olleh.maps.vector.RendererFactory}\r\n   *   .\r\n   * @private\r\n   * @returns {olleh.maps.vector.BaseRenderer}\r\n   */\r\n  createRenderer: function () {\r\n    return this.layer.getRendererFactory()['create' + this.rendererName](this._opts);\r\n  },\r\n\r\n  /**\r\n   * Vector  . Vector      .\r\n   */\r\n  draw: function () {\r\n    if(!this.isAdded())\r\n      return;\r\n    if(!this._renderer)\r\n      this._renderer = this.createRenderer();\r\n    if(!this._renderer)\r\n      return;\r\n    this._drawn = true;\r\n    this._doDraw();\r\n    if (!this._element) {\r\n      this._element = this._renderer.getRootElement();\r\n      var elem = this._element.elem;\r\n      this.layer.getContainer().appendChild(elem);\r\n      var eventDom = this._eventDom = this._renderer.getEventDom();\r\n      this.registerEventDom(eventDom);\r\n    }\r\n    this.registerEvent();\r\n    if(this._editable) {\r\n      this._attachEditHandler(); \r\n    }\r\n  },\r\n  \r\n  /**\r\n   * Vector  VectorLayer    VectorLayer  .\r\n   * @private\r\n   */\r\n  onRemove: function() {\r\n    this.erase();\r\n  },\r\n\r\n  /**\r\n   * draw()    . Vector       .\r\n   */\r\n  erase: function () {\r\n    olleh.maps.vector.Vector.$super.erase.apply(this, arguments);\r\n    if (this._element) {\r\n      this.unregisterEvent();\r\n      this.layer.getContainer().removeChild(this._element.elem);\r\n      this._element = null;\r\n      this._eventDom = null;\r\n      this._drawn = false;\r\n      if(this._editable) {\r\n        this._detachEditHandler();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @returns {Boolean}    <code>true</code>,   \r\n   *          <code>false</code>\r\n   * @private\r\n   */\r\n  isDrawn: function () {\r\n    return this._drawn;\r\n  },\r\n\r\n  /**\r\n   * Vector      renderer       . subclass\r\n   * should override this\r\n   * @private\r\n   * @returns {Element}\r\n   */\r\n  _doDraw: function () {\r\n  },\r\n\r\n  attach: function () {\r\n    var layer = this.map.getLayer('Vector');\r\n    if (layer)\r\n      layer.add(this);\r\n    else\r\n      throw new Error('VectorLayer does not exists.');\r\n  },\r\n\r\n  detach: function () {\r\n    this.layer && this.layer.remove(this);\r\n  },\r\n\r\n  /**\r\n   *  option   . subclass should override this\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  _getDefaultOptions: function () {\r\n    return {};\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {Object} options\r\n   */\r\n  setOptions: function (options) {\r\n    olleh.maps.mixin(this._opts, options, true);\r\n    if (this.isAdded() && this._renderer) {\r\n      this._renderer.setOptions(this._opts);\r\n      this.isVisible() && this._doDraw();\r\n    }\r\n    options.editable !== undefined && this.setEditable(options.editable);\r\n    olleh.maps.vector.Vector.$super.setOptions.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @returns {olleh.maps.Coord} \r\n   */\r\n  getCenter: function() {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *  bounds  .\r\n   * @returns {olleh.maps.Bounds} bounds\r\n   */\r\n  getBounds: function() {\r\n    \r\n  },\r\n\r\n  /**\r\n   *   / .\r\n   * @param {Boolean} editable true      .\r\n   */\r\n  setEditable: function(editable) {\r\n    if(this._editable !== editable) {\r\n      this._editable = editable;\r\n      if(!editable) {\r\n        this._detachEditHandler();\r\n      } else {\r\n        if(this._drawn) {\r\n          this._attachEditHandler();\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {Boolean} true     .\r\n   */\r\n  isEditable: function() {\r\n    return this._editable;\r\n  },\r\n  \r\n  _attachEditHandler: function() {\r\n    if(this._editHandler) {\r\n      this._editHandler.refresh();\r\n    } else {\r\n      var editHandlerClass = olleh.maps.vector.Vector.prototype.editHandlerRegistry[this.$classname];\r\n      if(editHandlerClass) {\r\n        var editHandler = new editHandlerClass(this);\r\n        editHandler.activate();\r\n        this._editHandler = editHandler;\r\n      }\r\n    }\r\n  },\r\n  \r\n  _detachEditHandler: function() {\r\n    this._editHandler && this._editHandler.deactivate();\r\n    this._editHandler = null;\r\n  }\r\n\r\n});\r\n/**\r\n * geometry  {@link olleh.maps.Path}   Polyline, Polygon   base class\r\n * @private\r\n */\r\n$class('olleh.maps.vector.Path').extend(olleh.maps.vector.Vector).define({\r\n\r\n  /**\r\n   * Path  Layer Pixel Array  .\r\n   * @param {olleh.maps.Path} path\r\n   * @returns {Array.<olleh.maps.Point>}\r\n   * @private\r\n   */\r\n  _convertPathToPoints: function (path) {\r\n    var points = [];\r\n    var lm = this.layer.layerMgr;\r\n    for ( var i = 0, len = path.getLength(); i < len; i++) {\r\n      var coord = path.getAt(i);\r\n      var layerPx = lm.getLayerPxFromCoord(coord);\r\n      points.push(layerPx);\r\n    }\r\n    return points;\r\n  }\r\n\r\n});/**\r\n * {@link olleh.maps.vector.Polygon} \r\n * @typedef olleh.maps.vector.PolygonOptions\r\n * @property {olleh.maps.Path|Array.<olleh.maps.Path>} paths Polygon   Path   \r\n * @property {String} [fillColor='transpraent'] Polygon   , CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Polygon  , 0.0  1.0    \r\n *        .\r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokeStyle]   .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\n * @property {Boolean} [visible=true]   .\r\n * @extends olleh.maps.vector.VectorOptions\n */\r\n\r\n/**\r\n * Polygon    vector class. {@link olleh.maps.Path}   {@link olleh.maps.Path}   geometry  .\r\n * \r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Polygon#event:paths_changed|paths_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>\r\n */\r\n$class('olleh.maps.vector.Polygon').extend(olleh.maps.vector.Path).define({\r\n  rendererName: 'PolygonRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.PolygonOptions} opts Polygon  \r\n   */\r\n  Polygon: function (opts) {\r\n  },\r\n  \r\n  init: function() {\r\n    olleh.maps.vector.Polygon.$super.init.call(this);\r\n    var paths = this.getPaths();\r\n    for(var i=0; i<paths.length; i++) {\r\n      paths[i].onChange(this.draw, this);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Polygon#setOptions\r\n   * @param {olleh.maps.vector.PolygonOptions} options Polygon \r\n   */\r\n\r\n  /**\r\n   * Polygon   path    .\r\n   * @param {olleh.maps.Path | Array} paths\r\n   */\r\n  setPaths: function (paths) {\r\n    var existingPaths = this.getPaths();\r\n    for(var i=0; i<existingPaths.length; i++) {\r\n      existingPaths[i].unsubscribeChange(this.draw, this);\r\n    }\r\n    this.erase();\r\n    paths = paths || [];\r\n    if (!olleh.maps.isArray(paths))\r\n      paths = [ paths ];\r\n    this._opts.paths = paths;\r\n    if (paths.length > 0) {\r\n      for(var i=0; i<paths.length; i++) {\r\n        paths[i].onChange(this.draw, this);\r\n      }\r\n      this.draw();\r\n    }\r\n    /**\r\n     * paths  . \r\n     *    path  coord     \r\n     * {@link olleh.maps.Path#onChange(callbackFn,ctx)}  .    \r\n     * @event olleh.maps.vector.Polygon#event:paths_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('paths_changed');\r\n  },\r\n\r\n  _doDraw: function () {\r\n    var paths = this.getPaths();\r\n    var pointsArray = [];\r\n    for(var i=0; i<paths.length; i++) {\r\n      var points = this._convertPathToPoints(paths[i]);\r\n      pointsArray.push(points);\r\n      this._renderer.draw(pointsArray);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Path  .\r\n   * @returns {Array.<olleh.maps.Path>} Polygon   Path . \r\n   *  Path     empty array\r\n   */\r\n  getPaths: function () {\r\n    if(olleh.maps.isArray(this._opts.paths))\r\n      return this._opts.paths;\r\n    return this._opts.paths ? [this._opts.paths] : [];\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      fillColor: 'transparent',\r\n      fillOpacity: 1.0,\r\n      fillRule: 'evenodd',\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n\r\n  getCenter: function() {\r\n    return this.getBounds().getCenter();\r\n  },\r\n  \r\n  getBounds: function() {\r\n    return this.getPaths()[0].getBounds();\r\n  }\r\n\r\n});\r\n/**\r\n * {@link olleh.maps.vector.Polyline} \r\n * @typedef olleh.maps.vector.PolylineOptions\r\n * @property {olleh.maps.Path} path Polyline   Path \r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokeStyle]   .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @extends olleh.maps.vector.VectorOptions\r\n */\r\n\r\n/**\r\n * Polyline    Vector class. {@link olleh.maps.Path}  geometry  .\r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Polyline#event:path_changed|path_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>\r\n */\r\n$class('olleh.maps.vector.Polyline').extend(olleh.maps.vector.Path).define({\r\n  rendererName: 'PolylineRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.PolylineOptions} opts Polyline  \r\n   */\r\n  Polyline: function (opts) {\r\n  },\r\n  \r\n  init: function() {\r\n    olleh.maps.vector.Polyline.$super.init.call(this);\r\n    if(this._opts.path) {\r\n      this._opts.path.onChange(this.draw, this);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Polyline#setOptions\r\n   * @param {olleh.maps.vector.PolylineOptions} options Polyline \r\n   */\r\n\r\n  _doDraw: function () {\r\n    if (this._opts.path) {\r\n      var points = this._convertPathToPoints(this._opts.path);\r\n      this._renderer.draw(points);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Path  .\r\n   * @param {olleh.maps.Path} path\r\n   */\r\n  setPath: function (path) {\r\n    if (this._opts.path) {\r\n      this._opts.path.unsubscribeChange(this.draw, this);\r\n    }\r\n    this._opts.path = path;\r\n    if (path) {\r\n      path.onChange(this.draw, this);\r\n      this.draw();\r\n    } else {\r\n      this.erase();\r\n    }\r\n    /**\r\n     * path  . \r\n     *    path  coord     \r\n     * {@link olleh.maps.Path#onChange(callbackFn,ctx)}  .    \r\n     * @event olleh.maps.vector.Polyline#event:path_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('path_changed');\r\n  },\r\n\r\n  /**\r\n   * Path  .\r\n   * @returns {olleh.maps.Path} Path \r\n   */\r\n  getPath: function () {\r\n    return this._opts.path;\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      icons: [],\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n  \r\n  getCenter: function() {\r\n    return this.getBounds().getCenter();\r\n  },\r\n  \r\n  getBounds: function() {\r\n    return this.getPath().getBounds();\r\n  }\r\n\r\n});\r\n/**\r\n * {@link olleh.maps.vector.Rectangle} \r\n * @typedef olleh.maps.vector.RectangleOptions\r\n * @property {olleh.maps.Bounds} bounds   Bounds\r\n * @property {String} [fillColor='transpraent'] Rectangle   . CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Rectangle   . 0.0  1.0     .\r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokePosition=center]  . center, inside, outside \r\n *            .\r\n * @property {String} [strokeStyle]   . \r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @extends olleh.maps.vector.VectorOptions\r\n */\r\n\r\n/**\r\n *    vector class. {@link olleh.maps.Bounds}  geometry  .\r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Rectangle#event:bounds_changed|bounds_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>\r\n */\r\n$class('olleh.maps.vector.Rectangle').extend(olleh.maps.vector.Vector).define({\r\n  rendererName: 'RectangleRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.RectangleOptions} opts Rectangle  \r\n   */\r\n  Rectangle: function (opts) {\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Rectangle#setOptions\r\n   * @param {olleh.maps.vector.RectangleOptions} options Rectangle \r\n   */\r\n\r\n  _doDraw: function () {\r\n    var lm = this.layer.layerMgr;\r\n    var resolution = lm.getResolution();\r\n    var bounds = this._opts.bounds;\r\n    var leftTopPx = lm.getLayerPxFromCoord(bounds.getLeftTopCoord());\r\n    var widthPx = bounds.getWidth() / resolution;\r\n    var heightPx = bounds.getHeight() / resolution;\r\n    this._renderer.draw(leftTopPx, widthPx, heightPx);\r\n  },\r\n\r\n  /**\r\n   * bounds  .\r\n   * @param {olleh.maps.Bounds} bounds Rectangle    .\r\n   */\r\n  setBounds: function (bounds) {\r\n    this._opts.bounds = bounds;\r\n    this.draw();\r\n    /**\r\n     * bounds  . \r\n     * @event olleh.maps.vector.Rectangle#event:bounds_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('bounds_changed');\r\n  },\r\n\r\n  /**\r\n   *  bounds  .\r\n   * @returns {olleh.maps.Bounds}\r\n   */\r\n  getBounds: function () {\r\n    return this._opts.bounds;\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      fillColor: 'transparent',\r\n      fillOpacity: 1.0,\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokePosition: 'center', // center, insdie, outside\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n  \r\n  getCenter: function() {\r\n    var bounds = this.getBounds();\r\n    var center = bounds.getCenter();\r\n    return center.transform(bounds.getType());\r\n  }\r\n  \r\n});\r\n/**\r\n * {@link olleh.maps.vector.Circle} \r\n * @typedef olleh.maps.vector.CircleOptions\r\n * @property {olleh.maps.Coord} center Circle \r\n * @property {Number} radius Circle \r\n * @property {String} [fillColor='transpraent'] Circle   . CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Circle   . 0.0  1.0   \r\n *         .\r\n * @property {String} [strokeColor='black']  . CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  . 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokePosition=center]  . center, inside, outside \r\n *            .\r\n * @property {String} [strokeStyle]   .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @property {Boolean} [visible=true]   .\r\n * @extends olleh.maps.vector.VectorOptions\r\n */\r\n\r\n/**\r\n *   vector class. (center)  (radius) .\r\n * \r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Circle#event:center_changed|center_changed}</li>\r\n * <li>{@link olleh.maps.vector.Circle#event:radius_changed|radius_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>  \r\n */\r\n$class('olleh.maps.vector.Circle').extend(olleh.maps.vector.Vector).define({\r\n  rendererName: 'CircleRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.CircleOptions} opts Circle \r\n   * \r\n   */\r\n  Circle: function (opts) {\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Circle#setOptions\r\n   * @param {olleh.maps.vector.CircleOptions} options Circle \r\n   */\r\n\r\n  /**\r\n   *   .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getCenter: function () {\r\n    return this._opts.center;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Number}\r\n   */\r\n  getRadius: function () {\r\n    return this._opts.radius;\r\n  },\r\n\r\n  _doDraw: function () {\r\n    var centerPx = this.layer.layerMgr.getLayerPxFromCoord(this._opts.center);\r\n    var resolution = this.layer.layerMgr.getResolution();\r\n    var radiusPx = this._opts.radius / resolution;\r\n    this._renderer.draw(centerPx, radiusPx);\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @param {olleh.maps.Coord} center\r\n   * @param {Number} radius\r\n   */\r\n  setCenterAndRadius: function (center, radius) {\r\n    this._opts.center = center;\r\n    this._opts.radius = radius;\r\n    this.draw();\r\n    this.fireEvent('center_changed');\r\n    this.fireEvent('radius_changed');\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Coord} center\r\n   */\r\n  setCenter: function(center) {\r\n    this._opts.center = center;\r\n    this.draw();\r\n    /**\r\n     * center  . \r\n     * @event olleh.maps.vector.Circle#event:center_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('center_changed');\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @param {Number} radius\r\n   */\r\n  setRadius: function(radius) {\r\n    this._opts.radius = radius;\r\n    this.draw();\r\n    /**\r\n     * radius  . \r\n     * @event olleh.maps.vector.Circle#event:radius_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('radius_changed');\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      fillColor: 'transparent',\r\n      fillOpacity: 1.0,\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokePosition: 'center', // center, insdie, outside\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n  \r\n  getBounds: function() {\r\n    var r = this.getRadius();\r\n    var center = this.getCenter();\r\n    var center_ =  center.asDefault();\r\n    var leftBottom = center_.clone();\r\n    leftBottom.x -= r;\r\n    leftBottom.y -= r;\r\n    var rightTop = center_.clone();\r\n    rightTop.x += r;\r\n    rightTop.y += r;\r\n    var bounds = new olleh.maps.Bounds(leftBottom, rightTop);\r\n    return bounds.transform(center.getClass());\r\n  }\r\n  \r\n});\r\n/**\r\n * vector({@link olleh.maps.vector.Vector})     .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.BaseRenderer').define({\r\n\r\n  /**\r\n   *  DOM  {@link olleh.maps.Element} .\r\n   * @returns {olleh.maps.Element}\r\n   */\r\n  getRootElement: function () { return null; },\r\n  \r\n  /**\r\n   * hit test  DOM Element .\r\n   * @returns {HTMLElement}\r\n   */\r\n  getEventDom: function () { return null; },\r\n\r\n  /**\r\n   *  .\r\n   * @param {Object} opts \r\n   */\r\n  setOptions: function (opts) {},\r\n\r\n  /**\r\n   * Vector   .\r\n   * @returns {Boolean}\r\n   */\r\n  isDrawn: function () {},\r\n  \r\n  /**\r\n   * Vector     .\r\n   */\r\n  prepareToDraw: function () {}\r\n});/**\n * vector {@link olleh.maps.vector.Vector}   container element   \n * .   svg   (path, circle )  svg element   . \n * @private\n */\n$class('olleh.maps.vector.ContainerRenderer').define({\n  \n  /**\n   * ContainerRenderer \n   * @param {Object} opts \n   * @param {VectorLayer} opts.layer VectorLayer \n   * @returns {olleh.maps.vector.ContainerRenderer}\n   */\n  ContainerRenderer: function(opts) {\n    /**\n     * Layer . ContainerRenderer    .\n     */\n    opts && (this.layer = opts.layer);\n  },\n  \n  /**\n   * Container element  .\n   * <p/>\n   *    API override .\n   * @returns {HTMLElement}\n   */\n  createContainer: function () {},\n  \n  /**\n   * Container element    . VectorLayer  draw  layer offset    . \n   */\n  setBounds: function() {}\n  \n});/**\r\n * {@link olleh.maps.vector.PathRenderer} \r\n * @private\r\n * @typedef olleh.maps.vector.PathRendererOptions\r\n * @property {String} [fillColor='transpraent'] Polygon   , CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Polygon  , 0.0  1.0    \r\n *        .\r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @property {String} [strokeStyle]    .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n */\r\n\r\n/**\r\n * VML shape  SVG path     vector     renderer\r\n * @private  \r\n */\r\n$class('olleh.maps.vector.PathRenderer').define({\r\n  /**\r\n   * \r\n   * @param {olleh.maps.vector.PathRendererOptions} opts\r\n   */\r\n  PathRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   * {@link #lineTo}     .\r\n   * @param {Number} x  x \r\n   * @param {Number} y  y \r\n   */\r\n  moveTo: function(x, y) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @param {Number} x x \r\n   * @param {Number} y y \r\n   */\r\n  lineTo: function(px) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {Number} cx   x\r\n   * @param {Number} cy   y\r\n   * @param {Number} r  \r\n   */\r\n  circle: function(cx, cy, r) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *    polyline  .\r\n   * @param {array.<olleh.maps.Point>} points\r\n   */\r\n  path: function(points) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   * {@link #path}    polyline    .\r\n   */\r\n  closePath: function() {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *   svg element ( vml element)  .\r\n   */\r\n  commit: function() {\r\n    \r\n  }\r\n\r\n});\n/**\r\n * vector {@link olleh.maps.vector.Polyline}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.PolylineRenderer').define({\r\n  \r\n  /**\r\n   * vector {@link olleh.maps.vector.Polyline}    .\r\n   * <p/>\r\n   *   . {@link olleh.maps.vector.RendererFactory} \r\n   *    SVG, Canvas, VML Renderer .\r\n   * @param {olleh.maps.vector.PolylineOptions} opts\r\n   */\r\n  PolylineRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *     polyline .\r\n   * <p/>\r\n   *    API override .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   */\r\n  draw: function (points) {\r\n  }\r\n});/**\r\n * vector {@link olleh.maps.vector.Rectangle}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.RectangleRenderer').define({\r\n  /**\r\n   * vector {@link olleh.maps.vector.Rectangle}    .\r\n   * <p/>\r\n   *   . {@link olleh.maps.vector.RendererFactory} \r\n   *    SVG, Canvas, VML Renderer .\r\n   * @param {olleh.maps.vector.RectangleOptions} opts\r\n   */\r\n  RectangleRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * <p/>\r\n   *    API override .\r\n   * @param {olleh.maps.Point} leftTop  \r\n   * @param {Number} width \r\n   * @param {Number} height \r\n   */\r\n  draw: function (leftTop, width, height) {\r\n  }\r\n});/**\r\n * vector {@link olleh.maps.vector.Circle}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.CircleRenderer').define({\r\n  \r\n  /**\r\n   * vector {@link olleh.maps.vector.Circle}    .\r\n   * <p/>\r\n   *   . {@link olleh.maps.vector.RendererFactory} \r\n   *    SVG, Canvas, VML Renderer .\r\n   * @param {olleh.maps.vector.CircleOptions} opts\r\n   */\r\n  CircleRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *     . \r\n   * <p/>\r\n   *    API override .\r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   */\r\n  draw: function (center, radius) {}\r\n});/**\r\n * vector {@link olleh.maps.vector.Polygon}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.PolygonRenderer').define({\r\n  \r\n  /**\r\n   * vector {@link olleh.maps.vector.Polygon}    .\r\n   * @param {olleh.maps.vector.PolygonOptions} opts\r\n   */\r\n  PolygonRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *     polygon .\r\n   * @param {Array.<Array.<olleh.maps.Point>>} pointsArray Polygon    2 \r\n   *          polygon      polygon  hole  . \r\n   */\r\n  draw: function (pointsArray) {\r\n    \r\n  }\r\n\r\n});/**\r\n * SVG vector({@link olleh.maps.vector.Vector})  .\r\n * @private\r\n */\r\nolleh.maps.browser.hasSVG &&\r\n$class('olleh.maps.vector.svg.Renderer').extend(olleh.maps.vector.BaseRenderer).define({\r\n  \r\n  $static: { \r\n    /**\r\n     *   SVG Element  .\r\n     * @param {String} name \r\n     * @returns {SVGElement}\r\n     */\r\n    createElement: function (name) {\r\n      var elem = document.createElementNS('http://www.w3.org/2000/svg', name);\r\n      olleh.maps.util.dom.setStyle(elem, 'userSelect', 'none');\r\n      elem.setAttribute('fill', 'none');\r\n      if (olleh.maps.browser.browserName === olleh.maps.browser.BROWSER_NAME.ie) {\r\n        // ie9  class   .\r\n        olleh.maps.util.dom.setStyle(elem, 'pointer-events', 'visiblePainted');\r\n      }\r\n      return elem;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'path',\r\n  \r\n  /**\r\n   * hit test  DOM Element .\r\n   * @returns {SVGElement}\r\n   * @see olleh.maps.vector.BaseRenderer#getEventDom\r\n   */\r\n  getEventDom: function () {\r\n    return this.elem;\r\n  },\r\n  \r\n  /**\r\n   * Vector     .\r\n   * @see olleh.maps.vector.BaseRenderer#prepareToDraw\r\n   */\r\n  prepareToDraw: function () {\r\n    this.getRootElement();\r\n    this._drawn = true;\r\n    this.setOptions();\r\n  },\r\n  \r\n  /**\r\n   * Vector   .\r\n   * @returns {Boolean}\r\n   * @see olleh.maps.vector.BaseRenderer#isDrawn\r\n   */\r\n  isDrawn: function () {\r\n    return !!this._drawn;\r\n  },\r\n  \r\n  /**\r\n   *  DOM  {@link olleh.maps.Element} .\r\n   * @returns {olleh.maps.Element}\r\n   * @see olleh.maps.vector.BaseRenderer#getRootElement\r\n   */\r\n  getRootElement: function () {\r\n    if (!this.rootElem) {\r\n      var rootElem = olleh.maps.vector.svg.Renderer.createElement(this.tag);\r\n      this.rootElem = new olleh.maps.Element(rootElem); \r\n      this.elem = rootElem;\r\n    }\r\n    return this.rootElem;\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {Object} opts \r\n   * @see olleh.maps.vector.BaseRenderer#setOptions\r\n   */\r\n  setOptions: function (opts) {\r\n    this.opts = olleh.maps.mixin(this.opts, opts, true);\r\n    \r\n    if (!this.isDrawn())return;\r\n    \r\n    var opts = this.opts;\r\n    var weight = opts.strokeWeight;\r\n    var elem = this.elem;\r\n    \r\n    opts.strokeColor ? elem.setAttribute('stroke', opts.strokeColor) : \r\n      elem.removeAttribute('stroke');\r\n    opts.strokeOpacity ? elem.setAttribute('stroke-opacity', opts.strokeOpacity) : \r\n      elem.removeAttribute('stroke-opacity');\r\n    opts.fillColor ? elem.setAttribute('fill', opts.fillColor) : \r\n      elem.setAttribute('fill', 'none');\r\n    opts.fillOpacity ? elem.setAttribute('fill-opacity', opts.fillOpacity) : \r\n      elem.removeAttribute('fill-opacity');\r\n\r\n    elem.setAttribute('stroke-linecap',opts.strokeLinecap || 'round');  // butt | round | square\r\n    elem.setAttribute('stroke-linejoin',opts.strokeLinejoin || 'round'); // miter | round | bevel\r\n    \r\n    opts.fillRule? elem.setAttribute('fill-rule',opts.fillRule) :\r\n      elem.removeAttribute('fill-rule') ;\r\n\r\n    if(opts.strokeStyle) {\r\n      var strokeDasharray;\r\n      if(olleh.maps.isArray(opts.strokeStyle))\r\n        strokeDasharray = opts.strokeStyle.join(' ');\r\n      else\r\n        strokeDasharray = this._strokeDashArray(opts.strokeStyle, weight);\r\n      elem.setAttribute('stroke-dasharray', strokeDasharray);\r\n    } else {\r\n      elem.removeAttribute('stroke-dasharray');\r\n    }\r\n    elem.setAttribute('stroke-width', weight || 0);\r\n  },\r\n  \r\n  // VML  strokeStyle  SVG    \r\n  _strokeDashArray: function(strokeStyle, weight) {\r\n    if(!weight)\r\n      weight = 1;\r\n    strokeStyle = strokeStyle.toLowerCase();\r\n    if(strokeStyle == 'solid') {\r\n      return '0';\r\n    } else if(strokeStyle == 'dot') {\r\n      return weight+ ',' +weight*3;\r\n    } else if(strokeStyle == 'dash') {\r\n      return weight*4+','+weight*3;\r\n    } else if(strokeStyle == 'shortdot') {\r\n      return weight+','+weight;\r\n    } else if(strokeStyle == 'shortdash') {\r\n      return weight*3+','+weight;\r\n    } else if(strokeStyle == 'longdash') {\r\n      return weight*8+','+weight*3;\r\n    } else if(strokeStyle == 'dashdot') {\r\n      return weight*4+','+weight*3+','+weight+','+weight*3;\r\n    } else if(strokeStyle == 'shortdashdot') {\r\n      return weight*3+','+weight+','+weight+','+weight;\r\n    } else if(strokeStyle == 'longdashdot') {\r\n      return weight*8+','+weight*3+','+weight+','+weight*3;\r\n    } else if(strokeStyle == 'shortdashdotdot') {\r\n      return weight*3+','+weight+','+weight+','+weight+','+weight+','+weight;\r\n    } else if(strokeStyle == 'longdashdotdot') {\r\n      return weight*8+','+weight*3+','+weight+','+weight*3+','+weight+','+weight*3;\r\n    }\r\n    return strokeStyle;\r\n  }\r\n  \r\n});/**\r\n * SVG    {@link olleh.maps.vector.PathRenderer}   \r\n * @private\r\n */\r\nolleh.maps.vector.svg &&\r\n$class('olleh.maps.vector.svg.PathRenderer').extend(olleh.maps.vector.PathRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n  \r\n  moveTo: function(x, y) {\r\n    this._initCommand();\r\n    this._command += 'M ' + x + ' ' + y;\r\n  },\r\n  \r\n  lineTo: function(x, y) {\r\n    this._initCommand();\r\n    this._command += 'L ' + x + ' ' + y;\r\n  },\r\n  \r\n  circle: function(cx, cy, r) {\r\n    this._initCommand();\r\n    this._command +='M '+cx+' '+cy+' '\r\n                  + 'm -'+r+',0 '\r\n                  + 'a ' +r+','+r+' 0 1,0 ' + r*2 +',0 '\r\n                  + 'a ' +r+','+r+' 0 1,0 -'+ r*2 +',0';\r\n  },\r\n  \r\n  path: function(points) {\r\n    this._initCommand();\r\n    for(var i=0;i<points.length;i++) {\r\n      var p = points[i];\r\n      if(i==0) {\r\n        this.moveTo(p.x, p.y);\r\n      } else {\r\n        this.lineTo(p.x, p.y);\r\n      }\r\n    }\r\n  },\r\n  \r\n  closePath: function() {\r\n    this._initCommand();\r\n    this._command += 'Z';\r\n  },\r\n  \r\n  _initCommand: function() {\r\n    if(!this._command)\r\n      this._command = '';\r\n    else\r\n      this._command += ' ';\r\n  },\r\n  \r\n  commit: function() {\r\n    this.elem.setAttribute('d',this._command);\r\n    this._command = null;\r\n  }\r\n\r\n});/**\n * SVG container  .\n * @private\n */\nolleh.maps.vector.svg &&\n$class('olleh.maps.vector.svg.ContainerRenderer').extend(olleh.maps.vector.ContainerRenderer).define({\n\n  buffer: 1,\n  \n  /**\n   * SVG  .        .\n   * @returns {SVGElement}\n   */\n  createContainer: function () {\n    if (!this._svgElem) {\n      var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      this._svgElem = svg;\n      svg.style.position = 'absolute';\n      olleh.maps.util.dom.setStyle(svg, 'userSelect', 'none');\n      if (olleh.maps.browser.browserName === olleh.maps.browser.BROWSER_NAME.ie) {\n        // ie9  class   .\n        olleh.maps.util.dom.setStyle(svg, 'pointer-events', 'none');\n      }\n      olleh.maps.util.dom.addClass(svg, 'ollehmap-noevent');\n    }\n    return this._svgElem;\n  },\n  \n  \n  /**\n   * SVG ,  .\n   */ \n  setBounds: function() {\n    var svg = this.createContainer();\n    var layerMgr = this.layer.layerMgr;\n    var viewportSize = layerMgr.getViewportSize();\n    var layerOffset = layerMgr.getLayerOffset().multiplyBy(-1);\n    //  viewport  buffer       return  .\n    var bounds;\n    if(this._bounds) {\n      bounds = this._bounds;\n      if(bounds.left <= layerOffset.x && layerOffset.x <= bounds.right &&\n         bounds.top <= layerOffset.y && layerOffset.y <= bounds.bottom) {\n        return;\n      }\n    }\n    bounds = {\n      left: layerOffset.x - viewportSize.width * this.buffer,\n      right: layerOffset.x + viewportSize.width * this.buffer,\n      top: layerOffset.y - viewportSize.height * this.buffer,\n      bottom: layerOffset.y + viewportSize.height * this.buffer\n    };\n    this._bounds = bounds;\n    svg.setAttribute('viewBox', bounds.left + ' ' + bounds.top + ' ' + viewportSize.width * (1 + 2 * this.buffer) + ' ' + viewportSize.height * (1 + 2 * this.buffer));\n    var use3d = olleh.maps.browser.osName !== olleh.maps.browser.OS_NAME.ios; // iOS  translate3d        \n    var styles = olleh.maps.util.dom.getPositionStyles(bounds.left, bounds.top, use3d); // buffer    \n    styles.width = viewportSize.width * (1 + 2 * this.buffer) + 'px'; \n    styles.height = viewportSize.height * (1 + 2 * this.buffer) + 'px'; \n    olleh.maps.util.dom.setStyles(svg, styles);\n  }\n\n});\n/**\r\n * vector({@link olleh.maps.vector.Polyline})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg && \r\n$class('olleh.maps.vector.svg.PolylineRenderer').extend(\r\n    olleh.maps.vector.PolylineRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'polyline',\r\n  \r\n  /**\r\n   *     polyline .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   * @see olleh.maps.vector.PolylineRenderer#draw\r\n   */\r\n  draw: function (points) {\r\n    if (!points || !points.length) return;\r\n    \r\n    this.prepareToDraw();\r\n    \r\n    var len = points.length;\r\n    var polyline = this.elem;\r\n    var value = [];\r\n    var i, preX = 0, preY = 0, curX, curY;\r\n    \r\n    for(i = 0; i < len; i++) {\r\n      \r\n      curX = points[i].x;\r\n      curY = points[i].y;\r\n\r\n      if (curX != preX || curY != preY) {\r\n        value.push(curX + ',' + curY);\r\n      }\r\n      preX = curX;\r\n      preY = curY;\r\n    }\r\n    if (value.length == 1) {\r\n      value.push(curX + ',' + curY);\r\n    }\r\n    polyline.setAttribute('points', value.join(' '));\r\n  }\r\n});/**\r\n * vector({@link olleh.maps.vector.Polygon})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg &&\r\n$class('olleh.maps.vector.svg.PolygonRenderer').extend(olleh.maps.vector.PolygonRenderer)\r\n  .mixin(olleh.maps.vector.svg.PathRenderer).define({\r\n    \r\n    draw: function(pointsArray) {\r\n      if(!olleh.maps.isArray(pointsArray))\r\n        throw TypeError('Type of pointsArray must be array.');\r\n      this.prepareToDraw();\r\n      if(pointsArray[0] instanceof olleh.maps.Point)\r\n        pointsArray = [pointsArray];\r\n      for(var i=0; i<pointsArray.length;i++ ) {\r\n        var points = pointsArray[i];\r\n        this.path(points);\r\n        this.closePath();\r\n      }\r\n      this.commit();\r\n    }\r\n    \r\n  \r\n});/**\r\n * vector({@link olleh.maps.vector.Circle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg && \r\n$class('olleh.maps.vector.svg.CircleRenderer').extend(\r\n    olleh.maps.vector.CircleRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'circle',\r\n  \r\n  /**\r\n   *     . \r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   * @see olleh.maps.vector.CircleRenderer#draw\r\n   */\r\n  draw: function (center, radius) {\r\n    if (!(center instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(radius))) return;\r\n    \r\n    this.prepareToDraw();\r\n    var elem = this.elem;\r\n    \r\n    elem.setAttribute('cx', center.x); \r\n    elem.setAttribute('cy', center.y); \r\n    elem.setAttribute('r', radius);\r\n  }\r\n});/**\r\n * vector({@link olleh.maps.vector.Rectangle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg && \r\n$class('olleh.maps.vector.svg.RectangleRenderer').extend(\r\n    olleh.maps.vector.RectangleRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'rect',\r\n  \r\n  /**\r\n   *      .\r\n   * @param {olleh.maps.Point} leftTop  \r\n   * @param {Number} width \r\n   * @param {Number} height \r\n   * @see olleh.maps.vector.RectangleRenderer#draw\r\n   */\r\n  draw: function (leftTop, width, height) {\r\n    if (!(leftTop instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(width))) return;\r\n    if (!(olleh.maps.isNumber(height))) return;\r\n    \r\n    this.prepareToDraw();\r\n    \r\n    var rootElem = this.rootElem.elem;\r\n    \r\n    rootElem.setAttribute('x', leftTop.x);\r\n    rootElem.setAttribute('y', leftTop.y);\r\n    \r\n    if (olleh.maps.isNumber(width)) {\r\n      rootElem.setAttribute('width', width);\r\n    }\r\n    if (olleh.maps.isNumber(height)) {\r\n      rootElem.setAttribute('height', height);\r\n    }\r\n  }\r\n});if (olleh.maps.browser.hasVML) {\r\n\r\n  document.namespaces.add('ollehmap-vml', 'urn:schemas-microsoft-com:vml');\r\n  \r\n\r\n  /**\r\n   * VML vector({@link olleh.maps.vector.Vector})  .\r\n   * @private\r\n   */\r\n  $class('olleh.maps.vector.vml.Renderer').extend(olleh.maps.vector.BaseRenderer).define({\r\n    \r\n    $static: {\r\n      /**\r\n       *   VML Element  .\r\n       * @param {String} name \r\n       * @returns {VMLElement}\r\n       */\r\n      createElement: function (name) {\r\n        var elem = document.createElement('<ollehmap-vml:' + name + '>');\r\n        elem.className = 'ollehmap-vml';\r\n        elem.unselectable = 'on';\r\n        return elem;\r\n      }\r\n    },\r\n    \r\n    /**\r\n     *  \r\n     * @type String\r\n     */\r\n    tag: 'shape',\r\n    \r\n    /**\r\n     * hit test  DOM Element .\r\n     * @returns {HTMLElement}\r\n     * @see olleh.maps.vector.BaseRenderer#getEventDom\r\n     */\r\n    getEventDom: function () {\r\n      return this.rootElem.elem;\r\n    },\r\n    \r\n    /**\r\n     * Vector     .\r\n     * @see olleh.maps.vector.BaseRenderer#prepareToDraw\r\n     */\r\n    prepareToDraw: function () {\r\n      this.getRootElement();\r\n      this._drawn = true;\r\n      this.setOptions();\r\n    },\r\n    \r\n    /**\r\n     * Vector   .\r\n     * @returns {Boolean}\r\n     * @see olleh.maps.vector.BaseRenderer#isDrawn\r\n     */\r\n    isDrawn: function () {\r\n      return !!this._drawn;\r\n    },\r\n    \r\n    /**\r\n     *  DOM  {@link olleh.maps.Element} .\r\n     * @returns {olleh.maps.Element}\r\n     * @see olleh.maps.vector.BaseRenderer#getRootElement\r\n     */\r\n    getRootElement: function () {\r\n      if (!this.rootElem) {\r\n        var rootElem = olleh.maps.vector.vml.Renderer.createElement(this.tag);\r\n        this.rootElem = new olleh.maps.Element(rootElem);\r\n        this._containerElem = this.rootElem.elem; \r\n      }\r\n      return this.rootElem;\r\n    },\r\n    \r\n    /**\r\n     *  .\r\n     * @param {Object} opts \r\n     * @see olleh.maps.vector.BaseRenderer#setOptions\r\n     */\r\n    setOptions: function (opts) {\r\n      this.opts = olleh.maps.mixin(this.opts, opts, true);\r\n      \r\n      if (!this.isDrawn())return;\r\n      \r\n      var opts = this.opts;\r\n      var container = this._containerElem;\r\n      var clazz = olleh.maps.vector.vml.Renderer;\r\n      container.stroked = !!(opts.strokeWeight || olleh.maps.isUndefined(opts.strokeWeight));\r\n      \r\n      if (opts.strokeLinecap === 'butt') {\r\n        opts.strokeLinecap = 'flat';\r\n      }\r\n      if (container.stroked) {\r\n        !this._stroke && (this._stroke = clazz.createElement('stroke'));\r\n        this._stroke.color = opts.strokeColor;\r\n        this._stroke.weight = opts.strokeWeight;\r\n        this._stroke.opacity = opts.strokeOpacity || 1;\r\n        this._stroke.endcap = opts.strokeLinecap || 'round'; // butt | round | square\r\n        this._stroke.joinstyle = opts.strokeLinejoin || 'round'; // miter | round | bevel\r\n        \r\n        // http://msdn.microsoft.com/en-us/library/bb264085(v=vs.85).aspx\r\n        if (opts.strokeStyle) { \r\n          this._stroke.dashStyle = olleh.maps.isArray(opts.strokeStyle) ?\r\n              opts.strokeStyle.join(' ') :\r\n                (opts.strokeStyle + \"\").replace(/ *, */g, ' ');\r\n        } else {\r\n          this._stroke.dashStyle = '';\r\n        }\r\n        \r\n        container.appendChild(this._stroke);\r\n      } else {\r\n        if (this._stroke) {\r\n          container.removeChild(this._stroke);\r\n          delete this._stroke;\r\n        } \r\n      }\r\n      \r\n      container.filled = !(opts.fillColor === 'none' || opts.fillColor === 'transparent' || olleh.maps.isUndefined(opts.fillColor));\r\n      if (container.filled) {\r\n        !this._fill && (this._fill = clazz.createElement('fill'));\r\n        this._fill.color = opts.fillColor;\r\n        this._fill.opacity = opts.fillOpacity || 1;\r\n        container.appendChild(this._fill);\r\n      } else {\r\n        if (this._fill) {\r\n          container.removeChild(this._fill);\r\n          delete this._fill;\r\n        }\r\n      }\r\n      \r\n      \r\n    },\r\n    \r\n    /**\r\n     * VML  .\r\n     * @param {olleh.maps.Point} leftTop\r\n     * @private\r\n     */\r\n    _updatePosition: function (leftTop) {\r\n      if (!leftTop) return;\r\n      \r\n      if (this.isDrawn()) {\r\n        this.rootElem.setStyle('left', leftTop.x + 'px');\r\n        this.rootElem.setStyle('top', leftTop.y + 'px');\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * VML  .\r\n     * @param {Number} width\r\n     * @param {Number} height\r\n     * @private\r\n     */\r\n    _updateSize: function (width, height) {\r\n      this._width = width;\r\n      this._height = height;\r\n      \r\n      if (this.isDrawn()) {\r\n        var rootElem = this.rootElem;\r\n        rootElem.setStyle('width', width +'px');\r\n        rootElem.setStyle('height', height + 'px');\r\n        if(this.tag == 'shape') {\r\n          rootElem.elem.coordsize = width + ' ' + height;\r\n        }\r\n      }\r\n    }\r\n  });\r\n}  /**\r\n * VML    {@link olleh.maps.vector.PathRenderer}   \r\n * @private\r\n */\r\nolleh.maps.vector.vml &&\r\n$class('olleh.maps.vector.vml.PathRenderer').extend(olleh.maps.vector.PathRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n  \r\n  PathRenderer: function() {\r\n    this._translateX = 0;\r\n    this._translateY = 0;\r\n  },\r\n\r\n  prepareToDraw: function () {\r\n    this._command = [];\r\n    olleh.maps.vector.vml.Renderer.prototype.prepareToDraw.call(this);\r\n  },\r\n  \r\n  moveTo: function(x, y) {\r\n    this._command.push(['M', x, y]);\r\n    if(!this._bounds) {\r\n      this._bounds = {left:x, top:y, right:x, bottom:y};\r\n    } else {\r\n      this._union(x, y);\r\n    }\r\n  },\r\n  \r\n  lineTo: function(x, y) {\r\n    this._command.push(['L', x, y]);\r\n    if(!this._bounds) {\r\n      this._bounds = {left: x, top:y, right:x, bottom:y};\r\n    } else {\r\n      this._union(x, y);\r\n    }\r\n  },\r\n  \r\n  circle: function(cx, cy, r) {\r\n    var left = cx-r;\r\n    var top = cy-r;\r\n    var right = cx+r;\r\n    var bottom = cy+r;\r\n    this._command.push(['AT',cx,cy,r]);\r\n    if(!this._bounds) {\r\n      this._bounds = {left: left, top:top, right:right, bottom:bottom};\r\n    } else {\r\n      this._union(left, top);\r\n      this._union(right, bottom);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @param {array.<olleh.maps.Point>} points\r\n   */\r\n  path: function(points) {\r\n    for(var i=0;i<points.length;i++) {\r\n      var p = points[i];\r\n      if(i==0) {\r\n        this.moveTo(p.x, p.y);\r\n      } else {\r\n        this.lineTo(p.x, p.y);\r\n      }\r\n    }\r\n  },\r\n  \r\n  closePath: function() {\r\n    this._command.push(['X']);\r\n  },\r\n  \r\n  commit: function() {\r\n    var bounds = this._bounds;\r\n    var str='';\r\n    for(var i=0; i<this._command.length;i++) {\r\n      var command = this._command[i];\r\n      if(str.length > 0) str += ' ';\r\n      str += this._toCommandStr(command, -bounds.left, -bounds.top);\r\n    }\r\n    this.rootElem.elem.path = str;\r\n    this._updatePosition({x: bounds.left, y: bounds.top});\r\n    this._updateSize(bounds.right-bounds.left, bounds.bottom-bounds.top);\r\n  },\r\n  \r\n  _toCommandStr: function(command, dx, dy) {\r\n    if(command[0] == 'M' || command[0] == 'L') {\r\n      return command[0] + ' '+ (command[1]+dx) + ' ' + (command[2]+dy);  \r\n    }\r\n    if(command[0] == 'AT') {\r\n      var cx = command[1] + dx;\r\n      var cy = command[2] + dy;\r\n      var r = command[3];\r\n      var left = cx-r;\r\n      var top = cy-r;\r\n      var right = cx+r;\r\n      var bottom = cy+r;\r\n      var startX = cx;\r\n      var startY = cy-r;\r\n      return 'AT '+left+' '+top+' '+right+' '+bottom+' '+ startX+' '+startY+' '+startX+' '+startY + ' X E';\r\n    }\r\n    return command.join(' ');\r\n  },\r\n  \r\n  \r\n  _union: function(x, y) {\r\n    var bounds = this._bounds;\r\n    bounds.left = Math.min(bounds.left, x);\r\n    bounds.top = Math.min(bounds.top, y);\r\n    bounds.right = Math.max(bounds.right, x);\r\n    bounds.bottom = Math.max(bounds.bottom, y);\r\n  }\r\n\r\n});/**\r\n * vector({@link olleh.maps.vector.Polyline})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml &&\r\n$class('olleh.maps.vector.vml.PolylineRenderer').extend(\r\n    olleh.maps.vector.PolylineRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @String\r\n   */\r\n  tag: 'polyline',\r\n  \r\n  /**\r\n   * point  bounds   bounds      .\r\n   * @param {Array.<olleh.maps.Point>} points\r\n   * @returns {Object} {points: Array.<olleh.maps.Point>, leftTop: new olleh.maps.Point(x1, y1), rightBottom: new olleh.maps.Point(x2, y2)}\r\n   * @private\r\n   */\r\n  _getPoints: function (points) {\r\n    if (!points || !points.length) return null;\r\n    \r\n    var x1 = x2 = points[0].x;\r\n    var y1 = y2 = points[0].y;\r\n    var len = points.length;\r\n    var x, y, point, i, preX, preY, curX, curY;\r\n    var value = [];\r\n    \r\n    for(i = 0; i < len; i++) {\r\n      point = points[i];\r\n      x = point.x;\r\n      y = point.y;\r\n      x1=Math.min(x1,x);\r\n      y1=Math.min(y1,y);\r\n      x2=Math.max(x2,x);\r\n      y2=Math.max(y2,y);\r\n    }\r\n    for(i = 0; i < len; i++) {\r\n      point = points[i];\r\n      curX = point.x;\r\n      curY = point.y;\r\n      \r\n      if (curX != preX || curY != preY) {\r\n        value.push((curX - x1)+ ',' + (curY - y1));\r\n      }\r\n      preX = curX;\r\n      preY = curY;\r\n    }\r\n    return {points: value, leftTop: new olleh.maps.Point(x1, y1), rightBottom: new olleh.maps.Point(x2, y2)};\r\n  },\r\n  \r\n    \r\n  /**\r\n   *     polyline .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   * @see olleh.maps.vector.PolylineRenderer#draw\r\n   */\r\n  draw: function (points) {\r\n    if (!points || !points.length) return;\r\n    \r\n    this.prepareToDraw();\r\n    var data = this._getPoints(points);\r\n    \r\n    if (!data) return;\r\n    \r\n    var polyline = this.getRootElement().elem;\r\n    var size = data.rightBottom.subtract(data.leftTop);\r\n    var value = data.points.join(' ');\r\n    \r\n    if (!polyline.points) {\r\n      polyline.points = value;\r\n    } else {\r\n      polyline.points.value = value;\r\n    }\r\n    \r\n    this._updatePosition(data.leftTop);\r\n    this._updateSize(size.x, size.y);\r\n  }\r\n  \r\n});/**\r\n * vector({@link olleh.maps.vector.Polygon})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml && \r\n$class('olleh.maps.vector.vml.PolygonRenderer').extend(olleh.maps.vector.PolygonRenderer).\r\n  mixin(olleh.maps.vector.vml.PathRenderer).define({\r\n\r\n  /**\r\n   * @param {array.<array.<olleh.maps.Point>>} pointsArray\r\n   */  \r\n  draw: function(pointsArray) {\r\n    if(!olleh.maps.isArray(pointsArray))\r\n      throw TypeError('Type of pointsArray must be array.');\r\n    this.prepareToDraw();\r\n    if(pointsArray[0] instanceof olleh.maps.Point)\r\n      pointsArray = [pointsArray];\r\n    for(var i=0; i<pointsArray.length;i++ ) {\r\n      var points = pointsArray[i];\r\n      this.path(points);\r\n      this.closePath();\r\n    }\r\n    this.commit();\r\n  }\r\n\r\n});/**\r\n * vector({@link olleh.maps.vector.Circle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml && \r\n$class('olleh.maps.vector.vml.CircleRenderer').extend(\r\n    olleh.maps.vector.CircleRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'oval',\r\n  \r\n  /**\r\n   *     . \r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   * @see olleh.maps.vector.CircleRenderer#draw\r\n   */\r\n  draw: function (center, radius) {\r\n    if (!(center instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(radius))) return;\r\n    \r\n    this.prepareToDraw();\r\n    var size = radius * 2;\r\n    \r\n    this._updatePosition(center.subtract(new olleh.maps.Point(radius, radius)));\r\n    this._updateSize(size, size);\r\n  }\r\n});/**\r\n * vector({@link olleh.maps.vector.Rectangle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml && \r\n$class('olleh.maps.vector.vml.RectangleRenderer').extend(\r\n    olleh.maps.vector.RectangleRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'rect',\r\n  \r\n  /**\r\n   *      .\r\n   * @param {olleh.maps.Point} leftTop  \r\n   * @param {Number} width \r\n   * @param {Number} height \r\n   * @see olleh.maps.vector.RectangleRenderer#draw\r\n   */\r\n  draw: function (leftTop, width, height) {\r\n    if (!(leftTop instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(width))) return;\r\n    if (!(olleh.maps.isNumber(height))) return;\r\n    \r\n    this.prepareToDraw();\r\n    this._updatePosition(leftTop);\r\n    this._updateSize(width, height);\r\n  }\r\n});/**\r\n * Canvas   vector   Renderer   base class\r\n * @private\r\n */\r\nolleh.maps.browser.hasCanvas &&\r\n$class('olleh.maps.vector.canvas.Renderer').extend(\r\n    olleh.maps.vector.BaseRenderer).define({\r\n  /**\r\n   *   canvas     \r\n   * @type Number\r\n   */\r\n  weightFactor: Math.sqrt(2),\r\n  \r\n  /**\r\n   * hit test  DOM Element . \r\n   * @returns {HTMLElement}\r\n   * @see olleh.maps.vector.BaseRenderer#getEventDom\r\n   */\r\n  getEventDom: function () {\r\n    return this.getRootElement().elem;\r\n  },\r\n  \r\n  /**\r\n   * Vector     .\r\n   * @see olleh.maps.vector.BaseRenderer#prepareToDraw\r\n   */\r\n  prepareToDraw: function () {\r\n    this.getRootElement();\r\n  },\r\n  \r\n  /**\r\n   * Vector   .\r\n   * @returns {Boolean}\r\n   * @see olleh.maps.vector.BaseRenderer#isDrawn\r\n   */\r\n  isDrawn: function () {\r\n    return !!this.canvas;\r\n  },\r\n  \r\n  /**\r\n   *  DOM   {@link olleh.maps.Element} .\r\n   * @returns {olleh.maps.Element}\r\n   * @see olleh.maps.vector.BaseRenderer#getRootElement\r\n   */\r\n  getRootElement: function () {\r\n    if (!this.canvas) {\r\n      var canvasElem = document.createElement('canvas');\r\n      var setStyle = function(key, value) {\r\n        switch (key) {\r\n        case 'left':\r\n        case 'top':\r\n          value = parseFloat(value) - (this._padding || 0) + 'px';\r\n          break;\r\n        }\r\n        olleh.maps.Element.prototype.setStyle.call(this, key, value);\r\n      };\r\n      this.canvas = olleh.maps.mixin(new olleh.maps.Element(canvasElem), {setStyle: setStyle}, true);\r\n      this.canvas.setStyle('position', 'absolute');\r\n      var ctx = canvasElem.getContext('2d');\r\n      ctx.lineCap = 'round';\r\n      ctx.lineJoin = 'round';\r\n      this.ctx = ctx;\r\n    }\r\n    return this.canvas;\r\n  },\r\n  \r\n  \r\n  /**\r\n   * Option  .\r\n   * @param {Object} opts\r\n   * @see olleh.maps.vector.BaseRenderer#setOptions\r\n   */\r\n  setOptions: function (opts) {\r\n    this.opts = olleh.maps.mixin(this.opts, opts, true);\r\n  },\r\n  \r\n  /**\r\n   *   option   Canvas Context    .\r\n   * @private\r\n   */\r\n  _updateStyle: function () {\r\n    var opts = this.opts;\r\n    var ctx = this.ctx;\r\n    ctx.save();\r\n    \r\n    if (opts.fillColor) {\r\n      ctx.fillStyle = opts.fillColor;\r\n      if (opts.fillOpacity < 1) {\r\n        ctx.globalAlpha = opts.fillOpacity;\r\n      }\r\n      ctx.fill();\r\n    }\r\n    \r\n    if (opts.strokeColor && opts.strokeWeight) {\r\n      ctx.strokeStyle = opts.strokeColor;\r\n      ctx.lineWidth = opts.strokeWeight;\r\n      ctx.lineCap = opts.strokeLinecap || 'round';\r\n      ctx.lineJoin = opts.strokeLinejoin || 'round';\r\n      if (opts.strokeOpacity < 1) {\r\n        ctx.globalAlpha = opts.strokeOpacity;\r\n      }\r\n      ctx.stroke();\r\n    }\r\n    \r\n    ctx.restore();\r\n  },\r\n  \r\n  /**\r\n   * Canvas    .\r\n   * @param {olleh.maps.Point} leftTop canvas \r\n   * @param {Number} width canvas width\r\n   * @param {Number} height canvas height\r\n   */\r\n  _updateCanvas: function(leftTop, width, height) {\r\n    if (this.canvas) {\r\n      var canvasElem = this.canvas.elem;\r\n      // update size\r\n      var weight = this.opts.strokeWeight;\r\n      var padding = weight ? this.weightFactor * weight : 0;\r\n      this.canvas._padding = padding;\r\n      var padding2 = 2 * padding;\r\n      var rootWidth = width + padding2;\r\n      var rootHeight = height + padding2;\r\n      if (olleh.maps.isNumber(width)) {\r\n        canvasElem.setAttribute('width', rootWidth + 'px');\r\n      }\r\n      if (olleh.maps.isNumber(height)) {\r\n        canvasElem.setAttribute('height', rootHeight + 'px');\r\n      }\r\n      // update position\r\n      this.canvas.setStyle('left', leftTop.x + 'px');\r\n      this.canvas.setStyle('top', leftTop.y + 'px');\r\n    }\r\n  }\r\n});/**\r\n * Polyline({@link olleh.maps.vector.Polyline})  .\r\n * @private\r\n */\r\nolleh.maps.vector.canvas && \r\n$class('olleh.maps.vector.canvas.PolylineRenderer').extend(\r\nolleh.maps.vector.PolylineRenderer).mixin(olleh.maps.vector.canvas.Renderer).define({\r\n  /**\r\n   * path     polygon    .\r\n   * @type Boolean\r\n   */\r\n  closePath: false,\r\n  /**\r\n   *     polyline  Polygon  .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   * @see olleh.maps.vector.PolylineRenderer#draw\r\n   */\r\n  draw: function (points) {\r\n    if (!points || !points.length)\r\n      return;\r\n\r\n    this.prepareToDraw();\r\n    var ctx = this.ctx;\r\n    var x1 = x2 = points[0].x;\r\n    var y1 = y2 = points[0].y;\r\n    for ( var i = 0, len = points.length; i < len; i++) {\r\n      var p = points[i];\r\n      x1 = Math.min(p.x, x1);\r\n      y1 = Math.min(p.y, y1);\r\n      x2 = Math.max(p.x, x2);\r\n      y2 = Math.max(p.y, y2);\r\n    }\r\n    this._updateCanvas(new olleh.maps.Point(x1, y1), x2 - x1, y2 - y1);\r\n    \r\n    ctx.translate(this.canvas._padding, this.canvas._padding);\r\n    ctx.beginPath();\r\n    ctx.moveTo(points[0].x - x1, points[0].y - y1);\r\n    for ( var i = 1, len = points.length; i < len; i++) {\r\n      var p = points[i];\r\n      ctx.lineTo(p.x - x1, p.y - y1);\r\n    }\r\n    if (this.closePath) {\r\n      ctx.closePath();\r\n    }\r\n    this._updateStyle();\r\n  }\r\n});/**\r\n * Polygon({@link olleh.maps.vector.Polygon})  .\r\n * @private\r\n */\r\nolleh.maps.vector.canvas &&\r\n$class('olleh.maps.vector.canvas.PolygonRenderer').extend(\r\n    olleh.maps.vector.canvas.PolylineRenderer).define({\r\n  /**\r\n   * @type Boolean\r\n   */\r\n  closePath: true\r\n});/**\r\n * Circle({@link olleh.maps.vector.Circle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.canvas &&\r\n$class('olleh.maps.vector.canvas.CircleRenderer').extend(\r\n    olleh.maps.vector.CircleRenderer).mixin(olleh.maps.vector.canvas.Renderer).define({\r\n  /**\r\n   * @type Number\r\n   */\r\n  weightFactor: .5,\r\n  \r\n  /**\r\n   *     . \r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   * @see olleh.maps.vector.CircleRenderer#draw\r\n   */\r\n  draw: function (center, radius) {\r\n    this.prepareToDraw();\r\n    var size = radius * 2;\r\n    var leftTop = center.subtract(new olleh.maps.Point(radius,\r\n        radius));\r\n    this._updateCanvas(leftTop, size, size);\r\n    \r\n    var ctx = this.ctx;\r\n    ctx.translate(this.canvas._padding, this.canvas._padding);\r\n    ctx.beginPath();\r\n    ctx.arc(radius, radius, radius, 0, Math.PI * 2, false);\r\n    \r\n    this._updateStyle();\r\n  }\r\n});/**\r\n * Rectangle({@link olleh.maps.vector.Rectangle })  .\r\n * @private \r\n */\r\nolleh.maps.vector.canvas && \r\n$class('olleh.maps.vector.canvas.RectangleRenderer').extend(\r\n    olleh.maps.vector.RectangleRenderer).mixin(olleh.maps.vector.canvas.Renderer).define({\r\n\r\n  /**\r\n   * @type Number\r\n   */\r\n  weightFactor: .5,\r\n /**\r\n  *      .\r\n  * @param {olleh.maps.Point} leftTop  \r\n  * @param {Number} width \r\n  * @param {Number} height \r\n  * @see olleh.maps.vector.RectangleRenderer#draw\r\n  */\r\n  draw: function (leftTop, width, height) {\r\n    this.prepareToDraw();\r\n    this._updateCanvas(leftTop, width, height);\r\n    \r\n    var ctx = this.ctx;\r\n    ctx.translate(this.canvas._padding, this.canvas._padding);\r\n    ctx.beginPath();\r\n    ctx.rect(0, 0, width, height);\r\n    \r\n    this._updateStyle();\r\n  }\r\n});!function (ns) {\r\n  /**\r\n   * vector {@link olleh.maps.vector.Vector}     API .\r\n   * <p/>\r\n   *    SVG, Canvas, VML Renderer .\r\n   * @private\r\n   */\r\n  ns && $class('olleh.maps.vector.RendererFactory').define({\r\n    \r\n    /**\r\n     * PolylineRenderer  .\r\n     * @param {olleh.maps.vector.PolylineRendererOptions} opts\r\n     * @returns {olleh.maps.vector.PolylineRenderer}\r\n     */\r\n    createPolylineRenderer: function (opts) {\r\n      var clazz = ns.PolylineRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * PolygonRenderer  .\r\n     * @param {olleh.maps.vector.PolygonRendererOptions} opts\r\n     * @returns {olleh.maps.vector.PolygonRenderer}\r\n     */\r\n    createPolygonRenderer: function (opts) {\r\n      var clazz = ns.PolygonRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * RectangleRenderer  .\r\n     * @param {olleh.maps.vector.RectangleRendererOptions} opts\r\n     * @returns {olleh.maps.vector.RectangleRenderer}\r\n     */\r\n    createRectangleRenderer: function (opts) {\r\n      var clazz = ns.RectangleRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * CircleRenderer  .\r\n     * @param {olleh.maps.vector.CircleRendererOptions} opts\r\n     * @returns {olleh.maps.vector.CircleRenderer}\r\n     */\r\n    createCircleRenderer: function (opts) {\r\n      var clazz = ns.CircleRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * ContainerRenderer  .\r\n     * @param {Object} opts\r\n     * @returns {olleh.maps.vector.ContainerRenderer}\r\n     */\r\n    createContainerRenderer: function (opts) {\r\n      if (!this._containerRenderer) {\r\n        var clazz = ns.ContainerRenderer;\r\n        this._containerRenderer = clazz ? new clazz(opts) : null;\r\n      }\r\n      return this._containerRenderer;\r\n    },\r\n    \r\n    /**\r\n     * SVG path  vml shape       PathRenderer  .\r\n     */\r\n    createPathRenderer: function(opts) {\r\n      var clazz = ns.PathRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    }\r\n    \r\n  });\r\n} (olleh.maps.vector[olleh.maps.browser.vector.toLowerCase()]);/**\n * Vector   Layer \n */\n$class('olleh.maps.vector.VectorLayer').extend(olleh.maps.layer.Layer).define({\n\n  name: 'Vector',\n\n  label: olleh.maps.msg(''),\n\n  autoActivate: true,\n  \n  zIndex: 999,\n\n  /**\n   * VectorLayer  .\n   */\n  VectorLayer: function () {\n    this._vectors = [];\n    this._rendererFactory = new olleh.maps.vector.RendererFactory();\n    this._containerRenderer = this._rendererFactory.createContainerRenderer({\n      layer: this\n    });\n    this._zoomAnim = false; // zoom animation  . transform   zoom animation .\n  },\n\n  start: function () {\n    var style = olleh.maps.browser.style;\n    if (style.transform) {\n      this._zoomAnim = true;\n    }\n    olleh.maps.vector.VectorLayer.$super.start.call(this);\n  },\n\n  /**\n   * VectorLayer    .\n   * @param {Boolean} visible false  VectorLayer   . \n   */\n  setVisible: function (visible) {\n    if (this._isVisible != visible) {\n      this._isVisible = visible;\n      visible && this.draw();\n      var pane = this.getPane();\n      var visibility = visible ? 'visible' : 'hidden';\n      pane.style.visibility = visibility;\n    }\n  },\n\n  /**\n   *  VectorLayer     .\n   * @returns {Boolean}\n   */\n  isVisible: function () {\n    return this._isVisible;\n  },\n\n  /**\n   * VectorLayer   Vector  .\n   */\n  draw: function () {\n    if (this._zoomAnim) {\n      this._ensureStopAnimation();\n    }\n    this._containerRenderer && this._containerRenderer.setBounds();\n    this.drawAll();\n  },\n\n  /**\n   *  Vector  draw()  .\n   * @private\n   */\n  drawAll: function () {\n    var i, len = this._vectors.length;\n    for (i = 0; i < len; i++) {\n      this._vectors[i].isVisible() && this._vectors[i].draw();\n    }\n  },\n\n  /**\n   * Zoom    .\n   * @param {Number} scale\n   * @param {olleh.maps.Point} origin\n   * @param {Number} duration\n   * @param {olleh.maps.fx.Pulse} [pulse]\n   * @private\n   */\n  zoomStart: function (scale, origin, duration, pulse) {\n    if (this._vectors.length === 0)\n      return;\n    var pane = this.getPane();\n    if (this._zoomAnim) {\n      var from;\n      \n      if (this._isZooming) {\n        from = this._animator.ignore();\n      } else {\n        olleh.maps.util.dom.setStyle(pane, 'transformOrigin', origin.x + 'px '\n            + origin.y + 'px');\n        from = {\n          transform: olleh.maps.util.dom.getScaleString(1)\n        };\n      }\n      \n      this._animator = new olleh.maps.fx.Animation({\n        from: from,\n        to: {\n          transform: olleh.maps.util.dom.getScaleString(scale)\n        },\n        defaultType: '=',\n        duration: duration,\n        pulse: pulse,\n        timing: olleh.maps.fx.timing.easeOut\n      }).animate(pane);\n    } else {\n      pane.style.visibility = 'hidden';\n    }\n    this._isZooming = true;\n  },\n  \n  \n\n  /**\n   * Zoom    .\n   * @private\n   */\n  zoomEnd: function () {\n    if (this._isZooming) {\n      if (this._zoomAnim) {\n        this._ensureStopAnimation();\n      } else {\n        var pane = this.getPane();\n        pane.style.visibility = 'visible';\n      }\n      this._isZooming = false;\n    }\n    // workaround for chrome bug: zoom in / out  ?   \n    if (olleh.maps.browser.browserName === olleh.maps.browser.BROWSER_NAME.chrome) {\n      this._eraseAll();\n    }\n    this.drawAll();\n  },\n  \n  _eraseAll: function() {\n    var i, len = this._vectors.length;\n    for (i = 0; i < len; i++) {\n      this._vectors[i].isVisible() && this._vectors[i].erase();\n    }\n  },\n  \n  _ensureStopAnimation: function() {\n    var pane = this.getPane();\n    var animator = this._animator;\n    if (animator && this._animator.status === 'started') {\n      this._animator.cancel();\n    }\n    pane && olleh.maps.util.dom.setStyle(pane, 'transform','');\n  },\n\n  /**\n   * Pan    .\n   * @private\n   */\n  moveEnd: function () {\n    this._containerRenderer && this._containerRenderer.setBounds();\n  },\n\n  /**\n   * VectorLayer    Vector  .\n   * @returns {Array} consists of olleh.maps.vector.Vector\n   */\n  getVectors: function () {\n    return this._vectors;\n  },\n\n  /**\n   * VectorLayer   Pane  . Pane    .\n   * @returns {HTMLElement}\n   */\n  getPane: function () {\n    if (!this._pane) {\n      var pane = document.createElement('div');\r\n      pane.style.position = 'absolute';\r\n      this._pane = pane;\r\n    }\r\n    return this._pane;\r\n  },\r\n  \r\n  /**\r\n   * Vector   container element  . Vector  pane   container  element   .\n   * SVG   ContainerRenderer    svg element   VML,Canvas   div pane  .  \r\n   * @returns {HTMLElement}\r\n   */\r\n  getContainer: function() {\r\n    if (!this._container) {\r\n      var pane = this.getPane();\r\n      if (this._containerRenderer) {\n        this._container = this._containerRenderer.createContainer();\n        pane.appendChild(this._container);\r\n      } else {\n        this._container = pane;\r\n      }\n    }\n    return this._container;\r\n  },\n\n  /**\n   * RendererFactory  .\n   * @returns {olleh.maps.vector.RendererFactory}\n   * @private\n   */\n  getRendererFactory: function () {\n    return this._rendererFactory;\n  },\n\n  /**\n   * Vector  .\n   * @param {olleh.maps.vector.Vector} vector\n   */\n  add: function (vector) {\n    this._vectors.push(vector);\n    vector.layer = this;\n    if (this.isStarted())\n      vector.onAdd(this);\n  },\n\n  /**\n   * Vector  .\n   * @param {olleh.maps.vector.Vector} vector\n   */\n  remove: function (vector) {\n    olleh.maps.util.removeFromArray(this._vectors, vector);\n    if (this.isStarted()) {\n      vector.onRemove();\n    }\n    vector.layer = null;\n  }\n});/**\r\n * EditHandler interface\r\n * @private\r\n */\r\n$class('olleh.maps.vector.EditHandler').define({\r\n  \r\n  EditHandler: function(target) {\r\n    this.target = target;\r\n  },\r\n  \r\n  activate: function() {\r\n    \r\n  },\r\n  \r\n  deactivate: function() {\r\n    \r\n  },\r\n  \r\n  getTarget: function() {\r\n    return this.target;\r\n  },\r\n  \r\n  refresh: function() {\r\n    \r\n  }\r\n\r\n});/**\n * @private\n */\n$class('olleh.maps.plugin.VectorPlugin').extend(olleh.maps.Adaptable).define({\n  \n  attach: function () {\n    this.vector = new olleh.maps.vector.VectorLayer({\n      map: this.map\n    });\n  },\n  \n  detach: function () {\n    // ????\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.VectorPlugin);/* Copyright (c) 2012 the authors listed at the following URL, and/or\nthe authors of referenced articles or incorporated external code:\nhttp://en.literateprograms.org/Quickhull_(Javascript)?action=history&offset=20120410175256\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nRetrieved from: http://en.literateprograms.org/Quickhull_(Javascript)?oldid=18434\n*/\nvar Quickhull = {\n  getDistant: function (cpt, bl) {\n    return (bl[0].y - bl[1].y) * (cpt.x - bl[0].x) + (bl[1].x - bl[0].x) * (cpt.y - bl[0].y);\n  },\n  findMostDistantPointFromBaseLine: function (baseLine, points) {\n    var i, l, maxD = 0, maxPt = null, newPoints = [];\n    for (i = 0, l = points.length; i < l; i++) {\n      var pt = points[i];\n      var d = this.getDistant(pt, baseLine);\n      if (d > 0) {\n        newPoints.push(pt);\n        if (d > maxD) {\n          maxD = d;\n          maxPt = pt;\n        }\n      }\n    }\n    return {\n      'maxPoint': maxPt,\n      'newPoints': newPoints\n    };\n  },\n  buildConvexHull: function (baseLine, points) {\n    var convexHullBaseLines = [], t = this.findMostDistantPointFromBaseLine(baseLine, points);\n    if (t.maxPoint) { // if there is still a point \"outside\" the base line\n      convexHullBaseLines = convexHullBaseLines.concat(this.buildConvexHull([ baseLine[0], t.maxPoint ], t.newPoints));\n      convexHullBaseLines = convexHullBaseLines.concat(this.buildConvexHull([ t.maxPoint, baseLine[1] ], t.newPoints));\n      return convexHullBaseLines;\n    }\n    // if there is no more point \"outside\" the base line, the current base line is part of the convex hull\n    return [ baseLine ];\n  },\n  getConvexHull: function (points) {\n    var i, l, maxPt, minPt, maxX = Number.MIN_VALUE, minX = Number.MAX_VALUE;\n    for (i = 0, l = points.length; i < l; i++) {\n      var pt = points[i];\n      if (pt.x > maxX) {\n        maxPt = pt;\n        maxX = pt.x;\n      }\n      if (pt.x < minX) {\n        minPt = pt;\n        minX = pt.x;\n      }\n    }\n    return [].concat(this.buildConvexHull([ minPt, maxPt ], points), this.buildConvexHull([ maxPt, minPt ], points));\n  }\n};/**\r\n * MarkerClusterOptions Object Specification\r\n * @typedef olleh.maps.overlay.MarkerClusterOptions\r\n * @property {boolean} [resetPosition=false]           .\r\n * @property {boolean} [clickToZoom=false]      <code>maxZoom + 1</code>  .\r\n * @property {boolean} [clickToExpand=true]        . <code>clickToZoom</code>    .\r\n * @property {boolean} [displaySize=true]       .\r\n * @property {number} [fontSize]    .  .\r\n * @property {boolean} [displayArea=true]        .\r\n * @property {olleh.maps.vector.PolygonOptions} [areaStyle]    .\r\n * @property {function} [iconFn]     .        {@link olleh.maps.overlay.MarkerOptions} .\r\n * @extends olleh.maps.overlay.PointedOverlayOptions\r\n */\r\n\r\n/**\r\n *        .\r\n */\r\n$class('olleh.maps.overlay.MarkerCluster').extend(olleh.maps.overlay.PointedOverlay).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @private\r\n     * @constants\r\n     * @type number\r\n     */\r\n    DEFAULT_FONT_SIZE: 10,\r\n\r\n    /**\r\n     * @private\r\n     * @constants\r\n     * @type String\r\n     */\r\n    DEFAULT_FONT_COLOR: '#000',\r\n\r\n    /**\r\n     * @private\r\n     * @constants\r\n     * @type olleh.maps.vector.PolygonOptions\r\n     */\r\n    DEFAULT_AREA_STYLE: {\r\n      strokeColor: '#69F',\r\n      strokeWeight: 5,\r\n      strokeOpacity: .8,\r\n      fillColor: '#69F',\r\n      fillOpacity: .4\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {number} size\r\n     * @returns {olleh.maps.overlay.MarkerIconOptions}\r\n     */\r\n    DEFAULT_ICON_FN: function (size) {\r\n      return {\r\n        url: olleh.maps.env.RESOURCE_URL + 'img/clusters.png',\r\n        size: new olleh.maps.Size(50, 50),\r\n        anchor: new olleh.maps.Point(25, 25),\r\n        origin: new olleh.maps.Point((4 - Math.min(Math.floor(size / 20), 4)) * 51, 0)\r\n      };\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @constants\r\n   * @type number\r\n   */\r\n  MARKER_ANIMATE_DURATION: .2,\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.MarkerClusterOptions} opts .\r\n   */\r\n  MarkerCluster: function (opts) {\r\n    var MarkerCluster = olleh.maps.overlay.MarkerCluster;\r\n    this._clickToExpand = true;\r\n    this._clickToZoom = false;\r\n    this._displaySize = true;\r\n    this._fontSize = MarkerCluster.DEFAULT_FONT_SIZE;\r\n    this._fontColor = MarkerCluster.DEFAULT_FONT_COLOR;\r\n    this._displayArea = true;\r\n    this._areaStyle = MarkerCluster.DEFAULT_AREA_STYLE;\r\n    this._iconFn = MarkerCluster.DEFAULT_ICON_FN;\r\n\r\n    this._areaPath = null;\r\n    this._originMap = null;\r\n    this._area = null;\r\n\r\n    this._children = [];\r\n    this._size = -1; // -1 indicates invalidate; should be recalculated before draw\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @returns {boolean}     <code>true</code>,    <code>false</code>\r\n   */\r\n  isExpanded: function () {\r\n    var i, l, children = this._children;\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      if (children[i].isAdded()) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.MarkerClusterOptions} opts\r\n   */\r\n  setOptions: function (opts) {\r\n    opts.resetPosition !== undefined && this.setResetPosition(opts.resetPosition);\r\n    opts.clickToZoom !== undefined && this.setClickToZoom(opts.clickToZoom);\r\n    opts.clickToExpand !== undefined && this.setClickToExpand(opts.clickToExpand);\r\n    opts.displaySize !== undefined && this.setDisplaySize(opts.displaySize);\r\n    opts.fontSize && this.setFontSize(opts.fontSize);\r\n    opts.fontColor && this.setFontColor(opts.fontColor);\r\n    opts.displayArea !== undefined && this.setDisplayArea(opts.displayArea);\r\n    opts.areaStyle && this.setAreaStyle(opts.areaStyle);\r\n    opts.iconFn && this.setIconFn(opts.iconFn);\r\n    olleh.maps.overlay.MarkerCluster.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  update: function () {\r\n    this._updateIcon();\r\n    this._updateSize();\r\n    olleh.maps.overlay.MarkerCluster.$super.update.apply(this, arguments);\r\n  },\r\n\r\n  /**\r\n   * @param zoom\r\n   * @returns {boolean}\r\n   */\r\n  isVisibleAtZoom: function (zoom) {\r\n    return this.minZoom <= zoom && zoom <= this.maxZoom;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#resetPosition}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isResetPosition: function () {\r\n    return this._resetPosition;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#resetPosition}  .\r\n   * @param {boolean} resetPosition  .\r\n   */\r\n  setResetPosition: function (resetPosition) {\r\n    this._resetPosition = resetPosition;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToZoom}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isClickToZoom: function () {\r\n    return this._clickToZoom;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToZoom}  .\r\n   * @param {boolean} clickToZoom  .\r\n   */\r\n  setClickToZoom: function (clickToZoom) {\r\n    this._clickToZoom = clickToZoom;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToExpand}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isClickToExpand: function () {\r\n    return this._clickToExpand;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToExpand}  .\r\n   * @param {boolean} clickToExpand  .\r\n   */\r\n  setClickToExpand: function (clickToExpand) {\r\n    this._clickToExpand = clickToExpand;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displaySize}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isDisplaySize: function () {\r\n    return this._displaySize;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displaySize}  .\r\n   * @param {boolean} displaySize  .\r\n   */\r\n  setDisplaySize: function (displaySize) {\r\n    this._displaySize = displaySize;\r\n    this.isDrawn() && this._updateSize();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _updateSize: function () {\r\n    this._sizeDiv.setProperty('innerHTML', this._displaySize ? this.getSize() : '');\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontSize}   .\r\n   * @returns {number}  .\r\n   */\r\n  getFontSize: function () {\r\n    return this._fontSize;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontSize}  .\r\n   * @param {boolean} fontSize  .\r\n   */\r\n  setFontSize: function (fontSize) {\r\n    this._fontSize = fontSize;\r\n    this.isDrawn() && this._updateIcon();\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontColor}   .\r\n   * @returns {string}  .\r\n   */\r\n  getFontColor: function () {\r\n    return this._fontColor;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontColor}  .\r\n   * @param {string} fontColor  .\r\n   */\r\n  setFontColor: function (fontColor) {\r\n    this._fontColor = fontColor;\r\n    this.isDrawn() && this._updateIcon();\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displayArea}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isDisplayArea: function () {\r\n    return this._displayArea;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displayArea}  .\r\n   * @param {boolean} displayArea  .\r\n   */\r\n  setDisplayArea: function (displayArea) {\r\n    this._displayArea = displayArea;\r\n    if (this.isDrawn() && !displayArea) {\r\n      this.hideArea();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#areaStyle}   .\r\n   * @returns {olleh.maps.vector.PolygonOptions}  .\r\n   */\r\n  getAreaStyle: function () {\r\n    return this._areaStyle;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#areaStyle}  .\r\n   * @param {olleh.maps.vector.PolygonOptions} areaStyle  .\r\n   */\r\n  setAreaStyle: function (areaStyle) {\r\n    this._areaStyle = areaStyle;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#iconFn}   .\r\n   * @returns {function}  .\r\n   */\r\n  getIconFn: function () {\r\n    return this._iconFn;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#iconFn}  .\r\n   * @param {function} iconFn  .\r\n   */\r\n  setIconFn: function (iconFn) {\r\n    this._iconFn = iconFn;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _updateIcon: function () {\r\n    var icon = this._iconFn(this.getSize());\r\n    var fontSize = this._fontSize;\r\n    var fontColor = this._fontColor;\r\n    var img = this._img;\r\n\r\n    if (!this._img) {\r\n      img = this._img = new olleh.maps.SpritedImage();\r\n\r\n      this._sizeDiv = olleh.maps.Element.create('div').setStyles({\r\n        position: 'absolute',\r\n        width: '100%',\r\n        textAlign: 'center',\r\n        fontWeight: 'bold',\r\n        zIndex: 1\r\n      });\r\n      this._sizeDiv.setStyle('userSelect', 'none');\r\n      img.appendChild(this._sizeDiv);\r\n      this.registerElement('upper_overlay_pane', img.elem);\r\n      this.registerEventDom(img.elem);\r\n    }\r\n\r\n    img.setStyles({\r\n      width: icon.size.width + 'px',\r\n      height: icon.size.height + 'px',\r\n      marginLeft: -icon.anchor.x + 'px',\r\n      marginTop: -icon.anchor.y + 'px'\r\n    }).setImage(icon.url, icon.origin, icon.scaledSize);\r\n\r\n    this._sizeDiv.setStyles({\r\n      paddingTop: (icon.size.height / 2 - fontSize / 2) + 'px',\r\n      fontSize: fontSize + 'px',\r\n      color: fontColor\r\n    });\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @returns {number}    .\r\n   */\r\n  getSize: function () {\r\n    var i, l, child, children, size = this._size;\r\n    if (size == -1) {\r\n      size = 0;\r\n      children = this._children;\r\n      for (i = 0, l = children.length; i < l; i++) {\r\n        child = children[i];\r\n        size += child.getSize ? child.getSize() : 1;\r\n      }\r\n      this._size = size;\r\n    }\r\n    return size;\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @private\r\n   */\r\n  _invalidate: function (depth) {\r\n    var parent = this.parent;\r\n    var areaAdded = this._area && this._area.isAdded();\r\n\r\n    if (areaAdded) {\r\n      this.hideArea();\r\n    }\r\n\r\n    this._size = -1;\r\n    this._bounds = null;\r\n    this._area = null;\r\n\r\n    if (parent && parent._size != -1) {\r\n      parent._invalidate();\r\n    }\r\n\r\n    if (this.isDrawn()) {\r\n      this._updateIcon();\r\n      this._updateSize();\r\n      if (areaAdded) {\r\n        this.showArea();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *        .\r\n   * @returns {olleh.maps.Bounds} \r\n   */\r\n  getBounds: function () {\r\n    var markers, i, coord, bounds = this._bounds;\r\n    var minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n\r\n    if (!bounds) {\r\n      if (!this._children.length) {\r\n        return null;\r\n      }\r\n\r\n      markers = this.getAllMarkers();\r\n      for (i = 0; i < markers.length; i++) {\r\n        coord = markers[i].getPosition().asDefault();\r\n        if (minX > coord.x) {\r\n          minX = coord.x;\r\n        }\r\n        if (minY > coord.y) {\r\n          minY = coord.y;\r\n        }\r\n        if (maxX < coord.x) {\r\n          maxX = coord.x;\r\n        }\r\n        if (maxY < coord.y) {\r\n          maxY = coord.y;\r\n        }\r\n      }\r\n\r\n      bounds = this._bounds = new olleh.maps.Bounds(new olleh.maps.UTMK(minX, minY), new olleh.maps.UTMK(maxX, maxY));\r\n    }\r\n\r\n    return bounds;\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @returns {Array.<olleh.maps.overlay.PointedOverlay>}     \r\n   */\r\n  getChildren: function () {\r\n    return this._children;\r\n  },\r\n\r\n  /**\r\n   * {#getChildren} .\r\n   * @deprecated\r\n   * @returns {Array.<olleh.maps.overlay.PointedOverlay>}     \r\n   */\r\n  getMarkers: function () {\r\n    return this._children;\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * , <code>getAllMarkers().length == getSize()</code> .\r\n   * @returns {Array.<olleh.maps.overlay.Marker>}   \r\n   */\r\n  getAllMarkers: function () {\r\n    var i, l, children = this._children, result = [];\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n      if (child.getAllMarkers) {\r\n        result = result.concat(child.getAllMarkers());\r\n      } else {\r\n        result.push(child);\r\n      }\r\n    }\r\n    return result;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.Coord}  \r\n   */\r\n  getCenter: function () {\r\n    var i, coord, x = 0, y = 0;\r\n    var children = this._children, length = children.length;\r\n    for (i = 0; i < length; i++) {\r\n      coord = children[i].getPosition().asDefault();\r\n      x += coord.x;\r\n      y += coord.y;\r\n    }\r\n    return new olleh.maps.UTMK(x / length, y / length);\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.PointedOverlay} child  \r\n   */\r\n  add: function (child) {\r\n    if (child.parent == this) {\r\n      return;\r\n    }\r\n\r\n    if (child.parent) {\r\n      child.parent.remove(child);\r\n    }\r\n\r\n    child.parent = this;\r\n    this._children.push(child);\r\n\r\n    if (this._resetPosition || this._children.length <= 2) {\r\n      this.setPosition(this.getCenter());\r\n    }\r\n\r\n    this._invalidate();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.PointedOverlay} child  \r\n   */\r\n  remove: function (child) {\r\n    if (child.parent != this) {\r\n      return;\r\n    }\r\n\r\n    child.parent = null;\r\n    child.setMap(null);\r\n    olleh.maps.util.removeFromArray(this._children, child);\r\n\r\n    if (this._resetPosition && this._children.length) {\r\n      this.setPosition(this.getCenter());\r\n    }\r\n\r\n    this._invalidate();\r\n  },\r\n\r\n  expand: function () {\r\n    if (this.maxZoom !== undefined) {\r\n      this.getMap().panTo(this.getPosition(), this.maxZoom + 1);\r\n    } else {\r\n      this.expandToDepth();\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  .          .\r\n   * @param {Number} [depth=1]  .           .\r\n   * @param {olleh.maps.overlay.MarkerCluster} [root]  .      .\r\n   */\r\n  expandToDepth: function (depth, root) {\r\n    var i, l, children, map, rootPx, child;\r\n    var MARKER_ANIMATE_DURATION = this.MARKER_ANIMATE_DURATION;\r\n\r\n    if (this.isMoving()) {\r\n      this.stopAnimators();\r\n    }\r\n\r\n    depth || (depth = 1);\r\n    root || (root = this);\r\n\r\n    map = root.getMap();\r\n    rootPx = root.getOriginalLayerPx();\r\n\r\n    depth--;\r\n\r\n    children = this._children;\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n      if (child.isAdded()) {\r\n        continue;\r\n      }\r\n\r\n      if (child.expandToDepth && depth > 0) {\r\n        child.expandToDepth(depth, root);\r\n      } else {\r\n        if (!child.isAdded()) {\r\n          child.onAdd = this._markerOnAdd.bind(child, rootPx, MARKER_ANIMATE_DURATION);\r\n          child.setMap(map);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.isAdded()) {\r\n      this.hideArea();\r\n      if (this.isDrawn()) {\r\n        this.onRemove = this._clusterOnRemove;\r\n      }\r\n      this.setMap(null);\r\n    }\r\n\r\n    if (this._clickToExpand && !this._clickToZoom && !this.parent) {\r\n      this._originMap = map; //       \r\n      map.onEvent('click', this._onMapClick, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *      <code>maxZoom</code>      .\r\n   * @param {Number} zoom  .\r\n   * @param {olleh.maps.Bounds} [bounds]  .\r\n   * @param {olleh.maps.overlay.MarkerCluster} [root]  .      .\r\n   * @return expand   \r\n   */\r\n  expandToZoom: function (zoom, bounds, root) {\r\n    var i, l, children, map, rootPx, child, result;\r\n    var MARKER_ANIMATE_DURATION = this.MARKER_ANIMATE_DURATION;\r\n\r\n    if (this.isMoving()) {\r\n      this.stopAnimators();\r\n    }\r\n\r\n    root || (root = this);\r\n\r\n    map = root.getMap();\r\n    rootPx = root.getOriginalLayerPx();\r\n\r\n    if (this == root && this.maxZoom >= zoom) {\r\n      return [this];\r\n    }\r\n\r\n    children = this._children;\r\n    result = [];\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n      if (!bounds || bounds.intersects(child.getBounds() || child.getPosition())) {\r\n        if (child.expandToZoom && child.maxZoom < zoom) {\r\n          result = result.concat(child.expandToZoom(zoom, bounds, root));\r\n        } else {\r\n          if (!child.isAdded()) {\r\n            child.onAdd = this._markerOnAdd.bind(child, rootPx, MARKER_ANIMATE_DURATION);\r\n            child.setMap(map);\r\n          }\r\n          result.push(child);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.isAdded()) {\r\n      this.hideArea();\r\n      if (this.isDrawn()) {\r\n        this.onRemove = this._clusterOnRemove;\r\n      }\r\n      this.setMap(null);\r\n    }\r\n\r\n    return result;\r\n  },\r\n\r\n  /**\r\n   *      .         .\r\n   * @param {olleh.maps.Map} map  .\r\n   * @param {olleh.maps.overlay.MarkerCluster} [root]  .      .\r\n   */\r\n  collapse: function (map, root) {\r\n    var i, l, children = this._children, rootPx, child;\r\n    var MARKER_ANIMATE_DURATION = this.MARKER_ANIMATE_DURATION;\r\n\r\n    if (this.isMoving()) {\r\n      this.stopAnimators();\r\n    }\r\n\r\n    root || (root = this);\r\n\r\n    rootPx = map.layerMgr.getLayerPxFromCoord(root.getPosition()); // root setMap  getOriginalLayerPx  \r\n\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n\r\n      if (child.isAdded()) {\r\n        if (child.isDrawn()) {\r\n          child.onRemove = this._markerOnRemove.bind(child, rootPx, MARKER_ANIMATE_DURATION);\r\n        }\r\n        child.setMap(null);\r\n      } else if (child.collapse) {\r\n        child.collapse(map, root);\r\n      }\r\n    }\r\n\r\n    if (this == root) {\r\n      this.onAdd = this._clusterOnAdd;\r\n      this.setMap(map);\r\n    }\r\n\r\n    if (this._originMap) {\r\n      map.unsubscribeEvent('click', this._onMapClick, this);\r\n      this._originMap = null;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *        .\r\n   * @returns {olleh.maps.vector.Polygon} \r\n   */\r\n  getArea: function () {\r\n    var area = this._area;\r\n\r\n    if (!area) {\r\n      var i, l;\r\n      var markerCoords = [], pathCoords = [];\r\n      var markers = this.getAllMarkers();\r\n\r\n      for (i = 0, l = markers.length; i < l; i++) {\r\n        markerCoords.push(markers[i].getPosition().asDefault());\r\n      }\r\n\r\n      var convexHull = Quickhull.getConvexHull(markerCoords);\r\n\r\n      for (i = 0, l = convexHull.length; i < l; i++) {\r\n        pathCoords.push(convexHull[i][0]);\r\n      }\r\n\r\n      area = new olleh.maps.vector.Polygon(this._areaStyle);\r\n      area.setPaths(new olleh.maps.Path(pathCoords));\r\n      this._area = area;\r\n    }\r\n\r\n    return area;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  showArea: function () {\r\n    var area = this.getArea();\r\n    if (!area.isAdded()) {\r\n      area.setMap(this.map);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  hideArea: function () {\r\n    if (this._area) {\r\n      this._area.setMap(null);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  $default_click: function () {\r\n    this.expand();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  $default_mouseover: function () {\r\n    if (this._displayArea) {\r\n      this.showArea();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  $default_mouseout: function () {\r\n    this.hideArea();\r\n  },\r\n\r\n  /**\r\n   *     \r\n   * @private\r\n   */\r\n  _onMapClick: function (event) {\r\n    if (event.getSource() instanceof olleh.maps.layer.LayerManager) {\r\n      this.collapse(this._originMap);\r\n    }\r\n  },\r\n\r\n  _clusterReady: function () {\r\n    this.setVisible(true);\r\n    this.ready();\r\n  },\r\n\r\n  _clusterOnAdd: function () {\r\n    this.setVisible(false);\r\n    olleh.maps.util.delay(this._clusterReady, this.MARKER_ANIMATE_DURATION * 1000, this);\r\n    delete this.onAdd;\r\n  },\r\n\r\n  _clusterOnRemove: function () {\r\n    olleh.maps.util.defer(this.cleanup, this);\r\n    delete this.onRemove;\r\n  },\r\n\r\n  _markerOnRemove: function (rootPx, duration) {\r\n    this.moveTo(rootPx, duration, false, this.cleanup);\r\n    delete this.onRemove;\r\n  },\r\n\r\n  _markerOnAdd: function (rootPx, duration) {\r\n    this.moveTo(rootPx);\r\n    this.moveTo(this.getOriginalLayerPx(), duration, false, this.ready);\r\n    delete this.onAdd;\r\n  },\r\n\r\n  attach: function () {\r\n    this.hideArea();\r\n    olleh.maps.overlay.MarkerCluster.$super.attach.apply(this, arguments);\r\n  },\r\n\r\n  detach: function () {\r\n    this.hideArea();\r\n    olleh.maps.overlay.MarkerCluster.$super.detach.apply(this, arguments);\r\n  }\r\n\r\n});\r\n/**\r\n * MarkerClustererOptions Object Specification\r\n * @typedef olleh.maps.overlay.MarkerClustererOptions\r\n * @property {number} [minZoom=0]    .\r\n * @property {number} [maxZoom=12]    .\r\n * @property {number} [gap=200]   .      .\r\n * @property {olleh.maps.overlay.MarkerClusterOptions} [clusterOpts]     . , <code>clickToZoom</code>  <code>resetPosition</code>  <code>true</code> .\r\n * @property {function} [afterCluster]     .\r\n * @property {function} [getDistance]     .\r\n * @property {function} [getThreshold]     .\r\n */\r\n\r\n/**\r\n *   .<br/>\r\n *        .\r\n *           ,\r\n *        .\r\n * @example\r\n * var map = new olleh.maps.Map(document.getElementById('map'), {\r\n *   center: new olleh.maps.UTMK(953755.70, 1949715.52),\r\n *   zoom: 8\r\n * });\r\n * var clusterer = new olleh.maps.overlay.MarkerClusterer();\r\n * clusterer.add(marker1); // marker.setMap()  .\r\n * clusterer.add(marker2);\r\n * clusterer.add(marker3);\r\n * clusterer.setMap(map); // marker1~3   .\r\n * clusterer.add(marker4); //  setMap()      . \r\n * clusterer.add(marker5);\r\n * clusterer.setMap(null); // marker1~5  .\r\n */\r\n$class('olleh.maps.overlay.MarkerClusterer').mixin(olleh.maps.Plugin).define({\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.MarkerClustererOptions} opts  .\r\n   */\r\n  MarkerClusterer: function (opts) {\r\n    opts || (opts = {});\r\n\r\n    this.pluginInfo = olleh.maps.mixin({\r\n      autoActivate: true\r\n    }, opts.pluginInfo, true);\r\n\r\n    this._clusterOpts = olleh.maps.util.clone(opts.clusterOpts) || {};\r\n    if (!opts.clusterOpts || opts.clusterOpts.clickToZoom === undefined) {\r\n      this._clusterOpts.clickToZoom = true;\r\n    }\r\n    this._clusterOpts.clickToExpand = false;\r\n    this._clusterOpts.resetPosition = true;\r\n    this._minZoom = opts.minZoom || 0;\r\n    this._maxZoom = opts.maxZoom || 12;\r\n    this._gap = opts.gap || 100;\r\n    this._getDistance = opts.getDistance || this.defaultGetDistance;\r\n    this._getThreshold = opts.getThreshold || this.defaultGetThreshold;\r\n    this._afterCluster = opts.afterCluster || null;\r\n\r\n    this._displayed = [];\r\n    this._zoom = -2;\r\n\r\n    this._bound_onClusterPositionChanged = this._onClusterPositionChanged.bind(this);\r\n    this.clear();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   */\r\n  clear: function () {\r\n    var i, l, markers = this._displayed;\r\n    var LayerManager = olleh.maps.layer.LayerManager;\r\n\r\n    for (i = 0, l = markers.length; i < l; i++) {\r\n      markers[i].setMap(null);\r\n    }\r\n    this._displayed = [];\r\n\r\n    this._rootCluster = new olleh.maps.overlay.MarkerCluster();\r\n    this._rootCluster.minZoom = -1;\r\n    this._rootCluster.maxZoom = -1;\r\n\r\n    for (i = 0, l = this._index ? this._index.length : 0; i < l; i++) {\r\n        this._index[i] && this._index[i].clear();\r\n    }\r\n    this._index = [];\r\n\r\n    for (i = this._minZoom, l = this._maxZoom + 2; i < l; i++) {\r\n      this._index[i] = new olleh.maps.overlay.GridIndex(256 * LayerManager.getResolutionForZoom(i));\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   * @param {olleh.maps.overlay.Marker} otherMarker\r\n   * @param {number} zoom\r\n   * @returns {number}\r\n   */\r\n  defaultGetDistance: function (marker, otherMarker, zoom) {\r\n    return marker.getPosition().distanceTo(otherMarker.getPosition());\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {number} zoom\r\n   * @returns {number}\r\n   */\r\n  defaultGetThreshold: function (zoom) {\r\n    return this._gap * olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  remove: function (marker) {\r\n    var parent, grandparent, sibling, children;\r\n\r\n    if (!marker || !this._index[this._maxZoom + 1].contains(marker)) {\r\n      return;\r\n    }\r\n\r\n    this._removeFromIndex(marker, marker.minZoom, marker.maxZoom);\r\n\r\n    parent = marker.parent;\r\n    parent.remove(marker);\r\n    children = parent.getChildren();\r\n\r\n    //         \r\n    //         \r\n    if (parent != this._rootCluster && children.length == 1) {\r\n      grandparent = parent.parent;\r\n      sibling = children[0];\r\n\r\n      sibling.minZoom = parent.minZoom;\r\n\r\n      this._removeFromIndex(parent, parent.minZoom, parent.maxZoom);\r\n      this._addToIndex(sibling, parent.minZoom, parent.maxZoom);\r\n\r\n      grandparent.remove(parent);\r\n      grandparent.add(sibling);\r\n      parent.unsubscribeEvent('position_changed', this._bound_onClusterPositionChanged);\r\n\r\n      parent = grandparent;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  add: function (marker) {\r\n    var cluster, minZoom, parent;\r\n    var closest = null, zoom = this._maxZoom;\r\n\r\n    if (!marker || this._index[this._maxZoom + 1].contains(marker)) {\r\n      return;\r\n    }\r\n\r\n    if (marker.isAdded()) {\r\n      marker.setMap(null);\r\n    }\r\n\r\n    while (zoom >= this._minZoom) {\r\n      closest = this._getClosest(marker, zoom);\r\n      if (closest) {\r\n        break;\r\n      }\r\n      zoom--;\r\n    }\r\n\r\n    if (!closest) { //  \r\n      this._rootCluster.add(marker);\r\n    } else {\r\n      if (closest.add && closest.maxZoom == zoom) { //     ,  \r\n        closest.add(marker);\r\n      } else { //      \r\n        minZoom = closest.minZoom;\r\n        parent = closest.parent;\r\n\r\n        this._removeFromIndex(closest, closest.minZoom, zoom);\r\n        closest.minZoom = zoom + 1;\r\n\r\n        cluster = new olleh.maps.overlay.MarkerCluster(this._clusterOpts);\r\n        cluster.minZoom = minZoom;\r\n        cluster.maxZoom = zoom;\r\n\r\n        cluster.add(closest);\r\n        cluster.add(marker);\r\n        if (this._afterCluster) {\r\n          this._afterCluster(cluster);\r\n        }\r\n\r\n        this._addToIndex(cluster, cluster.minZoom, cluster.maxZoom);\r\n\r\n        cluster.onEvent('position_changed', this._bound_onClusterPositionChanged);\r\n\r\n        parent.add(cluster);\r\n      }\r\n    }\r\n\r\n    marker.minZoom = zoom + 1;\r\n    marker.maxZoom = this._maxZoom + 1;\r\n    this._addToIndex(marker, marker.minZoom, marker.maxZoom);\r\n  },\r\n  \r\n  _getClosest: function (marker, zoom) {\r\n    var position = marker.getPosition();\r\n    var meter = this.defaultGetThreshold(zoom) * 2;\r\n    var bounds = new olleh.maps.Bounds(position, position).expand(meter, meter);\r\n    var overlays = this._index[zoom].getOverlays(bounds);\r\n    var threshold = this._getThreshold(zoom);\r\n    var i, l, distance, minDistance = Infinity, closest = null, overlay;\r\n\r\n    for (i = 0, l = overlays.length; i < l; i++) {\r\n      overlay = overlays[i];\r\n      distance = this._getDistance(marker, overlay, zoom);\r\n      if (distance < minDistance && distance < threshold) {\r\n        minDistance = distance;\r\n        closest = overlay;\r\n      }\r\n    }\r\n\r\n    return closest;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  _addToIndex: function (marker, minZoom, maxZoom) {\r\n    var i, zoom = this._zoom;\r\n    for (i = minZoom; i <= maxZoom; i++) {\r\n      if (this.map && i == zoom && !marker.isAdded()) {\r\n        marker.setMap(this.map);\r\n        this._displayed.push(marker);\r\n      }\r\n      this._index[i].add(marker, marker.getPosition());\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  _removeFromIndex: function (marker, minZoom, maxZoom) {\r\n    var i, zoom = this._zoom;\r\n\r\n    for (i = minZoom; i <= maxZoom; i++) {\r\n      if (this.map && i == zoom && marker.isAdded()) {\r\n        marker.setMap(null);\r\n        this._displayed.splice(olleh.maps.util.indexOf(this._displayed, marker), 1);\r\n      }\r\n      this._index[i].remove(marker, marker.getPosition());\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    <code>minZoom</code> <code>maxZoom</code>   .\r\n   * @private\r\n   */\r\n  _getAdjustedZoom: function () {\r\n    if (!this.map) {\r\n      return -2;\r\n    }\r\n\r\n    var zoom = this.map.getZoom();\r\n    if (zoom < this._minZoom) {\r\n      zoom = this._minZoom;\r\n    } else if (zoom > this._maxZoom + 1) {\r\n      zoom = this._maxZoom + 1;\r\n    }\r\n\r\n    return zoom;\r\n  },\r\n\r\n  doActivate: function () {\r\n    var i, l, markers, marker, map = this.map;\r\n    var zoom = this._getAdjustedZoom();\r\n    var bounds = map.layerMgr.getOverlayLayer().getBounds();\r\n\r\n    this._zoom = zoom;\r\n    this._bounds = bounds;\r\n\r\n    this._displayed = this._index[zoom].getOverlays(bounds);\r\n    for (i = 0, l = this._displayed.length; i < l; i++) {\r\n      this._displayed[i].setMap(map);\r\n    }\r\n\r\n    map.onEvent('overlay_layer_bounds_changed', this._onboundschanged, this);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var i, l, markers, map = this.map;\r\n\r\n    this._zoom = -2;\r\n    this._bounds = null;\r\n\r\n    for (i = 0, l = this._displayed.length; i < l; i++) {\r\n      this._displayed[i].setMap(null);\r\n    }\r\n    this._displayed = [];\r\n\r\n    map.unsubscribeEvent('overlay_layer_bounds_changed', this._onboundschanged, this);\r\n  },\r\n\r\n  _onClusterPositionChanged: function (e, payload) {\r\n    var i, marker = e.getSource();\r\n    for (i = marker.minZoom; i <= marker.maxZoom; i++) {\r\n      this._index[i].remove(marker, payload.from);\r\n      this._index[i].add(marker, payload.to);\r\n    }\r\n  },\r\n\r\n  _onboundschanged: function (event, payload) {\r\n    var oldZoom = this._zoom, zoom = this._getAdjustedZoom();\r\n    this._bounds = payload.to;\r\n    if (oldZoom == zoom) {\r\n      this._updateBounds();\r\n    } else {\r\n      this._zoom = zoom;\r\n      this._updateZoom(oldZoom < zoom ? this._expand : this._collapse);\r\n    }\r\n  },\r\n\r\n  _updateBounds: function () {\r\n    var marker, map = this.map, oldMarkers = this._displayed;\r\n    var newMarkers = this._index[this._zoom].getOverlays(this._bounds);\r\n\r\n    for (var i = 0; i < newMarkers.length; i++) {\r\n      marker = newMarkers[i];\r\n      if (marker.isAdded()) {\r\n        oldMarkers[olleh.maps.util.indexOf(oldMarkers, marker)] = null;\r\n      } else {\r\n        marker.setMap(map);\r\n      }\r\n    }\r\n\r\n    for (var i = 0; i < oldMarkers.length; i++) {\r\n      marker = oldMarkers[i];\r\n      if (marker) {\r\n        marker.setMap(null);\r\n      }\r\n    }\r\n\r\n    this._displayed = newMarkers;\r\n  },\r\n\r\n  _updateZoom: function (fn) {\r\n    this._displayed = this._recursevely(this._rootCluster, fn);\r\n    // zoom    .\r\n    this._hideNonDisplayedMarkers(this._rootCluster);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.MarkerCluster} markCluster\r\n   */\r\n  _hideNonDisplayedMarkers: function(cluster){\r\n    //  _displayed     .\r\n    if (cluster.isDrawn() && (olleh.maps.util.indexOf(this._displayed, cluster) === -1)){\r\n      cluster.setMap(null);\r\n    }\r\n    // children \r\n    if (!cluster.getChildren) return;\r\n    \r\n    var children = cluster.getChildren();\r\n    for (var i = 0, childCnt = children.length ; i < childCnt; i++){\r\n      this._hideNonDisplayedMarkers(children[i]);\r\n    }\r\n  },\r\n\r\n  _recursevely: function (cluster, fn) {\r\n    var map = this.map, zoom = this._zoom, bounds = this._bounds;\r\n    var i, child, result = [], children = cluster.getChildren();\r\n    for (i = 0; i < children.length; i++) {\r\n      child = children[i];\r\n      if (bounds.intersects(child.getBounds() || child.getPosition())) {\r\n        if (child.getChildren) {\r\n          //    expand/collapse.\r\n          result = result.concat(fn.call(this, child, zoom, bounds));\r\n        } else {\r\n          //     setMap().   \r\n          // !isVisibleAtZoom    min/max zoom\r\n          //   .\r\n          if (!child.isAdded()) {\r\n            child.setMap(map);\r\n          }\r\n          result.push(child);\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  },\r\n\r\n  _expand: function (cluster, zoom, bounds) {\r\n    if (cluster.isAdded()) {\r\n      return cluster.expandToZoom(zoom, bounds);\r\n    }\r\n    if (cluster.isVisibleAtZoom(zoom)) {\r\n      cluster.setMap(this.map);\r\n      return cluster;\r\n    }\r\n    return this._recursevely(cluster, this._expand);\r\n  },\r\n\r\n  _collapse: function (cluster, zoom, bounds) {\r\n    if (cluster.isVisibleAtZoom(zoom)) {\r\n      cluster.collapse(this.map);\r\n      return cluster;\r\n    }\r\n    if (cluster.maxZoom == -1 || cluster.maxZoom < zoom) {\r\n      return this._recursevely(cluster, this._collapse);\r\n    }\r\n    return [];\r\n  }\r\n\r\n});\r\n/**\r\n *   ,     \r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * </ul>\r\n *      .\r\n * @summary <code>dragstart</code>, <code>drag</code>, <code>dragend</code>    ,   .\r\n */\r\n$class('olleh.maps.event.Drag').mixin(olleh.maps.event.Recognizer).define({\r\n\r\n  /**\r\n   * ,  Drag  .\r\n   */\r\n  Drag: function () {\r\n    this._mousedown = false;\r\n    this._startEvent = null;\r\n    this._isDragStart = false;\r\n    this._isDragging = false;\r\n    this._xy = null;\r\n\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousedown: function (event) {\r\n    if (this._isDragStart && this._isDragging) {\r\n      return this.mouseup(event);\r\n    }\r\n    if (olleh.maps.event.EventManager.isRightClick(event.originEvent)) {\r\n       this._reset();\r\n       return;\r\n    }\r\n    this._mousedown = true;\r\n    this._startEvent = event;\r\n    this._isDragStart = false;\r\n    this._isDragging = false;\r\n    \r\n    // movementXY    pageXY .\r\n    // http://dvcs.w3.org/hg/pointerlock/raw-file/default/index.html#idl-def-MouseEvent\r\n    this._xy = event.pageXY;\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousemove: function (event) {\r\n    if (!this._mousedown) return;\r\n    \r\n    var domEvent = event.originEvent;\r\n    var startEvent = this._startEvent;\r\n    var prevXY = this._xy;\r\n    \r\n    this._xy = event.pageXY;\r\n    \r\n    var movementXY = this._xy.subtract(prevXY);\r\n    \r\n    if (movementXY.x === 0 && movementXY.y === 0) {\r\n      event.stopPropagation();\r\n      return;\r\n    } else if (!this._isDragStart) {\r\n\r\n      if (startEvent.getSource() !== event.getSource()) return this._reset();\r\n      \r\n      this._isDragStart = true;\r\n      /**\r\n       * dragstart \r\n       * <p/>\r\n       *   mousedown & mousemove   dragstart  .\r\n       *   touchstart & touchmove   dragstart  .\r\n       * @event olleh.maps.event.EventDelegator#event:dragstart\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      return {\r\n        name: 'dragstart', \r\n        opts: {\r\n          originEvent: domEvent, \r\n          targetDOM: startEvent.targetDOM, \r\n          pageXY: event.pageXY\r\n        }\r\n      };\r\n    }\r\n    this._isDragging = true;\r\n    /**\r\n     * drag \r\n     * <p/>\r\n     * dragstart   \r\n     *   mousemove   drag  .\r\n     *   touchmove   drag  .\r\n     * @event olleh.maps.event.EventDelegator#event:drag\r\n     * @param {olleh.maps.event.Event} event\r\n     * @param {Object} payload\r\n     * @param {Number} payload.movementXY  <p/> drag {@link olleh.maps.event.Event#pageXY}  {@link olleh.maps.event.Event#pageXY} . \r\n     * @see http://dvcs.w3.org/hg/pointerlock/raw-file/default/index.html#idl-def-MouseEvent|w3c mouse event\r\n     */\r\n    return {\r\n      name: 'drag', \r\n      src: startEvent.getSource(), \r\n      opts: {\r\n        originEvent: domEvent, \r\n        pageXY: event.pageXY,\r\n        targetDOM: startEvent.targetDOM\r\n      },\r\n      payload: {movementXY: movementXY}\r\n    };\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mouseup: function (event) {\r\n    if (!this._mousedown || !this._isDragStart) {\r\n      return this._reset();\r\n    }\r\n    var domEvent = event.originEvent;\r\n    var startEvent = this._startEvent;\r\n    var prevXY = this._xy;\r\n    var movementXY = event.pageXY.subtract(prevXY);\r\n    \r\n    olleh.maps.event.EventManager.preventDefault(domEvent);\r\n    this._reset();\r\n    this._isDragging = true;\r\n    /**\r\n     * drag \r\n     * <p/>\r\n     * drag   \r\n     *   mouseup   dragend  .\r\n     *   touchend   dragend  .\r\n     * @event olleh.maps.event.EventDelegator#event:dragend\r\n     * @param {olleh.maps.event.Event} event\r\n     * @param {Object} payload\r\n     * @param {Number} payload.movementXY  <p/> drag {@link olleh.maps.event.Event#pageXY}  {@link olleh.maps.event.Event#pageXY} . \r\n     * @see http://dvcs.w3.org/hg/pointerlock/raw-file/default/index.html#idl-def-MouseEvent|w3c mouse event\r\n     */\r\n    return {\r\n      name: 'dragend', \r\n      src: startEvent.getSource(),\r\n      opts: {\r\n        originEvent: domEvent, pageXY: event.pageXY,\r\n        targetDOM: startEvent.targetDOM\r\n      },\r\n      payload: {movementXY: movementXY}\r\n    };\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  click: function (event) {\r\n    if (this._isDragging) {\r\n      var domEvent = event.originEvent;\r\n      event.stopPropagation();\r\n      olleh.maps.event.EventManager.preventDefault(domEvent);\r\n    }\r\n    this._reset(); // reset          \r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  touchstart: function (event) {\r\n    var touches = event.touches;\r\n    if (!touches || touches.length !== 1) return this._reset();\r\n    return this.mousedown(event);\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  touchmove: function (event) {\r\n    var touches = event.touches;\r\n    var result;\r\n    \r\n    if (!touches || touches.length !== 1) return this._reset();\r\n    if (result = this.mousemove(event)) {\r\n      olleh.maps.event.EventManager.preventDefault(event.originEvent);\r\n    }\r\n    return result;\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  touchend: function (event) {\r\n    return this.mouseup(event);\r\n  },\r\n  \r\n  /**\r\n   *  trackking .\r\n   * @private\r\n   */\r\n  _reset: function () {\r\n    this._mousedown = false;\r\n    this._startEvent = null;\r\n    this._isDragStart = false;\r\n    this._isDragging = false;\r\n    this._xy = null;\r\n  }\r\n});/**\r\n * drag   {@link olleh.maps.Map}     .\r\n * \r\n * {@link olleh.maps.Map}  <code>olleh.maps.handler.Drag.prototype</code> mixin .\r\n * @example\r\n *   \r\n * olleh.maps.mixin(map, olleh.maps.handler.Drag.prototype, true);\r\n *   \r\n * for(var key in olleh.maps.handler.Drag.prototype) {\r\n *   delete map[key];\r\n * }\r\n * @private\r\n */\r\n$class('olleh.maps.handler.Drag').define({\r\n  \r\n  $static: {\r\n    // Drag   map option  default  map options  mixin .\r\n    attach: function(map) {\r\n      map.mergeDefaultOptions({\r\n        dragInertia: true,\r\n        dragInertiaThreshold: olleh.maps.browser.isMobile ? 45 : 65,\r\n        dragInertiaDeceleration: olleh.maps.browser.isMobile ? 4000 : 4500\r\n      });\r\n    }\r\n  },\r\n  \r\n  _zeroPoint: new olleh.maps.Point(0,0),\r\n  \r\n  $default_dragstart: function (event, payload) {\r\n    var point = event.getPoint();\r\n\r\n    if (!point) return;\r\n    \r\n    olleh.maps.util.dom.addClass(this._root_pane, 'ollehmap-drag');\r\n    if(!this._map.getOption('disableDraggingCursor'))\r\n      this._map.setCursor('dragging');\r\n    if(this._opts.dragInertia) {\r\n      this._times = [];\r\n      this._points = [];\r\n    }\r\n  },\r\n  \r\n  $default_drag: function (event, payload) {\r\n    var point = event.getPoint();\r\n    \r\n    if (!point) return;\r\n    var movementXY = payload.movementXY;\r\n    var newCenter = this.calcNewCenter(-movementXY.x, -movementXY.y);\r\n    this.moveTo(newCenter, null, 'off');\r\n    \r\n    if(this._opts.dragInertia) {\r\n      var time = event.timeStamp;\r\n      this._times.push(time);\r\n      this._points.push(point);\r\n    }\r\n  },\r\n  \r\n  $default_dragend: function (event, payload) {\r\n    var opts = this._opts;\r\n    var time = event.timeStamp;\r\n    var lastIndex = this._times.length - 1;\r\n    var i = Math.max(0, Math.min(lastIndex, 3)); // i  delay     event   index\r\n    var prevTime = this._times[lastIndex - i] || time;\r\n    var delay = time - prevTime; //  i event   event  delay\r\n    \r\n    if(opts.dragInertia && delay / (i + 1) < opts.dragInertiaThreshold) {\r\n      var direction = delay === 0 ? payload.movementXY : event.getPoint().subtract(this._points[lastIndex - i]);\r\n      var momentum = this._momentum(delay, direction);\r\n      var newCenter = this.calcNewCenter(momentum.x, momentum.y);\r\n      this.moveTo(newCenter, null, 'on', momentum.duration);\r\n    }\r\n    olleh.maps.util.dom.removeClass(this._root_pane, 'ollehmap-drag');\r\n    if(!this._map.getOption('disableDraggingCursor'))\r\n      this._map.resetCursor();\r\n  },\r\n  \r\n  \r\n  _momentum: function (delay, direction) {\r\n    var opts = this._opts;\r\n    var easeLinearity = opts.panAnimEaseLinearity2 || 0.25;\r\n    var inertiaDeceleration = opts.dragInertiaDeceleration;\r\n    var duration = delay / 1000 || 0.1; // 0.1     .\r\n    var speedVector = direction.multiplyBy(easeLinearity / duration);\r\n    var speed = speedVector.distanceTo(this._zeroPoint);\r\n    speed = Math.min(speed, 2500); //       speed \r\n    var deccelerationDuration = speed / (inertiaDeceleration * easeLinearity);\r\n    var offset = speedVector.multiplyBy(-deccelerationDuration / 2)._round();\r\n    return {x: offset.x, y: offset.y, duration: deccelerationDuration};\r\n  }\r\n  \r\n});\r\n/**\n * {@link olleh.maps.event.EventDelegator#event:req_zoomin}, {@link olleh.maps.event.EventDelegator#event:req_zoomout}\n *    .\n * @private\n */\n$class('olleh.maps.handler.Zoom').define({\n  \n  /**\n   * @param {Number}\n   * @param {olleh.maps.Point}\n   * @private\n   */\n  _calcZoomCenter: function (zoom, mousePx) {\n    var viewportCenter = this.getViewportCenter();\n    var scale = this._getScaleForZoom(zoom);\n    // mouse cursor     1-1/scale  , 1-1/scale  ?\n    var centerOffsetPx = mousePx.subtract(viewportCenter)._multiplyBy(\n        1 - 1 / scale);\n    var newCenterPx = viewportCenter._add(centerOffsetPx);\n    var coord = this.getCoordFromViewportPx(newCenterPx, false);\n    return coord;\n  },\n\n  /**\n   * @param {Number} zoom\n   * @returns {Boolean}\n   * @private\n   */\n  _checkZoomLevel: function (zoom) {\n    var minZoom = this.getMinZoom();\n    var maxZoom = this.getMaxZoom();\n    return minZoom <= zoom && zoom <= maxZoom;\n  },\n\n  $default_req_zoomin: function (event, payload) {\n    var zoom = this.getPendingZoom() + 1;\n\n    event.stopPropagation();\n\n    if (!this._checkZoomLevel(zoom))\n      return;\n\n    var mousePx = event.getPoint();\n    if (!mousePx)\n      return this.zoomIn(); // keyboardZoom   .\n    var coord = this._calcZoomCenter(zoom, mousePx);\n    this.panTo(coord, zoom);\n  },\n\n  $default_req_zoomout: function (event, payload) {\n    var zoom = this.getPendingZoom() - 1;\n\n    event.stopPropagation();\n    if (!this._checkZoomLevel(zoom))\n      return;\n    var mousePx = event.getPoint();\n    if (!mousePx)\n      return this.zoomOut(); // keyboardZoom   .\n    var coord = this._calcZoomCenter(zoom, mousePx);\n    this.panTo(coord, zoom);\n  }\n\n});\n/**\r\n * dblclick   {@link olleh.maps.Map}     .\r\n * \r\n * {@link olleh.maps.Map}  <code>olleh.maps.handler.DoubleClickZoom.prototype</code> mixin .\r\n * @example\r\n *   \r\n * olleh.maps.mixin(map, olleh.maps.handler.DoubleClickZoom.prototype, true);\r\n *   \r\n * for(var key in olleh.maps.handler.DoubleClickZoom.prototype) {\r\n *   delete map[key];\r\n * }\r\n * @private\r\n */\r\n$class('olleh.maps.handler.DoubleClickZoom').define({\r\n  $default_dblclick: function (event) {\r\n    return !this._opts.disableDoubleClickZoom && olleh.maps.handler.Zoom.\r\n      prototype['$default_req_zoomin'].apply(this, arguments);\r\n  },\r\n  \r\n  $default_dblrightclick: function (event) {\r\n    return !this._opts.disableDoubleClickZoom && olleh.maps.handler.Zoom.\r\n      prototype['$default_req_zoomout'].apply(this, arguments);\r\n  }\r\n});/**\n * @private\n */\n$class('olleh.maps.plugin.DefautlHandlers').extend(olleh.maps.Adaptable).define({\n  \n  $static: {\n    HANDLERS: [\n      olleh.maps.handler.Drag, \n      olleh.maps.handler.Zoom\n    ]\n  },\n  \n  attach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.DefautlHandlers.HANDLERS;\n    var i = handlers.length;\n    \n    eventMgr.addRecognizer(new olleh.maps.event.Drag());\n\n    if(!map.getOption('disableDoubleClickZoom')) \n      olleh.maps.event.handler.attach(layerMgr, \n          olleh.maps.handler.DoubleClickZoom);\n    \n    while(i--) {\n      olleh.maps.event.handler.attach(layerMgr, handlers[i]);\n    }\n    olleh.maps.handler.Drag.attach(map);\n  },\n  \n  detach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.DefautlHandlers.HANDLERS;\n    var i = handlers.length;\n    \n    eventMgr.removeRecognizer('olleh.maps.event.Drag');\n\n    if(!map.getOption('disableDoubleClickZoom'))\n      olleh.maps.event.handler.detach(layerMgr, \n          olleh.maps.handler.DoubleClickZoom);\n\n    while(i--) {\n      olleh.maps.event.handler.detach(layerMgr, handlers[i]);\n    }\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.DefautlHandlers);\n/**\r\n *     <code>dblclick</code>      .\r\n *    recognizer .\r\n * @summary <code>dblclick</code>      .\r\n */\r\n$class('olleh.maps.event.DoubleClick').mixin(olleh.maps.event.Recognizer).define({\r\n\r\n  /**\r\n   * ,  DoubleClick  .\r\n   * @param {Object} [opts] zoom \r\n   * @param {Boolean} [opts.dblrightclick=true] \r\n   * @param {Number} [opts.clickThreshold=4]    (px)\r\n   * @param {Number} [opts.clickDuration=400]    timestamp(ms) \r\n   */\r\n  DoubleClick: function (opts) {\r\n    this.isDblclicked = false;\r\n    this._history = {};\r\n    this.opts = olleh.maps.mixin({\r\n      clickThreshold: 4,\r\n      dblrightclick: true,\r\n      clickDuration: 400\r\n    }, opts, true);\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {Object} [opts] \r\n   * @param {Boolean} [opts.dblrightclick=true] \r\n   * @param {Number} [opts.clickThreshold=4]    (px).\r\n   * @param {Number} [opts.clickDuration=400]    timestamp(ms). \r\n   */\r\n  setOptions: function (opts) {\r\n    opts && olleh.maps.mixin(this.opts, opts, true, \r\n        ['dblrightclick', 'clickThreshold', 'clickDuration']);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousedown: function (event) {\r\n    var prevClick = this._history['click'];\r\n    \r\n    this.isDblclicked = false;\r\n    \r\n    if (!prevClick) return;\r\n    if (event.timeStamp - prevClick.timeStamp > this.opts.clickDuration) {\r\n      this._history['click'] = null;\r\n      return;\r\n    }\r\n\r\n    this._history['mouse'] = {\r\n      timeStamp: event.timeStamp,\r\n      pageXY: event.pageXY,\r\n      button: event.originEvent.button\r\n    };\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mouseup: function (event) {\r\n    var prevClick = this._history['click'];\r\n    var domEvent = event.originEvent;\r\n\r\n    if (!this.isDblclicked && this.opts.dblrightclick && !prevClick && \r\n        olleh.maps.event.EventManager.isRightClick(event.originEvent)) {\r\n      return this.click(event);\r\n    } else if (!prevClick) {\r\n      return;\r\n    }\r\n    var click = this._history['mouse'] || {pageXY: event.pageXY, \r\n      button: domEvent.button === 1 ? 0 : 2};\r\n\r\n    this._history['click'] = null;\r\n    this._history['mouse'] = null;\r\n    \r\n    if (prevClick && prevClick.button === click.button &&\r\n        prevClick.pageXY.distanceTo(click.pageXY) < this.opts.clickThreshold) {\r\n      this.isDblclicked = true;\r\n      return {name: click.button === 2 ? 'dblrightclick' : 'dblclick', opts: {originEvent: domEvent}};\r\n    }\r\n    return;\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  click: function (event) {\r\n    if (this.isDblclicked) {\r\n      this.isDblclicked = false;\r\n      return;\r\n    }\r\n    this._history['click'] = {\r\n      timeStamp: event.timeStamp,\r\n      pageXY: event.pageXY,\r\n      button: event.originEvent.button\r\n    };\r\n  }\r\n});/**\r\n *      <code>rightclick</code>      .\r\n * <p/>\r\n *    recognizer . \r\n * @summary <code>rightclick</code>      .\r\n */\r\n$class('olleh.maps.event.RightClick').mixin(olleh.maps.event.Recognizer).define({\r\n  \r\n  /**\r\n   * ,  RightClick  .\r\n   */\r\n  RightClick: function () {\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mouseup: function (event) {\r\n    var domEvent = event.originEvent;\r\n    return olleh.maps.event.EventManager.isRightClick(domEvent) ? \r\n        {name: 'rightclick', opts: {originEvent: domEvent}} : null; \r\n  }\r\n});/**\r\n *   <code>req_zoomin</code>, <code>req_zoomout</code>      .\r\n * <p/>\r\n *    recognizer .\r\n * @summary <code>req_zoomin</code>, <code>req_zoomout</code>        .\r\n */\r\n$class('olleh.maps.event.ScrollWheelZoom').mixin(olleh.maps.event.Recognizer).define({\r\n  \r\n  /**\r\n   * ,  ScrollWheelZoom  .\r\n   */\r\n  ScrollWheelZoom: function () {\r\n    this._timeStamp = null;\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousewheel: function (event) { // mousewheel, DOMMouseScroll\r\n    var domEvent = event.originEvent;\r\n    var delta = domEvent.wheelDelta || -domEvent.detail;  // FF:detail\r\n    var timeStamp = this._timeStamp;\r\n\r\n    this._timeStamp = event.timeStamp;\r\n    \r\n    if (timeStamp && event.timeStamp - timeStamp < 100) {\r\n      return null;\r\n    }\r\n    return {name: delta > 0 ? 'req_zoomin' : 'req_zoomout', opts: {originEvent: domEvent}};\r\n  }\r\n});/**\r\n *  +, -   <code>req_zoomin</code>, <code>req_zoomout</code>      .\r\n * <p/>\r\n *    recognizer .\r\n * @summary <code>req_zoomin</code>, <code>req_zoomout</code>      .\r\n */\r\n$class('olleh.maps.event.KeyboardZoom').mixin(olleh.maps.event.Recognizer).define({\r\n\r\n  /**\r\n   * ,  KeyboardZoom  .\r\n   */\r\n  KeyboardZoom: function () {\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  keydown : function (event) { // keypress\r\n    \r\n    if (!olleh.maps.event.EventManager.checkEnabledKeyevent()) return;\r\n    \r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n\r\n    switch(keyCode) {\r\n      case 107: // +\r\n      case 187: // =+\r\n      case 61: // =+\r\n        return {name: 'req_zoomin'};\r\n      case 109: // -\r\n      case 189: // -_\r\n      case 173: // FF -_\r\n        return {name: 'req_zoomout'};\r\n    }\r\n  }\r\n});/**\r\n *    {@link olleh.maps.Map}     .\r\n * {@link olleh.maps.Map}  <code>olleh.maps.handler.Desktop.prototype</code> mixin .\r\n * @example\r\n *   \r\n * olleh.maps.mixin(map, olleh.maps.handler.Desktop.prototype, true);\r\n *   \r\n * for(var key in olleh.maps.handler.Drag.prototype) {\r\n *   delete map[key];\r\n * }\r\n * @private\r\n */\r\n$class('olleh.maps.handler.Desktop').define({\r\n\r\n  $capture_mousedown: function (event, payload) {\r\n    this._abortPanAnimationAndUpdateCenter();\r\n  },\r\n  \r\n  $default_mousewheel: function (event, payload) {\r\n    olleh.maps.event.EventManager.preventDefault(event.originEvent);\r\n  }\r\n \r\n});\n/**\r\n * key        \r\n * @private\r\n */\r\n$class('olleh.maps.handler.Keyboard').define({\r\n  \r\n  $default_keydown: function (event, payload) {\r\n    var EventManager = olleh.maps.event.EventManager;\r\n\r\n    if (!EventManager.checkEnabledKeyevent()) return;\r\n    \r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n    var moveSize = 2; // map      .\r\n    \r\n\r\n    switch(keyCode) { // 37 38 39 40 < ^ > v\r\n      case 33: // page up\r\n        this._keymoveX = moveSize;\r\n        this._keymoveY = -moveSize;\r\n        break;\r\n      case 34: // page down\r\n        this._keymoveX = moveSize;\r\n        this._keymoveY = moveSize;\r\n        break;\r\n      case 35: // end\r\n        this._keymoveX = -moveSize;\r\n        this._keymoveY = moveSize;\r\n        break;\r\n      case 36: // home\r\n        this._keymoveX = -moveSize;\r\n        this._keymoveY = -moveSize;\r\n        break;\r\n      case 37: // left\r\n        this._keymoveX = -moveSize;\r\n       break;\r\n      case 38: // up\r\n        this._keymoveY = -moveSize;\r\n        break;\r\n      case 39: // right\r\n        this._keymoveX = moveSize;\r\n        break;\r\n      case 40: // down\r\n        this._keymoveY = moveSize;\r\n        break;\r\n      default:\r\n        if (this._moveTimeout) {\r\n          window.clearTimeout(this._moveTimeout); \r\n          delete this._moveTimeout;\r\n        }\r\n        return true;\r\n    }\r\n    this._keyboardMoveStart = true;\r\n    \r\n    EventManager.preventDefault(domEvent);\r\n    EventManager.stopPropagation(domEvent);\r\n    olleh.maps.util.deferAF(this._keyboardMove, this, event);\r\n  },\r\n  \r\n  $default_keyup: function (event, payload) {\r\n    var EventManager = olleh.maps.event.EventManager;\r\n\r\n    if (!EventManager.checkEnabledKeyevent()) return;\r\n    \r\n    if (this._moveTimeout) {\r\n      window.cancelAnimationFrame(this._moveTimeout);\r\n      delete this._moveTimeout;\r\n    }\r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n\r\n    switch(keyCode) { // 37 38 39 40 < ^ > v\r\n      case 33: // page up\r\n      case 34: // page down\r\n      case 35: // end\r\n      case 36: // home\r\n        this._keymoveX = 0;\r\n        this._keymoveY = 0;\r\n        break;\r\n      case 37: // left\r\n      case 39: // right\r\n        this._keymoveX = 0;\r\n       break;\r\n      case 38: // up\r\n      case 40: // down\r\n        this._keymoveY = 0;\r\n        break;\r\n      default:\r\n        return true;\r\n    }\r\n    EventManager.preventDefault(domEvent);\r\n    EventManager.stopPropagation(domEvent);\r\n    return false;\r\n  },\r\n  \r\n  /**\r\n   * @param {DOMTimeStamp} time\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  _keyboardMove: function (time, event) {\r\n    \r\n    if (!this._eventMgr.isMapClicked()) {\r\n      window.cancelAnimationFrame(this._moveTimeout); \r\n      delete this._moveTimeout;\r\n      return;\r\n    }\r\n\r\n    if (this._keyboardMoveStart && this._keymoveX || this._keymoveY) {\r\n      var newCenter = this.calcNewCenter(this._keymoveX || 0, this._keymoveY || 0);\r\n      this.moveTo(newCenter, null, 'off');\r\n      this._moveTimeout = olleh.maps.util.deferAF(this._keyboardMove, this, event);\r\n    } else {\r\n      if (this._moveTimeout || !this._eventMgr._ok) {\r\n        window.cancelAnimationFrame(this._moveTimeout); \r\n        delete this._moveTimeout;\r\n      }\r\n    }\r\n  }\r\n\r\n});\n/**\r\n * shift    drag      zoom  \r\n * @private\r\n */\r\n$class('olleh.maps.handler.BoxZoom').define({\r\n\r\n  $current_dragstart: function (event, payload) {\r\n    // boxZoom   \r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n    var shiftKey = domEvent.shiftKey;\r\n    var button = domEvent.button !== 1;\r\n    var dom = this._boxZoomElem;\r\n    \r\n    if (!shiftKey || (keyCode !== 1 && button)) return;\r\n\r\n    event.preventDefault();\r\n    \r\n    this._dragStartPosition = event.getPoint();\r\n    this._boxZoomStart = true;\r\n    \r\n    if (!dom) {\r\n      dom = this._boxZoomElem = document.createElement('div');\r\n      olleh.maps.util.dom.addClass(dom, 'ollehmap-boxzoom');\r\n    }\r\n    var divStyle = dom.style;\r\n    var px = this._dragStartPosition;\r\n    \r\n    divStyle.width = 0;\r\n    divStyle.height = 0;\r\n    divStyle.top = px.y + 'px';\r\n    divStyle.left = px.x + 'px';\r\n    \r\n    this._layer_container.appendChild(dom);\r\n  },\r\n  \r\n  $current_drag: function (event, payload) {\r\n    if (!this._boxZoomStart) return; // boxZoom   \r\n    \r\n    var px = event.getPoint();\r\n    var dragStartPx = this._dragStartPosition;\r\n    var x = Math.abs(px.x - dragStartPx.x);\r\n    var y = Math.abs(px.y - dragStartPx.y);\r\n    var divStyle = this._boxZoomElem.style; \r\n    \r\n    event.preventDefault();\r\n    divStyle.width =  x + 'px';\r\n    divStyle.height = y + 'px';\r\n    \r\n    px.y < dragStartPx.y && (divStyle.top = px.y + 'px');\r\n    px.x < dragStartPx.x && (divStyle.left = px.x + 'px');\r\n  },\r\n  \r\n  $current_dragend: function (event, payload) {\r\n    if (!this._boxZoomStart) return; // boxZoom   \r\n\r\n    var px = event.getPoint();\r\n    var left, right, top, bottom, leftBottom, rightTop;\r\n    var dragStartPx = this._dragStartPosition;\r\n\r\n    event.preventDefault();\r\n    this._boxZoomStart = false;\r\n    this._layer_container.removeChild(this._boxZoomElem);\r\n\r\n    if (px.x > dragStartPx.x) {\r\n      left = dragStartPx.x;\r\n      right = px.x;\r\n    } else {\r\n      left = px.x;\r\n      right = dragStartPx.x;\r\n    }\r\n    if (px.y > dragStartPx.y) {\r\n      top = dragStartPx.y;\r\n      bottom = px.y;\r\n    } else {\r\n      top = px.y;\r\n      bottom = dragStartPx.y;\r\n    }\r\n    leftBottom = this.getCoordFromViewportPx(new olleh.maps.Point(left, bottom), false);\r\n    rightTop = this.getCoordFromViewportPx(new olleh.maps.Point(right, top), false);\r\n    \r\n    leftBottom && rightTop && this.fitBounds(new olleh.maps.Bounds(leftBottom, rightTop));\r\n  }\r\n\r\n});/**\n * @private\n */\n$class('olleh.maps.plugin.Desktop').extend(olleh.maps.Adaptable).define({\n  \n  $static: {\n    HANDLERS: [\n      olleh.maps.handler.Desktop, \n      olleh.maps.handler.BoxZoom,\n      olleh.maps.handler.Keyboard\n    ]\n  },\n  \n  attach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.Desktop.HANDLERS;\n    var i = handlers.length;\n\n    eventMgr.addRecognizer(new olleh.maps.event.RightClick());\n    eventMgr.addRecognizer(new olleh.maps.event.DoubleClick());\n    if(!map.getOption('disableScrollWheelZoom'))\n      eventMgr.addRecognizer(new olleh.maps.event.ScrollWheelZoom());\n    eventMgr.addRecognizer(new olleh.maps.event.KeyboardZoom());\n    \n    while(i--) {\n      olleh.maps.event.handler.attach(layerMgr, handlers[i]);\n    }\n  },\n  \n  detach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.Desktop.HANDLERS;\n    var i = handlers.length;\n    \n    eventMgr.removeRecognizer('olleh.maps.event.RightClick');\n    eventMgr.removeRecognizer('olleh.maps.event.DoubleClick');\n    eventMgr.removeRecognizer('olleh.maps.event.ScrollWheelZoom');\n    eventMgr.removeRecognizer('olleh.maps.event.KeyboardZoom');\n\n    while(i--) {\n      olleh.maps.event.handler.detach(layerMgr, handlers[i]);\n    }\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.Desktop);\n/**\n * CopyrightControl          .\n */\n$class('olleh.maps.control.CopyrightControl').extend(olleh.maps.control.Control).define({\n    $static: {\n        /**\n         * @private\n         * @constant\n         * @type string\n         */\n        CONTENT: olleh.maps.env.TILE_COPYRIGHT.BASE\n    },\n\n    /**\n     * ,  CopyrightControl  .\n     * @example\n     * var map;\n     * var copyrightControl = new olleh.maps.control.CopyrightControl({\n     *     position: olleh.maps.control.Control.BOTTOM_RIGHT,\n     *     direction: olleh.maps.control.Control.VERTICAL\n     * });\n     * copyrightControl.setMap(map);\n     * @param {olleh.maps.control.ControlOptions} [opts] CopyrightControl  .<br>\n     * opts.position  : {@link olleh.maps.control.Control.BOTTOM_LEFT}<br>\n     * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n     */\n    CopyrightControl: function (opts) {\n        var Control = olleh.maps.control.Control;\n        var _opts = olleh.maps.mixin({\n            position: Control.BOTTOM_LEFT,\n            direction: Control.HORIZONTAL\n        }, opts, true);\n\n        this.position = _opts.position;\n        this.direction = _opts.direction;\n    },\n\n    /**\n     *  .\n     * @returns {olleh.maps.Element}  element\n     * @see olleh.maps.control.Control#draw\n     */\n    draw: function () {\n      var elem = olleh.maps.Element.create('div').addClass('ollehmap-copyright-control').setStyle('margin', '5px');\n\n      if(!this.map.hasMobileStylesheet){\n        this.contentElem = olleh.maps.Element.create('span');\n        elem.appendChild(this.contentElem);\n        this.map.onEvent('maptypeid_changed', this._updateContent, this);\n        this._updateContent();\n      }\n\n      return elem;\n    },\n\n    /**\n     * mapTypeId   copyright  .\n     * @private\n     */\n    _updateContent: function () {\n        var content;\n        var activeBaseLayer = this.map.layerMgr.getActiveBaseLayer();\n        if (activeBaseLayer) content = activeBaseLayer.copyright;\n        if (olleh.maps.isUndefined(content)) content = olleh.maps.control.CopyrightControl.CONTENT;\n        if(this.contentElem.elem.innerHTML !== content) {\n            this.contentElem.elem.innerHTML = content;\n        }\n    },\n\n    detach: function () {\n        var map = this.mgr.map;\n        !olleh.maps.browser.isMobile && map.unsubscribeEvent('maptypeid_changed', this._updateContent, this);\n        olleh.maps.control.CopyrightControl.$super.detach.apply(this, arguments);\n    }\n});\n\n/**\n * LogoControl          .\n */\n$class('olleh.maps.control.LogoControl').extend(olleh.maps.control.Control).define({\n  $static: {\n    /**\n     * @private\n     * @constant\n     * @type string\n     */\n    CONTENT: olleh.maps.env.TILE_COPYRIGHT.BASE\n  },\n\n  /**\n   * ,  LogoControl  .\n   * @example\n   * var map;\n   * var LogoControl = new olleh.maps.control.LogoControl({\n   *     position: olleh.maps.control.Control.BOTTOM_RIGHT,\n   *     direction: olleh.maps.control.Control.VERTICAL\n   * });\n   * @property {Boolean} [logoControl=true] LogoControl  .\n   * @property {olleh.maps.control.LogoControlOptions} [LogoControlOptions] LogoControl \n   * LogoControl.setMap(map);\n   * @param {olleh.maps.control.ControlOptions} [opts] LogoControl  .<br>\n   * opts.position  : {@link olleh.maps.control.Control.BOTTOM_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n  LogoControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    var _opts = olleh.maps.mixin({\n      position: Control.BOTTOM_RIGHT,\n      direction: Control.HORIZONTAL\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div')\n\n    if(this.map.hasMobileStylesheet){\n      elem.addClass('mobile-logo');\n      if(olleh.maps.browser.isHD) {\n        elem.addClass('retina').setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/retinas.png)');\n        //elem.setStyle('backgroundImage', 'url(../../resources/img/mobiles.png)');\n      } else{\n        elem.setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/mobiles.png)');\n        //elem.setStyle('backgroundImage', 'url(../../resources/img/mobiles.png)');\n      }\n    } else {\n      elem.addClass('ollehmap-logo-control');\n      elem.setStyle('backgroundImage', 'url(' + olleh.maps.control.Control.IMG_URL + ')');\n    }\n    \n    // mapType  \n    if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ROADMAP){\n      if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ENGMAP){\n       elem.addClass('imagery')\n      }\n    }\n\n    return elem;\n  },\n\n  detach: function () {\n    olleh.maps.control.LogoControl.$super.detach.apply(this, arguments);\n  },\n\n  _updateActiveBaseLayer: function () {\n    var layerMgr = this.mgr.map.layerMgr;\n    var mode = layerMgr.getActiveBaseLayer();\n    \n    if(this.elem && mode) {\n      if(mode.logoType === 'black') {\n        this.elem.removeClass('imagery');\n      } else {\n        this.elem.addClass('imagery');\n      }\n    }\n  },\n\n  attach: function() {\n    olleh.maps.control.LogoControl.$super.attach.apply(this, arguments);\n    this.map.onEvent('set_base_layer', this._updateActiveBaseLayer, this);\n  },\n\n  detach: function() {\n    this.map.unsubscribeEvent('set_base_layer', this._updateActiveBaseLayer, this);\n    olleh.maps.control.LogoControl.$super.detach.apply(this, arguments);\n  }\n\n});\n\n/**\n *         .\n */\n$class('olleh.maps.control.ScaleControl').extend(olleh.maps.control.Control).define({\n  /**\n   * ,  ScaleControl  .\n   * @example var map; var ns = olleh.maps.control; var scaleControl = new\n   *          olleh.maps.control.ScaleControl({ position:\n   *          ns.Control.BOTTOM_LEFT, direction: ns.Control.HORIZONTAL });\n   *          scaleControl.setMap(map);\n   * @param {olleh.maps.control.ControlOptions} [opts] ScaleControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.BOTTOM_LEFT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n   ScaleControl: function (opts) {\n     var Control = olleh.maps.control.Control;\n     var _opts = olleh.maps.mixin({\n       position: Control.BOTTOM_RIGHT,\n       direction: Control.HORIZONTAL\n     }, opts, true);\n\n     this.scaleImg = null;\n     this.scaleStr = null;\n     this.topOutUnits = 'km';\n     this.topInUnits = 'm';\n     this.position = _opts.position;\n     this.direction = _opts.direction;\n   },\n\n   /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n   draw: function () {\n     var elem = olleh.maps.Element.create('div').addClass('ollehmap-scale-control')\n     this.scaleImg = olleh.maps.Element.create('div').addClass('ollehmap-scale-image')\n     this.scaleStr = olleh.maps.Element.create('div');\n\n     //   \n     if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ROADMAP){\n        if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ENGMAP){\n         this.scaleImg.addClass('imagery')\n        }\n     }\n\n     elem.pushElement(this.scaleImg);\n     elem.pushElement(this.scaleStr);\n     this._update();\n     return elem;\n  },\n\n  _update: function () {\n    var layerMgr = this.mgr.map.layerMgr;\n    var res = layerMgr.getResolution();\n    if (!res)\n        return;\n\n    var inches = olleh.maps.util.INCHES_PER_UNIT;\n    var maxSizeData = 50 * res * inches['Meter'];\n    var topUnits;\n\n    if (maxSizeData > 100000) {\n        topUnits = this.topOutUnits;\n    } else {\n        topUnits = this.topInUnits;\n    }\n    var numTopMax = (maxSizeData / inches[topUnits]).toFixed(0);\n    this.scaleStr.elem.innerHTML = numTopMax + topUnits;\n  },\n  \n  _updateActiveBaseLayer: function () {\n    var layerMgr = this.mgr.map.layerMgr;\n    var mode = layerMgr.getActiveBaseLayer();\n    \n    if(this.scaleImg && mode) {\n      if(mode.logoType === 'black') {\n        this.scaleImg.removeClass('imagery');\n      } else {\n        this.scaleImg.addClass('imagery');\n      }\n    }\n  },\n\n  attach: function() {\n    olleh.maps.control.ScaleControl.$super.attach.apply(this, arguments);\n    this.map.onEvent('zoom_changed', this._update, this);\n    this.map.onEvent('set_base_layer', this._updateActiveBaseLayer, this);\n  },\n\n  detach: function() {\n    this.map.unsubscribeEvent('zoom_changed', this._update, this);\n    this.map.unsubscribeEvent('set_base_layer', this._updateActiveBaseLayer, this);\n    olleh.maps.control.ScaleControl.$super.detach.apply(this, arguments);\n  }\n});\n\n/**\n * PanControl          .\n */\n$class('olleh.maps.control.PanControl').extend(olleh.maps.control.Control).define(\n{\n  $static: {\n\n    /**\n     * @constant\n     * @type Number\n     */\n    SLIDE_FACTOR: 200,\n\n    /**\n     * @constant\n     * @type Object\n     */\n    PAN_INFO: {\n      'panup': {\n        desc: ' ',\n        origin: new olleh.maps.Point(25, 6)\n      },\n      'panleft': {\n        desc: ' ',\n        origin: new olleh.maps.Point(8, 23)\n      },\n      'panright': {\n        desc: ' ',\n        origin: new olleh.maps.Point(44, 23)\n      },\n      'pandown': {\n        desc: ' ',\n        origin: new olleh.maps.Point(24, 44)\n      }\n    }\n  },\n\n  /**\n   * ,  PanControl  .\n   * @example var map; var ns = olleh.maps.control; var panControl = new\n   *          olleh.maps.control.PanControl({ position: ns.Control.TOP_LEFT,\n   *          direction: ns.Control.VERTICAL }); panControl.setMap(map);\n   * @param {olleh.maps.control.ControlOptions} [opts] PanControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_LEFT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\n   */\n  PanControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    var _opts = olleh.maps.mixin({\n      position: Control.TOP_LEFT,\n      direction: Control.VERTICAL\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n    this.panBtns = [];\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var btn, info;\n    var panInfos = olleh.maps.control.PanControl.PAN_INFO;\n    var elem = olleh.maps.Element.create('div').setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n    var pan = olleh.maps.Element.create('div').addClass('control-pan').setStyle(\n        'backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n\n    elem.appendChild(pan);\n\n    for ( var i in panInfos) {\n      info = panInfos[i];\n      btn = this[i + 'Btn'] = olleh.maps.Element.create('div').addClass('control-' + i).addClass(\n          'ollehmap-control-clickable');\n      btn.setStyles({\n        backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)',\n        left: info.origin.x + this.padding + 'px',\n        top: info.origin.y + this.padding + 'px',\n        position: 'absolute'\n      });\n      btn.setProperty('title', info.desc);\n      elem.appendChild(btn);\n      this.registerEventDom(btn.elem);\n    }\n    return elem;\n  },\n\n  propagateEvent: function (event, payload) {\n    switch (event.getName()) {\n    case 'mousedown':\n    case 'touchstart':\n      this.mousedown(event, payload);\n      break;\n    case 'mouseup':\n    case 'touchend':\n    case 'dragend':\n    case 'mouseout':\n      this.mouseup(event, payload);\n      break;\n    }\n  },\n\n  mousedown: function (event, payload) {\n    var target = event.targetDOM;\n    var moveSize = 2;\n    this._pressTimeout = olleh.maps.util.delay(this.mousedown, 100, this, event);\n\n    if (target === this.panupBtn.elem) {\n      this._keymoveY = -moveSize;\n    } else if (target === this.pandownBtn.elem) {\n      this._keymoveY = moveSize;\n    } else if (target === this.panleftBtn.elem) {\n      this._keymoveX = -moveSize;\n    } else if (target === this.panrightBtn.elem) {\n      this._keymoveX = moveSize;\n    }\n    this._panMoveStart = true;\n    olleh.maps.util.deferAF(this._panMove, this, event);\n  },\n\n  mouseup: function (event, payload) {\n    var target = event.targetDOM;\n    if (this._moveTimeout) {\n      window.cancelAnimationFrame(this._moveTimeout);\n      delete this._moveTimeout;\n    }\n    if (this._pressTimeout) {\n      window.clearTimeout(this._pressTimeout);\n      delete this._pressTimeout;\n    }\n    if (target === this.panupBtn.elem || target === this.pandownBtn.elem) {\n      this._keymoveY = 0;\n    } else if (target === this.panleftBtn.elem || target === this.panrightBtn.elem) {\n      this._keymoveX = 0;\n    } else {\n      return;\n    }\n  },\n\n  /**\n   * @param {DOMTimeStamp} time\n   * @param {olleh.maps.event.Event} event\n   * @private\n   */\n  _panMove: function (time, event) {\n    if (this._panMoveStart && this._keymoveX || this._keymoveY) {\n      var lm = this.mgr.map.layerMgr;\n      var newCenter = lm.calcNewCenter(this._keymoveX || 0, this._keymoveY || 0);\n      lm.panTo(newCenter, lm.getZoom(), 'off');\n      this._moveTimeout = olleh.maps.util.deferAF(this._panMove, this, event);\n    } else {\n      if (this._moveTimeout) {\n        window.cancelAnimationFrame(this._moveTimeout);\n        delete this._moveTimeout;\n      }\n    }\n  }\n});\n/**\n * MapTypeControl  , , ,          .\n */\n$class('olleh.maps.control.MapTypeControl').extend(olleh.maps.control.Control).define({\n  $static: {\n\n    /**\n     *   \n     * @constant\n     * @type Array\n     */\n    DEFAULT_MAP_TYPE: [ 'roadmap', 'satellite', 'hybrid', 'engmap' ]\n  },\n\n  /**\n   * MapTypeControl \n   * @param {olleh.maps.control.ControlOptions} [opts] MapTypeControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\n   */\n  MapTypeControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    this.position = Control.TOP_RIGHT;\n    this.direction = Control.VERTICAL;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div');\n    var names = olleh.maps.control.MapTypeControl.DEFAULT_MAP_TYPE;\n    var backgroundImage = 'url('+ olleh.maps.control.Control.IMG_URL + ')';\n    var len = names.length;\n    var btn, name;\n\n    this._btnList = {};\n    elem.setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n\n    for(var i = 0 ; i < len ; i++){\n      name = names[i].toLowerCase();\n      if(name == 'engmap' && !this.mgr.map.getUseEngMap()) continue;\n      btn = olleh.maps.Element.create('div').addClass('control-'+name+'-out').addClass('olleh-maps-inline').addClass('ollehmap-control-clickable');\n      btn.setStyle('backgroundImage', backgroundImage);\n      btn.elem.name = name;\n      elem.appendChild(btn);\n      this.registerEventDom(btn.elem);\n      this._btnList[name] = btn;\n    }\n\n    this._changeButtonState(this.map.getMapTypeId());\n    return elem;\n  },\n\n  propagateEvent: function (event, payload) {\n    switch (event.getName()) {\n    case 'mouseup':\n    case 'touchend':\n      var target = event.targetDOM;\n      this._click(target);\n      break;\n    }\n  },\n\n  /**\n   * @private\n   * @param {HTMLElement} target\n   */\n  _click: function (target) {\n    var typeId = target.name;\n    typeId && this._changeButtonState(typeId);\n  },\n\n  /**\n   * @param key\n   * TODO:         .\n   */\n  _changeButtonState: function (key) {\n    if (!key) {\n      olleh.maps.log.warn('_changeButtonState: key is null', this);\n      return;\n    }\n    var list = this._btnList;\n    var mapTypeId = key.toUpperCase();\n    var classKey = key.toLowerCase();\n\n    this.map.setMapTypeId(mapTypeId);\n    for ( var k in list) {\n      list[k].removeClass('control-' + k + (k === classKey ? '-out' : '-selected'));\n      list[k].addClass('control-' + k + (k === classKey ? '-selected' : '-out'));\n    }\n  },\n\n  _onMapTypeIdChanged: function() {\n    if(this.isDrawn()) {\n      var mapTypeId = this.map.getMapTypeId();\n      this._changeButtonState(mapTypeId);\n    }\n  },\n\n  attach: function() {\n    olleh.maps.control.MapTypeControl.$super.attach.apply(this, arguments);\n    this.map.onEvent('maptypeid_changed', this._onMapTypeIdChanged, this); \n  },\n\n  detach: function() {\n    this.map.unsubscribeEvent('maptypeid_changed', this._onMapTypeIdChanged, this);\n    olleh.maps.control.MapTypeControl.$super.detach.apply(this, arguments);\n  }\n\n});\n/**\n * ZoomControlOptions Object Specification\n * @typedef olleh.maps.control.ZoomControlOptions\n * @extends olleh.maps.control.ControlOptions\n * @property {String} [style]   .  \n *           {@link olleh.maps.control.ZoomControl.LARGE}. <p/>  :\n *           <ul>\n *           <li>{@link olleh.maps.control.ZoomControl.LARGE}</li>\n *           <li>{@link olleh.maps.control.ZoomControl.SMALL}</li>\n *           </ul>\n */\n\n/**\n * ZoomControl         .\n */\n$class('olleh.maps.control.ZoomControl').extend(olleh.maps.control.Control).define({\n  $static: {\n\n    /**\n     * .  <code>olleh.maps.control.ZoomControl.LARGE</code> .\n     * @type String\n     */\n    DEFAULT: 'default',\n\n    /**\n     * zoomBar zoomButton  \n     * @type String\n     */\n    LARGE: 'large',\n\n    /**\n     * ,   \n     * @type String\n     */\n    SMALL: 'small',\n\n    /**\n     * @constant\n     * @type Object\n     */\n    ZOOM_INFO: {\n      // [1,3,5,8,11];\n      1: '',\n      3: '',\n      5: '',\n      8: '',\n      11: '',\n      13: ''\n    }\n  },\n\n  /**\n   * ,  ZoomControl  .\n   * @example var map; var ns = olleh.maps.control; var zoomControl = new\n   *          olleh.maps.control.ZoomControl({ position: ns.Control.TOP_RIGHT,\n   *          direction: ns.Control.VERTICAL, style: ns.ZoomControl.LARGE });\n   *          zoomControl.setMap(map);\n   * @param {olleh.maps.control.ZoomControlOptions} [opts] ZoomControl   <br>\n   * opts.position  : opts.position={@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}<br>\n   * opts.style  : {@link olleh.maps.control.ZoomControl.LARGE}\n   */\n  ZoomControl: function (opts) {\n    var ns = olleh.maps.control;\n    var _opts = olleh.maps.mixin({\n      position: ns.Control.TOP_RIGHT,\n      direction: ns.Control.VERTICAL,\n      style: ns.ZoomControl.LARGE\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n    this.style = _opts.style;\n\n    this._gradation = 9;\n    this._zoom = null;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div').addClass('ollehmap-zoom-control').setStyles({\n      padding: this.padding + 'px'\n    });\n\n    this.elem = elem;\n    if(this.style === olleh.maps.control.ZoomControl.SMALL) {\n      this._drawSmallZoom(elem);\n    } else {\n      this._drawBigZoom(elem);\n    }\n    return elem;\n  },\n\n  /**\n   * @private\n   * @param parent {olleh.maps.Element}\n   */\n  _drawSmallZoom: function (parent) {\n    this._addZoomBtn(parent, 'zoomin').setProperty('title', '');\n    this._addZoomBtn(parent, 'zoomout').setProperty('title', '');\n  },\n\n  /**\n   * @private\n   * @param parent {olleh.maps.Element}\n   */\n  _drawBigZoom: function (parent) {\n    var map = this.mgr.map;\n\n    this._btnY = 26;\n    this._resetMinMaxZoom();\n    this._drawZoomInfo(parent);\n    this._addAbsoluteImgBtn(parent, 'zoomslider', new olleh.maps.Point(8, 0));\n    this._addZoomBtn(parent, 'zoomin').setProperty('title', '');\n    this._drawZoomBar(parent);\n    this._addZoomBtn(parent, 'zoomout').setProperty('title', '');\n    this.zoomoutBtn.setStyle('margin-top', '-1px');\n    this._updateSlider();\n    this.zoomslider.addClass('ollehmap-control-clickable');\n    this.registerEventDom(this.zoomslider.elem);\n    map.onEvent('zoomrange_changed', this._updateZoomRange, this);\n    map.onEvent('zoom_change', this._updateSlider, this);\n    map.onEvent('zoom_changed', this._updateSlider, this);\n\n    this._hideZoomInfo();\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   */\n  _drawZoomBar: function (parent) {\n    var activeBar = this._activeBar = olleh.maps.Element.create('div').addClass('control-zoombar-active').addClass('ollehmap-control-clickable');\n    var deactiveBar = this._deactiveBar = olleh.maps.Element.create('div').addClass('control-zoombar-deactive').addClass('ollehmap-control-clickable');\n    deactiveBar.setStyle('backgroundImage', 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n    activeBar.setStyle('backgroundImage', 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n    parent.appendChild(deactiveBar.elem);\n    parent.appendChild(activeBar.elem);\n    this.registerEventDom(deactiveBar.elem);\n    this.registerEventDom(activeBar.elem);\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   */\n  _drawZoomInfo: function (parent) {\n    var point = new olleh.maps.Point(-35, 0);\n    var info = olleh.maps.Element.create('div');\n    var levels = olleh.maps.control.ZoomControl.ZOOM_INFO;\n    for ( var level in levels) {\n      this._addAbsoluteImgBtn(info, 'level' + level , point);\n    }\n    parent.elem.appendChild(info.elem);\n    this._updateZoomInfo();\n    this.zoomBarInfo = info;\n  },\n\n\n  /**\n   * max/minZoom   slider   zoom level .\n   * @private\n   */\n  _updateZoomRange: function () {\n    this._resetMinMaxZoom();\n    this._updateZoomInfo();\n    this._updateSlider();\n    this._setZoom(this.map.getZoom());\n  },\n\n  /**\n   * slider  \n   * @private\n   */\n  _updateSlider: function (event, zoom) {\n    if (!zoom) {\n      this._setZoom(this.mgr.map.getZoom());\n    } else if (zoom.newZoom !== this._zoom) {\n      this._setZoom(zoom.newZoom);\n    } \n  },\n\n  _updateZoomInfo: function () {\n    var levels = olleh.maps.control.ZoomControl.ZOOM_INFO;\n    for ( var level in levels) {\n      this._updateZoomLevelInfo(this['level' + level], level);\n    }\n  },\n\n  _updateZoomLevelInfo: function (btn, zoom) {\n    if (zoom >= this.minZoom && zoom <= this.maxZoom) {\n      btn.setStyles({\n        top: (this.maxZoom - zoom) * this._gradation + this.padding + this._btnY + 'px',\n        display: 'block'\n      });\n    } else\n      btn.setStyle('display', 'none');\n  },\n\n  _resetMinMaxZoom: function () {\n    var map = this.mgr.map;\n    this.maxZoom = map.getMaxZoom();\n    this.minZoom = map.getMinZoom();\n  },\n\n  /**\n   * @param {Number} zoom\n   * @private\n   */\n  _setZoom: function (zoom) {\n    this._zoom = zoom;\n    var sliderOffset = 3;\n    var sliderPosition = (this.maxZoom - zoom) * this._gradation + this.padding + this._btnY + sliderOffset;\n    this.zoomslider.setStyle('top', sliderPosition + 'px');\n    this._deactiveBar.setStyles({\n      height: this._gradation * (this.maxZoom - zoom + 1) + 'px'\n    });\n    this._activeBar.setStyles({\n      height: this._gradation * (zoom - this.minZoom + 1) + 'px'\n    });\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {String} id\n   * @param {olleh.maps.Point} point\n   * @returns {olleh.maps.Element} button\n   */\n  _addAbsoluteImgBtn: function (parent, id, size) {\n    var btn = this[id] = olleh.maps.Element.create('div').addClass('control-' + id);\n    btn.setStyles({\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)',\n      left:size.x + 'px',\n      top: size.y + 'px',\n      position: 'absolute'\n    });\n    parent.appendChild(btn.elem);\n    return btn;\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {String} id\n   * @returns {olleh.maps.Element} zoomButton\n   */\n  _addZoomBtn: function (parent, id) {\n    var btn = olleh.maps.Element.create('div').addClass('control-' + id).addClass('ollehmap-control-clickable');\n    btn.setStyles({\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)',\n      display: 'block'\n    });\n    parent.appendChild(btn.elem);\n    this.registerEventDom(btn.elem);\n    this[id + 'Btn'] = btn;\n    return btn;\n  },\n\n  /**\n   * Zoomcontrol mouseover  zoomInfo  \n   * @private\n   */\n  _showZoomInfo: function () {\n    this.zoomBarInfo && this.zoomBarInfo.setStyle('display', 'block');\n  },\n\n  /**\n   * Zoomcontrol mouseout  zoomInfo   \n   * @private\n   */\n  _hideZoomInfo: function () {\n    this.zoomBarInfo && this.zoomBarInfo.setStyle('display', 'none');\n  },\n\n  propagateEvent: function (event, payload) {\n    var target = event.targetDOM;\n    switch (event.getName()) {\n    case 'mouseover':\n      this._showZoomInfo();\n      break;\n    case 'mouseout':\n      this._hideZoomInfo();\n      break;\n    case 'dragstart':\n      this.dragstart(target);\n      break;\n    case 'drag':\n      this.drag(event, payload);\n      break;\n    case 'dragend':\n      this.dragend(target);\n      this.mouseup(target);\n      break;\n    case 'click':\n    case 'rightclick':\n      if (!this.isDraggable(target))\n        return;\n      this.dragFlag = true;\n      this.drag(event, payload);\n      this.dragFlag = false;\n      break;\n    case 'mousedown':\n    case 'touchstart':\n      this.mousedown(target);\n      break;\n    case 'mouseup':\n    case 'touchend':\n      this.mouseup(target);\n      break;\n    }\n  },\n\n  /**\n   * @private\n   * @param elem\n   * @returns {boolean}\n   */\n  isDraggable: function (elem) {\n    if (this.style === olleh.maps.control.ZoomControl.LARGE)\n      return true;\n    return false;\n  },\n\n  dragstart: function (target) {\n    if (!this.isDraggable(target))\n      return;\n    this.zoomslider.addClass('ollehmap-dragging');\n    this.dragFlag = true;\n  },\n\n  drag: function (event) {\n    if (!this.dragFlag)\n      return;\n    var crTop = this.elem.elem.getBoundingClientRect().top;\n    var initPt = event.originEvent.clientY - this._btnY - crTop - this.padding;\n    var zoom = parseInt(this.maxZoom - (initPt / this._gradation) + 1);\n    if (zoom <= this.maxZoom && zoom >= this.minZoom && zoom !== this._zoom) {\n      this.mgr.map.setZoom(zoom);\n    }\n  },\n\n  dragend: function (target) {\n    if (this.zoomslider)\n      this.zoomslider.removeClass('ollehmap-dragging');\n    this.dragFlag = false;\n  },\n\n  mousedown: function (target) {\n    var map = this.mgr.map;\n    var action = null;\n    if (target === this.zoominBtn.elem)\n      action = map.zoomIn;\n    else if (target === this.zoomoutBtn.elem)\n      action = map.zoomOut;\n    else\n      return;\n    action.apply(map);\n    this._interval = window.setInterval(action.bind(map), 500);\n  },\n\n  mouseup: function (target) {\n    if (this._interval) {\n      window.clearTimeout(this._interval);\n      delete this._interval;\n    }\n  },\n\n  detach: function () {\n    var map = this.mgr.map;\n    map.unsubscribeEvent('zoomrange_changed', this._updateZoomRange, this);\n    map.unsubscribeEvent('zoom_change', this._updateSlider, this);\n    map.unsubscribeEvent('zoom_changed', this._updateSlider, this);\n    olleh.maps.control.ZoomControl.$super.detach.apply(this, arguments);\n  }\n});\n/**\n * PluginControl  Map  pluginRegstry   plugin       Control .\n */\n$class('olleh.maps.control.PluginControl').extend(olleh.maps.control.Control).define({\n  /**\n   * PluginControl  .\n   * @param {olleh.maps.control.ControlOptions} [opts]  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n  PluginControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    this.position = Control.TOP_RIGHT;\n    this.direction = Control.HORIZONTAL;\n    olleh.maps.mixin(this, opts, true);\n  },\n  \n  attach: function() {\n    olleh.maps.control.PluginControl.$super.attach.call(this);\n    var pluginRegistry = this.mgr.map.pluginRegistry;\n    pluginRegistry.onEvent('plugin_added', this._redrawItems, this);\n    pluginRegistry.onEvent('plugin_state_changed', this._redrawItems, this);\n  },\n  \n  detach: function() {\n    var pluginRegistry = this.mgr.map.pluginRegistry;\n    this.mgr.map.unsubscribeEvent('mouseover', this._hideExpand, this);\n    pluginRegistry.unsubscribeEvent('plugin_added', this._redrawItems, this);\n    pluginRegistry.unsubscribeEvent('plugin_state_changed', this._redrawItems, this);\n    olleh.maps.control.PluginControl.$super.detach.call(this);\n  },\n\n  draw: function () {\n    var elem = olleh.maps.Element.create('div').setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n\n    this._drawExpandType(elem);\n    this.registerEventDom(elem.elem);\n    return elem;\n  },\n\n  _drawExpandType: function (parent) {\n    var expandBtn = olleh.maps.Element.create('a');\n    var form = this.form = olleh.maps.Element.create('form');\n\n    parent.addClass('ollehmap-maptype-control-expandtype');\n    expandBtn.addClass('ollehmap-maptype-control-toggle');\n    form.addClass('ollehmap-maptype-control-list');\n    expandBtn.setStyle('background', 'url('+ olleh.maps.env.RESOURCE_URL + 'img/layers.png)');\n    this._drawItems(form);\n    \n    parent.pushElement(expandBtn.elem);\n    parent.pushElement(form.elem);\n  },\n  \n  /**\n   * item    .\n   * @private\n   */\n  _redrawItems: function() {\n    if(!this.form)\n      return;\n    var childs = this.form.elem.childNodes;\n    var len = childs.length;\n    while(len--) {\n      this.form.removeChild(childs.item(len));\n    }\n    this._drawItems(this.form);\n  },\n  \n  \n  /**\n   * item  .\n   * @param {olleh.maps.Element} form\n   * @private\n   */\n  _drawItems: function(form) {\n    this.groups = this.mgr.map.pluginRegistry.getLabeledPluginsByGroup();\n    this._drawList(form, this.groups['$baseLayer'], 'radio', '$baseLayer');\n    for (var g in this.groups) {\n      if(g !== '$baseLayer' && g !== '$nogroup') {\n        this._drawSeparator(form);\n        this._drawList(form, this.groups[g], 'checkbox');\n      }\n    }\n    if(this.groups.$nogroup && this.groups.$nogroup.length) {\n      this._drawSeparator(form);\n      this._drawList(form, this.groups['$nogroup'], 'checkbox');\n    }\n  },\n  \n\n  /**\n   *  .\n   * @private\n   * @param {olleh.maps.Element} parent\n   */\n  _drawSeparator: function (parent) {\n    var separator = olleh.maps.Element.create('div').addClass(\n        'ollehmap-maptype-control-separator');\n    parent.appendChild(separator);\n  },\n\n  /**\n   *  input type  item  .\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {Object} list  baseLayer  group Object\n   * @param {String} type input type\n   * @param {String} name input name\n   */\n  _drawList: function (parent, list, type, name) {\n    for (var i = 0, len = list.length ; i < len ; i++) {\n      var plugin = list[i];\n      if(plugin.name == 'OllehEng' && !this.mgr.map.getUseEngMap()) continue;\n      this._drawChild(parent, plugin, type, name);\n    }\n  },\n\n  /**\n   * item  .\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {String} label layer  group label\n   * @param {String} plugin layer  group\n   * @param {String} type input Type\n   * @param {String} name input name\n   */\n  _drawChild: function (parent, plugin, type, name) {\n    var div = olleh.maps.Element.create('div');\n    var label = plugin.pluginInfo.label;\n    \n    var tmpl = '<input type=\"#{type}\" name=\"#{name}\" #{checked}>#{label}</input>';\n    var html = olleh.maps.util.applyTemplate(tmpl,{\n      type: type,\n      name: name ? name : '',\n      checked: plugin.isActive() ? 'checked=\"checked\"' : '',\n      label: label\n    });\n    div.elem.innerHTML = html;\n    this.registerEventDom(div.elem);\n    div.setProperty('data-value', plugin);\n    div.setProperty('data-type', type);\n    parent.appendChild(div);\n  },\n\n  _showExpand: function () {\n    this.elem.addClass('ollehmap-maptype-control-expanded');\n    if (!this._expanded) {\n      this.mgr.map.onEvent('mouseover', this._hideExpand, this);\n      this._expanded = true;\n    }\n  },\n\n  _hideExpand: function (event, payload) {\n    if (event.getSource() !== this) {\n      this.elem && this.elem.removeClass('ollehmap-maptype-control-expanded');\n      this.mgr.map.unsubscribeEvent('mouseover', this._hideExpand, this);\n      this._expanded = false;\n    }\n  },\n\n  propagateEvent: function (event, payload) {\n    switch (event.getName()) {\n    case 'click':\n    case 'touchend':\n      this._click(event, payload);\n      break;\n    case 'mouseover':\n      this._showExpand();\n      break;\n    }\n  },\n\n  /**\n   *   .\n   * @private\n   * @param event\n   * @param payload\n   */\n  _click: function (event, payload) {\n    var target = event.targetDOM;\n    var plugin = target['data-value'];  \n    if (plugin) {\n      if(target['data-type'] === 'radio') {\n        !plugin.isActive() && plugin.activate();\n      } else {\n        plugin.isActive() ? plugin.deactivate() : plugin.activate();\n      }\n    }\n  },\n\n  _changeButtonState: function (key) {\n    var imgLoc = olleh.maps.control.Control.IMG_LOCATION;\n    var imgURLS = olleh.maps.control.PluginControl.IMG_URLS;\n    var list = this._dButtonList;\n    for ( var akey in list) {\n      list[akey].setProperty('src', imgLoc + imgURLS[akey + (akey === key ? '_ON' : '_OFF')]);\n    }\n  }\n});\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.DesktopControlsPlugin').extend(olleh.maps.Adaptable).define({\r\n\r\n  attach: function () {\r\n    var map = this.map;\r\n    if (map.checkDefaultControl('panControl')) {\r\n      this.panControl = new olleh.maps.control.PanControl();\r\n      this.panControl.setMap(map);\r\n    }\r\n    if (map.checkDefaultControl('logoControl')) {\r\n      this.logoControl = new olleh.maps.control.LogoControl();\r\n      this.logoControl.setMap(map);\r\n    }\r\n    if (map.checkDefaultControl('scaleControl')) {\r\n      this.scaleControl = new olleh.maps.control.ScaleControl();\r\n      this.scaleControl.setMap(map);\r\n    }\r\n    /*if (map.checkDefaultControl('copyrightControl')) {\r\n      this.copyrightControl = new olleh.maps.control.CopyrightControl();\r\n      this.copyrightControl.setMap(map);\r\n    }*/\r\n    if (map.checkDefaultControl('mapTypeControl')) {\r\n      this.mapTypeControl = new olleh.maps.control.MapTypeControl();\r\n      this.mapTypeControl.setMap(map);\r\n    }\r\n    if (map.checkDefaultControl('zoomControl')) {\r\n      this.zoomControl = new olleh.maps.control.ZoomControl();\r\n      this.zoomControl.setMap(map);\r\n    }\r\n  },\r\n\r\n  detach: function () {\r\n    // ????\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.DesktopControlsPlugin);/**\r\n * /   . measure      \r\n *  measureService  service id    .\r\n *  /      MeasureControl   .\r\n * service Id  measureService    / vector   \r\n * clear()       .\r\n * <br/>\r\n * <pre>\r\n *  map.services.measureService.clear();\r\n * </pre>\r\n * <br>\r\n *     api        .\r\n * <pre>\r\n *  map.services.measureArea.activate();\r\n * </pre>\r\n *         .\r\n * <pre>\r\n *  map.services.measureArea.deactivate();\r\n * </pre>\r\n * <br>\r\n *     api        .\r\n * <pre>\r\n *  map.services.measureDistance.activate();\r\n * </pre>\r\n *         .\r\n * <pre>\r\n *  map.services.measureDustabce.deactivate();\r\n * </pre>\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureService').extend(olleh.maps.Adaptable).define({\r\n  \r\n  /**\r\n   * Service ID: measureService\r\n   * @type String\r\n   */\r\n  serviceId: 'measureService',\r\n\r\n  attach: function () {\r\n    if(this.map.checkDefaultControl('measureControl')){\r\n      this.measureControl = new olleh.maps.control.MeasureControl();\r\n      this.measureControl.setMap(this.map);\r\n    }\r\n    this.measureDistancePlugin = new olleh.maps.plugin.measure.MeasureDistancePlugin();\r\n    this.measureDistancePlugin.setMap(this.map);\r\n    this.measureAreaPlugin = new olleh.maps.plugin.measure.MeasureAreaPlugin();\r\n    this.measureAreaPlugin.setMap(this.map);\r\n  },\r\n\r\n  detach: function () {\r\n    this.measureControl && this.measureControl.setMap(null);\r\n    this.measureDistancePlugin.setMap(null);\r\n    this.measureAreaPlugin.setMap(null);\r\n  },\r\n  \r\n  add: function(measureOverlay) {\r\n    if(!this._measureOverlays)\r\n      this._measureOverlays = [];\r\n    this._measureOverlays.push(measureOverlay);\r\n  },\r\n  \r\n  remove: function(measureOverlay) {\r\n    measureOverlay.setMap(null);\r\n    olleh.maps.util.removeFromArray(this._measureOverlays, measureOverlay);\r\n  },\r\n  \r\n  /**\r\n   *   /  vector  overlay   .\r\n   */\r\n  clear: function() {\r\n    this.map.services.measureDistance.deactivate();\r\n    this.map.services.measureArea.deactivate();\r\n    var measureOverlays = this._measureOverlays;\r\n    if(measureOverlays) {\r\n      for(var i = 0 ; i < measureOverlays.length; i++) {\r\n        measureOverlays[i].setMap(null);\r\n      }\r\n      delete this._measureOverlays;\r\n    }\r\n  }\r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.measure.MeasureService);\r\n/**\r\n *   . MeasureService     measureDistance  service id  \r\n *  .   measureDistance service  activate   .\r\n * <br/>\r\n * <pre>\r\n *  map.services.measureDistance.activate();\r\n * </pre>\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureDistancePlugin').mixin(olleh.maps.Plugin).define({\r\n  \r\n  cursor: 'cursor/distance.cur',\r\n  deleteOrigin: new olleh.maps.Point(107, 156),\r\n  serviceId: 'measureDistance',\r\n  pointOrigin: new olleh.maps.Point(127, 145),\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('url(' + olleh.maps.env.RESOURCE_URL + this.cursor + '), default');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('rightclick',this._onRightClick, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  _onClick: function (event) {\r\n    var map = this.map;\r\n    // zoom animation  click    .\r\n    if(map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    var coord = event.getCoord();\r\n    if (!this._measureOverlayGroup) {\r\n      var vector = this._createVector(event.getCoord());\r\n      var detailInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n        map: map,\r\n        position: event.getCoord()\r\n      });\r\n      var inProgressVector = this._createInProgressVector(event.getCoord());\r\n      this._measureOverlayGroup = new olleh.maps.plugin.measure.MeasureOverlayGroup(vector, inProgressVector, detailInfo);\r\n      map.services.measureService.add(this._measureOverlayGroup);\r\n      detailInfo.bringToFront();\r\n      \r\n      var pointIcon = this._createPointIcon(coord);\r\n      this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      var pointInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n        map: map,\r\n        position: coord,\r\n        type: 'pointStart'\r\n      });\r\n      this._measureOverlayGroup.addPointInfo(pointInfo);\r\n      map.layerMgr.onEvent('mousemove', this._onMove, this, true);\r\n    } else {\r\n      var inProgressPath = this._measureOverlayGroup.inProgressVector.getPath();\r\n      var path = this._measureOverlayGroup.getPath();\r\n      if(!path.getLast().equals(inProgressPath.getLast())) {\r\n        var distance = inProgressPath.getDistance();\r\n        var pointIcon = this._createPointIcon(coord);\r\n        var pointInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n          map: map,\r\n          position: coord,\r\n          type: 'pointInfo',\r\n          distance: distance\r\n        });\r\n        this._measureOverlayGroup.addPointIcon(pointIcon);\r\n        this._measureOverlayGroup.addPointInfo(pointInfo);\r\n        path.push(coord);\r\n        inProgressPath.setAt(0, coord);\r\n        inProgressPath.setAt(1, coord);\r\n      }\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _onMove: function (event) {\r\n    if(!this._measureOverlayGroup)\r\n      return;\r\n    var inProgressPath = this._measureOverlayGroup.inProgressVector.getPath();\r\n    inProgressPath.setAt(1, event.getCoord());\r\n    var detailInfo = this._measureOverlayGroup.detailInfo;\r\n    detailInfo.setPosition(event.getCoord());\r\n    detailInfo.setDistance(this._measureOverlayGroup.getPath().getDistance() + inProgressPath.getDistance());\r\n    event.stopPropagation();\r\n  },\r\n\r\n  _onRightClick: function(event) {\r\n    if(this.map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    this.deactivate();\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _createPointIcon: function(coord) {\r\n    var pointIcon = new olleh.maps.overlay.Marker({\r\n      map: this.map,\r\n      position: coord,\r\n      flat: true,\r\n      icon: {\r\n        url: olleh.maps.env.RESOURCE_URL + 'img/controls.png',\r\n        origin: this.pointOrigin,\r\n        size: new olleh.maps.Size(11,11),\r\n        anchor: new olleh.maps.Point(5,5)\r\n      }\r\n    });\r\n    return pointIcon;\r\n  },\r\n  \r\n  _createInProgressVector: function(coord) {\r\n    var path = new olleh.maps.Path([ coord, coord ]);\r\n    var polyline = new olleh.maps.vector.Polyline({\r\n      map: this.map,\r\n      path: path,\r\n      strokeColor: '#df2428',\r\n      strokeOpacity: .3,\r\n      strokeWeight: 5\r\n    });\r\n    return polyline;\r\n  },\r\n\r\n  _createVector: function (coord) {\r\n    var path = new olleh.maps.Path([ coord , coord]);\r\n    var polyline = new olleh.maps.vector.Polyline({\r\n      map: this.map,\r\n      path: path,\r\n      strokeColor: '#df2428',\r\n      strokeOpacity: .7,\r\n      strokeWeight: 5\r\n    });\r\n    return polyline;\r\n  },\r\n  \r\n  _getDistance: function() {\r\n    return this._measureOverlayGroup.getPath().getDistance();\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    map.resetCursor();\r\n    var layerMgr = map.layerMgr;\r\n    layerMgr.unsubscribeEvent('mousemove', this._onMove, this);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this);\r\n    layerMgr.unsubscribeEvent('rightclick', this._onRightClick, this);\r\n    layerMgr.setEditMode(false);\r\n    if(this._measureOverlayGroup) {\r\n      var point;\r\n      if(this._measureOverlayGroup.inProgressVector) {\r\n        point = this._measureOverlayGroup.inProgressVector.getPath().getLast();\r\n        this._measureOverlayGroup.removeInProgressVector();\r\n      } else {\r\n        point = this._measureOverlayGroup.getPath().getLast();\r\n      }\r\n      this._measureOverlayGroup.getPath().push(point);\r\n      var pointIcon = this._createPointIcon(point);\r\n      this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      this._measureOverlayGroup.detailInfo.finish(this._getDistance());\r\n      this._createDeleteMarker();\r\n      this._measureOverlayGroup = null;\r\n    }\r\n  },\r\n  \r\n  _createDeleteMarker: function() {\r\n    var measureOverlayGroup = this._measureOverlayGroup;\r\n    var path = measureOverlayGroup.getPath();\r\n    var lastPoint = path.getAt(path.getLength() - 1);\r\n    var deleteMarker = new olleh.maps.overlay.Marker({map: this.map, position: lastPoint, flat: true,\r\n      icon:{\r\n        url: olleh.maps.env.RESOURCE_URL + 'img/controls.png',\r\n        origin: this.deleteOrigin,\r\n        size: new olleh.maps.Size(18,17),\r\n        anchor: new olleh.maps.Point(-10,8)\r\n    } });\r\n    measureOverlayGroup.setDeleteMarker(deleteMarker);\r\n    var map = this.map;\r\n    deleteMarker.onEvent('click',function() {\r\n      map.services.measureService.remove(measureOverlayGroup);\r\n    });\r\n  }\r\n});\r\n/**\r\n *   . MeasureService     measureArea  service id  \r\n *  .   measureArea service  activate   .\r\n * <br/>\r\n * <pre>\r\n *  map.services.measureArea.activate();\r\n * </pre>\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureAreaPlugin').extend(olleh.maps.plugin.measure.MeasureDistancePlugin).define({\r\n\r\n  cursor: 'cursor/area.cur',\r\n  deleteOrigin: new olleh.maps.Point(107, 112),\r\n  serviceId: 'measureArea',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n  pointOrigin: new olleh.maps.Point(127, 134),\r\n\r\n  _createVector: function (coord) {\r\n    var path = new olleh.maps.Path([ coord, coord ]);\r\n    return new olleh.maps.vector.Polygon({\r\n      map: this.map,\r\n      paths: path,\r\n      strokeColor: '#06b3f5',\r\n      strokeOpacity: .7,\r\n      strokeWeight: 5,\r\n      fillColor: '#06b3f5',\r\n      fillOpacity: .3\r\n    });\r\n  },\r\n  \r\n  _onClick: function (event) {\r\n    var map = this.map;\r\n    var coord = event.getCoord();\r\n    if (!this._measureOverlayGroup) {\r\n      var vector = this._createVector(event.getCoord());\r\n      var detailInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n        map: map,\r\n        position: event.getCoord(),\r\n        type: 'areaInfo'\r\n      });\r\n      detailInfo.bringToFront();\r\n      this._measureOverlayGroup = new olleh.maps.plugin.measure.MeasureOverlayGroup(vector, null, detailInfo);\r\n      map.services.measureService.add(this._measureOverlayGroup);\r\n      var pointIcon = this._createPointIcon(coord);\r\n      this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      map.layerMgr.onEvent('mousemove', this._onMove, this, true);\r\n    } else {\r\n      var path = this._measureOverlayGroup.getPath();\r\n      var p = path.getAt(path.getLength() -2);\r\n      if(!path.getLast().equals(p)) {\r\n        path.setAt(path.getLength() - 1, coord);\r\n        path.push(coord);\r\n        var pointIcon = this._createPointIcon(coord);\r\n        this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      }\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _onMove: function (event) {\r\n    if(!this._measureOverlayGroup)\r\n      return;\r\n    var path = this._measureOverlayGroup.getPath();\r\n    path.setAt(path.getLength() - 1, event.getCoord());\r\n    this._measureOverlayGroup.detailInfo.setPosition(event.getCoord());\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _getDistance: function() {\r\n    return this._measureOverlayGroup.getPath().getArea();\r\n  }\r\n\r\n});/**\r\n *     Control\r\n */\r\n$class('olleh.maps.control.MeasureControl').extend(olleh.maps.control.Control).define({\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.control.ControlOptions} [opts] MeasureControl  <br>\r\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\r\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\r\n   */\r\n  MeasureControl: function (opts) {\r\n    this.position = olleh.maps.control.Control.TOP_RIGHT;\r\n    this.direction = olleh.maps.control.Control.VERTICAL;\r\n    olleh.maps.mixin(this, opts, true);\r\n  },\r\n  \r\n  attach: function() {\r\n    olleh.maps.control.MeasureControl.$super.attach.apply(this, arguments);\r\n    this.map.pluginRegistry.onEvent('plugin_state_changed', this._onStateChanged, this);\r\n  },\r\n  \r\n  detach: function() {\r\n    this.map.pluginRegistry.unsubscribeEvent('plugin_state_changed', this._onStateChanged, this);\r\n    olleh.maps.control.MeasureControl.$super.detach.apply(this, arguments);\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @returns {olleh.maps.Element}  element\r\n   * @see olleh.maps.control.Control#draw\r\n   */\r\n  draw: function () {\r\n    var div = olleh.maps.Element.create('div');\r\n    var url = 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)';\r\n    div.setStyles({\r\n      position: 'relative',\r\n      height: '75px'\r\n    });\r\n\r\n    var distanceImg = this._distanceImg = olleh.maps.Element.create('div');\r\n    distanceImg.addClass('control-distance-out').addClass('ollehmap-control-clickable');\r\n    distanceImg.setProperty('title', '');\r\n    distanceImg.setStyles({\r\n      backgroundImage: url,\r\n      position: 'absolute',\r\n      top: '0px',\r\n      right: '5px'\r\n    });\r\n    div.appendChild(distanceImg.elem);\r\n    this.registerEventDom(distanceImg.elem);\r\n\r\n    var areaImg = this._areaImg = olleh.maps.Element.create('div');\r\n    areaImg.addClass('control-shape-out').addClass('ollehmap-control-clickable');\r\n    areaImg.setProperty('title', '');\r\n    areaImg.setStyles({\r\n      backgroundImage: url,\r\n      position: 'absolute',\r\n      top: '25px',\r\n      right: '5px'\r\n    });\r\n    div.appendChild(areaImg.elem);\r\n    this.registerEventDom(areaImg.elem);\r\n\r\n    var clearImg = this._clearImg = olleh.maps.Element.create('div');\r\n    clearImg.addClass('control-change').addClass('ollehmap-control-clickable');\r\n    clearImg.setProperty('title', '');\r\n    clearImg.setStyles({\r\n      backgroundImage: url,\r\n      position: 'absolute',\r\n      top: '50px',\r\n      right: '5px'\r\n    });\r\n    div.appendChild(clearImg.elem);\r\n    this.registerEventDom(clearImg.elem);\r\n\r\n    return div;\r\n  },\r\n  \r\n  propagateEvent: function (event, payload) {\r\n    switch (event.getName()) {\r\n    case 'click':\r\n    case 'touchend':\r\n      this._click(event);\r\n      break;\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _click: function(event) {\r\n    var target = event.targetDOM;\r\n    var map = this.map;\r\n    if(target === this._distanceImg.elem) {\r\n      map.services.measureDistance.activate();\r\n    } else if(target === this._areaImg.elem) {\r\n      map.services.measureArea.activate();\r\n    } else if(target === this._clearImg.elem) {\r\n      map.services.measureService.clear();\r\n    }\r\n  },\r\n  \r\n  _onStateChanged: function(event, payload) {\r\n    var isActive;\r\n    var map = this.map;\r\n    if(payload.plugin === map.services.measureDistance) {\r\n      isActive =  map.services.measureDistance.isActive();\r\n      this._distanceImg.addClass('control-distance' + (isActive ? '-selected' : '-out'));\r\n      this._distanceImg.removeClass('control-distance' + (isActive ? '-out' : '-selected'));\r\n    } else if(payload.plugin === map.services.measureArea) {\r\n      isActive =  map.services.measureArea.isActive();\r\n      this._areaImg.addClass('control-shape' + (isActive ? '-selected' : '-out'));\r\n      this._areaImg.removeClass('control-shape' + (isActive ? '-out' : '-selected'));\r\n    }\r\n  }\r\n  \r\n});/**\r\n * /   vector  overlay  .\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureOverlayGroup').define({\r\n  /**\r\n   * ,  vector, detailInfo    .\r\n   * @param {olleh.maps.vector.Vector} vector\r\n   * @param {olleh.maps.vector.Vector} inProgressVector\r\n   * @param {olleh.maps.plugin.measure.MeasureOverlay} detailInfo\r\n   */\r\n  MeasureOverlayGroup: function (vector, inProgressVector, detailInfo) {\r\n    this.vector = vector;\r\n    this.inProgressVector = inProgressVector;\r\n    this.detailInfo = detailInfo;\r\n    this.pointInfos = [];\r\n    this.pointIcons = [];\r\n    this.deleteMarker;\r\n  },\r\n  \r\n  removeInProgressVector: function() {\r\n    if(this.inProgressVector) {\r\n      this.inProgressVector.setMap(null);\r\n      this.inProgressVector = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * Overlay    .\r\n   * @param {olleh.maps.overlay.Marker} deleteMarker\r\n   * @private\r\n   */\r\n  setDeleteMarker: function(deleteMarker) {\r\n    this.deleteMarker = deleteMarker;\r\n  },\r\n  \r\n  /**\r\n   *     Overlay  .\r\n   * @param {olleh.maps.plugin.measure.MeasureOverlay} pointInfo\r\n   * @private\r\n   */\r\n  addPointInfo: function(pointInfo) {\r\n    this.pointInfos.push(pointInfo);\r\n  },\r\n  \r\n  /**\r\n   *    Marker  . \r\n   * @param {olleh.maps.overlay.Marker} pointIcon\r\n   * @private\r\n   */\r\n  addPointIcon: function(pointIcon) {\r\n    this.pointIcons.push(pointIcon);\r\n  },\r\n  \r\n  /**\r\n   *   path  .\r\n   * @returns {olleh.maps.Path}\r\n   * @private\r\n   */\r\n  getPath: function() {\r\n    if(this.vector.getPath)\r\n      return this.vector.getPath();\r\n    if(this.vector.getPaths) // vector is Polygon\r\n      return this.vector.getPaths()[0];\r\n  },\r\n  \r\n  /**\r\n   *   vector  overlay  setMap(map)  .\r\n   * @param {olleh.maps.Map} map\r\n   * @private\r\n   */\r\n  setMap: function(map) {\r\n    this.vector.setMap(map);\r\n    this.inProgressVector && this.inProgressVector.setMap(map);\r\n    this.detailInfo.setMap(map);\r\n    this.deleteMarker && this.deleteMarker.setMap(map);\r\n    for(var i = 0 ; i < this.pointInfos.length ; i++) {\r\n      this.pointInfos[i].setMap(map);\r\n    }\r\n    for(var j = 0 ; j < this.pointIcons.length ; j++) {\r\n      this.pointIcons[j].setMap(map);\r\n    }\r\n  }\r\n\r\n});/**\r\n *  /   Overlay\r\n * @private \r\n */\r\n$class('olleh.maps.plugin.measure.MeasureOverlay').extend(olleh.maps.overlay.PointedOverlay).define({\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {Object} opts\r\n   * @param {String} opts.type \r\n   *  pointStart:, areaInfo: , distanceInfo: , detailInfo:    \r\n   * @param {Number} opts.distance    \r\n   * @param {Number} opts.anchroX position  measureInfo  x  \r\n   * @param {Number} opts.anchroY position  measureInfo  y  \r\n   */\r\n  MeasureOverlay: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      type: 'distanceInfo'\r\n    },opts, true);\r\n  },\r\n  \r\n  update: function() {\r\n    if(!this.div) {\r\n      this.div = olleh.maps.Element.create('div');\r\n      this.div.addClass('ollehmap-measure');\r\n      this.div.setStyles({\r\n        boxShadow: '0 0 1px rgba(0,0,0,0.5)',\r\n        userSelect: 'none'\r\n      });\r\n      var opts = this._opts;\r\n      if(opts.type === 'areaInfo') { //  \r\n        this._updateAreaInfo();\r\n      } else if(opts.type === 'pointStart') { //  : \r\n        this._updatePointStart();\r\n      } else if(opts.type === 'pointInfo') { //  : \r\n        this._updatePointInfo();\r\n      } else { // opts.type === 'pointDetail'  : \r\n        this._updatePointDetail();\r\n      }\r\n      this.registerElement('upper_overlay_pane', this.div.elem);\r\n    }\r\n    olleh.maps.plugin.measure.MeasureOverlay.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  // \r\n  _updateAreaInfo: function() {\r\n    this.div.addClass('ollehmap-measure-areaInfo');\r\n    var imgUrl = 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)'; \r\n    this.div.elem.innerHTML = '  <br>  <div class=\"control-measure-bluemouse olleh-maps-inline\" style=\"background-image:'+ imgUrl +'\"></div>';\r\n  },\r\n  \r\n  //  \r\n  _updateFinalAreaInfo: function(area) {\r\n    this.div.removeClass('ollehmap-measure-areaInfo');\r\n    this.div.addClass('ollehmap-measure-finalAreaInfo');\r\n    var areaHtml = olleh.maps.util.applyTemplate(' <strong>#{value}</strong>#{unit}', this._getArea(area));\r\n    this.div.elem.innerHTML = areaHtml;\r\n  },\r\n  \r\n  //  \r\n  _updatePointStart: function() {\r\n    this.div.addClass('ollehmap-measure-pointStart');\r\n    this.div.elem.innerHTML = '';\r\n  },\r\n  \r\n  //  \r\n  _updatePointInfo: function() {\r\n    this.div.addClass('ollehmap-measure-pointInfo');\r\n    var dist = this._getDistance(this._opts.distance);\r\n    this.div.elem.innerHTML = dist.value + '' + dist.unit;\r\n  },\r\n  \r\n  _updatePointDetail: function() {\r\n    var div = this.div;\r\n    div.addClass('ollehmap-measure-pointDetail');\r\n    var distLabel = olleh.maps.Element.create('div');\r\n    distLabel.addClass('ollehmap-measure-pointDetail1');\r\n    distLabel.elem.innerHTML = '';\r\n    distLabel.setStyle('margin-bottom','5px');\r\n    div.appendChild(distLabel);\r\n    this._distValue = olleh.maps.Element.create('div');\r\n    this._distValue.setStyle('margin-bottom','5px');\r\n    this._distValue.addClass('ollehmap-measure-pointDetail2');\r\n    div.appendChild(this._distValue);\r\n    var walkLabel = olleh.maps.Element.create('div');\r\n    walkLabel.addClass('ollehmap-measure-pointDetail1');\r\n    walkLabel.setStyle('margin-bottom','5px');\r\n    walkLabel.elem.innerHTML = '';\r\n    div.appendChild(walkLabel);\r\n    this._walkValue = olleh.maps.Element.create('div');\r\n    this._walkValue.setStyle('margin-bottom','5px');\r\n    this._walkValue.addClass('ollehmap-measure-pointDetail2');\r\n    div.appendChild(this._walkValue);\r\n    var bikeLabel = olleh.maps.Element.create('div');\r\n    bikeLabel.elem.innerHTML = '';\r\n    bikeLabel.addClass('ollehmap-measure-pointDetail1');\r\n    div.appendChild(bikeLabel);\r\n    this._bikeValue = olleh.maps.Element.create('div');\r\n    this._bikeValue.addClass('ollehmap-measure-pointDetail2');\r\n    div.appendChild(this._bikeValue);\r\n    \r\n    this._rightButtonToFinish = olleh.maps.Element.create('div');\r\n    this._rightButtonToFinish.addClass('ollehmap-measure-finish');\r\n    var imgUrl = 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)'; \r\n    this._rightButtonToFinish.elem.innerHTML = '  <br>  <span class=\"control-measure-redmouse olleh-maps-inline\" style=\"background-image:'+ imgUrl +'\"></span>';\r\n    div.appendChild(this._rightButtonToFinish);\r\n  },\r\n  \r\n  _updateFinalDistanceInfo: function() {\r\n    this.div.setStyles({\r\n      paddingBottom:'8px',\r\n      marginTop:'-88px',\r\n      marginLeft:'30px'\r\n     });\r\n    this._rightButtonToFinish.setStyle('display','none');\r\n  },\r\n  \r\n  setDistance: function(dist) {\r\n    var valueHtml = olleh.maps.util.applyTemplate(\r\n        '<strong>#{value}</strong>#{unit}',this._getDistance(dist));\r\n    this._distValue.elem.innerHTML = valueHtml;\r\n    this._walkValue.elem.innerHTML = this._getTimeHtml(dist, 66.6); //  4km/h = 66.6m/m\r\n    this._bikeValue.elem.innerHTML = this._getTimeHtml(dist, 266.6); //  16km/h = 266.6m/m\r\n  },\r\n  \r\n  finish: function(distOrArea) {\r\n    if(this._opts.type === 'areaInfo')\r\n      this._updateFinalAreaInfo(distOrArea);\r\n    else \r\n      this._updateFinalDistanceInfo();\r\n  },\r\n  \r\n  _getTimeHtml: function(dist, speed) {\r\n    var time = this._getTime(dist, speed);\r\n    var html = olleh.maps.util.applyTemplate(\r\n      '<strong>#{m}</strong>',time);\r\n    if(time.h) {\r\n      html = olleh.maps.util.applyTemplate(\r\n          '<strong>#{h}</strong> ',time) + html;\r\n    }\r\n    return html;\r\n  },\r\n  \r\n  _getTime: function(dist, speed) {\r\n    var time = dist / speed;\r\n    var h = Math.floor(time / 60);\r\n    var m = Math.floor(time % 60);\r\n    var result  = {m: m};\r\n    if(h > 0) {\r\n      result.h = h;\r\n    }\r\n    return result;\r\n  },\r\n    \r\n  _getDistance: function(dist) {\r\n    var unit = 'm';\r\n    if(dist > 1000) {\r\n      unit = 'km';\r\n      dist = dist / 1000;\r\n    }\r\n    return {value: dist.toFixed(3), unit: unit};\r\n  },\r\n  \r\n  _getArea: function(area) {\r\n    var unit;\r\n    if(area > 1000000) {\r\n      area = area / 1000000;\r\n      unit = 'km';\r\n    } else {\r\n      unit = 'm';\r\n    }\r\n    return {value: area.toFixed(3), unit: unit};\r\n  }\r\n  \r\n});/**\r\n * DrawCircle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawCircle').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawCircle',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawCircleOptions\r\n   * @property {olleh.maps.vector.CircleOptions} circleOpts Circle  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawCircleOptions} opts \r\n   * @private \r\n   */\r\n  DrawCircle: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n    circleOpts: {\r\n      fillColor: '#05A15C',\r\n      fillOpacity: .3,\r\n      strokeColor: '#05A15C',\r\n      strokeOpacity: .7,\r\n      strokePosition: 'center', // center, insdie, outside\r\n      strokeWeight: 5}\r\n    }, opts, 'remix');\r\n  },\r\n  \r\n  setOptions: function (opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.onEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this, true);\r\n    layerMgr.unsubscribeEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.unsubscribeEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(false);\r\n  },\r\n  \r\n  _complete: function() {\r\n    if(this._circle) {\r\n      var vectorLayer = this.map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._circle);\r\n      this._circle = null;\r\n    }\r\n  },\r\n  \r\n  _onClick: function(event, payload) {\r\n    if(!this._circle) {\r\n      this._circle = this._createCircle(event.getCoord());\r\n      this.map.layerMgr.onEvent('mousemove',this._onDrag, this);\r\n    } else {\r\n      this.map.layerMgr.unsubscribeEvent('mousemove', this._onDrag, this);\r\n      this._complete();\r\n    }\r\n  },\r\n  \r\n  _onDragStart: function(event, payload) {\r\n    event.preventDefault();\r\n    if(!this._circle) {\r\n      this._circle = this._createCircle(event.getCoord());\r\n      this.map.layerMgr.onEvent('drag',this._onDrag,this);\r\n    }\r\n  },\r\n  \r\n  _onDrag: function(event, payload) {\r\n    event.preventDefault();\r\n    var r = this._center.distanceTo(event.getCoord());\r\n    this._circle.setRadius(r);\r\n  },\r\n  \r\n  _onDragEnd: function(event, payload) {\r\n    event.preventDefault();\r\n    this.map.layerMgr.unsubscribeEvent('drag',this._onDrag,this);\r\n    this._complete();\r\n  },\r\n  \r\n  _createCircle: function(coord) {\r\n    this._center = coord;\r\n    var opts = olleh.maps.mixin({\r\n      map: this.map,\r\n      center: coord,\r\n      radius: 1\r\n    }, this._opts.circleOpts, true);\r\n    var circle = new olleh.maps.vector.Circle(opts);\r\n    return circle;\r\n  }\r\n\r\n});/**\r\n * DrawPolygon\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawPolygon').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawPolygon',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawPolygonOptions\r\n   * @property {olleh.maps.vector.PolygonOptions} polygonOpts Polygon  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawPolygonOptions} opts \r\n   * @private \r\n   */\r\n  DrawPolygon: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      polygonOpts: {\r\n        fillRule: 'evenodd',\r\n        strokeColor: '#06b3f5',\r\n        strokeOpacity: .7,\r\n        strokeWeight: 5,\r\n        fillColor: '#06b3f5',\r\n        fillOpacity: .3\r\n      }\r\n    }, opts, 'remix');\r\n  },\r\n  \r\n  \r\n  setOptions: function(opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('dblclick', this._onDblClick, this, true);\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n  \r\n  _onDblClick: function(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n    this._complete();\r\n    this._prevCoord = event.getCoord();\r\n  },\r\n  \r\n  _onClick: function(event) {\r\n    var map = this.map;\r\n    // zoom animation  click    .\r\n    if(map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    var coord = event.getCoord();\r\n    if(coord.equals(this._prevCoord))\r\n      return;\r\n    this._prevCoord = coord;\r\n    if(!this._polygon) {\r\n      var opts = olleh.maps.mixin({map: this.map, paths: new olleh.maps.Path([coord , coord])}, this._opts.polygonOpts);\r\n      this._polygon = new olleh.maps.vector.Polygon(opts);\r\n      map.layerMgr.onEvent('mousemove', this._onMouseMove, this);\r\n    } else {\r\n      this._completePoint(coord);\r\n    }\r\n  },\r\n  \r\n  _completePoint: function(coord) {\r\n    var path = this._polygon.getPaths()[0];\r\n    path.push(coord);\r\n  },\r\n  \r\n  _onMouseMove: function(event, payload) {\r\n    var path = this._polygon.getPaths()[0];\r\n    path.setAt(path.getLength()-1, event.getCoord());\r\n  },\r\n  \r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this);\r\n    layerMgr.unsubscribeEvent('dblclick',this._onDblClick, this);\r\n    layerMgr.setEditMode(false);\r\n    this._complete();\r\n  },\r\n  \r\n  _complete: function() {\r\n    if(this._polygon) {\r\n      var path = this._polygon.getPaths()[0];\r\n      var last = path.getLength()-1;\r\n      if(path.getAt(last).equals(path.getAt(last-1))) {\r\n        path.pop();\r\n      }\r\n      var map = this.map;\r\n      var vectorLayer = map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._polygon);\r\n      this._polygon = null;\r\n      map.layerMgr.unsubscribeEvent('mousemove',this._onMouseMove, this);\r\n    }    \r\n  }\r\n\r\n});/**\r\n * DrawPolyline\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawPolyline').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawPolyline',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawPolylineOptions\r\n   * @property {olleh.maps.vector.PolylineOptions} polylineOpts Polyline  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawPolylineOptions} opts \r\n   * @private \r\n   */\r\n  DrawPolyline: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      polylineOpts: {\r\n        strokeColor: '#df2428',\r\n        strokeOpacity: .7,\r\n        strokeWeight: 5\r\n      }\r\n    }, opts, 'remix');\r\n  },\r\n\r\n  setOptions: function (opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('dblclick', this._onDblClick, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  _onDblClick: function (event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n    this._finishDrawing();\r\n    this._dblClickCoord = event.getCoord();\r\n  },\r\n\r\n  _onClick: function (event) {\r\n    var map = this.map;\r\n    // zoom animation  click    .\r\n    if (map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    var coord = event.getCoord();\r\n    if(coord.equals(this._dblClickCoord))\r\n      return;\r\n    this._dblClickCoord = null;\r\n    if (!this._polyline) {\r\n      var opts = olleh.maps.mixin({\r\n        map: this.map,\r\n        path: new olleh.maps.Path([ coord ])\r\n      }, this._opts.polylineOpts);\r\n      this._polyline = new olleh.maps.vector.Polyline(opts);\r\n      opts = olleh.maps.mixin({\r\n        map: this.map,\r\n        path: new olleh.maps.Path([ coord, coord ])\r\n      }, this._opts.polylineOpts);\r\n      opts.strokeOpacity = .5;\r\n      this._inprogressLine = new olleh.maps.vector.Polyline(opts);\r\n      map.layerMgr.onEvent('mousemove', this._onMouseMove, this);\r\n    } else {\r\n      this._completePoint(coord);\r\n    }\r\n  },\r\n\r\n  _completePoint: function (coord) {\r\n    var path = this._polyline.getPath();\r\n    path.push(coord);\r\n    this._inprogressLine.setPath(new olleh.maps.Path([ coord, coord ]));\r\n  },\r\n\r\n  _onMouseMove: function (event, payload) {\r\n    var path = this._inprogressLine.getPath();\r\n    path.setAt(1, event.getCoord());\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this);\r\n    layerMgr.unsubscribeEvent('dblclick', this._onDblClick, this);\r\n    layerMgr.setEditMode(false);\r\n    this._finishDrawing();\r\n  },\r\n\r\n  _finishDrawing: function () {\r\n    if (this._polyline) {\r\n      this.map.layerMgr.unsubscribeEvent('mousemove', this._onMouseMove, this);\r\n      var vectorLayer = map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._polyline);\r\n      this._inprogressLine.setMap(null);\r\n      this._inprogressLine = null;\r\n      this._polyline = null;\r\n    }\r\n  }\r\n});/**\r\n * DrawRectangle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawRectangle').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawRectangle',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawRectangleOptions\r\n   * @property {olleh.masps.vector.RectangleOptions} rectangleOpts Rectangle  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawRectangleOptions} opts \r\n   * @private \r\n   */\r\n  DrawRectangle: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      rectangleOpts: {\r\n        fillColor: '#FFC408',\r\n        fillOpacity: .3,\r\n        strokeColor: '#FFC408',\r\n        strokeOpacity: .7,\r\n        strokePosition: 'center', // center, insdie, outside\r\n        strokeWeight: 5\r\n      }}, opts, 'remix');\r\n  },\r\n\r\n  setOptions: function (opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.onEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this, true);\r\n    layerMgr.unsubscribeEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.unsubscribeEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(false);\r\n    this._complete();\r\n  },\r\n  \r\n  _complete: function() {\r\n    if(this._rectangle) {\r\n      var vectorLayer = map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._rectangle);\r\n      this._rectangle = null;\r\n    }\r\n  },\r\n\r\n  _onClick: function (event, payload) {\r\n    if (!this._rectangle) {\r\n      this._rectangle = this._createRectangle(event.getCoord());\r\n      this.map.layerMgr.onEvent('mousemove', this._onDrag, this);\r\n    } else {\r\n      this.map.layerMgr.unsubscribeEvent('mousemove', this._onDrag, this);\r\n      this.deactivate();\r\n    }\r\n  },\r\n\r\n  _onDragStart: function (event, payload) {\r\n    event.preventDefault();\r\n    if (!this._rectangle) {\r\n      this._rectangle = this._createRectangle(event.getCoord());\r\n      this.map.layerMgr.onEvent('drag', this._onDrag, this);\r\n    }\r\n  },\r\n\r\n  _onDrag: function (event, payload) {\r\n    event.preventDefault();\r\n    var coord = event.getCoord();\r\n    var bounds = this._rectangle.getBounds();\r\n    \r\n    var left = Math.min(coord.x, this._startCoord.x);\r\n    var bottom = Math.min(coord.y, this._startCoord.y);\r\n    var right = Math.max(coord.x, this._startCoord.x);\r\n    var top = Math.max(coord.y, this._startCoord.y);\r\n    bounds = new olleh.maps.Bounds(new olleh.maps.UTMK(left,bottom), new olleh.maps.UTMK(right,top));\r\n    this._rectangle.setBounds(bounds);\r\n  },\r\n\r\n  _onDragEnd: function (event, payload) {\r\n    event.preventDefault();\r\n    this.map.layerMgr.unsubscribeEvent('drag', this._onDrag, this);\r\n    this._complete();\r\n  },\r\n  \r\n  _createRectangle: function (coord) {\r\n    this._startCoord = coord;\r\n    var opts = olleh.maps.mixin({\r\n      map: this.map,\r\n      bounds: new olleh.maps.Bounds(coord, coord)\r\n    }, this._opts.rectangleOpts, true);\r\n    var rect = new olleh.maps.vector.Rectangle(opts);\r\n    return rect;\r\n  }\r\n\r\n});\r\n/**\r\n * DrawingControl\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawingControl').extend(olleh.maps.control.Control).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawingControlOpts\r\n   * @property {String} position \r\n   * @property {String} direction \r\n   */\r\n  \r\n  /**\r\n   * Constructor\r\n   */\r\n  DrawingControl: function (opts) {\r\n    this.position = olleh.maps.control.Control.TOP_RIGHT;\r\n    this.direction = olleh.maps.control.Control.VERTICAL;\r\n    olleh.maps.mixin(this, opts, true);\r\n  },\r\n\r\n  attach: function () {\r\n    olleh.maps.plugin.drawing.DrawingControl.$super.attach.apply(this, arguments);\r\n    this.map.pluginRegistry.onEvent('plugin_state_changed', this._onStateChanged, this);\r\n  },\r\n\r\n  detach: function () {\r\n    this.map.pluginRegistry.unsubscribeEvent('plugin_state_changed', this._onStateChanged, this);\r\n    olleh.maps.plugin.drawing.DrawingControl.$super.detach.apply(this, arguments);\r\n  },\r\n\r\n  draw: function () {\r\n    var div = olleh.maps.Element.create('div');\r\n    div.setStyles({\r\n      position: 'relative',\r\n      width: '25px',\r\n      height: '125px',\r\n      margin: '6px',\r\n      backgroundColor: 'white'\r\n    });\r\n\r\n    // circle\r\n    var circleImg = this._circleImg = olleh.maps.Element.create('div');\r\n    circleImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_circle.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'black black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '0px',\r\n      left: '0px',\r\n      'border-radius': '5px 5px 0px 0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(circleImg.elem);\r\n    this.registerEventDom(circleImg.elem);\r\n\r\n    // rectangle\r\n    var rectangleImg = this._rectangleImg = olleh.maps.Element.create('div');\r\n    rectangleImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_rectangle.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '25px',\r\n      left: '0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(rectangleImg.elem);\r\n    this.registerEventDom(rectangleImg.elem);\r\n\r\n    // polyline\r\n    var polylineImg = this._polylineImg= olleh.maps.Element.create('div');\r\n    polylineImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_polyline.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '50px',\r\n      left: '0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(polylineImg.elem);\r\n    this.registerEventDom(polylineImg.elem);\r\n    \r\n    // polygon\r\n    var polygonImg = this._polygonImg = olleh.maps.Element.create('div');\r\n    polygonImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_polygon.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '75px',\r\n      left: '0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(polygonImg.elem);\r\n    this.registerEventDom(polygonImg.elem);\r\n\r\n    // hand\r\n    var handImg = this._handImg = olleh.maps.Element.create('div');\r\n    handImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_hand.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black black black',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '100px',\r\n      left: '0px',\r\n      'border-radius': '0px 0px 5px 5px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(handImg.elem);\r\n    this.registerEventDom(handImg.elem);\r\n\r\n    return div;\r\n  },\r\n\r\n  propagateEvent: function (event, payload) {\r\n    switch (event.getName()) {\r\n    case 'click':\r\n    case 'touchend':\r\n      this._click(event);\r\n      break;\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n\r\n  _click: function (event, payload) {\r\n    var target = event.targetDOM;\r\n    var map = this.map;\r\n    if(target === this._polylineImg.elem) {\r\n      map.services.drawPolyline.activate();\r\n    } else if(target === this._polygonImg.elem) {\r\n      map.services.drawPolygon.activate();\r\n    } else if(target === this._rectangleImg.elem) {\r\n      map.services.drawRectangle.activate();\r\n    } else if(target === this._circleImg.elem) {\r\n      map.services.drawCircle.activate();\r\n    } else if(target === this._handImg.elem) {\r\n      map.services.drawPolyline.deactivate();\r\n      map.services.drawPolygon.deactivate();\r\n      map.services.drawRectangle.deactivate();\r\n      map.services.drawCircle.deactivate();\r\n    }\r\n  },\r\n\r\n  _onStateChanged: function (event, payload) {\r\n\r\n  }\r\n\r\n});/**\r\n * DrawingService\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawingService').extend(olleh.maps.Adaptable).define({\r\n  \r\n  serviceId: 'drawingService', \r\n  \r\n  /**\r\n   * DrawingService   plugin   vector    .  \r\n   * @event olleh.maps.plugin.drawing.DrawingService#event:vector_created\r\n   * @param {olleh.maps.event.Event} event  \r\n   * @param {olleh.maps.vector.Vector} payload  Vector \r\n   */\r\n  \r\n  /**\r\n   * Drawing service \r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawingServiceOptions\r\n   * @property {olleh.maps.vector.CircleOptions} circleOpts Circle   \r\n   * @property {olleh.maps.vector.RectangleOptions} rectangleOpts Rectangle  \r\n   * @property {olleh.maps.vector.PolylineOptions} polylineOpts Polyline  \r\n   * @property {olleh.maps.vector.PolygonOptions} polygonOpts Polygon  \r\n   * @property {olleh.maps.plugin.drawing.EditingPluginOptions} editOpts  \r\n   * @property {olleh.maps.plugin.drawing.DrawingControlOpts} controlOpts Control  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawingServiceOptions} opts \r\n   */\r\n  DrawingService: function (opts) {\r\n    this._opts = opts || {};\r\n  },\r\n\r\n  attach: function() {\r\n    this.drawCircle = new olleh.maps.plugin.drawing.DrawCircle(this._opts);\r\n    this.drawCircle.setMap(this.map);\r\n    this.drawPolyline = new olleh.maps.plugin.drawing.DrawPolyline(this._opts);\r\n    this.drawPolyline.setMap(this.map);\r\n    this.drawPolygon = new olleh.maps.plugin.drawing.DrawPolygon(this._opts);\r\n    this.drawPolygon.setMap(this.map);\r\n    this.drawRectangle = new olleh.maps.plugin.drawing.DrawRectangle(this._opts);\r\n    this.drawRectangle.setMap(this.map);\r\n    this.editingPlugin = new olleh.maps.plugin.drawing.EditingPlugin(this._opts);\r\n    this.editingPlugin.setMap(this.map);\r\n    if(this._opts.controlOpts) {\r\n      this.control = new olleh.maps.plugin.drawing.DrawingControl(this._opts.controlOpts);\r\n      this.control.setMap(this.map);\r\n    }\r\n  },\r\n  \r\n  detach: function() {\r\n    this.drawCircle.setMap(null);\r\n    this.drawPolyline.setMap(null);\r\n    this.drawPolygon.setMap(null);\r\n    this.drawRectangle.setMap(null);\r\n    this.editingPlugin.setMap(null);\r\n    this.control && this.control.setMap(null);\r\n  }\r\n\r\n});/**\r\n * EditingPlugin\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditingPlugin').extend(olleh.maps.Plugin).define({\r\n  \r\n  serviceId: 'editingPlugin',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   *  \r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.EditingPluginOptions\r\n   * @property {String} activation ['click'|'all'] 'click'         .\r\n   *            'all'         .\r\n   */\r\n  /**\r\n   * CONSTRUCTOR\r\n   * @param {olleh.maps.plugin.drawing.DrawingServiceOptions} opts  \r\n   */\r\n  EditingPlugin: function (opts) {\r\n    opts = opts || {};\r\n    this._opts = opts.editOpts || {};\r\n  },\r\n  \r\n  doActivate: function() {\r\n    if(this._opts.activation === 'click') {\r\n      this.map.onEvent('click',this._onclick,this);\r\n    } else {\r\n      this._activateAllVector();\r\n    }\r\n  },\r\n  \r\n  _activateAllVector: function() {\r\n    var vectorLayer = this.map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n    var vectors = vectorLayer.getVectors();\r\n    for(var i=0; i<vectors.length; i++) {\r\n      vectors[i].setEditable(true);\r\n    }\r\n  },\r\n  \r\n  _deactivateAllVector: function() {\r\n    var vectorLayer = this.map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n    var vectors = vectorLayer.getVectors();\r\n    for(var i=0; i<vectors.length; i++) {\r\n      vectors[i].setEditable(false);\r\n    }\r\n  },\r\n  \r\n  doDeactivate: function() {\r\n    if(this._opts.activation === 'click') {\r\n      if(this._activeEditTarget) {\r\n        this._activeEditTarget.setEditable(false);\r\n        this._activeEditTarget = null;\r\n      }\r\n      this.map.unsubscribeEvent('click',this._onclick,this);\r\n    } else {\r\n      this._deactivateAllVector();\r\n    }\r\n  },\r\n  \r\n  _onclick: function(event, payload) {\r\n    var source = event.getSource();\r\n    if(!(source instanceof olleh.maps.vector.Vector))\r\n      return;\r\n    if(this._activeEditTarget && this._activeEditTarget === source) {\r\n      return;\r\n    }\r\n    source.setEditable(true);\r\n    this._activeEditTarget = source;\r\n  }\r\n\r\n});/**\r\n * EditPolyline\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditPolyline').extend(olleh.maps.vector.EditHandler).define({\r\n\r\n  activate: function () {\r\n    if (!this.target)\r\n      return;\r\n    this._draggableVertices = [];\r\n    this._draggableVertices2 = [];\r\n    this.refresh();\r\n  },\r\n\r\n  refresh: function () {\r\n    var paths = this._getPaths();\r\n    var k = 0;\r\n    for (var j = 0; j < paths.length; j++) {\r\n      var path = paths[j];\r\n      var coords = path.getCoords();\r\n      for (var i = 0; i < coords.length; i++) {\r\n        var existing = this._draggableVertices[k];\r\n        if (existing) {\r\n          existing.setOptions({\r\n            path: path,\r\n            index: i\r\n          });\r\n        } else {\r\n          var vertex = new olleh.maps.plugin.drawing.PathEditingHandle({\r\n            editHandler: this,\r\n            path: path,\r\n            index: i,\r\n            map: this.target.map\r\n          });\r\n          this._draggableVertices.push(vertex);\r\n        }\r\n        if (!this._onChanging && (i > 0 || this.target instanceof olleh.maps.vector.Polygon)) {\r\n          var existing2 = this._draggableVertices2[k];\r\n          if (existing2) {\r\n            existing2.setOptions({\r\n              path: path,\r\n              index: i\r\n            });\r\n          } else {\r\n            var vertex = new olleh.maps.plugin.drawing.AddVertexHandle({\r\n              editHandler: this,\r\n              path: path,\r\n              index: i,\r\n              map: this.target.map\r\n            });\r\n            this._draggableVertices2.push(vertex);\r\n          }\r\n        }\r\n        k++;\r\n      }\r\n    }\r\n    var length = this._draggableVertices.length;\r\n    while (k++ < length) {\r\n      var toRemove = this._draggableVertices.pop();\r\n      toRemove.setMap(null);\r\n      toRemove = this._draggableVertices2.pop();\r\n      toRemove && toRemove.setMap(null);\r\n    }\r\n    var center = this.target.getCenter();\r\n    if (center) {\r\n      if (this._centerHandle) {\r\n        this._centerHandle.setPosition(center);\r\n      } else {\r\n        this._centerHandle = new olleh.maps.plugin.drawing.EditingHandle({\r\n          map: this.target.map,\r\n          position: center\r\n        });\r\n        this._centerHandle.onEvent('drag', this._onCenterDrag, this);\r\n      }\r\n    }\r\n  },\r\n\r\n  _getPaths: function () {\r\n    var paths;\r\n    if (this.target.getPath) {\r\n      paths = [ this.target.getPath() ];\r\n    } else {\r\n      paths = this.target.getPaths();\r\n    }\r\n    return paths;\r\n  },\r\n\r\n  _onCenterDrag: function (event) {\r\n    var oldCenter = this._centerHandle.getPosition();\r\n    var coord = event.getCoord();\r\n    var dx = coord.x - oldCenter.x;\r\n    var dy = coord.y - oldCenter.y;\r\n    this._centerHandle.setPosition(coord);\r\n    var draggableVertices = this._draggableVertices;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      var vertex = draggableVertices[i];\r\n      var pos = vertex.getPosition().clone();\r\n      pos.x += dx;\r\n      pos.y += dy;\r\n      vertex.setPosition(pos);\r\n    }\r\n    draggableVertices = this._draggableVertices2;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      var vertex = draggableVertices[i];\r\n      var pos = vertex.getPosition().clone();\r\n      pos.x += dx;\r\n      pos.y += dy;\r\n      vertex.setPosition(pos);\r\n    }\r\n    var paths = this._getPaths();\r\n    for (var i = 0; i < paths.length; i++) {\r\n      var path = paths[i];\r\n      var coords = path.getCoords();\r\n      for (var j = 0; j < coords.length; j++) {\r\n        var a = coords[j].clone();\r\n        a.x += dx;\r\n        a.y += dy;\r\n        coords[j] = a;\r\n      }\r\n    }\r\n    this.target.draw();\r\n  },\r\n\r\n  deactivate: function () {\r\n    var draggableVertices = this._draggableVertices;\r\n    this._draggableVertices = null;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      draggableVertices[i].setMap(null);\r\n    }\r\n    draggableVertices = this._draggableVertices2;\r\n    this._draggableVertices2 = null;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      draggableVertices[i].setMap(null);\r\n    }\r\n    this._centerHandle.setMap(null);\r\n    this._centerHandle = null;\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Polyline'] = olleh.maps.plugin.drawing.EditPolyline;/**\r\n * EditRectangle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditRectangle').extend(olleh.maps.vector.EditHandler).define({\r\n\r\n  activate: function () {\r\n    var rectangle = this.target;\r\n    if (!rectangle)\r\n      return;\r\n    var bounds = rectangle.getBounds();\r\n    var handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.getLeftTopCoord()\r\n    });\r\n    this._leftTopHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.rightTop\r\n    });\r\n    this._rightTopHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.getRightBottomCoord()\r\n    });\r\n    this._rightBottomHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.leftBottom\r\n    });\r\n    this._leftBottomHandle = handle;;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    \r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.getCenter()\r\n    });\r\n    this._centerHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n  },\r\n\r\n  _onDrag: function (event, payload) {\r\n    event.preventDefault();\r\n    var coord = event.getCoord();\r\n    var handle = event.getSource();\r\n    var oppositePoint;\r\n    var rightTop = this._rightTopHandle.getPosition().clone();\r\n    var leftBottom = this._leftBottomHandle.getPosition().clone();\r\n    var leftTop = this._leftTopHandle.getPosition().clone();\r\n    var rightBottom = this._rightBottomHandle.getPosition().clone();\r\n    if (handle === this._leftTopHandle) {\r\n      oppositePoint = this._rightBottomHandle.getPosition();\r\n      rightTop.y = coord.y;\r\n      leftBottom.x = coord.x;\r\n      leftTop = coord;\r\n    } else if (handle === this._rightTopHandle) {\r\n      oppositePoint = this._leftBottomHandle.getPosition();\r\n      leftTop.y = coord.y;\r\n      rightBottom.x = coord.x;\r\n      rightTop = coord;\r\n    } else if (handle === this._rightBottomHandle) {\r\n      oppositePoint = this._leftTopHandle.getPosition();\r\n      rightTop.x = coord.x;\r\n      leftBottom.y = coord.y;\r\n      rightBottom = coord;\r\n    } else if (handle === this._leftBottomHandle) {\r\n      oppositePoint = this._rightTopHandle.getPosition();\r\n      leftTop.x = coord.x;\r\n      rightBottom.y = coord.y;\r\n      leftBottom = coord;\r\n    } else if(handle === this._centerHandle) {\r\n      var center = this._centerHandle.getPosition();\r\n      var dx = event.getCoord().x - center.x;\r\n      var dy = event.getCoord().y - center.y;\r\n      rightTop.x += dx;\r\n      rightTop.y += dy;\r\n      leftBottom.x += dx;\r\n      leftBottom.y += dy;\r\n      leftTop.x += dx;\r\n      leftTop.y += dy;\r\n      rightBottom.x += dx;\r\n      rightBottom.y += dy;\r\n      coord = leftTop;\r\n      oppositePoint = rightBottom;\r\n    }\r\n    var left = Math.min(coord.x, oppositePoint.x);\r\n    var bottom = Math.min(coord.y, oppositePoint.y);\r\n    var right = Math.max(coord.x, oppositePoint.x);\r\n    var top = Math.max(coord.y, oppositePoint.y);\r\n    bounds = new olleh.maps.Bounds(new olleh.maps.UTMK(left,bottom), new olleh.maps.UTMK(right,top));\r\n    this.target.setBounds(bounds);\r\n    \r\n    this._rightTopHandle.setPosition(rightTop);\r\n    this._leftBottomHandle.setPosition(leftBottom);\r\n    this._leftTopHandle.setPosition(leftTop);\r\n    this._rightBottomHandle.setPosition(rightBottom);\r\n    this._centerHandle.setPosition(bounds.getCenter());\r\n  },\r\n  \r\n  refresh: function() {\r\n    var bounds = this.target.getBounds();\r\n    this._rightTopHandle.setPosition(bounds.rightTop);\r\n    this._leftBottomHandle.setPosition(bounds.leftBottom);\r\n    this._leftTopHandle.setPosition(bounds.getLeftTopCoord());\r\n    this._rightBottomHandle.setPosition(bounds.getRightBottomCoord());\r\n    this._centerHandle.setPosition(bounds.getCenter());\r\n  },\r\n\r\n  deactivate: function () {\r\n    this._rightTopHandle.setMap(null);\r\n    this._leftBottomHandle.setMap(null);\r\n    this._leftTopHandle.setMap(null);\r\n    this._rightBottomHandle.setMap(null);\r\n    this._centerHandle.setMap(null);\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Rectangle'] = olleh.maps.plugin.drawing.EditRectangle;/**\r\n * EditPolygon\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditPolygon').extend(olleh.maps.plugin.drawing.EditPolyline).define({\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Polygon'] = olleh.maps.plugin.drawing.EditPolygon;/**\r\n * EditCircle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditCircle').extend(olleh.maps.vector.EditHandler).define({\r\n\r\n  activate: function() {\r\n    var circle = this.target;\r\n    if(!circle)\r\n      return;\r\n    var handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: circle.map,\r\n      position: circle.getCenter()\r\n    });\r\n    handle.onEvent('drag', this._onCenterDrag, this);\r\n    this._centerHandle = handle;\r\n    \r\n    var threeClock = circle.getCenter().clone();\r\n    threeClock.x += circle.getRadius();\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: circle.map,\r\n      position: threeClock\r\n    });\r\n    handle.onEvent('drag', this._onRadiusDrag, this);\r\n    this._radiusHandle = handle;\r\n  },\r\n  \r\n  refresh: function() {\r\n    var circle = this.target;\r\n    this._centerHandle.setPosition(circle.getCenter());\r\n    var threeClock = circle.getCenter().clone();\r\n    threeClock.x += circle.getRadius();\r\n    this._radiusHandle.setPosition(threeClock);\r\n  },\r\n  \r\n  _onCenterDrag: function(event, payload) {\r\n    var coord = event.getCoord();\r\n    var circle = this.target;\r\n    var dx = coord.x - circle.getCenter().x;\r\n    var dy = coord.y - circle.getCenter().y;\r\n    circle.setCenter(coord);\r\n    var threeClock = this._radiusHandle.getPosition();\r\n    threeClock.x += dx;\r\n    threeClock.y += dy;\r\n    this._radiusHandle.setPosition(threeClock.clone());\r\n  },\r\n  \r\n  _onRadiusDrag: function(event, payload) {\r\n    var r = this.target.getCenter().distanceTo(event.getCoord());\r\n    this.target.setRadius(r);\r\n  },\r\n  \r\n  deactivate: function() {\r\n    this._centerHandle.setMap(null);\r\n    this._radiusHandle.setMap(null);\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Circle'] = olleh.maps.plugin.drawing.EditCircle;/**\r\n * EditingHandle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditingHandle').extend(olleh.maps.overlay.PointedOverlay).define({\r\n  \r\n  defaultStyles: {\r\n    width:  '11px',\r\n    height: '11px',\r\n    marginLeft: '-5px',\r\n    marginTop: '-5px'\r\n  },\r\n  \r\n  update: function() {\r\n    if(!this.div) {\r\n      this.div = new olleh.maps.SpritedImage();\r\n      this.div.setImage(\r\n          olleh.maps.env.RESOURCE_URL + 'img/controls.png',\r\n          new olleh.maps.Point(127,145)\r\n      );\r\n      this.div.setStyles(this.defaultStyles);\r\n      olleh.maps.util.dom.setStyle(this.div.elem, 'userSelect', 'none');\r\n      this.registerElement('upper_overlay_pane', this.div.elem);\r\n      this.registerEventDom(this.div.elem);\r\n    }\r\n    olleh.maps.plugin.drawing.EditingHandle.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  $capture_dragstart: function(event, payload) {\r\n    event.preventDefault();\r\n  },\r\n  \r\n  $capture_dragend: function(event, payload) {\r\n    event.preventDefault();\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this.setPosition(coord);\r\n  },\r\n\r\n  $capture_drag: function (event, payload) {\r\n    event.preventDefault();\r\n    this.move(payload.movementXY);\r\n  }\r\n});/**\r\n * PathEditingHandle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.PathEditingHandle').extend(olleh.maps.plugin.drawing.EditingHandle).define({\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.EditHandler} opts.editHandler\r\n   * @param {olleh.maps.Path} opts.path\r\n   * @param {Number} opts.index\r\n   */\r\n  PathEditingHandle: function (opts) {\r\n    this._editHandler = opts.editHandler;\r\n    this._path = opts.path;\r\n    this._index = opts.index;\r\n    this.setPosition(this._path.getAt(this._index));\r\n  },\r\n  \r\n  setOptions: function(opts) {\r\n    if(opts.path && opts.index !== undefined) {\r\n      this._path = opts.path;\r\n      this._index = opts.index;\r\n      this.setPosition(this._path.getAt(this._index));\r\n    } \r\n    olleh.maps.plugin.drawing.PathEditingHandle.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  $capture_dragstart: function(event, payload) {\r\n    event.preventDefault();\r\n  },\r\n  \r\n  $capture_dragend: function(event, payload) {\r\n    event.preventDefault();\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this.setPosition(coord);\r\n  },\r\n\r\n  $capture_drag: function (event, payload) {\r\n    event.preventDefault();\r\n    this.move(payload.movementXY);\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this._path.setAt(this._index, coord);\r\n  }\r\n\r\n});/**\r\n * AddVertexHandle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.AddVertexHandle').extend(olleh.maps.plugin.drawing.EditingHandle).define({\r\n  \r\n  defaultStyles: {\r\n    width:  '11px',\r\n    height: '11px',\r\n    marginLeft: '-5px',\r\n    marginTop: '-5px',\r\n    opacity: '.5'\r\n  },\r\n  \r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.Path} opts.path \r\n   * @param {Number} opts.index \r\n   */\r\n  AddVertexHandle: function (opts) {\r\n    this._editHandler = opts.editHandler;\r\n    this._setOptions(opts);\r\n  },\r\n  \r\n  _setOptions: function(opts) {\r\n    this._path = opts.path;\r\n    this._index = opts.index;\r\n    var coords = opts.path.getCoords();\r\n    var prevIndex = opts.index === 0 ? coords.length-1 : opts.index-1;\r\n    var point1 = coords[prevIndex];\r\n    var point2 = coords[opts.index];\r\n    var point = point1.clone();\r\n    point.x += (point2.x - point1.x) / 2;\r\n    point.y += (point2.y - point1.y) / 2;\r\n    this.setPosition(point);\r\n  },\r\n\r\n  setOptions: function (opts) {\r\n    if (opts.path && opts.index !== undefined) {\r\n      this._setOptions(opts);\r\n    }\r\n    olleh.maps.plugin.drawing.AddVertexHandle.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  $capture_dragstart: function (event, payload) {\r\n    event.preventDefault();\r\n    var newPoint = event.getCoord().clone();\r\n    this._editHandler._onChanging = true;\r\n    this._path.insertAt(this._index, newPoint);\r\n  },\r\n\r\n  $capture_dragend: function (event, payload) {\r\n    event.preventDefault();\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this.setPosition(coord);\r\n    this._editHandler._onChanging = false;\r\n    this._editHandler.target.draw();\r\n  },\r\n\r\n  $capture_drag: function (event, payload) {\r\n    event.preventDefault();\r\n    this.move(payload.movementXY);\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this._path.setAt(this._index, coord);\r\n  }\r\n\r\n});","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('kt-map')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"kmap\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"kmap\"></div>\n</template>\n\n<script>\nimport test from \"@/map/ktmap-all-desktop\";\n\n/* global olleh */\n\nexport default {\n  data: () => ({}),\n  methods: {\n    initMap() {\n      const container = document.getElementById(\"kmap\");\n      const options = {\n        center: new olleh.maps.UTMK(958386.063532902, 1941447.5761742294),\n        zoom: 9,\n        mapTypeId: \"ROADMAP\",\n      };\n      console.log(options);\n      const map = new olleh.maps.Map(container, options);\n      console.log(map);\n      console.log(\"inti Map completed...\");\n    },\n  },\n  mounted() {\n    console.log(test);\n    console.log(olleh);\n    console.log(\"KtMap Component Mounted...\");\n\n    if (!window.olleh || !window.olleh.maps) {\n      console.log(this.map);\n      this.initMap();\n    } else {\n      this.initMap();\n    }\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KtMap.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KtMap.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./KtMap.vue?vue&type=template&id=6b304cb0&\"\nimport script from \"./KtMap.vue?vue&type=script&lang=js&\"\nexport * from \"./KtMap.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <kt-map />\n</template>\n<script>\nimport KtMap from \"@/components/maps/KtMap.vue\";\n\nexport default {\n  name: \"MapView\",\n  components: {\n    KtMap,\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MapAnalysisView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MapAnalysisView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapAnalysisView.vue?vue&type=template&id=22996c53&\"\nimport script from \"./MapAnalysisView.vue?vue&type=script&lang=js&\"\nexport * from \"./MapAnalysisView.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["document","write","GLOBAL","Date","now","Function","prototype","bind","oThis","this","TypeError","aArgs","Array","slice","call","arguments","fToBind","fNOP","fBound","apply","concat","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","oRequestAnimationFrame","cancelAnimationFrame","cancelRequestAnimationFrame","webkitCancelAnimationFrame","webkitCancelRequestAnimationFrame","mozCancelAnimationFrame","mozCancelRequestAnimationFrame","msCancelAnimationFrame","msCancelRequestAnimationFrame","oCancelAnimationFrame","oCancelRequestAnimationFrame","callback","setTimeout","undefined","requestid","window","clearTimeout","indexOf","elem","i","len","length","_OBJ2TYPE","olleh","maps","typeOf","obj","Object","toString","isArray","relaxed","splice","propertyIsEnumerable","isBoolean","isDate","isRegExp","isElement","nodeType","isFragment","isFunction","isNamespace","ns","isString","test","isNumber","isFinite","isObject","isUndefined","isValue","t","curry","fn","ctx","args","SyntaxError","_fn","_args","arr","a","mixin","dest","src","override","filter","p","hasOwnProperty","namespace","attach","overwrite","parent","modified","parts","split","isFn","Error","join","TObject","$super","$classname","currentStack","that","current","callee","caller","cs","name","isMixinOf","target","cls","constructor","mixins","getClass","$class","dontEnumProperties","dontEnumBug","extend","define","superclass","sup","m","mm","shortname","substring","lastIndexOf","ctor","stack","push","pop","$constructor","supClsProto","afterDefine","supCls","$afterDefine","$static","desc","dontEnumProps","$skeleton","PROTOCOL","location","protocol","PORT","VERSION","RESOURCE_URL","TILE_URL","BASE","AIR","HYBRID","ENG","TRAFFIC","HD_BASE","HD_HYBRID","TILE_COPYRIGHT","LANG","$LANG","LOG_LEVEL","MSG","msg","key","lang","l","env","console","warn","BROWSER_NAME","ie","firefox","safari","chrome","opera","chromeMobile","chromeForAndroid","chromeForIos","other","ENGINE_NAME","webkit","gecko","presto","trident","OS_NAME","ios","android","mac","win","linux","STYLE_DASH_PREFIX","STYLE_PREFIX","browserName","browserVer","engineName","engineVer","event","hasOrientationChange","hasTouch","navigator","userAgent","has3D","hasCanvas","createElement","getContext","hasPointerEvents","hasSVG","implementation","hasFeature","hasVML","namespaces","div","innerHTML","childNodes","isMobile","isTablet","osName","osVer","style","styleDashPrefix","stylePrefix","styleTranslateTmpl","vector","isStyleSupported","browser","bodyStyle","body","capitalize","prop","browsers","engine","os","documentElement","enginePrefix","browserPrefix","osPrefix","mobile","android_tablet","ipad","ics3DWhiteList","ics3DBlackList","str","charAt","toUpperCase","substr","testStyle","testPrefixedStyle","match","RegExp","transition","transform","transformOrigin","backgroundSize","opacity","userSelect","get","getAttribute","set","value","setAttribute","removeAttribute","transitionend","parseFloat","isHD","isHDTile","usePulseForZoom","use3DRootPane","hotfixAndroid","ver","majorVers","majorVer","styleScaleTmpl","log","level","opts","_class","_package","_tag","config","_level","LEVEL","$tag","util","DEBUG","getMilliseconds","INFO","WARN","ERROR","FATAL","NONE","isLevel","debug","info","error","fatal","DEFAULT_PRECISION","INCHES_PER_UNIT","meters_per_inch","inches_per_unit","DOTS_PER_INCH","_ID_SEED","getTime","genId","prefix","radToDeg","radian","Math","PI","degToRad","degree","toFloat","num","precision","toPrecision","getResolutionFromScale","scale","units","resolution","normScale","getScaleFromResolution","applyTemplate","tmpl","data","item","to","regexp","exec","replace","lastIndex","index","fromIndex","n","Number","Infinity","floor","abs","k","max","min","removeFromArray","toRemove","trim","string","end","ws","copyOpts","excludes","clone","object","source","startsWith","delay","milis","curried","defer","deferAF","CSS_UNITS","getStyle","getComputedStyle","dom","browserStyle","currentStyle","hyphenToCamelCase","defaultView","getPropertyValue","camelCaseToHyphen","setStyle","setStyles","styles","addClass","className","classList","add","hasClass","contains","elemClassName","removeClass","remove","replaceClass","oldC","newC","toggleClass","elementOf","id","getElementById","pushElement","children","insertBefore","appendChild","popElement","removeChild","removeElements","e","r","elems","removed","parentNode","unshift","extractValueFromStyle","result","isNaN","extractUnitFromStyle","unit","getTranslateString","x","y","use3D","getScaleString","getPositionStyles","useTransform","left","top","getPointFromStyle","parsed","parseStyleValue","loop","params","Point","getXY","webkitConvert","webkitConvertPointFromNodeToPage","point","WebKitPoint","rect","getBoundingClientRect","pageXOffset","pageYOffset","ie8","scrollLeft","scrollTop","_round","_cbHyphenToCamelCase","_","c","_cbCamelCaseToHyphen","toLowerCase","uv","getUnitAndValue","methodParams","methodName","parsedStyleToString","parsedStyle","j","s","methodResult","floatValue","isAttached","map","getMap","setMap","_unregisterService","detach","_registerService","serviceId","services","Adaptable","setPluginInfo","pluginInfo","pluginRegistry","deactivate","autoActivate","isStarted","activate","callActivate","unsubscribeEvent","onEvent","isActive","_active","drawingTool","drawingToolActivate","doActivate","setActive","active","fireEvent","plugin","doDeactivate","Initializable","init","Proj4js","defaultDatum","readyToUse","reportError","srsCode","datum","datum_type","common","PJD_3PARAM","PJD_7PARAM","datumCode","wgs84","WGS84","axis","adjust_axis","projName","D2R","to_meter","inverse","from_greenwich","datum_transform","R2D","forward","compare_datums","PJD_NODATUM","es","geodetic_to_geocentric","geocentric_to_wgs84","geocentric_from_wgs84","geocentric_to_geodetic","crs","denorm","v","xin","yin","zin","z","alert","destination","property","Class","initialize","extended","func","newArgs","scriptName","defsLookupService","libPath","getScriptLocation","scriptNameLen","scripts","getElementsByTagName","loadScript","url","onload","onfail","loadCheck","script","type","onerror","onreadystatechange","checkReadyState","readyState","Proj","title","x0","y0","localCS","queue","srsCodeInput","parseWKT","deriveConstants","loadProjCode","urn","srsAuth","srsProjNumber","loadProjDefinition","defs","defsLoaded","loadFromService","checkDefsLoaded","defsFailed","parseDefs","initTransforms","loadProjCodeSuccess","loadProjCodeFailure","checkCodeLoaded","dependsOn","shift","wktRE","wkt","wktMatch","wktName","wktObject","wktContent","wktTemp","wktArray","bkCount","token","geocsCode","wktProjections","datumName","ellps","rf","unitsPerMeter","k0","long0","lat0","datum_params","paramName","paramVal","defData","paramArray","nagrids","b","lat1","lat2","lat_ts","alpha","longc","R_A","zone","parseInt","utmSouth","PrimeMeridian","legalAxis","datumDef","Datum","towgs84","ellipse","Ellipsoid","EPSLN","sphere","a2","b2","sqrt","SIXTH","RA4","RA6","ep2","longlat","pt","identity","HALF_PI","TWO_PI","FORTPI","SEC_TO_RAD","MAX_ITER","COS_67P5","AD_C","PJD_UNKNOWN","PJD_GRIDSHIFT","PJD_WGS84","SRS_WGS84_SEMIMAJOR","RV4","RV6","msfnz","eccent","sinphi","cosphi","con","tsfnz","phi","com","pow","tan","phi2z","ts","dphi","eccnth","atan","sin","qsfnz","asinz","asin","e0fn","e1fn","e2fn","e3fn","mlfn","e0","e1","e2","e3","srat","esinp","exp","sign","adjust_lon","adjust_lat","latiso","NaN","POSITIVE_INFINITY","fL","L","invlatiso","Iphi","sinh","cosh","tanh","asinh","acosh","atanh","gN","temp","pj_enfn","en","C00","C02","C04","C06","C08","C22","C44","C46","C48","C66","C68","C88","pj_mlfn","sphi","cphi","pj_inv_mlfn","arg","cos","proj","X","Y","Z","Rn","Sin_Lat","Sin2_Lat","Cos_Lat","Longitude","Latitude","Height","Error_Code","P","RR","CT","ST","RX","RK","RN","CPHI0","SPHI0","CPHI","SPHI","SDPHI","iter","genau","genau2","maxiter","atan2","geocentric_to_geodetic_noniter","W","W2","T0","T1","S0","S1","Sin_B0","Sin3_B0","Cos_B0","Sin_p1","Cos_p1","Sum","At_Pole","Dx_BF","Dy_BF","Dz_BF","Rx_BF","Ry_BF","Rz_BF","M_BF","x_out","y_out","z_out","x_tmp","y_tmp","z_tmp","coords","toShortString","ellipseName","nadgrids","tmerc","ml0","lon","lat","delta_lon","sin_phi","cos_phi","acos","al","als","tq","ml","delta_phi","max_iter","f","g","h","tan_phi","d","ds","DEFAULT_EPSILON_IN_METER","Coord","equals","almostEquals","epsilonInMeter","distanceTo","utmkThis","asDefault","utmkOther","diff","xy","Type","PROJ","UTMK","valueOf","_projs","arg0","arg1","coord","LatLng","lng","Katech","Path","_coords","clear","_notifyListeners","getCoords","getAt","getLength","insertAt","last","removeAt","setAt","onChange","callbackFn","listener","_getEventListener","idx","ctxs","unsubscribeChange","_listeners","create","listeners","getFirst","getLast","getDistance","distance","getArea","area","coord1","coord2","getType","getCenteroid","sumX","sumY","center","getBounds","bottom","right","leftBottom","rightTop","Bounds","closedPath","dist","_distanceToSegment","x1","y1","x2","y2","segment","dx","dy","along","simplify","tolerance","firstPoint","lastPoint","pointIndexsToKeep","_douglasPeuckerReduction","returnPoints","sort","maxDistance","indexFarthest","_perpendicularDistance","point1","point2","height","getLeft","getBottom","getRight","getTop","getLeftTopCoord","getRightBottomCoord","getWidth","utmkBounds","getHeight","getCenter","intersects","_containsCoord","utmkCoord","intersection","union","_unionCoord","expand","width","zero","_zero","_add","subtract","_subtract","divideBy","_divideBy","multiplyBy","_multiplyBy","round","_floor","toCSSString","Size","full","_full","size","asPoint","tagName","element","Element","getProperty","setProperty","setProperties","properties","oldClassName","newClassName","forceReflow","clientWidth","addEventListener","attachEvent","removeEventListener","detachEvent","SpritedImage","position","backgroundColor","backgroundRepeat","_img","setImage","origin","scaledSize","backgroundImage","backgroundPosition","Timing","getCSSName","getBackwardCSSName","getFn","genFn","fx","timing","CubicBezier","f0","f1","f2","refinedT","refinedT2","refinedT3","slope","CubicBezierBasedTiming","_curve","Ease","EaseIn","EaseOut","EaseInOut","linear","Linear","ease","easeIn","easeOut","easeInOut","DEFAULT_DURATION","DEFAULT_TIMING","REPEAT_FOREVER","Animation","from","duration","repeat","comeback","pulse","newAnimator","Animator","NoAnimationAnimator","CSSAnimator","PulseAnimator","animate","start","animateSync","startSync","applyImmediately","Pulse","period","_jobs","initTime","stop","isPlaying","_af","startTime","_step","time","playTime","useAFTime","AnimatorBuffer","_animators","_timer","animator","flush","status","animatorBuffer","doInit","doCycle","doStop","doClean","stopRepeat","pause","doPause","resume","doResume","cancel","doCancel","abort","ignore","doIgnore","finishCycle","_styleName","_eventType","_bound_onTransitionend","_onTransitionend","_isForward","_listening","_clearEventFallback","_startTimestamp","_playedTimestamp","_receivedEvent","_startTransition","_pausedStyles","_styleCount","_eventFallback","_finish","stopPropagation","getPulse","_pulse","_lastStyle","setPulse","_attached","_bound_step","step","_from","_to","_detachPulse","_attachPulse","_applyStyle","RangeError","_lastTime","ll","fromOpt","toOpt","fromParam","toParam","percent","ceil","AnimationFrameQueue","_enabled","isEnabled","setEnabled","enabled","job","jobs","performance","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","DEFAULT_PHASE","Event","_name","_src","_stopPropagation","_stopImmediatePropagation","_defaultPrevented","eventPhase","pageXY","_point","_coord","_map","targetTouches","touches","changedTouches","originEvent","timeStamp","pageX","pageY","targetDOM","ownerDocument","doc","clientX","clientLeft","clientY","clientTop","getName","getSource","stopImmediatePropagation","preventDefault","getPoint","_getMap","rootXY","layerMgr","getViewportOffset","getCoord","viewportPx","getCoordFromViewportPx","hit","bubble","getBubble","Map","registerEvent","eventMgr","_getEventManager","registry","registerEventDom","registryDom","unregisterEventDom","unregistryDom","unregisterEvent","unregistry","getId","_id","payload","_handleFireEvent","lookupBubbles","results","eventName","capture","_findEventListener","$ctxs","propagateEvent","_getEventListeners","$fn","_eventListeners","_findEventListeners","phase","_eventMgr","defaultFn","path","_checkEvent","capturing","ex","$EVENTS","clazz","clazzPrototype","events","domEvent","cancelBubble","returnValue","isRightClick","which","button","checkEnabledKeyevent","activeElement","nodeName","EventManager","_root","_hitTargets","_recognizers","_desktopIE","_clicked","_layerMgr","_history","_addEventsListener","hackDOM","zIndex","_hackDOM","_mousewheel","_started","_removeEventsListener","delegator","findRecognizer","classname","addRecognizer","recognizer","Recognizer","removeRecognizer","names","handler","_ieHandler","handleEvent","domTarget","srcElement","_prevDomEvent","_domEvent","_prevActiveElement","_activeElement","domMousedownEvent","domMouseupEvent","domMousemoveEvent","domGenericEvent","domMouseoverEvent","domMouseoutEvent","domResizeEvent","parentElement","domKeyboardEvent","handleTouchEvent","hitTarget","relatedTarget","handleMapEvent","root","offsetWidth","clientHeight","offsetHeight","orientation","getSelection","empty","removeAllRanges","selection","focus","blur","prevEvent","_prevEvent","touch","prevDomEvent","_mousedown","identifier","setEnable","_opts","noevent","returnVal","noPointerEvents","noevents","layerMgrElem","_root_pane","_findAncestorNoEventDom","visibility","elementFromPoint","innerText","textContent","resultSrc","recognizeredEvent","resultEvent","handle","isMapClicked","_disabled","_EXCLUDES","handlerClass","EventDelegator","fnName","originHandleFn","backup","Corner","ctrls","vAlign","hAlign","horizontalArea","_createInnerDom","verticalArea","ControlManager","_ctrls","_corners","_defaultMargin","corner","corners","cornerClass","control","ctrlClass","Control","positions","TOP_LEFT","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_RIGHT","fragment","createDocumentFragment","getOptions","draw","_getCtrlClassName","ctrl","cn","mgr","option","setDrawn","_updatePosition","direction","cornerDOM","container","containerDOM","firstChild","_containerDOM","destroy","removeByClass","findByClass","removeAll","HORIZONTAL","VERTICAL","IMG_URL","padding","_isDrawn","initOptions","setPosition","setDirection","controlMgr","isDrawn","Plugin","layerType","Layer","_constructorOpts","label","group","setVisible","getPane","move","moveStart","moveEnd","mapStart","zoomStart","zoomEnd","oldZoom","newZoom","visible","isVisible","isVisibleForZoom","setActiveBaseLayer","getActiveBaseLayer","addLayer","removeLayer","getResolutionForZoom","zoom","defaultOpts","minZoom","maxZoom","maxExtent","panAnimDuration","zoomAnimDuration","useCSSTransform","LayerManager","_center","_zoom","_minZoom","_maxZoom","_mapElem","_viewportSize","_viewportOffset","_layerOffset","_pendingZoom","_pendingCenter","_isZooming","_baseLayers","_groundLayers","_activeBaseLayer","_overlayLayer","_transparent_pane","_layer_container","_panAnimTiming","_initPanes","layer_container","_createPane","transparent_pane","display","pane","layer","addBaseLayer","addGroundLayer","getLayer","layerName","getBaseLayers","getGroundLayers","getOverlayLayer","oldLayer","TileLayer","_hideLayerFn","minMaxZoomChanged","_updateMinMaxZoom","moveTo","setMinZoom","_updateZoomRange","setMaxZoom","mapMaxZoom","newMinZoom","newMaxZoom","getZoomForBounds","bounds","coordSize","_getCoordSizeForZoom","isValidCoord","_disableLoadingWhilePanning","getOption","_initialBounds","panAnimEaseLinearity1","panAnimEaseLinearity2","_zoomPulse","overlayLayer","panes","backgroundLayer","BackgroundLayer","_backgroundLayer","getResolution","getViewportSize","getViewportCenter","getLayerOffset","_getCoordOrigin","afterZoom","getPendingZoom","getPendingCenter","getViewportPxFromCoord","coordOrigin","getLayerPxFromCoord","getCoordFromLayerPx","layerPx","getLayerPxFromViewportPx","getViewportPxFromLayerPx","getZoom","getMinZoom","getMaxZoom","_getScaleForZoom","_getScaleForChanges","changeAmount","_getZoomForScale","LN2","setZoom","zoomIn","zoomOut","panToBounds","panTo","fitBounds","panBy","newCenter","calcNewCenter","_dx","_dy","animation","_moveRootPane","_getPositionStyles","_panRootPane","animationDuration","animationCallback","currentStyles","_rootPaneAnimator","_abortPanAnimationAndUpdateCenter","currentPosition","_moveLayers","_resetIdleTimer","setCenter","resize","horizontalRef","verticalRef","viewportSize","_viewportSizeChanged","_adjustCenter","restrictedExtent","centerBounds","_pinch_started","oldCenter","zoomChanged","centerChanged","forceDraw","useAnimation","panDuration","zoomDuration","_zoomEndReq","_setBounds","_drawLayers","_fireBoundsChangedEvent","_initialOriginLayerPx","_initialCenterLayerPx","initialCenterLayerPx","offsetPx","tempCoord","centerLayerPx","_zoomStartLayers","_triggerZoomEnd","_moveEndLayers","_moveStartLayers","_triggerZoomEnd2","_zoomTimer","_triggerZoomEnd3","_zoomEndLayers","_centerChanged","_zoomChanged","isZooming","_forEachLayers","_idle","fnString","setEditMode","editable","getMaxExtent","getRestrictedExtent","_idleTimer","__resetIdleTimer","_pane","_buffer","_onIdle","layerOffset","buffeSize","baseIndex","disableShadow","paneIds","OverlayLayer","paneId","_visible","_overlays","_displayedOverlays","_gridIndex","overlay","GridIndex","$current_bounds_changed","o","_updateSingleOverlayDisplayHint","$current_position_changed","getOverlays","overlayPanes","_toAddOverlaysAtZoomEnd","getPosition","erase","layerBoundsChanged","currentCenter","bufferBounds","_getBufferBounds","_onBoundsChanged","overlays","toAddOverlaysAtZoomEnd","isMapStart","_bounds","_updateAllOverlayDisplayHint","_getBufferSize","lm","buffer","overlaysAsArray","setDisplayHint","displayHint","cellSize","_cellSize","_grid","col","cell","range","_getCellRange","getIndexObject","minX","maxX","minY","maxY","xMax","yMax","oMax","gridX","gridY","PluginRegistry","_plugins","_drawingTools","getPlugins","getLabeledPluginsByGroup","plugins","pluginsByGroup","groupId","arrs","DEFAULT_MAX_EXTENT_LEFT","DEFAULT_MAX_EXTENT_BOTTOM","DEFAULT_MAX_EXTENT_RIGHT","DEFAULT_MAX_EXTENT_TOP","ROADMAP","SATELLITE","ENGMAP","DEFAULT_NORMAL_MAX_ZOOM","mapTypeId","trackWindowSize","disableDraggingCursor","draggingCursor","draggableCursor","disableLoadingWhilePanning","useEngMap","skeleton","_defaultOpts","_cursor","_cursors","_setUseEngMap","hasMobileStylesheet","_mapTypeRegistry","setMapTypeId","setCursor","_orientation","_useEngMap","getUseEngMap","registerMapType","mapTypePlugin","_mapTypeId","unregisterMapType","getMapTypeRegistry","oldMapTypePlugin","getMapTypeId","_warnZooming","_checkStart","cursor","resetCursor","checkDefaultControl","ctrlName","ctrlOpt","disableDefaultUI","defaultValue","mergeDefaultOptions","$default_resize","ref","getTooltip","_tooltip","Tooltip","Tile","setLayer","_animationPolicy","_loading","_layer","setEffectPolicy","animationPolicy","isLoading","_position","_getTileSize","normalMaxZoom","tileSize","tileSizeW","tileSizeH","getURL","_url","setPositionAndUrl","_update","img","tileAnimation","stopAnimator","cachedTileURLs","_animator","_fadedin","getElement","_bound_onload","_onload","_bound_onerror","_onerror","errorTileURL","isFinished","ERROR_TILE_URL","DEFAULT_TILE_SIZE","DEFAULT_MAX_WAIT_TIME","DEFAULT_UPDATE_INTERVAL","DEFAULT_BUFFER_NUM","DEFAULT_TILE_FADE_IN_DURATION","maxWaitTime","_tileQueue","_tiles","_movingBuffer","_createGridDiv","tileFadeInDuration","bufferNum","_updateInterval","getTileSize","_updateVisibility","_getLayerSize","gridNum","_gridNum","_getDisplayOffset","offset","_offset","_getTilePosition","_div","_removeTileFromArray","_getGridNum","_cleanup","dontCleanZoomingBuffer","_loadedTileNum","_unloadedTileNum","_stopUpdateTimer","_stopZoomAnimation","_cleanZoomingBufferDiv","_calculate","tileOrigin","tileCoordSize","coordOffset","tileLeftBottom","tile","tileInfo","tilePosition","tileUrl","oldTiles","tiles","later","unloadedTileNum","getTileURL","isMoving","_updateTimer","_shiftGrid","_cleanMovingBuffer","useBuffer","isUpdated","layerSize","bufferSize","displayOffset","_shiftCol","_shiftRow","tileCol","_shiftTile","oldTile","newTile","_appendTileLater","_zoomingScale","zoomingTiles","_stopCleanTimer","_zoomingTiles","_zoomingBufferDiv","_zoomWithTransform","_zoomWithoutTransform","zoomingBufferDiv","_zoomAnimator","_zoomAnimators","_cleanTimer","$capture_loaded","logoType","_OUT_OF_BOUND_TILE_URL","tileMaxBounds","OllehTileLayer","OUT_OF_BOUND_TILE_URL","_maxTileIndex","getMaxTileIndex","maxTileIndex","nomalMaxZoom","maxIndex","tileX","tileY","tileOpt","tileURLTmpl","_fillZero","useHD","oBase","copyright","DefaultComponents","setAirMap","setEngMap","setHybridMap","oHybrid","ollehHybridMapType","OllehHybridMapType","oAir","ollehAirMapType","OllehAirMapType","oEng","ollehEngMapType","OllehEngMapType","OllehTilesPlugin","SPEED_INFO","color","loadSpeed","TrafficInfoControl","tooltips","rdoms","speedInfos","imgDiv","_closeTrafficInfo","_openTrafficInfo","createTextNode","speedInfo","trafficBar","loadInfos","pointerEvents","tooltip","ul","loadInfo","li","infoElem","MobileTrafficInfoControl","trafficImg","_trafficImg","trafficLayer","trafficInfoControl","TrafficInfoPlugin","Overlay","_bubble","setOptions","isAdded","onAdd","onRemove","setBubble","MAX_ZINDEX","BaseOverlay","_drawn","_zIndex","_displayHint","elements","_moveAnimators","setZIndex","update","_updateZIndex","_display","forEachElement","getCurrentZIndex","_currentZIndex","getZIndex","_isFront","getAutoZIndex","bringToFront","resetZIndex","isRegistered","registerElement","appendElement","unregisterElement","removeElement","_currentStyles","appendElements","ready","cleanup","erased","_fadeInAnimation","getFadeInAnimation","_fadeInRequested","_fadeInFinished","_fadeInElement","_fadeOutAnimation","getFadeOutAnimation","_removeRequested","_removeFinished","_fadeOutElement","_onFadeInFinished","_onElementRemoved","stopAnimators","moveAnimators","updatePositioningStyles","animateTo","_finishedAnimation","_animationCallback","_animationCallbackCtx","_animationFinished","OverlayGroup","PointedOverlay","maxTopCoord","before","_currentLayerPx","getOriginalLayerPx","newPx","px","getCurrentLayerPx","$default_mouseover","$default_mouseout","DEFAULT_ICON","DEFAULT_MOBILE_ICON","DEFAULT_HD_ICON","DEFAULT_SHADOW","anchor","DEFAULT_MOBILE_SHADOW","DEFAULT_HD_SHADOW","DRAG_POINT","DRAG_FLOATING_PX","BOUNCE","DROP","bouncePulse","dropTiming","DropTiming","getBounceAnimator","isShadow","SQRT1_2","marginLeft","marginTop","Marker","getDropAnimator","_title","_flat","_draggable","_angle","icon","setIcon","angle","setAngle","shadow","setShadow","caption","setCaption","setTitle","draggable","setDraggable","flat","setFlat","setAnimation","_updateIcon","_updateAngle","_updateCursor","_updateShadow","_updateCaption","_updateAnimation","_infoWin","close","getIcon","_icon","_iconImg","iconDiv","_currentIcon","getAngle","getTitle","getCursor","getShadow","_shadowImg","_shadow","_shadowAnimator","_currentShadow","getCaption","_caption","span","_captionDiv","textAlign","fontSize","fontWeight","isFlat","isDraggable","isDragging","_isDragging","$capture_dragstart","dragImg","_dragImg","_float","_dragStart","$capture_drag","movementXY","_drag","$capture_dragend","_sink","_dragEnd","shadowD","_animation","getAnimation","stopAnimationImmediately","_iconAnimator","stopAnimation","setInfoWindow","infoWin","pos","setContent","setPixelOffset","open","ContentOverlay","_defaultCss","_defaultPadding","_body","_marginPx","_topleftPx","pixelOffset","_contentAttacted","contentSize","minWidth","minHeight","maxWidth","maxHeight","$default_detached","_eliminateElements","_setMaxWidth","_setPadding","content","_updateContent","contentElem","_updateElements","beforeContent","getContent","_updateMargin","_updateBounds","getPixelOffset","createBodyElem","createShadowElem","domutil","_checkContentSize","_topLeftPx","topLeftPoint","optsContent","rootElem","_appendEvent","oldBounds","topleft","s_topleft","s_leftBottom","s_rightTop","shadowBounds","bm","sm","pDiv","iDiv","contentPadding","dbContentPadding","margin","overflow","infopane","disableCloseButton","closeElem","AUTO_PAN_MARGIN","BaseInfoWindow","_anchor","_anchorOffset","$default_attached","disableAutoPan","_autoPan","$capture_click","$default_click","_optsPosition","markerIcon","markerShadow","_setPosition","bodyUpPoint","shadowUpPoint","_dragUpPoint","deltaPoint","BaseInfo","tPoint","centerPoint","viewSize","viewHalfOfWidth","viewHalfOfHeight","viewTopLeft","viewBottomRight","infoData","_calInfoData","infoPos","infoSize","infoTopLeft","topLeft","infoBottomRight","bottomRight","moveX","moveY","infoTopTypePoint","infoBottomTypePoint","isMoveX","isMoveY","checkInfoSize","isLongerThanView","isHigherThanView","checkInfoPos","isLeftOfCenter","isTopOfCenter","URL","SHADOW_URL","INFO_URL","CLOSE_URL","BORDER","TIP_POS_RATE","TIP_POS_MAXLEFT","TIP_HEIGHT","TIP_NOVIEW_HEIGHT","SHADOW_LEFT_HYPOTENUSE","SHADOW_RIGHT_HYPOTENUSE","SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP","SHADOW_IMG_TIP_GAP","SHADOW_IMG_TIP_WIDTH","SHADOW_IMG_TOP_HEIGHT","SHADOW_IMG_TOP_WIDTH","SHADOW_IMG_BOTTOM_HEIGHT","SHADOW_IMG_BOTTOM_WIDTH","SHADOW_IMG_LEFTTOP_WIDTH","SHADOW_IMG_RIGHTTOP_WIDTH","SHADOW_IMG_LEFTBOTTOM_WIDTH","SHADOW_IMG_RIGHTBOTTOM_WIDTH","SHADOW_IMG_LEFTBOTTOM_W_PADDING","INFO_TMPL","INFO_SHADOW_TMPL","InfoWindow","infoBodyWidth","infoBodyHeight","infoWidth","infoHeight","infoPosY","tipleftPos","infoleftofTip","infoPosX","infoTopofTip","infoDiv","closeUrl","infoUrl","contentMaxWidth","contentWidth","contentHeight","bodyWidth","bodyHeight","shadowHeight","shadowWidth","shadowInfoLeftofTip","shadowPosY","shadowPosX","infoShadowDiv","middleLeftHSize","topCenterWSize","bottomLeftTipWSize","bottomRightTipWSize","bottomLeftPoint","bottomLeftOfTipPoint","bottomLeftOfTipWidth","bottomTipPoint","bottomRightOfTipPoint","bottomRightOfTipRightWidth","bottomRightPoint","middleLeftWidth","middleLeftPoint","middleLeftSize","middleLeftImgLeftPx","middlePoint","middleSize","middleRightPoint","middleRightSize","middleRightImgLeftPx","topCenterPoint","topCenterWidth","topRightPoint","bottomLeftPointX","bottomLeftPointY","bottomRightPointX","bottomRightPointY","bottomTipPointX","bottomTipPointY","topCenterPointX","topCenterPointY","middleLeftPointX","middleLeftPointY","middleLeftHeight","middleRightPointX","middleRightPointY","middleRightWidth","middleRightHeight","bottomLeftOfTipPointX","bottomLeftOfTipPointY","bottomRightOfTipPointX","bottomRightOfTipPointY","middlePointX","middlePointY","middleWidth","middleHeight","TOOLTIP_TMPL","contentMaxHeight","_calTooltipPosition","viewBounds","radius","_calRadiusOfAnchor","mIcon","_isOpenOptions","_openOptions","options","ProjectedOverlay","_opacity","_fadeIn","_fadeOut","setBounds","setOpacity","fadeIn","setFadeIn","fadeOut","setFadeOut","_updateOpacity","_currentScale","getOriginalSize","getOpacity","isFadeIn","isFadeOut","originalSize","originalLayerPx","leftBottomPx","rightTopPx","getCurrentScale","setURL","GroundOverlay","_updateURL","$default_mousemove","rendererName","editHandlerRegistry","Vector","_editable","_element","_eventDom","_renderer","_getDefaultOptions","_updateVisiblity","createRenderer","getRendererFactory","_doDraw","getRootElement","getContainer","eventDom","getEventDom","_attachEditHandler","_detachEditHandler","setEditable","isEditable","_editHandler","refresh","editHandlerClass","editHandler","_convertPathToPoints","points","Polygon","paths","getPaths","setPaths","existingPaths","pointsArray","fillColor","fillOpacity","fillRule","strokeColor","strokeOpacity","strokeWeight","Polyline","setPath","getPath","icons","Rectangle","leftTopPx","widthPx","heightPx","strokePosition","Circle","getRadius","centerPx","radiusPx","setCenterAndRadius","setRadius","center_","prepareToDraw","ContainerRenderer","createContainer","PathRenderer","lineTo","circle","cx","cy","closePath","commit","PolylineRenderer","RectangleRenderer","leftTop","CircleRenderer","PolygonRenderer","BaseRenderer","createElementNS","tag","svg","Renderer","strokeDasharray","weight","strokeLinecap","strokeLinejoin","strokeStyle","_strokeDashArray","_initCommand","_command","_svgElem","use3d","curX","curY","polyline","preX","preY","unselectable","vml","_containerElem","stroked","_stroke","endcap","joinstyle","dashStyle","filled","_fill","_updateSize","_width","_height","coordsize","_translateX","_translateY","_union","command","_toCommandStr","startX","startY","_getPoints","rightBottom","weightFactor","canvas","canvasElem","_padding","lineCap","lineJoin","_updateStyle","save","fillStyle","globalAlpha","fill","lineWidth","stroke","restore","_updateCanvas","padding2","rootWidth","rootHeight","translate","beginPath","arc","createPolylineRenderer","createPolygonRenderer","createRectangleRenderer","createCircleRenderer","createContainerRenderer","_containerRenderer","createPathRenderer","VectorLayer","_vectors","_rendererFactory","RendererFactory","_zoomAnim","_isVisible","_ensureStopAnimation","drawAll","defaultType","_eraseAll","getVectors","_container","EditHandler","getTarget","VectorPlugin","Quickhull","getDistant","cpt","bl","findMostDistantPointFromBaseLine","baseLine","maxD","maxPt","newPoints","buildConvexHull","convexHullBaseLines","maxPoint","getConvexHull","minPt","MIN_VALUE","MAX_VALUE","DEFAULT_FONT_SIZE","DEFAULT_FONT_COLOR","DEFAULT_AREA_STYLE","DEFAULT_ICON_FN","MARKER_ANIMATE_DURATION","MarkerCluster","_clickToExpand","_clickToZoom","_displaySize","_fontSize","_fontColor","_displayArea","_areaStyle","_iconFn","_areaPath","_originMap","_area","_children","_size","isExpanded","resetPosition","setResetPosition","clickToZoom","setClickToZoom","clickToExpand","setClickToExpand","displaySize","setDisplaySize","setFontSize","fontColor","setFontColor","displayArea","setDisplayArea","areaStyle","setAreaStyle","iconFn","setIconFn","isVisibleAtZoom","isResetPosition","_resetPosition","isClickToZoom","isClickToExpand","isDisplaySize","_sizeDiv","getSize","getFontSize","getFontColor","isDisplayArea","hideArea","getAreaStyle","getIconFn","paddingTop","child","_invalidate","depth","areaAdded","showArea","markers","getAllMarkers","getChildren","getMarkers","expandToDepth","rootPx","_markerOnAdd","_clusterOnRemove","_onMapClick","expandToZoom","collapse","_markerOnRemove","_clusterOnAdd","markerCoords","pathCoords","convexHull","_clusterReady","MarkerClusterer","_clusterOpts","clusterOpts","_gap","gap","_getDistance","defaultGetDistance","_getThreshold","getThreshold","defaultGetThreshold","_afterCluster","afterCluster","_displayed","_bound_onClusterPositionChanged","_onClusterPositionChanged","_rootCluster","_index","marker","otherMarker","grandparent","sibling","_removeFromIndex","_addToIndex","cluster","closest","_getClosest","meter","threshold","minDistance","_getAdjustedZoom","_onboundschanged","_updateZoom","_expand","_collapse","oldMarkers","newMarkers","_recursevely","_hideNonDisplayedMarkers","childCnt","Drag","_startEvent","_isDragStart","_xy","mousedown","mouseup","_reset","mousemove","startEvent","prevXY","click","touchstart","touchmove","touchend","dragInertia","dragInertiaThreshold","dragInertiaDeceleration","_zeroPoint","$default_dragstart","_times","_points","$default_drag","$default_dragend","prevTime","momentum","_momentum","easeLinearity","inertiaDeceleration","speedVector","speed","deccelerationDuration","_calcZoomCenter","mousePx","viewportCenter","centerOffsetPx","newCenterPx","_checkZoomLevel","$default_req_zoomin","$default_req_zoomout","$default_dblclick","disableDoubleClickZoom","Zoom","$default_dblrightclick","HANDLERS","handlers","DefautlHandlers","DoubleClickZoom","DoubleClick","isDblclicked","clickThreshold","dblrightclick","clickDuration","prevClick","RightClick","ScrollWheelZoom","_timeStamp","mousewheel","delta","wheelDelta","detail","KeyboardZoom","keydown","keyCode","$capture_mousedown","$default_mousewheel","$default_keydown","moveSize","_keymoveX","_keymoveY","_moveTimeout","_keyboardMoveStart","_keyboardMove","$default_keyup","_ok","$current_dragstart","shiftKey","_boxZoomElem","_dragStartPosition","_boxZoomStart","divStyle","$current_drag","dragStartPx","$current_dragend","Desktop","BoxZoom","Keyboard","CONTENT","CopyrightControl","activeBaseLayer","LogoControl","_updateActiveBaseLayer","mode","ScaleControl","scaleImg","scaleStr","topOutUnits","topInUnits","res","topUnits","inches","maxSizeData","numTopMax","toFixed","SLIDE_FACTOR","PAN_INFO","PanControl","panBtns","btn","panInfos","pan","_pressTimeout","panupBtn","pandownBtn","panleftBtn","panrightBtn","_panMoveStart","_panMove","DEFAULT_MAP_TYPE","MapTypeControl","_btnList","_changeButtonState","_click","typeId","list","classKey","_onMapTypeIdChanged","DEFAULT","LARGE","SMALL","ZOOM_INFO","ZoomControl","_gradation","_drawSmallZoom","_drawBigZoom","_addZoomBtn","_btnY","_resetMinMaxZoom","_drawZoomInfo","_addAbsoluteImgBtn","_drawZoomBar","zoomoutBtn","_updateSlider","zoomslider","_hideZoomInfo","activeBar","_activeBar","deactiveBar","_deactiveBar","levels","_updateZoomInfo","zoomBarInfo","_setZoom","_updateZoomLevelInfo","sliderOffset","sliderPosition","_showZoomInfo","dragstart","drag","dragend","dragFlag","crTop","initPt","action","zoominBtn","_interval","setInterval","PluginControl","_redrawItems","_hideExpand","_drawExpandType","expandBtn","form","_drawItems","childs","groups","_drawList","_drawSeparator","$nogroup","separator","_drawChild","html","checked","_showExpand","_expanded","imgLoc","IMG_LOCATION","imgURLS","IMG_URLS","_dButtonList","akey","panControl","logoControl","scaleControl","mapTypeControl","zoomControl","DesktopControlsPlugin","measureControl","MeasureControl","measureDistancePlugin","measure","MeasureDistancePlugin","measureAreaPlugin","MeasureAreaPlugin","measureOverlay","_measureOverlays","measureDistance","measureArea","measureOverlays","MeasureService","deleteOrigin","pointOrigin","_onClick","_onRightClick","_measureOverlayGroup","inProgressPath","inProgressVector","pointIcon","_createPointIcon","pointInfo","MeasureOverlay","addPointIcon","addPointInfo","_createVector","detailInfo","_createInProgressVector","MeasureOverlayGroup","measureService","_onMove","setDistance","removeInProgressVector","finish","_createDeleteMarker","measureOverlayGroup","deleteMarker","setDeleteMarker","_onStateChanged","distanceImg","_distanceImg","areaImg","_areaImg","clearImg","_clearImg","pointInfos","pointIcons","boxShadow","_updateAreaInfo","_updatePointStart","_updatePointInfo","_updatePointDetail","imgUrl","_updateFinalAreaInfo","areaHtml","_getArea","distLabel","_distValue","walkLabel","_walkValue","bikeLabel","_bikeValue","_rightButtonToFinish","_updateFinalDistanceInfo","paddingBottom","valueHtml","_getTimeHtml","distOrArea","_getTime","DrawCircle","circleOpts","_onDragStart","_onDragEnd","_complete","_circle","vectorLayer","_onDrag","_createCircle","DrawPolygon","polygonOpts","_onDblClick","_prevCoord","_polygon","_completePoint","_onMouseMove","DrawPolyline","polylineOpts","_finishDrawing","_dblClickCoord","_polyline","_inprogressLine","DrawRectangle","rectangleOpts","_rectangle","_createRectangle","_startCoord","DrawingControl","drawing","circleImg","_circleImg","borderWidth","borderStyle","borderColor","rectangleImg","_rectangleImg","polylineImg","_polylineImg","polygonImg","_polygonImg","handImg","_handImg","drawPolyline","drawPolygon","drawRectangle","drawCircle","DrawingService","editingPlugin","EditingPlugin","controlOpts","editOpts","activation","_onclick","_activateAllVector","vectors","_deactivateAllVector","_activeEditTarget","_draggableVertices","_draggableVertices2","_getPaths","existing","vertex","PathEditingHandle","_onChanging","existing2","AddVertexHandle","_centerHandle","EditingHandle","_onCenterDrag","draggableVertices","EditPolyline","rectangle","_leftTopHandle","_rightTopHandle","_rightBottomHandle","_leftBottomHandle","oppositePoint","EditRectangle","EditPolygon","threeClock","_onRadiusDrag","_radiusHandle","EditCircle","defaultStyles","_path","_setOptions","prevIndex","newPoint","render","_vm","_h","$createElement","_c","_self","staticRenderFns","attrs","methods","initMap","mounted","component","components","KtMap"],"sourceRoot":""}