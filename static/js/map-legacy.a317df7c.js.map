{"version":3,"file":"static/js/map-legacy.a317df7c.js","mappings":"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","sources":["webpack://front-end/./node_modules/core-js/modules/es.string.sup.js","webpack://front-end/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://front-end/./node_modules/@babel/runtime/helpers/typeof.js","webpack://front-end/./src/map/ktmap-all-desktop.js","webpack://front-end/./src/views/MapAnalysisView.vue?2e7e","webpack://front-end/./src/components/maps/KtMap.vue?1c19","webpack://front-end/src/components/maps/KtMap.vue","webpack://front-end/./src/components/maps/KtMap.vue?b89c","webpack://front-end/./src/components/maps/KtMap.vue","webpack://front-end/src/views/MapAnalysisView.vue","webpack://front-end/./src/views/MapAnalysisView.vue?676a","webpack://front-end/./src/views/MapAnalysisView.vue"],"sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar createHTML = require('../internals/create-html');\nvar forcedStringHTMLMethod = require('../internals/string-html-forced');\n\n// `String.prototype.sup` method\n// https://tc39.es/ecma262/#sec-string.prototype.sup\n$({ target: 'String', proto: true, forced: forcedStringHTMLMethod('sup') }, {\n  sup: function sup() {\n    return createHTML(this, 'sup', '', '');\n  }\n});\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\n\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","/*\n * KT Map JavaScript API v3.0.44\n * \n * Copyright (c) 2013-2018 kt corp. All rights reserved.\n * \n * This is a proprietary software of kt corp, and you may not use this software\n * except in compliance with license agreement with kt corp. Any redistribution\n * or use of this software, with or without modification shall be strictly\n * prohibited without prior written approval of kt corp, and the copyright\n * notice above does not evidence any actual or intended publication of such\n * software.\n */\ndocument.write('<style type=\"text/css\">.ollehmap *,.ollehmap :after,.ollehmap :before{box-sizing:content-box;-webkit-box-sizing:content-box;-moz-box-sizing:content-box}.ollehmap{position:relative;overflow:hidden;padding:0;margin:0;border:none;background-color:#EEE;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ollehmap-noevent{pointer-events:none!important}.ollehmap-event{pointer-events:auto}.ollehmap-drag .ollehmap-info,.ollehmap-drag .ollehmap-info-shadow{opacity:.3}.ollehmap-dragging{z-index:357913941!important}.ollehmap-vector{pointer-events:visiblePainted}.ollehmap-info{position:absolute}.ollehmap-info-defaultStyle{font-family:Dotum,Baekmuk Dotum,Undotum,Apple Gothic,Latin font,sans-serif;font-size:12px;font-weight:400;line-height:normal;font-style:normal}.ollehmap-info-area{cursor:default;position:relative;left:0;top:0;background-color:#fff;border:2px solid #474747}.ollehmap-info-content{cursor:auto;position:absolute;min-height:60px;min-width:300px;max-height:500px;z-index:9999;-webkit-user-select:text;-khtml-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ollehmap-info-content-overflow{overflow:auto;-webkit-overflow-scrolling:auto}.ollehmap-info-tip{width:16px;height:26px;overflow:hidden;z-index:1;position:absolute}.ollehmap-info-tip-img{position:absolute;border:0;padding:0;margin:0;top:-348px;left:0;z-index:auto}.ollehmap-info-bottom{position:absolute;left:0;top:0;border:2px solid #474747}.ollehmap-info-shadow{position:absolute}.ollehmap-info-shadow>div{overflow:hidden;position:absolute;z-index:1;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ollehmap-info-shadow img{position:absolute;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:0;padding:0;margin:0}.ollehmap-info-shadow-topleft,.ollehmap-info-shadow-topright{top:0;width:70px;height:10px}.ollehmap-info-shadow-topleft>img{left:-296px;top:0}.ollehmap-info-shadow-topright>img{left:-1036px;top:0}.ollehmap-info-shadow-bottomleft,.ollehmap-info-shadow-bottomright{width:70px;height:30px}.ollehmap-info-shadow-bottomleft>img{left:12px;top:-315px}.ollehmap-info-shadow-bottomright>img{left:-716px;top:-315px}.ollehmap-info-shadow-bottomtip{width:40px;height:30px}.ollehmap-info-shadow-bottomtip>img{left:-356px;top:-315px}.ollehmap-info-shadow-topcenter{height:10px}.ollehmap-info-shadow-topcenter>img{left:-366px;top:0}.ollehmap-info-shadow-centerleft>img{top:-10px}.ollehmap-info-shadow-centerright>img{top:-10px}.ollehmap-info-shadow-bottomleftoftip,.ollehmap-info-shadow-bottomrightoftip{height:30px}.ollehmap-info-shadow-bottomleftoftip>img,.ollehmap-info-shadow-bottomrightoftip>img{left:-396px;top:-315px}.ollehmap-info-shadow-center>img{left:-366px;top:-10px}.ollehmap-info-tooltip-area{position:relative;background-color:#fff;left:0;top:0;border:1px solid #555;border-radius:2px}.ollehmap-info-tooltip-data{font-family:Dotum,Baekmuk Dotum,Undotum,Apple Gothic,Latin font,sans-serif;font-size:13px;font-weight:700;line-height:normal;font-style:normal}.ollehmap-corner-container{position:relative}.ollehmap-corner-container-horizontal{display:inline-block}.ollehmap-corner{position:absolute;z-index:1}.ollehmap-corner-area{position:relative;display:inline-block}.ollehmap-control-rightAlign{margin-left:auto;margin-right:0}.ollehmap-copyright-control{color:#000;font:700 12px/1.5 Dotum,Arial,Helvetica,sans-serif;text-shadow:-1px 0 white,0 1px white,1px 0 white,0 -1px #fff;display:inline}.ollehmap-logo-control,.ollehmap-logo-control.imagery{background-position:-78px -316px;width:22px;height:22px;margin:0 8px 12px 2px}.ollehmap-logo-control.imagery{background-position:-100px -316px}.ollehmap-maptype-control-expandtype{padding:6px;margin:6px;box-shadow:0 1px 7px #999;border:1px solid #000;background-color:#fff;border-radius:8px;-moz-border-radius:8px;font:12px/1.5 \"Helvetica Neue\",Arial,Helvetica,sans-serif;color:#000;opacity:.8}.ollehmap-maptype-control-expandtype:hover{opacity:1}.ollehmap-maptype-control-expandtype .ollehmap-maptype-control-toggle{display:block;width:27px;height:27px}.ollehmap-maptype-control-expanded .ollehmap-maptype-control-toggle,.ollehmap-maptype-control-expandtype .ollehmap-maptype-control-list{display:none}.ollehmap-maptype-control-expanded .ollehmap-maptype-control-list{display:block}.ollehmap-maptype-control-expanded .ollehmap-maptype-control-separator{height:0;border-top:1px solid #000;margin:5px -6px}.ollehmap-scale-control{background-repeat:no-repeat;background-position:bottom;color:#000;font:11px Dotum,Arial,Helvetica,sans-serif;font-weight:700;text-shadow:-1px 0 white,0 1px white,1px 0 white,0 -1px #fff;text-align:center;margin-bottom:12px}.ollehmap-scale-image{width:46px;height:8px;border:2px solid #000;border-top:none;margin-top:-4px}.ollehmap-scale-image.imagery{border-color:#fff}.ollehmap-zoom-control{position:relative;width:26px}.ollehmap-zoom-control .highlighted{border:1px dashed red}.ollehmap-hidden{display:none!important}.ollehmap-traffic-control{opacity:.8;padding:6px;margin:6px;box-shadow:gray 0 1px 7px;background-color:#fff;border-radius:8px;font-size:11px;font-family:Dotum,sans-serif;letter-spacing:-1px;text-align:left}.ollehmap-traffic-control .imgDiv{height:26px}.ollehmap-traffic-control:hover{opacity:1}.ollehmap-traffic-control .tooltip{position:absolute;top:50px;width:142px}.ollehmap-traffic-control h1{color:#1065ac;font-size:11px;margin:6px}.ollehmap-traffic-control ul{padding:5px;margin:5px 0;list-style-position:inside}.ollehmap-traffic-control li{line-height:15px}.ollehmap-traffic-control .trafficbar{width:55px;height:8px;display:inline-block;padding:1px 0}.ollehmap-traffic-control .trafficbar:hover{padding:0;width:53px;border:1px solid #444}.control-zoombar-active{background-position:0 0;width:26px;height:180px}.control-zoombar-deactive{background-position:-26px 0;width:26px;height:180px}.control-traffic-info{background-position:0 -180px;width:142px;height:63px}.control-pan{background-position:-52px 0;width:60px;height:63px}.control-zoomout{background-position:-112px 0;width:26px;height:26px}.control-zoomin{background-position:-112px -26px;width:26px;height:26px}.control-distance-selected{background-position:-112px -52px;width:26px;height:25px}.control-distance-out{background-position:-52px -63px;width:26px;height:25px}.control-shape-out{background-position:-78px -63px;width:26px;height:25px}.control-shape-selected{background-position:-104px -77px;width:26px;height:25px}.control-change:hover{background-position:-52px -88px;width:26px;height:24px}.control-change{background-position:-78px -88px;width:26px;height:24px}.control-roadmap-out{background-position:-52px -112px;width:55px;height:22px}.control-roadmap-selected{background-position:-52px -156px;width:55px;height:22px}.control-hybrid-out{background-position:0 -265px;width:75px;height:22px}.control-hybrid-selected{background-position:-52px -134px;width:75px;height:22px}.control-satellite-out{background-position:0 -243px;width:55px;height:22px}.control-satellite-selected{background-position:-55px -243px;width:55px;height:22px}.control-engmap-out{background-position:0 -335px;width:55px;height:22px}.control-engmap-selected{background-position:-55px -335px;width:55px;height:22px}.control-measure-distance-start{background-position:-75px -265px;width:37px;height:21px}.control-measure-area-delete{background-position:-107px -112px;width:18px;height:17px}.control-measure-distance-delete{background-position:-107px -156px;width:18px;height:17px}.control-measure-redmouse{background-position:-112px -254px;width:11px;height:16px}.control-measure-bluemouse{background-position:-124px -254px;width:11px;height:16px}.control-level1{background-position:-75px -286px;width:39px;height:15px}.control-level5{background-position:0 -287px;width:39px;height:15px}.control-level3{background-position:-39px -301px;width:39px;height:15px}.control-level13{background-position:-78px -301px;width:39px;height:15px}.control-level11{background-position:0 -302px;width:39px;height:15px}.control-level8{background-position:-39px -316px;width:39px;height:15px}.control-panleft{background-position:-104px -63px;width:8px;height:13px}.control-panright{background-position:-130px -77px;width:8px;height:13px}.control-panleft:hover{background-position:-130px -90px;width:8px;height:13px}.control-panright:hover{background-position:-125px -112px;width:9px;height:12px}.control-area-icon{background-position:-127px -134px;width:11px;height:11px}.control-distance-icon{background-position:-127px -145px;width:11px;height:11px}.control-zoomslider{background-position:-110px -243px;width:20px;height:11px}.control-scale{background-position:-78px -332px;width:54px;height:10px}.control-panup:hover{background-position:-125px -156px;width:12px;height:10px}.control-panup{background-position:-125px -166px;width:12px;height:10px}.control-pandown:hover{background-position:-125px -124px;width:12px;height:9px}.control-pandown{background-position:-130px -243px;width:12px;height:9px}.control-traffic-bullet{background-position:-138px 0;width:4px;height:1px}.control-gauge{background-position:-130px -103px;width:8px;height:1px}.infowin-shadow{background-position:0 0;width:1068px;height:347px}.infowin-tip{background-position:0 -347px;width:18px;height:25px}.infowin-close{background-position:-18px -347px;width:13px;height:13px}.olleh-maps-inline{display:inline-block;margin-left:3px}.ollehmap-measure{background:#fff;white-space:nowrap;width:auto;border:1px solid;position:absolute;font-family:dotum}.ollehmap-measure strong{color:#df2428;font-weight:700}.ollehmap-measure-areaInfo{padding:8px;font-size:11px;border:1px solid #555;background:#F7F7F7;color:#333;white-space:normal;width:110px;margin-top:-63px;margin-left:30px}.ollehmap-measure-finalAreaInfo{padding:10px;font-size:12px;font-weight:700;border:1px solid;color:#333;margin-top:-49px;margin-left:30px}.ollehmap-measure-pointStart{border:1px solid #BC1437;color:#fff;background:#E02428;font-size:12px;font-weight:700;padding:5px}.ollehmap-measure-pointInfo{border:1px solid #DF2428;color:#333;background:#F9F9F9;font-size:12px;font-weight:400;padding:5px}.ollehmap-measure-pointDetail{font-size:12px;border:1px solid #555;padding:10px 10px 55px;color:#333;width:130px;margin-top:-135px;margin-left:30px}.ollehmap-measure-pointDetail1{float:left;clear:left;width:60px;font-weight:700}.ollehmap-measure-pointDetail2{float:left;width:70px;font-weight:700}.ollehmap-measure-finish{padding:8px 19px;background:#F7F7F7;border-top:1px solid #DBDBDB;position:absolute;left:0;bottom:0;right:0;font-size:11px;white-space:normal}</style><style type=\"text/css\">.ollehmap{cursor:default}.ollehmap-boxzoom{position:absolute;background-color:#fff;opacity:.5;border:2px dotted red;width:0;height:0}.ollehmap-transparent{background-color:#fff;opacity:0}.ollehmap-control-clickable{cursor:pointer}.ollehmap-info-close{position:absolute;width:14px;height:14px;overflow:hidden;right:18px;top:13px;z-index:10000;cursor:pointer}.ollehmap-info-close-img{position:absolute;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:0;padding:0;margin:0;top:-346px;left:-51px}</style><!--[if lte IE 8]><style type=\"text/css\">.ollehmap-vml{behavior:url(#default#VML);position:absolute}.ollehmap-boxzoom{-ms-filter:\"alpha(Opacity=50)\";filter:alpha(opacity=50)}.ollehmap-transparent{-ms-filter:\"alpha(Opacity=0)\";filter:alpha(opacity=0)}.ollehmap-corner-area{margin:1px}.ollehmap-maptype-control-expandtype>form{height:100%;padding:0;margin:0}.ollehmap-measure-pointDetail{width:135px}.ollehmap-measure-areaInfo{width:120px}</style><![endif]-->');\n!function (GLOBAL) {\r\n  if (!Date.now) {\r\n    Date.now = function () {\r\n      return +(new Date);\r\n    };\r\n  }\r\n  \r\n  if (!Function.prototype.bind) {\r\n    Function.prototype.bind = function (oThis) {\r\n      if (typeof this !== 'function') {\r\n        throw new TypeError('Bind must be called on a function');\r\n      }\r\n      \r\n      var aArgs = Array.prototype.slice.call(arguments, 1);\r\n      var fToBind = this;\r\n      var fNOP = function () {};\r\n      var fBound = function () {\r\n        return fToBind.apply(this instanceof fNOP && oThis ? this : oThis, \r\n            aArgs.concat(Array.prototype.slice.call(arguments)));\r\n      };\r\n      fNOP.prototype = this.prototype;\r\n      fBound.prototype = new fNOP();\r\n      return fBound;\r\n    };\r\n  }\r\n  \r\n  if (!GLOBAL.requestAnimationFrame) {\r\n    GLOBAL.requestAnimationFrame = GLOBAL.webkitRequestAnimationFrame\r\n      || GLOBAL.mozRequestAnimationFrame\r\n      || GLOBAL.msRequestAnimationFrame\r\n      || GLOBAL.oRequestAnimationFrame;\r\n  }\r\n\r\n  if (!GLOBAL.cancelAnimationFrame) {\r\n    GLOBAL.cancelAnimationFrame = GLOBAL.cancelRequestAnimationFrame\r\n      || GLOBAL.webkitCancelAnimationFrame\r\n      || GLOBAL.webkitCancelRequestAnimationFrame\r\n      || GLOBAL.mozCancelAnimationFrame\r\n      || GLOBAL.mozCancelRequestAnimationFrame\r\n      || GLOBAL.msCancelAnimationFrame\r\n      || GLOBAL.msCancelRequestAnimationFrame\r\n      || GLOBAL.oCancelAnimationFrame\r\n      || GLOBAL.oCancelRequestAnimationFrame;\r\n  }\r\n  \r\n  if (!GLOBAL.requestAnimationFrame || !GLOBAL.cancelAnimationFrame) {\r\n    GLOBAL.requestAnimationFrame = function (callback) {\r\n      return GLOBAL.setTimeout(callback.bind(undefined, +Date.now()), 17);\r\n    };\r\n    GLOBAL.cancelAnimationFrame = function (requestid) {\r\n      window.clearTimeout(requestid);\r\n    };\r\n  }\r\n\r\n} (window);/**\r\n * @name olleh Maps\r\n * @version 3\r\n * @author KT\r\n * @copyright (c) 2013 KT Corp.\r\n * @fileoverview\r\n */\r\n!function (GLOBAL) {\r\n  \r\n  var indexOf = [].indexOf || function(elem) { // ie 9 support .\r\n    for (var i = 0, len = this.length ; i < len; i++ ) {\r\n      if ( this[i] === elem ) return i;\r\n    }\r\n    return -1;\r\n  };\r\n  \r\n  // Mapping of normalized type names for olleh.maps.typeOf()\r\n  var _OBJ2TYPE = {\r\n    '[object Boolean]'  : 'boolean',\r\n    '[object Number]'   : 'number',\r\n    '[object String]'   : 'string',\r\n    '[object Function]' : 'function',\r\n    '[object Object]'   : 'object',\r\n    '[object Array]'    : 'array',\r\n    '[object Date]'     : 'date',\r\n    '[object RegExp]'   : 'regexp',\r\n    '[object Error]'    : 'error'\r\n  };\r\n  \r\n  if (!GLOBAL.olleh) {\r\n    GLOBAL.olleh = {};\r\n  }\r\n  \r\n  /**\r\n   *  .       .\r\n   * @name olleh.maps\r\n   * @namespace \r\n   */\r\n  \r\n  /**\r\n   * @lends olleh.maps\r\n   */\r\n  GLOBAL.olleh.maps = {\r\n    \r\n    /**\r\n     * Normalize typeof        \r\n     *  .( ,   null JavaScript \r\n     * typeof  'object'  olleh.maps.typeOf \r\n     * 'null' )\r\n     * <p/>\r\n     * Normalize JavaScript   \r\n     * <pre>\r\n     *   ARRAY:       'array'\r\n     *   BOOLEAN:     'boolean'\r\n     *   DATE:        'date'\r\n     *   ERROR:       'error'\r\n     *   FUNCTION:    'function'\r\n     *   NUMBER:      'number'\r\n     *   NULL:        'null'\r\n     *   OBJECT:      'object'\r\n     *   REGEXP:      'regexp'\r\n     *   STRING:      'string'\r\n     *   UNDEFINED:   'undefined'\r\n     * </pre>\r\n     * @example\r\n     * olleh.maps.typeOf('foo'); // 'string'\r\n     * olleh.maps.typeOf(123); // 'number'\r\n     * olleh.maps.typeOf([]); // 'array'\r\n     * olleh.maps.typeOf({}); // 'object'\r\n     * olleh.maps.typeOf(null); 'null'\r\n     * olleh.maps.typeOf(new Date); // 'date'\r\n     * olleh.maps.typeOf(true); // 'boolean'\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {String} Normalize JavaScript ()\r\n     */\r\n    typeOf: function (obj) {\r\n      return _OBJ2TYPE[Object.prototype.toString.call(obj)]\r\n          || (obj ? 'object' : obj === null ? 'null' : 'undefined');\r\n    },\r\n    \r\n    /**\r\n     *       true/false .\r\n     * @example\r\n     * olleh.maps.isArray([]); // true\r\n     * olleh.maps.isArray({}); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @param {Boolean} relaxed      \r\n     * (,  )\r\n     * @returns {Boolean}    true  \r\n     *   false .\r\n     */\r\n    isArray: function (obj, relaxed) {\r\n      if (!relaxed) {\r\n        return Array.isArray && (Array.isArray(obj)) || this.typeOf(obj) === 'array';\r\n      } else {\r\n        // Handles arrays inheritance and arrays from external frame/window\r\n        return obj && (typeof obj === 'object'\r\n            && typeof obj.length === 'number'\r\n            && typeof obj.splice === 'function'\r\n            && !obj.propertyIsEnumerable('length')) || (obj instanceof Array);\r\n      }\r\n    },\r\n    \r\n    /**\r\n     *   Boolean     true/false .\r\n     * @example\r\n     * olleh.maps.isBoolean(true); // true\r\n     * olleh.maps.isBoolean(false); // true\r\n     * olleh.maps.isBoolean({}); // false\r\n     * olleh.maps.isBoolean([]); // false\r\n     * olleh.maps.isBoolean(1); // false\r\n     * olleh.maps.isBoolean(0); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}    boolean true \r\n     *  false .\r\n     */\r\n    isBoolean: function (obj) {\r\n      return typeof obj === 'boolean';\r\n    },\r\n    \r\n    /**\r\n     *   Date    true/false .\r\n     * @example\r\n     * olleh.maps.isDate(new Date()); // true\r\n     * olleh.maps.isDate({}); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   Date true\r\n     *   false .\r\n     */\r\n    isDate: function (obj) {\r\n      return this.typeOf(obj) === 'date';\r\n    },\r\n    \r\n    /**\r\n     *   RegExp    true/false .\r\n     * @example\r\n     * olleh.maps.isDate(new RegExp()); // true\r\n     * olleh.maps.isDate(/abc/); // true\r\n     * olleh.maps.isDate({}); // false\r\n     * \r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   RegExp true\r\n     *   false .\r\n     */\r\n    isRegExp: function (obj) {\r\n      return this.typeOf(obj) === 'regexp';\r\n    },\r\n\r\n    /**\r\n     *   HTML DOM     true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isElement(document.createElement('div')); // true\r\n     * olleh.maps.isElement(document.createTextNode('foo')); // false\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @returns {Boolean}   DOM  \r\n     * true   false .\r\n     */\r\n    isElement: function (obj) {\r\n      return !!(obj && obj.nodeType === 1);\r\n    },\r\n    \r\n    /**\r\n     *   HTML DOM Fragment    true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isFragment(document.createElement('div')); // false\r\n     * olleh.maps.isFragment(document.createDocumentFragment()); // true\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @returns {Boolean}   DOM Fragment\r\n     * true   false .\r\n     */\r\n    isFragment: function (obj) {\r\n      return !!(obj && obj.nodeType === 11);\r\n    },\r\n    \r\n    /**\r\n     *   function  class    true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isFunction(123); // false\r\n     * olleh.maps.isFunction(new Function()); // true\r\n     * olleh.maps.isFunction(olleh.maps.isString); // true\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @returns {Boolean}   function true  \r\n     * false .\r\n     */\r\n    isFunction: function (obj) {\r\n      return this.typeOf(obj) === 'function';\r\n    },\r\n    \r\n    /**\r\n     *        true/false\r\n     * .\r\n     * @example\r\n     * olleh.maps.isNamespace('foo'); // true\r\n     * olleh.maps.isNamespace('foo.bar'); // true\r\n     * olleh.maps.isNamespace('foo,bar'); // false\r\n     * olleh.maps.isNamespace('foo-bar'); // false\r\n     *\r\n     * @param {String} ns  \r\n     * @returns {Boolean}      \r\n     * true    false .\r\n     */\r\n    isNamespace: function (ns) {\r\n      return this.isString(ns) && /^[\\w]+(\\.[\\w]+)*$/.test(ns);\r\n    },\r\n    \r\n    /**\r\n     *      \r\n     * Boolean .\r\n     * @example\r\n     * olleh.maps.isNumber(0); // true\r\n     * olleh.maps.isNumber(2.3); // true\r\n     * olleh.maps.isNumber('foo'); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   true  \r\n     * false .\r\n     */\r\n    isNumber: function (obj) {\r\n      return typeof obj === 'number' && isFinite(obj);\r\n    },\r\n    \r\n    /**\r\n     *      \r\n     * true/false .   \r\n     * function    isFunction \r\n     *  true  .\r\n     * @example\r\n     * olleh.maps.isObject({}); // true\r\n     * olleh.maps.isObject([]); // true\r\n     * olleh.maps.isObject(new Function()); // false\r\n     * olleh.maps.isObject(new Function(), true); // true\r\n     *\r\n     * @param {Object} obj JavaScript  \r\n     * @param {Boolean} isFunction true  function\r\n     * true .\r\n     * @returns {Boolean}   Object  function true\r\n     *    false .\r\n     */\r\n    isObject: function (obj, isFunction) {\r\n      return obj && ((typeof obj === 'object') \r\n          || (isFunction && this.isFunction(obj))) || false;\r\n    },\r\n\r\n    /**\r\n     *   String   \r\n     * true/false .\r\n     * @example\r\n     * olleh.maps.isString(123); // false\r\n     * olleh.maps.isString('foo'); // true\r\n     * olleh.maps.isString(''); // true\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}    String true  \r\n     * false .\r\n     */\r\n    isString: function (obj) {\r\n      return typeof obj === 'string';\r\n    },\r\n    \r\n    /**\r\n     *  (obj) 'undefined'   \r\n     *  Boolean .\r\n     * @example\r\n     * olleh.maps.isUndefined(undefined); // true\r\n     * olleh.maps.isUndefined(); // true\r\n     * olleh.maps.isUndefined(null); // false\r\n     * olleh.maps.isUndefined(0); // false\r\n     * olleh.maps.isUndefined(''); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}  undefined true \r\n     *  false .\r\n     */\r\n    isUndefined: function (obj) {\r\n      return typeof obj === 'undefined';\r\n    },\r\n\r\n    /**\r\n     *        \r\n     * true/false .   undefined/null/NaN/\"\"\r\n     *   true .\r\n     * @example\r\n     * olleh.maps.isValue({}); // true\r\n     * olleh.maps.isValue([]); // true\r\n     * olleh.maps.isValue(null); // false\r\n     * olleh.maps.isValue(undefined); // false\r\n     * olleh.maps.isValue(''); // false\r\n     *\r\n     * @param {Object} obj JavaScript \r\n     * @returns {Boolean}   undefined, null, NaN, \"\"  \r\n     * true    false .\r\n     */\r\n    isValue: function (obj) {\r\n      var t = this.typeOf(obj);\r\n      switch (t) {\r\n      case 'undefined':\r\n      case 'null':\r\n        return false;\r\n      case 'number':\r\n        return isFinite(obj);\r\n      case 'string':\r\n        return '' !== obj;\r\n      }\r\n      return !!(t);\r\n    },\r\n\r\n    /**\r\n     *  function   function \r\n     *       \r\n     * .     \r\n     * .\r\n     * <p/>\r\n     * @example\r\n     * function showArguments() {\r\n     *   alert(Array.prototype.join.call.join(arguments, ', '));\r\n     * }\r\n     * showArguments(1, 2, 3);\r\n     * // -> alerts \"1, 2, 3\"\r\n     * var f = olleh.maps.curry(showArguments, this, 1, 2, 3);\r\n     * f('a', 'b');\r\n     * // -> alerts \"a, b, 1, 2, 3\"\r\n     *\r\n     * @param {Function} fn   function\r\n     * @param {Object} ctx context \r\n     * @param {Arguments} [args]    \r\n     */\r\n    curry: function (fn, ctx, args) {\r\n      if (!arguments.length) {\r\n        throw new SyntaxError('method reference to curry is missing!');\r\n      }\r\n      if (arguments.length === 1) return arguments[0];\r\n      var _fn = fn, _args = Array.prototype.slice.call(arguments, 2);\r\n      return function () {\r\n        var arr = Array.prototype,\r\n            a = arr.concat.call(arr.slice.call(arguments), _args);\r\n        return _fn.apply(ctx, a);\r\n      };\r\n    },\r\n    \r\n    /**\r\n     * (src)   (dest) \r\n     *  .\r\n     * <p/>\r\n     *   (  )  \r\n     *  .\r\n     *\r\n     * @example\r\n     * var src = {\r\n     *   level: 'low',\r\n     *   opts: {one: 1, two: 2},\r\n     *   add: function (a, b) {\r\n     *     return a + b;\r\n     *   }\r\n     * };\r\n     *\r\n     * var dest = {\r\n     *   level: 'high',\r\n     *   opts: {three: 3, four: 4},\r\n     *   multiply: function (a, b) {\r\n     *     return a * b;\r\n     *   }\r\n     * }\r\n     * var d = olleh.maps.mixin(dest, src); // mixin\r\n     * d.multiply(2, 3); // 6\r\n     * d.add(2, 3); // 5 (mixed in)\r\n     * d.level; // 'high'\r\n     *\r\n     * d = olleh.maps.mixin(dest, src, true); // override\r\n     * d.level; // 'low' (overridden)\r\n     * d.opts; // {one: 1, two: 2}\r\n     *\r\n     * d = olleh.maps.mixin(dest, src, 'remix'); // 'remix'\r\n     * d.opts; // {one: 1, two: 2, three: 3, four: 4}\r\n     *\r\n     * d = olleh.maps.mixin(dest, src, true, ['level', 'add']); // 'filter'\r\n     * d.add(2, 3); // 5\r\n     * d.level; // 'low'\r\n     * d.opts; // {three: 3, four: 4}\r\n     *\r\n     * @param {Object} dest      \r\n     * @param {Object} src       \r\n     * @param {Boolean|String} [override] Override  'remix' (recursive mix)\r\n     * @param {Array} [filter]     .\r\n     * @returns {Object}      \r\n     */\r\n    mixin: function (dest, src, override, filter) {\r\n      dest = dest || {};\r\n      if (src !== dest) {\r\n        // Copy properties on override or if it doesn't already exist\r\n        for (var p in src) {\r\n          // Copy owned/filtered src properties to undefined/overriden dest\r\n          if (src.hasOwnProperty(p) && (override || dest[p] === undefined)\r\n              && (!filter || indexOf.call(filter, p) > -1)) {\r\n            // Recursively mix or overwrite to dest property\r\n            if (override === 'remix' && this.isObject(dest[p])) {\r\n              dest[p] = this.mixin(dest[p], src[p], override, filter);\r\n            } else {\r\n              dest[p] = src[p];\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return dest;\r\n    },\r\n    \r\n    /**\r\n     * JavaScript  .\r\n     * <p/>\r\n     *     \r\n     *     \r\n     *      .\r\n     * <p/>\r\n     *      \r\n     *    Error .\r\n     * @example\r\n     * olleh.maps.namespace('foo.bar'); // creates namespace 'foo.bar'\r\n     * olleh.maps.namespace('foo.bar', {name: 'mobell'});\r\n     * foo.bar.name; // 'mobell'\r\n     *\r\n     * olleh.maps.namespace('foo.bar.baz', function () { return 'mobello';});\r\n     * foo.bar.baz(); // 'mobello'\r\n     *\r\n     * @param {String} ns   \r\n     * @param {Object|Function} [attach]   \r\n     *   Function\r\n     * @param {Boolean} [overwrite] true   .\r\n     * @returns {Boolean}    \r\n     * true .\r\n     * @throws {Error}      \r\n     *     \r\n     */\r\n    namespace: function (ns, attach, overwrite) {\r\n      if (!this.isNamespace(ns)) {\r\n        throw new SyntaxError('olleh.maps.namespace: invalid namespace, ' + ns);\r\n      }\r\n      \r\n      var i, len; \r\n      var parent = window;\r\n      var modified = false;\r\n      var parts = ns.split('.'); \r\n      var isFn = this.isFunction(attach);\r\n\r\n      // Validate each namespace parts (create one if it doesn't exist)\r\n      for (i = 0, len = isFn ? parts.length - 1 : parts.length; i < len; i++) {\r\n        if (typeof parent[parts[i]] === 'undefined') {\r\n          parent[parts[i]] = {};\r\n          modified = true;\r\n        } else if (!overwrite && this.isFunction(parent[parts[i]]) && i < len - 1) {\r\n          // Any parent part in the namespace must not be a function\r\n          throw new Error('olleh.maps.namespace: \\\"' + parts.slice(0, i + 1)\r\n              .join('.') + '\\\" function was previously defined in hierarchy');\r\n        }\r\n        parent = parent[parts[i]];\r\n      }\r\n      \r\n      if (isFn) {\r\n        // Function assignment for the last portion of namespace\r\n        if (overwrite || typeof parent[parts[i]] === 'undefined') {\r\n          parent[parts[i]] = attach;\r\n          modified = true;\r\n        } else {\r\n          throw new Error('olleh.maps.namespace: \\\"' + ns + '\\\" definition ' + ' already exists, cannot be overridden');\r\n        }\r\n      } else {\r\n        // Attach properties to the final namespace part; does not overwrite\r\n        for (i in attach) {\r\n          if (typeof parent[i] === 'undefined' && attach.hasOwnProperty(i)) {\r\n            parent[i] = attach[i];\r\n            modified = true;\r\n          }\r\n        }\r\n      }\r\n      \r\n      return modified;\r\n    },\r\n    \r\n    /**\r\n     * @name olleh.maps.TObject \r\n     * @class\r\n     * $class()    KT   .\r\n     *    instanceof  KT    .\r\n     * @example\r\n     * var foo = // KT   \r\n     * if (foo instanceof olleh.maps.TObject) {} // true\r\n     * @see $class\r\n     * @private\r\n     */\r\n    TObject: (function () {\r\n      var obj = function TObject() {};\r\n      \r\n      /**\r\n       *     .\r\n       * KT        .\r\n       * @example\r\n       * $class('com.mycompany.MySuper').define({\r\n       *   foo: function () { // override\r\n       *     return 'MySuper';\r\n       *   }\r\n       * });\r\n       *\r\n       * $class('com.mycompany.MyClass').extend(com.mycompany.MySuper).define({\r\n       *   foo: function () { // override\r\n       *     var msg = com.mycompany.MyClass.$super.foo.apply(this, arguments);\r\n       *     return msg + ' and MyClass';\r\n       *   }\r\n       * });\r\n       * \r\n       * @example\r\n       * var my = new com.mycompany.MyClass();\r\n       * my.foo(); // prints 'MySuper and MyClass'\r\n       *\r\n       * @name olleh.maps.TObject.$super\r\n       */\r\n      obj.$super = null;\r\n      \r\n      /**\r\n       *    .\r\n       * @example\r\n       * $class('foo.Bar').define({\r\n       *   ...\r\n       * });\r\n       * \r\n       * @example\r\n       * var bar = new foo.Bar();\r\n       * bar.$classname // 'foo.Bar'\r\n       *\r\n       * @name $classname\r\n       * @field\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @constant\r\n       * @type String\r\n       */\r\n      obj.prototype.$classname = 'olleh.maps.TObject';\r\n      \r\n      /**\r\n       *     . \r\n       * KT  foo.Bar  \r\n       *  \"[object foo.Bar]\" .\r\n       * @example\r\n       * var v = new foo.Bar();\r\n       * v.toString(); // '[object foo.Bar]'\r\n       * @name toString\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @returns {String}   \r\n       */\r\n      obj.prototype.toString = function () {\r\n        return '[object '.concat(this.$classname, ']');\r\n      };\r\n      \r\n      /**\r\n       *  callstack  .  \r\n       *       \r\n       *    .\r\n       * @example\r\n       * var aa = ...\r\n       * aa.currentStack().toString();\r\n       * // prints callstack as a String\r\n       *\r\n       * @name currentStack\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @returns {Object}  callstack  \r\n       * \r\n       */\r\n      obj.prototype.currentStack = function  () {\r\n        var that = this, current = arguments.callee.caller;\r\n        return  {\r\n          toString: function () {\r\n            var cs = ' @'.concat(that.$classname);\r\n            for(var name in that) {\r\n              if (that[name] === current) {\r\n                return cs.concat('.', name, '();');\r\n              }\r\n            }\r\n            return cs;\r\n          }\r\n        };\r\n      };\r\n\r\n      /**\r\n       *     mixin \r\n       *   true/false .\r\n       * @example\r\n       * $class('foo.Bar').mixin(foo.Baz).define({\r\n       *   ...\r\n       * });\r\n       *\r\n       * @example\r\n       * var bar = new foo.Bar();\r\n       * bar.isMixinOf(foo.Baz); // true\r\n       *\r\n       * @name isMixinOf\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @param {Object} target   mixin \r\n       *   \r\n       * @returns {Boolean}    \r\n       * mixin true   false\r\n       * .\r\n       */\r\n      obj.prototype.isMixinOf = function (target) {\r\n        var cls = this.constructor;\r\n        for (var i = 0; cls.mixins && i < cls.mixins.length; i++) {\r\n          if (cls.mixins[i] === target.prototype.$classname) {\r\n            return true;\r\n          }\r\n        }\r\n        return cls.$super ? cls.$super.isMixinOf(target) : false;\r\n      };\r\n\r\n      /**\r\n       *   Class .\r\n       * @example\r\n       * var bar = new foo.Bar();\r\n       * var clazz = bar.getClass();\r\n       * // clazz is foo.Bar\r\n       * \r\n       * @name getClass\r\n       * @function\r\n       * @memberOf olleh.maps.TObject.prototype\r\n       * @returns {olleh.maps.TObject} \r\n       */\r\n      obj.prototype.getClass = function () {\r\n        return this.constructor;\r\n      };\r\n      \r\n      return obj;\r\n    })()\r\n  };\r\n  \r\n  GLOBAL.$class = (function () {\r\n    var maps = olleh.maps;\r\n    var dontEnumProperties;\r\n    var dontEnumBug = !{toString:'foo'}.propertyIsEnumerable('toString');\r\n    \r\n    // ie8  DontEnum bug\r\n    // https://developer.mozilla.org/en-US/docs/ECMAScript_DontEnum_attribute#section_2\r\n    if (dontEnumBug) {\r\n      dontEnumProperties = function (src, desc) {\r\n        if (!src || !desc) return;\r\n        \r\n        var dontEnumProps = ['toLocaleString', 'toString', 'valueOf', 'equals'];\r\n        var i = dontEnumProps.length;\r\n        var p;\r\n        \r\n        while(i--) {\r\n          p = dontEnumProps[i];\r\n          if (src.hasOwnProperty(p)) {\r\n            desc[p] = src[p];\r\n          }\r\n        }\r\n      };\r\n    }\r\n    \r\n    /**\r\n     * KT     .\r\n     * $class('foo.Bar').define({ ... }); \r\n     *        \r\n     *      \r\n     *  .     \r\n     *   .\r\n     * <p/>\r\n     * KT       \r\n     *  , , , ()  \r\n     *       .\r\n     * <ul>\r\n     *   <li>extend:  .</li> \r\n     *   <li>mixin:    \r\n     *         . </li>\r\n     *   <li>define:    .</li>\r\n     * </ul>\r\n     * :      \r\n     *     .\r\n     * @name $class\r\n     * @class\r\n     * @example\r\n     * $class('foo.Bar').extend(foo.Baz).define({\r\n     *   Bar: function () { // Constructor\r\n     *     // ...\r\n     *   },\r\n     *\r\n     *   say: function () { // Member function\r\n     *     // ...\r\n     *   }\r\n     * });\r\n     */\r\n    function $class (name) {\r\n      return {\r\n        name: name,\r\n        extend: extend,\r\n        mixin: mixin,\r\n        define: define\r\n      };\r\n    }\r\n    \r\n    /**\r\n     *    (). \r\n     *       \r\n     *        \r\n     * .     \r\n     *    .\r\n     * @example\r\n     * $class('com.mycompany.MySuper').define({\r\n     *   $static: {                     // Static variables\r\n     *     MAX_SIZE: 1000\r\n     *   },\r\n     *\r\n     *   MySuper: function (a, b) { // Class constructor\r\n     *     this._a = a;\r\n     *     this._b = b;\r\n     *   },\r\n     *\r\n     *   foo: function () { // Class member\r\n     *     return this._a + this._b;\r\n     *   },\r\n     *\r\n     *   getMax: function () {\r\n     *     return com.mycompany.MySuper.MAX_SIZE;\r\n     *   },\r\n     *   \r\n     *   $afterDefine: function () { // class define callbackFn\r\n     *     var clazz = this;\r\n     *   }\r\n     * });\r\n     *\r\n     * $class('com.mycompany.MyClass').extend(com.mycompany.MySuper).define({\r\n     *   foo: function () { // override\r\n     *     return this._a * this._b;\r\n     *   },\r\n     *\r\n     *   bar: function () { // add new function\r\n     *     return this._a - this._b;\r\n     *   }\r\n     * });\r\n     *\r\n     * @name extend\r\n     * @function\r\n     * @memberof $class\r\n     * @param {Function} superclass   .\r\n     * @returns {$class}      \r\n     * @throws {Error} superclass   \r\n     */\r\n    function extend(superclass) {\r\n      if (!olleh.maps.isFunction(superclass)) {\r\n        throw new Error('$class.extend: '+ this.name \r\n            + ' cannot extend undefined class, \\\"' + superclass + '\\\"');\r\n      }\r\n      this.sup = superclass;\r\n      delete this.extend;\r\n      return this;\r\n    }\r\n    \r\n    /**\r\n     *      \r\n     * .     \r\n     *  .\r\n     * @example\r\n     * $class('com.mycompany.MySuper').mixin(com.mycompany.Util).define({\r\n     *   ...\r\n     * });\r\n     *\r\n     * @example\r\n     * $class('com.mycompany.MySuper').mixin( // more than one class\r\n     *     com.mycompany.Util, com.mycompany.Common).define({ //\r\n     *   ...\r\n     * });\r\n     *\r\n     * @name mixin\r\n     * @function\r\n     * @memberof $class\r\n     * @param {Object} args mixin ,     .\r\n     * @returns {$class}      \r\n     */\r\n    function mixin() {\r\n      this.mixins = arguments;\r\n      delete this.mixin;\r\n      return this;\r\n    }\r\n    \r\n    /**\r\n     *   .\r\n     * <p/>\r\n     *       \r\n     *     .\r\n     * @example\r\n     * $class('com.mycompany.MySuper').define({\r\n     *   MySuper: function () { // constructor\r\n     *\r\n     *   },\r\n     *\r\n     *   foo: function (a, b) { // member function\r\n     *\r\n     *   }\r\n     * });\r\n     * <p/>\r\n     *\r\n     * @name define\r\n     * @function\r\n     * @memberof $class\r\n     * @param {Object} m    \r\n     * @throws {Error}       \r\n     */\r\n    function define(m) {\r\n      var p, len, mm;\r\n      var sup = this.sup || maps.TObject;\r\n      var name = this.name, mixins = this.mixins;\r\n      var shortname = name.substring(name.lastIndexOf('.') + 1);\r\n      \r\n      var cls = function () {\r\n        var ctor, stack = [], current = this;\r\n        \r\n        do {\r\n          stack.push(current);\r\n          current = current.constructor.$super;\r\n        } while (current);\r\n\r\n        while (current = stack.pop()) {\r\n          if (ctor = current.$constructor) {\r\n            ctor.apply(this, arguments);\r\n          }\r\n        }\r\n      };\r\n      \r\n      if (!maps.namespace(name, cls)) {\r\n        throw new Error('$class.define: \\\"' + name +'\\\" already defined');\r\n      }\r\n      \r\n      var parent = function () {};\r\n      parent.prototype = sup.prototype;\r\n      \r\n      cls.$super = sup.prototype;\r\n      cls.prototype = new parent();\r\n      cls.prototype.constructor = cls;\r\n      cls.prototype.$constructor = null;\r\n      cls.prototype.$classname = name;\r\n\r\n      var afterDefine = [];\r\n      var supCls = cls.$super;\r\n      var supClsProto;\r\n\r\n      while(supCls && supCls !== maps.TObject) {\r\n        supClsProto = supCls.constructor; \r\n        for (p = 0, len = supClsProto.mixins ? supClsProto.mixins.length : 0; p < len; p++) {\r\n          mm = supClsProto.mixins[p].prototype;\r\n          if (mm && mm.$afterDefine) {\r\n            afterDefine.push(mm.$afterDefine);\r\n          }\r\n        }\r\n        supCls = supCls.$super;\r\n      }\r\n      \r\n      // Apply mixin properties \r\n      for (p = 0, len = mixins ? mixins.length : 0; p < len; p++) {\r\n        //olleh.maps.mixin(cls.prototype, this.mixins[p]);\r\n        //tweaked for efficiency by genie\r\n        if (p === 0) {\r\n          cls.mixins = [];\r\n        }\r\n        mm = mixins[p].prototype;\r\n        if (mm) {\r\n          cls.mixins.push(mm.$classname);\r\n          if (mm.$afterDefine) {\r\n            afterDefine.push(mm.$afterDefine);\r\n          }\r\n        } else {\r\n          mm = mixins[p];\r\n        }\r\n        maps.mixin(cls.prototype, mm);\r\n      }\r\n\r\n      if (m.$afterDefine) {\r\n        afterDefine.push(m.$afterDefine);\r\n      } else if (cls.prototype.$afterDefine) {\r\n        afterDefine.push(cls.prototype.$afterDefine);\r\n      }\r\n\r\n      // Define static properties/methods\r\n      for (p in m.$static) {\r\n        if (m.$static.hasOwnProperty(p)) {\r\n          cls[p] = m.$static[p];\r\n        }\r\n      }\r\n\r\n      // Define prototype properties/methods\r\n      for (p in m) {\r\n        if (p !== '$static' && m.hasOwnProperty(p)) {\r\n          if (shortname == p) {\r\n            cls.prototype.$constructor = m[p];\r\n          }\r\n          cls.prototype[p] = m[p];\r\n        }\r\n      }\r\n      \r\n      // ie8  DontEnum bug\r\n      if (dontEnumBug) {\r\n        dontEnumProperties(m.$static, cls);\r\n        dontEnumProperties(m, cls.prototype);\r\n      }\r\n      \r\n      for (var i = 0; i < afterDefine.length; i++) {\r\n        afterDefine[i].apply(cls);\r\n      }\r\n    }\r\n    \r\n    return $class;\r\n  })();\r\n} (window);\r\n\r\n\r\nolleh.maps.namespace('olleh.maps', {\r\n  $skeleton: []\r\n});\r\n/**\r\n *    \r\n * @example\r\n * olleh.maps.env = {\r\n *   RESOURCE_URL: '../resources'\r\n * };\r\n */\r\n(function (GLOBAL) {\r\n\r\n  var PROTOCOL = location.protocol == 'https:' ? 'https:' : 'http:';\r\n  var PORT = PROTOCOL == 'https:' ? '10083' : '10080';\r\n  var VERSION = \"v=yyyymmdd\";\r\n  olleh.maps.namespace('olleh.maps.env', {\r\n    PROTOCOL: PROTOCOL,\r\n    RESOURCE_URL: PROTOCOL + '//api.ktgis.com:' + PORT + '/ollehmap/resource/v3/',\r\n    TILE_URL: {\r\n      // BASE: PROTOCOL + '//map.ktgis.com/BaseMap/olleh7.10.1_1027/layers/_alllayers/l#{z}/r#{y}/c#{x}.png',\r\n      // AIR: PROTOCOL + '//map.ktgis.com/ServiceAir/version20110705/l#{z}/r#{y}/c#{x}.jpg',\r\n      // HYBRID: PROTOCOL + '//map.ktgis.com/HybridMap/olleh6.03.1_0405_hyb/layers/_alllayers/l#{z}/r#{y}/c#{x}.png',\r\n      BASE: PROTOCOL + '//tile.gis.kt.com/current/base.default/#{z}/#{y}/#{x}.png?' + VERSION,\r\n      AIR: PROTOCOL + '//tile.gis.kt.com/current/base.satellite/#{z}/#{y}/#{x}.jpg?' + VERSION,\r\n      HYBRID: PROTOCOL + '//tile.gis.kt.com/current/overlay.hybrid/#{z}/#{y}/#{x}.png?' + VERSION,\r\n      ENG: PROTOCOL + '//tile.gis.kt.com/current/base.english/#{z}/#{y}/#{x}.png?' + VERSION,\r\n      TRAFFIC: PROTOCOL + '//roadtiledmz.ktgis.com/NTraffic/TTileServlet/256/L#{z}/R#{y}/C#{x}.png',\r\n      HD_BASE: PROTOCOL + '//map.ktgis.com/BaseMaphd/olleh5.04.1_0511_hd/layers/_alllayers/l#{z}/r#{y}/c#{x}.png',\r\n      HD_HYBRID: PROTOCOL + '//map.ktgis.com/HybridMaphd/olleh5.04.1_0511_hyb_hd/layers/_alllayers/l#{z}/r#{y}/c#{x}.png'\r\n    },\r\n    TILE_COPYRIGHT: {\r\n      BASE: ' KT corp.',\r\n      AIR: ' KT corp.',\r\n      HD_BASE: ' KT corp.'\r\n    },\r\n    LANG: GLOBAL.$LANG || 'ko',\r\n    LOG_LEVEL: 3 // 1(DEBUG), 2(INFO), 3(WARN), 4(ERROR), 5(FATAL), 6(NONE)\r\n  });\r\n})(window);\r\n!function (GLOBAL) {\r\n\r\n  var MSG = {\r\n    'en': {\r\n      '': 'roadmap',\r\n      '': 'satellite',\r\n      ' ': 'hybrid label',\r\n      ' ': 'real-time traffic',\r\n      '': 'vector',\r\n      ' ': 'Real-Time Traffic Legend',\r\n      '': 'fast',\r\n      '': 'slow',\r\n      ',': 'National Highway',\r\n      '': 'Urban Expressway',\r\n      '': 'highway',\r\n      '    ,    ': 'Clicking on the above line speed information, check detailed information available',\r\n      '         ': 'In the city roads may differ from the actual speed signal stops , etc.'\r\n    }\r\n  };\r\n\r\n  olleh.maps.namespace('olleh.maps', {\r\n\r\n    msg: function (key, lang) {\r\n      var l, m;\r\n      var lang = lang === undefined ? olleh.maps.env.LANG : lang;\r\n\r\n      if (lang === 'ko') {\r\n        return key;\r\n      }\r\n      l = MSG[lang];\r\n      if (!l) {\r\n        console.warn('unsupported language: ' + lang);\r\n        return key;\r\n      }\r\n      m = l[key];\r\n      if (!m) {\r\n        console.warn('unsupported key: ' + key);\r\n        return key;\r\n      }\r\n      return m;\r\n    }\r\n  });\r\n\r\n  olleh.maps.namespace('olleh.maps.msg', {\r\n  // TODO\r\n  });\r\n}(window);/**\r\n * browser  \r\n */\r\nolleh.maps.namespace('olleh.maps.browser', {\r\n  /**\r\n   * \r\n   * @enum {String}\r\n   */\r\n  BROWSER_NAME: {\r\n    ie: 'IE',\r\n    firefox: 'FireFox',\r\n    safari: 'Safari',\r\n    chrome: 'Chrome',\r\n    opera: 'Opera',\r\n    /**\r\n     * @ignore\r\n     */\r\n    chromeMobile: 'Chrome',\r\n    /**\r\n     * @ignore\r\n     */\r\n    chromeForAndroid: 'Chrome',\r\n    /**\r\n     * @ignore\r\n     */\r\n    chromeForIos: 'Chrome',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   *  \r\n   * @enum {String}\r\n   */\r\n  ENGINE_NAME: {\r\n    webkit: 'WebKit',\r\n    gecko: 'Gecko',\r\n    presto: 'Presto',\r\n    trident: 'Trident',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   * OS \r\n   * @enum {String}\r\n   */\r\n  OS_NAME: {\r\n    ios: 'iOS',\r\n    android: 'Android',\r\n    mac: 'Mac',\r\n    win: 'Windows',\r\n    linux: 'Linux',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   *   CSS dath(-) prefix\r\n   * @enum {String}\r\n   */\r\n  STYLE_DASH_PREFIX: {\r\n    webkit: '-webkit-',\r\n    gecko: '-moz-',\r\n    trident: '-ms-',\r\n    presto: '-o-',\r\n    other: ''\r\n  },\r\n\r\n  /**\r\n   *   CSS prefix\r\n   * @enum {String}\r\n   */\r\n  STYLE_PREFIX: {\r\n    webkit: 'webkit',\r\n    gecko: 'moz',\r\n    trident: 'ms',\r\n    presto: 'o',\r\n    other: ''\r\n  },\r\n  \r\n  /**\r\n   *  \r\n   * @type olleh.maps.browser.BROWSER_NAME\r\n   */\r\n  browserName: '', // BROWSER_NAME['other']\r\n  /**\r\n   *   \r\n   * @example\r\n   * olleh.maps.browser.browserVer; // 5\r\n   * @type String\r\n   */\r\n  browserVer: '',\r\n  /**\r\n   *   \r\n   * @type olleh.maps.browser.ENGINE_NAME\r\n   */\r\n  engineName: '', // ENGINE_NAME['other']\r\n  /**\r\n   *    \r\n   * @type String\r\n   */\r\n  engineVer: '',\r\n  /**\r\n   * cross-browser     \r\n   * @type Object\r\n   * @property {String} transitionend \r\n   */\r\n  event: {}, \r\n  \r\n  /** \r\n   *    orientationchange \r\n   * .\r\n   * @type Boolean\r\n   */\r\n  hasOrientationChange: ('onorientationchange' in window),\r\n  \r\n  /** \r\n   *    touch   .\r\n   * @type Boolean\r\n   */\r\n  hasTouch: ('ontouchstart' in window) && !/chrome/i.test(window.navigator.userAgent),\r\n\r\n  /** \r\n   *    3D  .\r\n   * @type Boolean\r\n   */\r\n  has3D: false,\r\n  /**\r\n   * canvas \r\n   * @type Boolean\r\n   */\r\n  hasCanvas: !!document.createElement(\"canvas\").getContext,\r\n  /**\r\n   * HTML element pointer-events css \r\n   * @type Boolean\r\n   */\r\n  hasPointerEvents: false,\r\n  /**\r\n   * svg \r\n   * @type Boolean\r\n   */\r\n  hasSVG: document.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1'),\r\n  /**\r\n   * vml \r\n   * @type Boolean\r\n   */\r\n  hasVML: (function () {\r\n    if (!document.namespaces) return false;\r\n    \r\n    var div = document.createElement('div');\r\n    div.innerHTML = '<!--[if vml]><br><![endif]-->';\r\n    return div.childNodes.length == 1;\r\n  })(),\r\n  /**\r\n   *   \r\n   * @type Boolean\r\n   */\r\n  isMobile: false,\r\n  /**\r\n   *   \r\n   * @type Boolean\r\n   */\r\n  isTablet: false,  \r\n  /**\r\n   *  OS \r\n   * @type olleh.maps.browser.OS_NAME\r\n   */\r\n  osName: '', // OS_NAME['other']\r\n  /**\r\n   *  OS \r\n   * @example\r\n   * olleh.maps.browser.osVer; // 2.3\r\n   * @type String\r\n   */\r\n  osVer: '',\r\n  /**\r\n   * cross-browser     \r\n   * @param {String} transition\r\n   */\r\n  style: {},\r\n  /**\r\n   *    dash(-) CSS prefix\r\n   * @type olleh.maps.browser.STYLE_DASH_PREFIX\r\n   */\r\n  styleDashPrefix: '', // STYLE_DASH_PREFIX['other']\r\n  /**\r\n   *    CSS prefix\r\n   * @type olleh.maps.browser.STYLE_PREFIX\r\n   */\r\n  stylePrefix: '', //STYLE_PREFIX['other']\r\n  /**\r\n   * translate template\r\n   * <pre>\r\n   *   translate3d(#{x}px,#{y}px,0) \r\n   *   translate(#{x}px,#{y}px)\r\n   * </pre>\r\n   * @type String\r\n   */\r\n  styleTranslateTmpl: '',\r\n  /**\r\n   *   vector (SVG, Canvas, VML)\r\n   * @type String\r\n   */\r\n  vector: '',\r\n\r\n  /**\r\n   *   .\r\n   * @param {String} name   \r\n   * @returns {Boolean}\r\n   * @static\r\n   */\r\n  isStyleSupported: function (name) {\r\n    var browser = olleh.maps.browser;\r\n    var bodyStyle = document.body.style;\r\n\r\n    return (name in bodyStyle) || \r\n    (browser.stylePrefix !== '' && \r\n        (browser.stylePrefix + capitalize(name) in bodyStyle));\r\n  }\r\n});\r\n\r\n\r\n!function (GLOBAL) {\r\n  var prop, browsers, engine, os;\r\n  var browser = olleh.maps.browser;\r\n  var body = document.body || document.documentElement;\r\n  var bodyStyle = body.style;\r\n  var BROWSER_NAME = browser.BROWSER_NAME;\r\n  var ENGINE_NAME = browser.ENGINE_NAME;\r\n  var OS_NAME = browser.OS_NAME;\r\n  var STYLE_DASH_PREFIX = browser.STYLE_DASH_PREFIX;\r\n  var STYLE_PREFIX = browser.STYLE_PREFIX;\r\n  var userAgent = GLOBAL.navigator.userAgent;\r\n  var enginePrefix = {\r\n    webkit: 'AppleWebKit/',\r\n    gecko: 'Gecko/',\r\n    presto: 'Presto/',\r\n    trident: 'Trident/'\r\n  };\r\n  var browserPrefix = {\r\n    ie: 'MSIE ',\r\n    firefox: 'Firefox/',\r\n    chromeMobile: 'CrMo', //  CrMo -> Chrome .    \r\n    chromeForAndroid: 'Android[\\\\W|\\\\w]*Chrome\\/',\r\n    chromeForIos: 'CriOS/',\r\n    chrome: 'Chrome/',\r\n    safari: 'Version/',\r\n    opera: 'Opera/'\r\n  };\r\n  var osPrefix = {\r\n    ios: 'i(?:Pad|Phone|Pod)(?:.*)CPU(?: iPhone)? OS ',\r\n    android: '(Android |HTC_|Silk/)', // Some HTC devices ship with an OSX userAgent by default,\r\n    // so we need to add a direct check for HTC_,\r\n    mac: 'Macintosh; Intel Mac OS X ',\r\n    win: 'Windows NT ',\r\n    linux: 'Linux; '\r\n  };\r\n  var mobile = {\r\n    other: /Mobile/,\r\n    android_tablet: /Android/,\r\n    ipad: /ipad/\r\n  };\r\n  var ics3DWhiteList = /SHW-|SHV-|GT-|SCH-|SGH-|SPH-|LG-F160|LG-F100|LG-F180|LG-F200|EK-|IM-A|LG-F240|LG-F260/;\r\n  var ics3DBlackList = /SHW-M250|SHW-M420|SHW-M200|GT-S7562/;\r\n  \r\n  var capitalize = function (str) {\r\n    return str ? str.charAt(0).toUpperCase() + str.substr(1) : '';\r\n  };\r\n  var testStyle = function (name) {\r\n    if (name in bodyStyle) {\r\n      return name;\r\n    }\r\n    return null;\r\n  };\r\n  var testPrefixedStyle = function (name) {\r\n    name = browser.stylePrefix + capitalize(name);\r\n    if (name in bodyStyle) {\r\n      return name;\r\n    }\r\n    return null;\r\n  };\r\n  \r\n  // browser, \r\n  for (prop in browserPrefix) {\r\n    browsers = userAgent.match(new RegExp(browserPrefix[prop] + '([0-9]{1,}[\\.0-9]{0,})'));\r\n\r\n    if (browsers) {\r\n      browser.browserName = BROWSER_NAME[prop];\r\n      browser.browserVer = browsers[1];\r\n      break;\r\n    }\r\n  }\r\n\r\n  // browser  , \r\n  for (prop in enginePrefix) {\r\n    engine = userAgent.match(new RegExp(enginePrefix[prop] + '([0-9]{1,}[\\.0-9]{0,})'));\r\n\r\n    if (engine) {\r\n      browser.engineName = ENGINE_NAME[prop];\r\n      browser.engineVer = engine[1];\r\n      browser.styleDashPrefix = STYLE_DASH_PREFIX[prop] || '';\r\n      browser.stylePrefix = STYLE_PREFIX[prop] || '';\r\n      break;\r\n    }\r\n  }\r\n\r\n  // OS , \r\n  for (prop in osPrefix) {\r\n    os = userAgent.match(new RegExp(osPrefix[prop] + '([0-9]{1,}[\\.0-9]{0,})'));\r\n\r\n    if (os) {\r\n      browser.osName = OS_NAME[prop];\r\n      browser.osVer = os[2] || os[1];\r\n      break;\r\n    }\r\n  }\r\n\r\n  //  \r\n  if (mobile.other.test(userAgent)) {\r\n    browser.isMobile = true;\r\n\r\n    if (mobile.ipad.test(userAgent))\r\n      browser.isTablet = true;\r\n\r\n  } else if (mobile.android_tablet.test(userAgent)) {\r\n    browser.isMobile = true;\r\n    browser.isTablet = true;\r\n  }\r\n  browser.style = {\r\n    transition: testPrefixedStyle('transition') || testStyle('transition'),\r\n    transform:\r\n      // #3764 Windows Safari tranform  object tag     \r\n      browser.osName == 'Windows' && browser.browserName == 'Safari' ? null :\r\n        testStyle('transform') || testPrefixedStyle('transform'),\r\n    transformOrigin: testStyle('transformOrigin') || testPrefixedStyle('transformOrigin'),\r\n    backgroundSize:\r\n      // #3728:   3d transform  sprited image    repaint    \r\n      //        backgroundSize   false  SpritedImage  background image   img  \r\n      browser.osName == 'Windows' && browser.browserName == 'Chrome' ? null :  \r\n        testStyle('backgroundSize'),\r\n    opacity: (browser.osName == 'Android' && browser.osVer >= '4.2.2' && browser.osVer < '4.3') ? null : testStyle('opacity'), // #1285\r\n    userSelect: testStyle('userSelect') || testPrefixedStyle('userSelect') || {\r\n      get: function (elem) {\r\n        return elem.getAttribute('unselectable') == 'on' ? 'none' : 'auto';\r\n      },\r\n      set: function (elem, value) {\r\n        if (value === 'none') {\r\n          elem.setAttribute('unselectable', 'on');\r\n        } else {\r\n          elem.removeAttribute('unselectable');\r\n        }\r\n      }\r\n    }\r\n  };\r\n  \r\n  browser.event = {\r\n    transitionend: (function () {\r\n      var transition = browser.style.transition;\r\n      if (transition) {\r\n        if (transition == 'transition' || transition == 'msTransition') {\r\n          return 'transitionend';\r\n        }\r\n        if (transition == 'oTransition' && parseFloat(browser.browserVer) >= 12) {\r\n          return 'otransitionend';\r\n        }\r\n        return transition + 'End';\r\n      }\r\n      return null;\r\n    })()\r\n  };\r\n  \r\n  browser.isHD = false;//window.devicePixelRatio > 1;\r\n  browser.isHDTile = (function() {\r\n    if(!browser.isHD)\r\n      return false;\r\n    if(browser.osName == 'Android')\r\n      return browser.osVer >= '4.3';\r\n    return true;\r\n  })();\r\n\r\n  browser.has3D = (function () {\r\n    if (!browser.style.transform) {\r\n      return false;\r\n    }\r\n    if (!testStyle('perspective') && !testPrefixedStyle('perspective')) {\r\n      return false;\r\n    }\r\n    //   \r\n    if (browser.osName == 'Android') {\r\n      // ICS    \r\n      if (browser.osVer < '4.0.3') {\r\n        return false;\r\n      }\r\n      // ICS  whiteList  blackList    ,   \r\n      if (browser.osVer < '4.1.0') {\r\n        if (!ics3DWhiteList.test(userAgent) || ics3DBlackList.test(userAgent)) {\r\n          return false;\r\n        }\r\n      }\r\n      // 4.2.2 3D       (#1285)\r\n      // -G 4.1.2  3D    (2013/07/01)\r\n      if (browser.osVer < '4.1.0' && browser.browserName === 'Chrome') {\r\n        return false;\r\n      }\r\n      //    \r\n    }\r\n    return true;\r\n  })();\r\n  \r\n  browser.usePulseForZoom = !browser.isMobile;\r\n  \r\n  browser.use3DRootPane = (function () {\r\n    if (!browser.has3D) {\r\n      return false;\r\n    }\r\n    if (browser.osName == 'Android') {\r\n      return false;\r\n    }\r\n    // #2945, #3528\r\n    if (browser.osName != 'iOS' && browser.browserName == 'Safari') {\r\n      return false;\r\n    } \r\n    return true;\r\n  })();\r\n\r\n  browser.hotfixAndroid = (function () {\r\n    if (browser.osName !== 'Android') {\r\n      return false;\r\n    }\r\n    // android    \r\n    var ver = browser.browserVer;\r\n    if (ver) {\r\n      var majorVers = ver.split('.');\r\n      var majorVer = majorVers.length > 0 ? majorVers[0] : 0;\r\n      if (majorVer < 43) { // Lollipop \r\n        return true;\r\n      }\r\n    }\r\n    return false; \r\n  })();\r\n\r\n  browser.hasPointerEvents = ('pointer-events' in bodyStyle) && browser.browserName !== browser.BROWSER_NAME.ie;\r\n  \r\n  browser.vector = browser.hasSVG ? 'SVG' : browser.hasCanvas ? 'Canvas' : browser.hasVML ? 'VML' : '';\r\n  \r\n  browser.styleTranslateTmpl = browser.has3D ? 'translate3d(#{x}px,#{y}px,0)' : 'translate(#{x}px,#{y}px)';\r\n  \r\n  browser.styleScaleTmpl = browser.has3D ? 'scale3d(#{scale}, #{scale}, 1)' : 'scale(#{scale}, #{scale})';\r\n\r\n}(window);\r\nolleh.maps.namespace('olleh.maps', {\r\n  /**\r\n   *   .\r\n   * <pre>\r\n   *  Log levels (tau.log.*):\r\n   *   DEBUG  : 1 (default)\r\n   *   INFO   : 2\r\n   *   WARN   : 3 \r\n   *   ERROR  : 4\r\n   *   FATAL  : 5\r\n   *   NONE   : 6\r\n   * </pre>\r\n   * @example\r\n   * olleh.maps.log('olleh.maps'); // \"olleh.maps\"\r\n   * olleh.maps.log('olleh.maps', 1); // \"[614] olleh.maps\" (614 is milliseconds)\r\n   * olleh.maps.log('olleh.maps', 3, 'debug'); // \"[debug] olleh.maps\"\r\n   * olleh.maps.log('olleh.maps', 3, this, {$tag: 'event'}); // \"@event:[olleh.maps.XXX] olleh.maps\"\r\n   * @param {String} msg   \r\n   * @param {Number} [level=1] : 1(debug) - 6(none),  1(debug)\r\n   * @param {String|Class} [src]    \r\n   * @param {Object} [opts] \r\n   * @param {String} [opts.$tag]  .\r\n   * @returns {String}   \r\n   */\r\n  log: function (msg, level, src, opts) {\r\n    if (olleh.maps.isUndefined(window.console))\r\n      return msg;\r\n    var config = this.log.config, _level = this.log.LEVEL, _class, _package, _tag;\r\n    if (config) {\r\n      _tag = config.$tag;\r\n      // config  tag      .\r\n      if (_tag && _tag.length && olleh.maps.util.indexOf(_tag, opts.$tag) == -1)\r\n        return;\r\n\r\n      if (src && (_class = src.$classname)) {\r\n        _package = _class.substring(0, _class.lastIndexOf('.'));\r\n      }\r\n\r\n      if (_class && _class !== '' && config[_class]) {\r\n        _level = config[_class];\r\n      } else if (_package && _package !== '') {\r\n        while (_package !== '' && !(_level = config[_package])) {\r\n          _package = _package.substring(0, _package.lastIndexOf('.'));\r\n        }\r\n      }\r\n      _level = _level || this.log.LEVEL;\r\n    }\r\n    if (_level <= (olleh.maps.isUndefined(level) ? olleh.maps.log.DEBUG : level)) {\r\n      // Prepends class/context from which the logging is done\r\n      if (level == this.log.DEBUG) {\r\n        msg = '[' + new Date().getMilliseconds() + '] ' + msg;\r\n      }\r\n      if (this.isString(src)) {\r\n        msg = '[' + src + '] ' + msg;\r\n      } else if (this.isObject(src) && src.$classname) {\r\n        msg = '[' + src.$classname + '] ' + msg;\r\n      }\r\n      console.log(msg);\r\n    }\r\n    return msg;\r\n  }\r\n});\r\n\r\n/** \r\n * log\r\n * @example\r\n * olleh.maps.log.LEVEL = olleh.maps.log.DEBUG;\r\n * olleh.maps.log.config = {\r\n *   tag: ['event', 'test1'],\r\n *   'olleh.maps': olleh.maps.log.DEBUG,\r\n *   'olleh.maps.Marker': olleh.maps.log.DEBUG\r\n * };\r\n * \r\n * olleh.maps.log.debug('message....', olleh.maps.log.DEBUG, {tag: 'test1'});\r\n */\r\nolleh.maps.namespace('olleh.maps.log', {\r\n\r\n  LEVEL: olleh.maps.env.LOG_LEVEL !== undefined ? olleh.maps.env.LOG_LEVEL : 3, // Logging level \r\n  DEBUG: 1,\r\n  INFO: 2,\r\n  WARN: 3,\r\n  ERROR: 4,\r\n  FATAL: 5,\r\n  NONE: 6,\r\n\r\n  /**\r\n   * log   config\r\n   * @example\r\n   * olleh.maps.log.config.$tag = ['event', 'test1', 'test2']; //\r\n   * olleh.maps.log.config['com.Test'] = olleh.maps.log.DEBUG; //   .\r\n   * olleh.maps.log.config['com.test'] = olleh.maps.log.DEBUG; //   .\r\n   * @type {Object} \r\n   */\r\n  config: {},\r\n\r\n  /** Checks if the current logging level */\r\n  isLevel: function (level) {\r\n    return this.LEVEL <= level;\r\n  },\r\n  /** Debug logging */\r\n  debug: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.DEBUG, src, opts);\r\n  },\r\n  /** Information logging */\r\n  info: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.INFO, src, opts);\r\n  },\r\n  /** Warning logging */\r\n  warn: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.WARN, src, opts);\r\n  },\r\n  /** Error logging */\r\n  error: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.ERROR, src, opts);\r\n  },\r\n  /** Fatal logging */\r\n  fatal: function (msg, src, opts) {\r\n    this.call(olleh.maps, msg, this.FATAL, src, opts);\r\n  }\r\n});\r\n/**\r\n * Map Utility .\r\n */\r\nolleh.maps.namespace('olleh.maps.util', {\r\n\r\n  /**\r\n   * The number of significant digits to retain to avoid floating point\r\n   * precision errors.\r\n   *\r\n   * We use 14 as a \"safe\" default because, although IEEE 754 double floats\r\n   * (standard on most modern operating systems) support up to about 16\r\n   * significant digits, 14 significant digits are sufficient to represent\r\n   * sub-millimeter accuracy in any coordinate system that anyone is likely to\r\n   * use with OpenLayers.\r\n   *\r\n   * If DEFAULT_PRECISION is set to 0, the original non-truncating behavior\r\n   * of OpenLayers <2.8 is preserved. Be aware that this will cause problems\r\n   * with certain projections, e.g. spherical Mercator.\r\n   * @type {Number}\r\n   */\r\n  DEFAULT_PRECISION: 14,\r\n\r\n  /**\r\n   *       .\r\n   *   .\r\n   * <pre>\r\n   *   inches :       U.S. Surveyor's Inch\r\n   *   ft:\r\n   *   mi:\r\n   *   m:\r\n   *   km:\r\n   *   dd:\r\n   *   yd:\r\n   *   in:            inches \r\n   *   degrees:       dd \r\n   *   nmi:           International Nautical Mile\r\n   *   Inch:          inches \r\n   *   Meter:         EPSG:9001\r\n   *   Foot:          EPSG:9003\r\n   *   IFoot:         EPSG:9002\r\n   *   ClarkeFoot:    EPSG:9005\r\n   *   SearsFoot:     EPSG:9041\r\n   *   GoldCoastFoot: EPSG:9094\r\n   *   IInch:\r\n   *   MicroInch:\r\n   *   Mil:\r\n   *   Centimeter:\r\n   *   Kilometer:     EPSG:9036\r\n   *   Yard:          U.S. Surveyor's Yard\r\n   *   SearsYard:     EPSG:9040\r\n   *   IndianYard:    EPSG:9084\r\n   *   IndianYd37:    EPSG:9085\r\n   *   IndianYd62:    EPSG:9086\r\n   *   IndianYd75:    EPSG:9087\r\n   *   IndianFoot:    EPSG:9080\r\n   *   IndianFt37:    EPSG:9081\r\n   *   IndianFt62:    EPSG:9082\r\n   *   IndianFt75:    EPSG:9083\r\n   *   Mile:          U.S. Surveyor's Statute Mile\r\n   *   IYard:         EPSG:9096\r\n   *   IMile:         EPSG:9093\r\n   *   NautM:         EPSG:9030\r\n   *   Lat-66:\r\n   *   Lat-83:\r\n   *   Decimeter:\r\n   *   Millimeter:\r\n   *   Dekameter:\r\n   *   Decameter:\r\n   *   Hectometer:\r\n   *   GermanMeter:   EPSG:9031\r\n   *   CaGrid:\r\n   *   ClarkeChain:   EPSG:9038\r\n   *   GunterChain:   EPSG:9033\r\n   *   BenoitChain:   EPSG:9062\r\n   *   SearsChain:    EPSG:9042\r\n   *   ClarkeLink:    EPSG:9039\r\n   *   GunterLink:    EPSG:9034\r\n   *   BenoitLink:    EPSG:9063\r\n   *   SearsLink:     EPSG:9043\r\n   *   Rod:\r\n   *   IntnlChain:    EPSG:9097\r\n   *   IntnlLink:     EPSG:9098\r\n   *   Perch:\r\n   *   Pole:\r\n   *   Furlong:\r\n   *   Rood:\r\n   *   CapeFoot:\r\n   *   Brealey:\r\n   *   ModAmFt:\r\n   *   Fathom:        International Fathom\r\n   *   NautM-UK:\r\n   *   50kilometers:\r\n   *   150kilometers:\r\n   *   \r\n   *   mm:            Milimeter \r\n   *   cm:            Centimeter \r\n   *   dm:            \r\n   *   km:            Kilometer \r\n   *   kmi:           nmi \r\n   *   fath:          Fathom \r\n   *   ch:            IntnlChain \r\n   *   lnk:           IntnlLink \r\n   *   us-in:         inches \r\n   *   us-ft:         Foot \r\n   *   us-yd:         Yard \r\n   *   us-ch:         GunterChain \r\n   *   us-mi::        Mile \r\n   *   ind-yd:        IndianYd37 \r\n   *   ind-ft:        IndianFt37 \r\n   *   ind-ch:        Indian Chain\r\n   * </pre>\r\n   * @type {Object}\r\n   */\r\n  INCHES_PER_UNIT: (function () {\r\n    var meters_per_inch = .02540005080010160020;\r\n    var inches_per_unit = {\r\n      'inches': 1.0,\r\n      'ft': 12.0,\r\n      'mi': 63360.0,\r\n      'm': 39.3701,\r\n      'km': 39370.1,\r\n      'dd': 4374754,\r\n      'yd': 36,\r\n      \"nmi\": 1852 * 39.3701,\r\n      \"in\": 1.0, // inches\r\n      \"degrees\": 4374754 // dd\r\n    };\r\n\r\n    olleh.maps.mixin(inches_per_unit, { // Units from CS-Map\r\n      \"Inch\": 1.0,\r\n      \"Meter\": 1.0 / meters_per_inch, //EPSG:9001\r\n      \"Foot\": .30480060960121920243 / meters_per_inch, //EPSG:9003\r\n      \"IFoot\": .30480000000000000000 / meters_per_inch, //EPSG:9002\r\n      \"ClarkeFoot\": .3047972651151 / meters_per_inch, //EPSG:9005\r\n      \"SearsFoot\": .30479947153867624624 / meters_per_inch, //EPSG:9041\r\n      \"GoldCoastFoot\": .30479971018150881758 / meters_per_inch, //EPSG:9094\r\n      \"IInch\": .02540000000000000000 / meters_per_inch,\r\n      \"MicroInch\": .00002540000000000000 / meters_per_inch,\r\n      \"Mil\": .00000002540000000000 / meters_per_inch,\r\n      \"Centimeter\": .01000000000000000000 / meters_per_inch,\r\n      \"Kilometer\": 1000.00000000000000000000 / meters_per_inch, //EPSG:9036\r\n      \"Yard\": .91440182880365760731 / meters_per_inch,\r\n      \"SearsYard\": .914398414616029 / meters_per_inch, //EPSG:9040\r\n      \"IndianYard\": .91439853074444079983 / meters_per_inch, //EPSG:9084\r\n      \"IndianYd37\": .91439523 / meters_per_inch, //EPSG:9085\r\n      \"IndianYd62\": .9143988 / meters_per_inch, //EPSG:9086\r\n      \"IndianYd75\": .9143985 / meters_per_inch, //EPSG:9087\r\n      \"IndianFoot\": .30479951 / meters_per_inch, //EPSG:9080\r\n      \"IndianFt37\": .30479841 / meters_per_inch, //EPSG:9081\r\n      \"IndianFt62\": .3047996 / meters_per_inch, //EPSG:9082\r\n      \"IndianFt75\": .3047995 / meters_per_inch, //EPSG:9083\r\n      \"Mile\": 1609.34721869443738887477 / meters_per_inch,\r\n      \"IYard\": .91440000000000000000 / meters_per_inch, //EPSG:9096\r\n      \"IMile\": 1609.34400000000000000000 / meters_per_inch, //EPSG:9093\r\n      \"NautM\": 1852.00000000000000000000 / meters_per_inch, //EPSG:9030\r\n      \"Lat-66\": 110943.316488932731 / meters_per_inch,\r\n      \"Lat-83\": 110946.25736872234125 / meters_per_inch,\r\n      \"Decimeter\": .10000000000000000000 / meters_per_inch,\r\n      \"Millimeter\": .00100000000000000000 / meters_per_inch,\r\n      \"Dekameter\": 10.00000000000000000000 / meters_per_inch,\r\n      \"Decameter\": 10.00000000000000000000 / meters_per_inch,\r\n      \"Hectometer\": 100.00000000000000000000 / meters_per_inch,\r\n      \"GermanMeter\": 1.0000135965 / meters_per_inch, //EPSG:9031\r\n      \"CaGrid\": .999738 / meters_per_inch,\r\n      \"ClarkeChain\": 20.1166194976 / meters_per_inch, //EPSG:9038\r\n      \"GunterChain\": 20.11684023368047 / meters_per_inch, //EPSG:9033\r\n      \"BenoitChain\": 20.116782494375872 / meters_per_inch, //EPSG:9062\r\n      \"SearsChain\": 20.11676512155 / meters_per_inch, //EPSG:9042\r\n      \"ClarkeLink\": .201166194976 / meters_per_inch, //EPSG:9039\r\n      \"GunterLink\": .2011684023368047 / meters_per_inch, //EPSG:9034\r\n      \"BenoitLink\": .20116782494375872 / meters_per_inch, //EPSG:9063\r\n      \"SearsLink\": .2011676512155 / meters_per_inch, //EPSG:9043\r\n      \"Rod\": 5.02921005842012 / meters_per_inch,\r\n      \"IntnlChain\": 20.1168 / meters_per_inch, //EPSG:9097\r\n      \"IntnlLink\": .201168 / meters_per_inch, //EPSG:9098\r\n      \"Perch\": 5.02921005842012 / meters_per_inch,\r\n      \"Pole\": 5.02921005842012 / meters_per_inch,\r\n      \"Furlong\": 201.1684023368046 / meters_per_inch,\r\n      \"Rood\": 3.778266898 / meters_per_inch,\r\n      \"CapeFoot\": .3047972615 / meters_per_inch,\r\n      \"Brealey\": 375.00000000000000000000 / meters_per_inch,\r\n      \"ModAmFt\": .304812252984505969011938 / meters_per_inch,\r\n      \"Fathom\": 1.8288 / meters_per_inch,\r\n      \"NautM-UK\": 1853.184 / meters_per_inch,\r\n      \"50kilometers\": 50000.0 / meters_per_inch,\r\n      \"150kilometers\": 150000.0 / meters_per_inch\r\n    });\r\n\r\n    olleh.maps.mixin(inches_per_unit, { //unit abbreviations supported by PROJ.4\r\n      \"mm\": inches_per_unit[\"Meter\"] / 1000.0,\r\n      \"cm\": inches_per_unit[\"Meter\"] / 100.0,\r\n      \"dm\": inches_per_unit[\"Meter\"] * 100.0,\r\n      \"km\": inches_per_unit[\"Meter\"] * 1000.0,\r\n      \"kmi\": inches_per_unit[\"nmi\"], //International Nautical Mile\r\n      \"fath\": inches_per_unit[\"Fathom\"], //International Fathom\r\n      \"ch\": inches_per_unit[\"IntnlChain\"], //International Chain\r\n      \"link\": inches_per_unit[\"IntnlLink\"], //International Link\r\n      \"us-in\": inches_per_unit[\"inches\"], //U.S. Surveyor's Inch\r\n      \"us-ft\": inches_per_unit[\"Foot\"], //U.S. Surveyor's Foot\r\n      \"us-yd\": inches_per_unit[\"Yard\"], //U.S. Surveyor's Yard\r\n      \"us-ch\": inches_per_unit[\"GunterChain\"], //U.S. Surveyor's Chain\r\n      \"us-mi\": inches_per_unit[\"Mile\"], //U.S. Surveyor's Statute Mile\r\n      \"ind-yd\": inches_per_unit[\"IndianYd37\"], //Indian Yard\r\n      \"ind-ft\": inches_per_unit[\"IndianFt37\"], //Indian Foot\r\n      \"ind-ch\": 20.11669506 / meters_per_inch //Indian Chain\r\n    });\r\n    \r\n    return inches_per_unit;\r\n  })(),\r\n\r\n  /**\r\n   * dot  \r\n   * @type Number\r\n   */\r\n  DOTS_PER_INCH: 72,\r\n\r\n  /**\r\n   * Unique id seed (incremented as new IDs are created)\r\n   * @type {Number}\r\n   */\r\n  _ID_SEED: new Date().getTime(),\r\n\r\n  /**\r\n   *     .\r\n   * <p/>\r\n   *  <code>null</code>  <code>''</code>\r\n   *  prefix     id\r\n   *  .\r\n   * @example\r\n   * olleh.maps.util.genId(); // \"ollehmap1339376987400\"\r\n   * olleh.maps.util.getId(null); // 1339376987401\r\n   * olleh.maps.util.genId(''); // \"1339376987402\"\r\n   * olleh.maps.util.genId('olleh'); // \"olleh1339376987403\"\r\n   *\r\n   * @param {String} [prefix]  id  prefix (default: 'ollehmap') \r\n   * @returns {String}   id\r\n   */\r\n  genId: function (prefix) {\r\n    return (olleh.maps.isUndefined(prefix) ? 'ollehmap' : (prefix || '')) + (++olleh.maps.util._ID_SEED);\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @example\r\n   * olleh.maps.util.radToDeg(1.5707963267948966); // 90.0000000000002\r\n   * @param {Float} degree \r\n   * @returns {Float}\r\n   */\r\n  radToDeg: function (radian) {\r\n    return radian * 180 / Math.PI;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @example\r\n   * olleh.maps.util.degToRad(90); //  90  . 1.5707963267948966\r\n   * @param {Float} degree \r\n   * @returns {Float}\r\n   */\r\n  degToRad: function (degree) {\r\n    return degree * Math.PI / 180; //  Math.PI / 180 : 1 \r\n  },\r\n\r\n  /**\r\n   * Convenience method to cast an object to a Number, rounded to the\r\n   * desired floating point precision.\r\n   * @param {Number|String} num Number   Number .\r\n   * @param {Number} [precision=olleh.maps.util.DEFAULT_PRECISION] An integer suitable for use with\r\n   *      Number.toPrecision(). If set to 0, no rounding is performed. \r\n   * @returns {Number} The cast, rounded number\r\n   * @throws {TypeError} num Number type ,       .\r\n   */\r\n  toFloat: function (num, precision) {\r\n    olleh.maps.isString(num) && (num = parseFloat(num));\r\n\r\n    if (!olleh.maps.isNumber(num))\r\n      throw new TypeError('Specified num is not Number type: ' + num);\r\n\r\n    precision = precision || olleh.maps.util.DEFAULT_PRECISION;\r\n\r\n    return precision === 0 ? num : parseFloat(num.toPrecision(precision));\r\n  },\r\n\r\n  /**\r\n   * (scale) ('km', 'cm'...)  resolution .\r\n   * @example\r\n   * olleh.maps.util.getResolutionFromScale(25000);\r\n   * olleh.maps.util.getResolutionFromScale(1/25000);\r\n   * @param {Number} scale\r\n   * @param {String} [units='Meter'] {@link olleh.maps.util.INCHES_PER_UNIT}   .\r\n   * @returns {Number}\r\n   * @throws {TypeError} scale Number     .\r\n   */\r\n  getResolutionFromScale: function (scale, units) {\r\n    if (!olleh.maps.isNumber(scale))\r\n      throw new TypeError('Specified scale is not Number type: ' + scale);\r\n\r\n    var resolution;\r\n    if (scale) {\r\n      units = units || \"Meter\"; // olleh map  Meter?\r\n      var normScale = (scale > 1.0) ? (1.0 / scale) : scale;\r\n      resolution = 1 / (normScale * this.INCHES_PER_UNIT[units] * this.DOTS_PER_INCH);\r\n    }\r\n    return resolution;\r\n  },\r\n\r\n  /**\r\n   * resolution ('km', 'cm'...)  (scale) .\r\n   * @example\r\n   * olleh.maps.util.getScaleFromResolution(1024);\r\n   * olleh.maps.util.getScaleFromResolution(2048);\r\n   * @param {Number} resolution\r\n   * @param {String} [units='Meter'] {@link olleh.maps.util.INCHES_PER_UNIT}   .\r\n   * @returns {Number}\r\n   * @throws {TypeError} resolution Number     .\r\n   */\r\n  getScaleFromResolution: function (resolution, units) {\r\n    if (!olleh.maps.isNumber(resolution))\r\n      throw new TypeError('Specified resolution is not Number type: ' + resolution);\r\n\r\n    return resolution * this.INCHES_PER_UNIT[units || \"Meter\"] * this.DOTS_PER_INCH;\r\n  },\r\n\r\n  /**\r\n   *   place holder    .\r\n   *  Place Holder  data property   \r\n   * '#{'  '}' .\r\n   * @example\r\n   * var tmpl = '<h2>#{title}</h2><p>#{content}</p>';\r\n   * var data = {title: 'Some title', content: 'Some cool content coming...'};\r\n   * var result = olleh.maps.util.applyTemplate(tmpl, data);\r\n   * // result value is '<h2>Some title</h2><p>Some cool content coming...</p>'\r\n   * @param {String} tmpl  \r\n   * @param {Object} data      JSON\r\n   */\r\n  applyTemplate: function (tmpl, data) {\r\n    var item, to, regexp = /#\\{(\\w+)\\}/g;\r\n    while (item = regexp.exec(tmpl)) {\r\n      to = data[item[1]];\r\n      if (to !== undefined && to !== null) {\r\n        tmpl = tmpl.replace(new RegExp(item[0], 'g'), to);\r\n        regexp.lastIndex = item.index;\r\n      }\r\n    }\r\n    return tmpl;\r\n  },\r\n\r\n  /**\r\n   *   elem    .\r\n   * @param {Array} arr\r\n   * @param {Object} elem   element\r\n   * @param {Number} fromIndex   \r\n   * @returns {Number}\r\n   * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.14\r\n   */\r\n  indexOf: function (arr, elem, fromIndex) {\r\n    var indexOf = arr.indexOf;\r\n\r\n    if (indexOf) {\r\n      return indexOf.call(arr, elem, fromIndex);\r\n    }\r\n\r\n    if (!olleh.maps.isArray(arr)) {\r\n      throw new TypeError();\r\n    }\r\n    var len = arr.length;\r\n    if (len === 0) {\r\n      return -1;\r\n    }\r\n    var n = 0;\r\n    if (arguments.length > 2) {\r\n      n = Number(fromIndex);\r\n      if (n != n) {\r\n        n = 0;\r\n      } else if (n != 0 && n != Infinity && n != -Infinity) {\r\n        n = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n      }\r\n    }\r\n    if (n >= len) {\r\n      return -1;\r\n    }\r\n    var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\r\n    for (; k < len; k++) {\r\n      if (arr[k] === elem) {\r\n        return k;\r\n      }\r\n    }\r\n    return -1;\r\n  },\r\n\r\n  /**\r\n   *   elem    .\r\n   * @param {Array} arr\r\n   * @param {Object} elem   element\r\n   * @param {Number} fromIndex   \r\n   * @returns {Number}\r\n   * @see http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.15\r\n   */\r\n  lastIndexOf: function (arr, elem, fromIndex) {\r\n    var lastIndexOf = arr.lastIndexOf;\r\n\r\n    if (lastIndexOf) {\r\n      return lastIndexOf.call(arr, elem, olleh.maps.isNumber(fromIndex) ? fromIndex : -1);\r\n    }\r\n\r\n    if (!olleh.maps.isArray(arr)) {\r\n      throw new TypeError();\r\n    }\r\n    var len = arr.length;\r\n    if (len === 0) {\r\n      return -1;\r\n    }\r\n    var n = len;\r\n    if (arguments.length > 2) {\r\n      n = Number(fromIndex);\r\n      if (n != n) {\r\n        n = 0;\r\n      } else if (n != 0 && n != Infinity && n != -Infinity) {\r\n        n = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n      }\r\n    }\r\n\r\n    var k = n >= 0 ? Math.min(n, len - 1) : len - Math.abs(n);\r\n    for (; k >= 0; k--) {\r\n      if (arr[k] === elem) {\r\n        return k;\r\n      }\r\n    }\r\n    return -1;\r\n  },\r\n\r\n  /**\r\n   * Array    .\r\n   * @param {Array} arr\r\n   * @param {Object} toRemove\r\n   * @returns {Number}      index,    -1\r\n   */\r\n  removeFromArray: function (arr, toRemove) {\r\n    var index = olleh.maps.util.indexOf(arr, toRemove);\r\n    if (index > -1) {\r\n      arr.splice(index, 1);\r\n    }\r\n    return index;\r\n  },\r\n\r\n  /**\r\n   *  \r\n   * @param {String} string\r\n   * @returns {String}\r\n   */\r\n  trim: function (string) {\r\n    var trim = string.trim;\r\n\r\n    if (trim) {\r\n      return trim.call(string);\r\n    }\r\n\r\n    var str = string.replace(/^\\s+/, \"\");\r\n    var end = str.length - 1;\r\n    var ws = /\\s/;\r\n\r\n    while (ws.test(str.charAt(end))) {\r\n      end--;\r\n    }\r\n\r\n    return str.slice(0, end + 1);\r\n  },\r\n\r\n  /**\r\n   * src   dest   .\r\n   * @param {Object} dest  \r\n   * @param {Object} src  \r\n   * @param {Array} excludes     \r\n   */\r\n  copyOpts: function (dest, src, excludes) {\r\n    var p;\r\n    for (p in src) {\r\n      if (src.hasOwnProperty(p) && (!excludes || olleh.maps.util.indexOf(excludes, p) === -1)) {\r\n        dest[p] = src[p];\r\n      }\r\n    }\r\n    return dest;\r\n  },\r\n\r\n  /**\r\n   * @param {Object} object\r\n   * @returns {Object}\r\n   */\r\n  clone: function (object) {\r\n    var i, clone;\r\n    if (object == null) {\r\n      clone = null;\r\n    } else if (olleh.maps.isObject(object)) {\r\n      if (olleh.maps.isArray(object)) {\r\n        clone = [];\r\n        for(i = 0; i < object.length ; i++) {\r\n          clone[i] = olleh.maps.util.clone(object[i]);\r\n        }\r\n      } else if (olleh.maps.isDate(object)) {\r\n        clone = new Date(object.getTime());\r\n      } else if (olleh.maps.isRegExp(object)) {\r\n        clone = new RegExp(object.source);\r\n      } else if (object.clone) {\r\n        clone = object.clone();\r\n      } else {\r\n        clone = {};\r\n        for (i in object) {\r\n          if (object.hasOwnProperty(i)) {\r\n            clone[i] = object[i];\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      clone = object;\r\n    }\r\n    return clone;\r\n  },\r\n  \r\n  /**\r\n   * string  prefix    .\r\n   * @returns {Boolean} string  prefix   true\r\n   */\r\n  startsWith: function(str, prefix) {\r\n    return str.slice(0, prefix.length) === prefix;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * @param {Function} fn  \r\n   * @param {Number} milis  \r\n   * @param {Object} [ctx] context \r\n   * @param {Any} [args...]   \r\n   */\r\n  delay: function (fn, milis, ctx, args) {\r\n    args = Array.prototype.slice.call(arguments, 3);\r\n    var curried = Function.prototype.bind.apply(fn, [ctx].concat(args));\r\n    return window.setTimeout(curried, milis);\r\n  },\r\n  \r\n  /**\r\n   *       .\r\n   * @param {Function} fn  \r\n   * @param {Object} [ctx] context \r\n   * @param {Any} [args...]   \r\n   */\r\n  defer: function (fn, ctx, args) {\r\n    args = Array.prototype.slice.call(arguments, 2);\r\n    return olleh.maps.util.delay.apply(this, [fn, 1, ctx].concat(args));\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * @param {Function} fn  \r\n   * @param {Object} [ctx] context \r\n   * @param {Any} [args...]   \r\n   */\r\n  deferAF: function (fn, ctx, args) {\r\n    args = Array.prototype.slice.call(arguments, 2);\r\n    //var curried = Function.prototype.bind.apply(fn, [ctx].concat(args)); \r\n    //bind  requestAnimationFrame    timeStamp   \r\n    var curried = olleh.maps.curry.apply(this, [fn, ctx].concat(args));\r\n    return window.requestAnimationFrame(curried);\r\n  }\r\n  \r\n});\r\n/**\r\n * DOM    .\r\n * <h3>DOM Element   </h3>\r\n * <ul>\r\n *   <li>{@link olleh.maps.util.dom.getStyle}</li>\r\n *   <li>{@link olleh.maps.util.dom.getComputedStyle}</li>\r\n *   <li>{@link olleh.maps.util.dom.setStyle}</li>\r\n *   <li>{@link olleh.maps.util.dom.setStyles}</li>\r\n *   <li>{@link olleh.maps.util.dom.addClass}</li>\r\n *   <li>{@link olleh.maps.util.dom.hasClass}</li>\r\n *   <li>{@link olleh.maps.util.dom.removeClass}</li>\r\n *   <li>{@link olleh.maps.util.dom.toggleClass}</li>\r\n * </ul>\r\n * <h3>DOM Element  </h3>\r\n * <ul>\r\n *   <li>{@link olleh.maps.util.dom.elementOf}</li>\r\n *   <li>{@link olleh.maps.util.dom.pushElement}</li>\r\n *   <li>{@link olleh.maps.util.dom.popElement}</li>\r\n *   <li>{@link olleh.maps.util.dom.removeElements}</li>\r\n * </ul>\r\n * <h3>DOM Element </h3>\r\n * <ul>\r\n *   <li>{@link olleh.maps.util.dom.getXY}</li>\r\n * </ul>\r\n */\r\nolleh.maps.namespace('olleh.maps.util.dom', {\r\n  \r\n  /**\r\n   * CSS UNIT\r\n   * @private\r\n   */\r\n  CSS_UNITS: ['in', 'cm', 'mm', 'em', 'ex', 'pt', 'pc', 'px'],\r\n  \r\n  /**\r\n   * DOM element        .\r\n   * @example\r\n   * \r\n   * var elem = document.getElementById('div1');\r\n   * elem.style['background'] = 'red';\r\n   * var value = olleh.maps.util.dom.getStyle(elem, 'background');  // red\r\n   * \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} style  . Camel Notation .background-image -> backgroundImage\r\n   * @returns {String} DOM Element   \r\n   */\r\n  getStyle: function (elem, style) {\r\n    if (!olleh.maps.isElement(elem)) {\r\n      olleh.maps.log.error('Specified elem is not HTML Element: ' + elem);\r\n      return;\r\n    }\r\n\r\n    style = olleh.maps.browser.style[style] || style;\r\n    if (style.get) {\r\n      return style.get(elem);\r\n    }\r\n    return elem.style[style];\r\n  },\r\n\r\n  /**\r\n   * DOM Element    .\r\n   * @example\r\n   * \r\n   * var elem = document.getElementById('div1');\r\n   * ...\r\n   * \r\n   * var value = olleh.maps.util.dom.getComputedStyle(elem, 'width');\r\n   *  \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} style  . Camel Notation .background-image -> backgroundImage\r\n   * @returns {String}   DOM Element  \r\n   */\r\n  getComputedStyle: function (elem, style) {\r\n    var ns = olleh.maps.util.dom;\r\n    var n, t = null;\r\n\r\n    var browserStyle = olleh.maps.browser.style;\r\n    if (browserStyle[style]) {\r\n      style = browserStyle[style];\r\n      if (style.get) {\r\n        return style.get(elem);\r\n      }\r\n    }\r\n    \r\n    if (elem.currentStyle) {\r\n      t = elem.currentStyle[style];\r\n      if (t == 'auto') {\r\n        n = ns.hyphenToCamelCase('offset-' + style);\r\n        if (n in elem) {\r\n          t = elem[n];\r\n        } else {\r\n          t = '0';\r\n        }\r\n      }\r\n    } else if (window.getComputedStyle) {\r\n      t = document.defaultView.getComputedStyle(elem, null).getPropertyValue(\r\n          ns.camelCaseToHyphen(style));\r\n    }\r\n\r\n    if (t == 'none') {\r\n      if (style == 'transform') {\r\n        t = 'matrix(1,0,0,1,0,0)';\r\n      }\r\n    }\r\n    \r\n    return t || ns.getStyle(elem, style);\r\n  },\r\n  \r\n  /**\r\n   * DOM Element   .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.setStyle(elem, 'width', '100px');\r\n   * olleh.maps.util.dom.setStyle(elem, 'paddingLeft', '10px');\r\n   * var value = olleh.maps.util.dom.getStyle(elem, 'width'); // 100px\r\n   * @param {HTMLElement} elem HTML \r\n   * @param {String} style  . Camel Notation .background-image -> backgroundImage \r\n   * @param {String} value  \r\n   * @see olleh.maps.util.dom.getStyle\r\n   */\r\n  setStyle: function (elem, style, value) {\r\n    if (!olleh.maps.isElement(elem)) {\r\n      olleh.maps.log.error('Specified elem is not HTML Element: ' + elem);\r\n      return;\r\n    }\r\n    \r\n    var browserStyle = olleh.maps.browser.style;\r\n    \r\n    if (browserStyle[style]) {\r\n      style = browserStyle[style];\r\n      if (style.set) {\r\n        style.set(elem, value);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    elem.style[style] = value;\r\n  },\r\n\r\n  /**\r\n   * DOM Element  json    .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.setStlyes(elem, {\r\n   *   'width': '100px',\r\n   *   'height': '200px',\r\n   *   'backgroundColor': 'red'\r\n   * });\r\n   * @param {HTMLElement} elem HTML element\r\n   * @param {Object} styles style name  value   Object Literals\r\n   * @param {String} styles.style  . Camel Notation .background-image -> backgroundImage\r\n   * @param {String} styles.value  \r\n   * @see olleh.maps.util.dom.setStyle \r\n   */\r\n  setStyles: function (elem, styles) {\r\n    var setStyle = olleh.maps.util.dom.setStyle;\r\n    for (var k in styles) {\r\n      setStyle(elem, k, styles[k]);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  DOM Element className .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo1');\r\n   * olleh.maps.util.dom.addClass(elem, 'foo2');\r\n   * \r\n   * @param {HTMLElement} elem HTML DOM Element\r\n   * @param {String} className CSS  \r\n   * @returns {Boolean}  CSS class  <code>true</code> .\r\n   */\r\n  addClass: function (elem, className) {\r\n    if (!elem || !className) {\r\n      return false;\r\n    }\r\n    var classList = elem.classList;\r\n    if (classList) {\r\n      classList.add(className);\r\n      return true;\r\n    } else if (olleh.maps.isString(elem.className)){\r\n      if (!olleh.maps.util.dom.hasClass(elem, className)) {\r\n        elem.className += (elem.className ? ' ' : '') + className;\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  DOM Element CSS className  \r\n   *   .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo')); // true\r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} className CSS \r\n   * @returns {Boolean}  className   <code>true</code> .\r\n   */\r\n  hasClass: function (elem, className) {\r\n    if (elem) {\r\n      var classList = elem.classList;\r\n      if (classList) {\r\n        return classList.contains(className);\r\n      } else {\r\n        var elemClassName = elem.className;\r\n        return (olleh.maps.isString(elemClassName) && \r\n            elemClassName.length > 0 && (elemClassName == className || \r\n            new RegExp('\\\\b' + className + '\\\\b').test(elemClassName)));\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  HTML DOM className .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo')); // true\r\n   * olleh.maps.util.dom.removeClass(elem, 'foo');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo')); // false \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} className css  \r\n   * @returns {Boolean}  CSS class  <code>true</code> .\r\n   */\r\n  removeClass: function (elem, className) {\r\n    if (elem && className) {\r\n      var classList = elem.classList;\r\n      if (classList) {\r\n        classList.remove(className);\r\n      } else {\r\n        if (olleh.maps.isString(elem.className)) {\r\n          elem.className = elem.className.replace(new RegExp(\"(^|\\\\s+)\" + \r\n              className + \"(\\\\s+|$)\"), ' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  DOM Element oldClassName   newClassName   .<p/>\r\n   *  oldClassName    newClassName  .\r\n   * @exmple\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo1');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // true\r\n   * olleh.maps.util.dom.replaceClass(elem, 'foo2');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // false \r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo2')); // true \r\n   * @param {HTMLElement} elem DOM Element\r\n   * @param {String} oldC    \r\n   * @param {String} newC    \r\n   * @returns {Boolean}     <code>true</code> .\r\n   */\r\n  replaceClass: function (elem, oldC, newC) {\r\n    if (elem) {\r\n      var classList = elem.classList;\r\n      if (classList) {\r\n        if (oldC) {\r\n          classList.remove(oldC);\r\n        }\r\n        classList.add(newC);\r\n      } else {\r\n        var ns = olleh.maps.util.dom;\r\n        if (ns.hasClass(elem, oldC)) {\r\n          elem.className = elem.className.replace(new RegExp(\"(^|\\\\s+)\" + \r\n              oldC + \"(\\\\s+|$)\"), ' ' + newC).replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n        } else {\r\n          ns.addClass(elem, newC);\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  DOM Element oldClassName   newClassName   .<p/>\r\n   *  oldClassName    newClassName  .\r\n   * @exmple\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * olleh.maps.util.dom.addClass(elem, 'foo1');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // true\r\n   * olleh.maps.util.dom.toggleClass(elem, 'foo1');\r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // false\r\n   * olleh.maps.util.dom.toggleClass(elem, 'foo1'); \r\n   * olleh.maps.log.info(olleh.maps.util.dom.hasClass(elem, 'foo1')); // true\r\n   * @param {HTMLElement} dom HTML DOM Element\r\n   * @param {String} oldClassName    \r\n   * @param {String} newClassName    \r\n   * @returns {Boolean}     true .\r\n   */\r\n  toggleClass: function (elem, name) {\r\n    var ns = olleh.maps.util.dom;\r\n    return ns.hasClass(elem, name) ? ns.removeClass(elem, name) : ns.addClass(elem, name);\r\n  },\r\n\r\n  /**\r\n   *  id   HTML  \r\n   * .\r\n   * @example\r\n   * var elem = document.getElementById('div1');\r\n   * \r\n   * var div1 = olleh.maps.util.dom.elementOf('div1');\r\n   * \r\n   * olleh.maps.log.info(elem === div1);  // true\r\n \r\n   * @param {String|Object} id  id  HTMLElement id\r\n   *  element DOM element  \r\n   * @return {HTMLElement} DOM element specified by the id\r\n   */\r\n  elementOf: function (id) {\r\n    return id ? document.getElementById(id) : null;\r\n  },\r\n\r\n  /**\r\n   *  HTML (elem) parent  \r\n   * child .\r\n   * @param {HTMLElement} parent  DOM Element\r\n   * @param {HTMLElement} elem  DOM Element\r\n   * @returns {Boolean}  (elm)  \r\n   * true .\r\n   */\r\n  pushElement: function (parent, elem) {\r\n    if (parent.children && parent.children[0]) {\r\n      return parent.insertBefore(elem, parent.children[0]) !== null;\r\n    } else {\r\n      return parent.appendChild(elem) !== null;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * parent  Child   child\r\n   *    .\r\n   * @param {HTMLElement} parent  DOM Element\r\n   * @param {HTMLElement} elem  DOM Element\r\n   */\r\n  popElement: function (parent, elem) {\r\n    if (!parent) {\r\n      parent = elem.parent;\r\n    }\r\n    if (parent && elem && parent.removeChild(elem)) {\r\n      return elem;\r\n    }\r\n    return null;\r\n  },\r\n\r\n  /** \r\n   *  HTML     .\r\n   *   comma(,)   \r\n   *  .\r\n   * @example\r\n   * olleh.maps.util.dom.removeElements(div1);\r\n   * olleh.maps.util.dom.removeElements(div1, div2, div3);\r\n   * olleh.maps.util.dom.removeElements([div1, div2, div3]);\r\n   * \r\n   * @param {...HTMLElement|Array.<HTMLElement>} elem  DOM Element. DOM Element   1  DOM Element  .\r\n   * @returns {Array.<HTMLElement>}  HTML DOM Element \r\n   */\r\n  removeElements: function (elem) {\r\n    var i, e, r, elems, removed;\r\n    var ns = olleh.maps.util.dom;\r\n    if (arguments.length === 1 && elem.parentNode) {\r\n      return elem.parentNode.removeChild(elem); // Remove a single DOM element\r\n    } else if (arguments.length > 1) {\r\n      elems = arguments; // Multiple parameters\r\n    } else if (!olleh.maps.isString(elem) && elem.length) {\r\n      elems = elem; // Single array parameter\r\n    }\r\n\r\n    // Handles Paramter/Element list removal\r\n    removed = [];\r\n    if (elems) {\r\n      i = elems.length;\r\n      while(i--) {\r\n        e = elems[i];\r\n        r = null;\r\n        if (e.length) {\r\n          r = ns.removeElements(e); // Recursively remove a list\r\n        } else if (e.parentNode) {\r\n          r = e.parentNode.removeChild(e); // Remove single DOM directly\r\n        }\r\n\r\n        // Update removed DOM list\r\n        if (olleh.maps.isArray(r)) {\r\n          removed.unshift.apply(removed, r);\r\n        } else if (r) {\r\n          removed.unshift(r);\r\n        }\r\n      }\r\n    }\r\n    return removed;\r\n  },\r\n\r\n  /** \r\n   * CSS      .\r\n   * @example\r\n   * olleh.maps.util.extractValueFromStyle('200px') == 200.0 // true\r\n   * @TODO olleh.maps.util  \r\n   * @param {String} str CSS  \r\n   * @returns {Number} CSS  \r\n   */\r\n  extractValueFromStyle: function (str) {\r\n    try {\r\n      var result = parseFloat(str);\r\n      if (isNaN(result)) {\r\n        return 0;\r\n      }\r\n      return result;\r\n    } catch (e) {\r\n      return 0;\r\n    }\r\n  },\r\n\r\n  /** \r\n   * CSS   .\r\n   * @example\r\n   * olleh.maps.util.extractValueFromStyle('200px') == 'px' // true\r\n   * @TODO olleh.maps.util  \r\n   * @param {String} str CSS  \r\n   * @returns {String} CSS  \r\n   */\r\n  extractUnitFromStyle: function (str) {\r\n    if (str === \"\") {\r\n      return \"\";\r\n    }\r\n    var value = olleh.maps.util.dom.extractValueFromStyle(str);\r\n    var unit = str.replace(value, \"\");\r\n    return unit;\r\n  },\r\n\r\n  /**\r\n   *         translate3d .\r\n   *    translate .\r\n   * @example\r\n   * var str = olleh.maps.util.getTranslateString(100px, 100px); // translate3d(100px,100px,0)  translate(100px,100px)\r\n   * @TODO olleh.maps.util  \r\n   * @param {Number} x x offset\r\n   * @param {Number} y y offset\r\n   * @param {Boolean} use3D <code>false</code> 3D   3D  .\r\n   * @returns {String}\r\n   */\r\n  getTranslateString: function (x, y, use3D) {\r\n    var tmpl = olleh.maps.browser.has3D && use3D !== false ? 'translate3d(#{x}px, #{y}px, 0px)' : 'translate(#{x}px, #{y}px)';\r\n    return olleh.maps.util.applyTemplate(tmpl, {\r\n      x: x,\r\n      y: y\r\n    });\r\n  },\r\n\r\n  /**\r\n   *         scale3d .\r\n   *    scale .\r\n   * @example\r\n   * var str = olleh.maps.util.getScaleString(100px, 100px); // scale3d(2,2,1)  scale(2,2)\r\n   * @TODO olleh.maps.util  \r\n   * @param {Number} scale scale\r\n   * @param {Boolean} use3D <code>false</code> 3D   3D  .\r\n   * @returns {String}\r\n   */\r\n  getScaleString: function (scale, use3D) {\r\n    var tmpl = olleh.maps.browser.has3D && use3D !== false ? 'scale3d(#{scale}, #{scale}, 1)' : 'scale(#{scale}, #{scale})';\r\n    return olleh.maps.util.applyTemplate(tmpl, {\r\n      scale: scale\r\n    });\r\n  },\r\n  \r\n\r\n  /**\r\n   * Position   left, top     json  .\r\n   * transform     \r\n   *   left/top   .\r\n   * @example\r\n   * olleh.maps.util.getPositionStyles(100, 100); // {left: 100px, top: 100px}\r\n   * olleh.maps.util.getPositionStyles(100, 100, true); // translate3d(100px,100px,0)  translate(100px,100px)\r\n   * @TODO olleh.maps.util  \r\n   * @param {Number} x x offset\r\n   * @param {Number} y y offset\r\n   * @param {Boolean} useTransform <code>false</code> transform   transform  .\r\n   * @param {Boolean} use3D <code>false</code> 3D   3D  . \r\n   * @returns {{transform: String} | {left: String, top: String}}\r\n   */\r\n  getPositionStyles: function (x, y, useTransform, use3D) {\r\n    if (useTransform !== false && olleh.maps.browser.style.transform) {\r\n      return {\r\n        transform: olleh.maps.util.dom.getTranslateString(x, y, use3D)\r\n      };\r\n    }\r\n    return {\r\n      left: x + 'px',\r\n      top: y + 'px'\r\n    };\r\n  },\r\n\r\n  /**\r\n   * json       .\r\n   * <p/>\r\n   *  animation      DOM Element     .\r\n   * @example\r\n   * olleh.maps.util.getPointFromStyle({left: 100px, top: 100px, background: red});\r\n   * olleh.maps.util.getPointFromStyle({translate(100px, 200px), background: red});\r\n   * olleh.maps.util.getPointFromStyle({translate3d(100px, 200px, 0), background: red});\r\n   * @TODO olleh.maps.util  \r\n   * @param {Object} styles\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  getPointFromStyle: function (style) {\r\n    var x = 0, y = 0;\r\n    if (style.transform) {\r\n      var parsed = olleh.maps.util.dom.parseStyleValue(style.transform);\r\n      loop: for (var i = 0; i < parsed.length; i++) {\r\n        var params = parsed[i].params;\r\n        switch (parsed[i].name) {\r\n        case 'translate': // translate(tx,ty)\r\n        case 'translate3d': // translate3d(tx,ty,tz)\r\n          x = params[0].value;\r\n          y = params[1].value;\r\n          break loop;\r\n        case 'matrix': // matrix(1,0,0,1,tx,ty)\r\n          x = params[4].value;\r\n          y = params[5].value;\r\n          break loop;\r\n        case 'matrix3d': // matrix3d(1,0,0,0, 0,1,0,0, 0,0,1,0, tx,ty,tz,1)\r\n          x = params[12].value;\r\n          y = params[13].value;\r\n          break loop;\r\n        }\r\n      }\r\n    } else {\r\n      style.left && (x = style.left);\r\n      style.top && (y = style.top);\r\n    }\r\n    return new olleh.maps.Point(parseFloat(x), parseFloat(y));\r\n  },\r\n\r\n  /**\r\n   * viewport(body)  DOM element x,y  .\r\n   * @param {HTMLElement} elem DOM element\r\n   * @return {olleh.maps.Point} viewport(body)  element x,y  . {x: 10, y:20} \r\n   */\r\n  getXY: function (elem) {\r\n    var webkitConvert = window.webkitConvertPointFromNodeToPage;\r\n    if (webkitConvert) {\r\n      var point = webkitConvert(elem, new WebKitPoint(0, 0));\r\n      return new olleh.maps.Point(point.x, point.y);\r\n    }\r\n    var rect = elem.getBoundingClientRect();\r\n    var pageXOffset = 0, pageYOffset = 0; \r\n    if (olleh.maps.isNumber(window.pageXOffset) && olleh.maps.isNumber(window.pageYOffset)) {\r\n      pageXOffset = window.pageXOffset;\r\n      pageYOffset = window.pageYOffset;\r\n    } else {\r\n      var body = document.body;\r\n      var browser = olleh.maps.browser;\r\n      var ie8 = (browser.browserName === browser.BROWSER_NAME.ie) &&(browser.browserVer < 9);\r\n\r\n      pageXOffset = body.scrollLeft;\r\n      pageYOffset = body.scrollTop +  ie8 ? document.documentElement.scrollTop : 0;\r\n    }\r\n    \r\n    return new olleh.maps.Point(rect.left + pageXOffset, rect.top + pageYOffset)._round();\r\n  },\r\n  \r\n  /**\r\n   *   CSS  camelCase .\r\n   * @example\r\n   * olleh.maps.util.hyphenToCamelCase('margin-top') === 'marginTop';\r\n   * olleh.maps.util.hyphenToCamelCase('-webkit-transition') === 'webkitTransition'\r\n   * @TODO olleh.maps.util  \r\n   * @params {String}   CSS \r\n   * @returns {String} camelCase  CSS \r\n   */\r\n  hyphenToCamelCase: function (str) {\r\n    if(str.lastIndexOf('-', 0) === 0)\r\n      str = str.substr(1);\r\n    return str.replace(/-([a-z])/g, olleh.maps.util.dom._cbHyphenToCamelCase);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cbHyphenToCamelCase: function (_, c) {\r\n    return c.toUpperCase();\r\n  },\r\n\r\n  /**\r\n   * camelCase  CSS   .\r\n   * @example\r\n   * olleh.maps.util.hyphenToCamelCase('marginTop') === 'margin-top';\r\n   * olleh.maps.util.hyphenToCamelCase('webkitTransition') === '-webkit-transition'\r\n   * @TODO olleh.maps.util  \r\n   * @params {String} camelCase  CSS \r\n   * @returns {String}   CSS \r\n   */\r\n  camelCaseToHyphen: function (str) {\r\n    var result = str.replace(/([A-Z])/g, olleh.maps.util.dom._cbCamelCaseToHyphen);\r\n    if(result.lastIndexOf('webkit-', 0) === 0 || result.lastIndexOf('moz-', 0) === 0\r\n        || result.lastIndexOf('ms-', 0) === 0 || result.lastIndexOf('o-', 0) === 0) {\r\n      result = '-' + result;\r\n    }\r\n    return result;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cbCamelCaseToHyphen: function (_, c) {\r\n    return '-' + c.toLowerCase();\r\n  },\r\n  \r\n  /**\r\n   * @param {Array} value \r\n   * @TODO olleh.maps.util  \r\n   * @returns {Array}\r\n   */\r\n  parseStyleValue: function (value) {\r\n    var trim = olleh.maps.util.trim; \r\n    var uv = olleh.maps.util.dom.getUnitAndValue;\r\n    var i, c, stack = [], opts = [], methodParams = [], methodName = null;\r\n    \r\n    if (!value) return opts;\r\n    value = '' + value;\r\n    \r\n    for (i = 0; i < value.length; i++) {\r\n      c = value.charAt(i);\r\n      if (c == '(') {\r\n        methodName = trim(stack.join(''));\r\n        stack.length = 0;\r\n        continue;\r\n      } else if (c == ')') {\r\n        if (stack.length > 0) {\r\n          methodParams.push(uv(trim(stack.join(''))));\r\n          stack = [];\r\n        }\r\n        opts.push({\r\n          name: methodName,\r\n          params: methodParams\r\n        });\r\n        methodName = null;\r\n        methodParams = [];\r\n        continue;\r\n      } else if (c == ',' && methodName) {\r\n        if (stack.length > 0) {\r\n          methodParams.push(uv(trim(stack.join(''))));\r\n          stack = [];\r\n        }\r\n      } else if(c == ' ' && !methodName) {\r\n        if(stack.length > 0) {\r\n          opts.push(uv(stack.join('')));\r\n          stack = [];\r\n        }\r\n      } else {\r\n        stack.push(c);\r\n      }\r\n    }\r\n    if (stack.length > 0) {\r\n      opts.push(uv(stack.join('')));\r\n    }\r\n    return opts;\r\n  },\r\n  \r\n  /**\r\n   * @param {Array} parsedStyle\r\n   * @TODO olleh.maps.util   \r\n   * @returns {String}\r\n   */\r\n  parsedStyleToString: function (parsedStyle) {\r\n    var i, j, s, methodResult, result = [];\r\n    \r\n    if (!parsedStyle) return '';\r\n    \r\n    for (i = 0; i < parsedStyle.length; i++) {\r\n      s = parsedStyle[i];\r\n      if (s.name) {\r\n        methodResult = [];\r\n        for (j = 0; j < s.params.length; j++) {\r\n          methodResult.push(s.params[j].value + s.params[j].unit);\r\n        }\r\n        result.push(s.name + '(' + methodResult.join(', ') + ')');\r\n      } else {\r\n        result.push(s.value + s.unit);\r\n      }\r\n    }\r\n    return result.join(' ');\r\n  },\r\n  \r\n  /** \r\n   * CSS      .\r\n   * px, em, %  , rgb(), url()    .\r\n   *       .\r\n   *        .\r\n   *          split   .\r\n   *  \r\n   * @example \r\n   * olleh.maps.util.extractValueFromStyle('200px') === [200, 'px'];\r\n   * olleh.maps.util.extractValueFromStyle('0') === [0, ''];\r\n   * olleh.maps.util.extractValueFromStyle('blue') === ['blue', ''];\r\n   * olleh.maps.util.extractValueFromStyle('rgb(10,20,30)') === ['rgb(10,20,30)', ''];\r\n   * olleh.maps.util.extractValueFromStyle('200px 100px') === ['200px 100px', ''];\r\n   * @TODO olleh.maps.util  \r\n   * @param {String} str CSS  \r\n   * @returns {Array} 0: CSS  , 1: CSS  \r\n   */\r\n  getUnitAndValue: function (str) {\r\n    var i, unit, value, floatValue;\r\n    var CSS_UNITS = olleh.maps.util.dom.CSS_UNITS;\r\n          \r\n    if (str == '') {\r\n      return { unit: '', value: '' };\r\n    }\r\n    \r\n    if (str.slice(-1) == '%') {\r\n      unit = '%';\r\n      value = str.slice(0, -1);\r\n    } else {\r\n      i = olleh.maps.util.indexOf(CSS_UNITS, str.slice(-2));\r\n      if (i == -1) {\r\n        unit = '';\r\n        value = str;\r\n      } else {\r\n        unit = CSS_UNITS[i];\r\n        value = str.slice(0, -2);\r\n      }\r\n    }\r\n    \r\n    floatValue = parseFloat(value);\r\n    \r\n    if (floatValue != value) {\r\n      return { unit: '', value: value + unit };\r\n    } \r\n    return { unit: unit, value: floatValue };\r\n  }\r\n});\n/**\r\n *         .\r\n * KT      /    Adaptable  \r\n *  . Adpatable      \r\n * setMap(map)    setMap(null)   .\r\n * Adaptable  mixin    extend   mixin   .\r\n * @group Base \r\n */\r\n$class('olleh.maps.Adaptable').define({\r\n  \r\n  /**\r\n   *  \r\n   * @name map\r\n   * @field\r\n   * @memberof olleh.maps.Adaptable.prototype\r\n   * @type olleh.maps.Map\r\n   */\r\n  /**\r\n   * Service Id. Service Id      \r\n   * {@link olleh.maps.Map#services}    serviceId  key \r\n   *     .\r\n   * @name serviceId\r\n   * @field\r\n   * @memberof olleh.maps.Adaptable.prototype \r\n   * @type String\r\n   */\r\n  \r\n  /**\r\n   *     .\r\n   * @return {boolean}    <code>true</code>,    <code>false</code>\r\n   */\r\n  isAttached: function () {\r\n    return !!this.map;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @return {olleh.maps.Map}     {@link olleh.maps.Map} ,    <code>null</code>. \r\n   */\r\n  getMap: function () {\r\n    return this.map;\r\n  },\r\n  \r\n  /**\r\n   *  Adaptable   .\r\n   * @param {olleh.maps.Map|null} map Adaptable   . <code>null</code>     . \r\n   */\r\n  setMap: function (map) {\r\n    if (this.map != map) {\r\n      if (this.map) {\r\n        this._unregisterService();\r\n        this.detach();\r\n      }\r\n      this.map = map;\r\n      if (this.map) {\r\n        this._registerService();\r\n        this.attach();\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  map service registry  \r\n   * @private\r\n   */\r\n  _unregisterService: function() {\r\n    if(this.serviceId) {\r\n      this.map.services[this.serviceId] === this && delete this.map.services[this.serviceId];\r\n    }\r\n  },\r\n\r\n  /**\r\n   * service id    map service registry  \r\n   * @private\r\n   */\r\n  _registerService: function() {\r\n    if(this.serviceId) {\r\n      if(this.map.services[this.serviceId])\r\n        olleh.maps.log('[Warning] Duplicate service id: ' + this.serviceId);\r\n      else\r\n        this.map.services[this.serviceId] = this;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     . {@link olleh.maps.Adaptable} \r\n   *          .\r\n   *     {@link olleh.maps.Adaptable#map}   Adaptable   {@link olleh.maps.Map}  .\r\n   */\r\n  attach: function () {\r\n  },\r\n\r\n  /**\r\n   *     . {@link olleh.maps.Adaptable} \r\n   *          .\r\n   *     {@link olleh.maps.Adaptable#map}  Adaptable   {@link olleh.maps.Map}  .\r\n   */\r\n  detach: function () {\r\n  }\r\n});\r\n/**\n * PluginInfo  Plugin    . \n * @typedef olleh.maps.PluginInfo \n * @property {String} [label] PluginControl    \n * @property {String} [group] group   PluginControl   .\n * @property {Boolean} [autoActivate=false] true  plugin      activate()  . \n * @property {boolean} [drawingTool=false] Drawing tool  . Drawing tool   plugin    plugin  active \r\n *  drawing tool plugin   deactivate .  \r\n */\n\n/**\n * Plugin   /      interface . \n */\n$class('olleh.maps.Plugin').mixin(olleh.maps.Adaptable).define({\n\n  /**\n   * Plugin     .\n   * @name olleh.maps.Plugin#pluginInfo\n   * @type olleh.maps.PluginInfo\n   */\n  /**\n   * pluginInfo    .  pluginInfo    \n   *   .\n   * @param {olleh.maps.PluginInfo} \n   */\n  setPluginInfo: function(pluginInfo) {\n    var current = olleh.maps.util.clone(this.pluginInfo);\n    this.pluginInfo = olleh.maps.mixin(current, pluginInfo, true);\n  },\n\n  /**\n   *  Plugin   .    .\n   * @param {olleh.maps.Map|null} map Plugin   . <code>null</code>     . \n   */\n  setMap: function (map) {\n    if (this.map != map) {\n      if (this.map) {\n        this._unregisterService();\n        this.map.pluginRegistry.remove(this);\n        this.deactivate();\n        this.detach();\n      }\n      this.map = map;\n      if (map) {\n        this._registerService();\n        this.map.pluginRegistry.add(this);\n        this.attach();\n        if(this.pluginInfo && this.pluginInfo.autoActivate) {\n          if(map.isStarted()) {\n            this.activate();\n          } else {\n            var callActivate = function() {\n              this.activate();\n              this.map.unsubscribeEvent(callActivate);\n            };\n            map.onEvent('started', callActivate, this);\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Plugin   .    .\n   * @returns {Boolean}\n   */\n  isActive: function () {\n    return !!this._active;\n  },\n\n  /**\n   * Plugin  .   .\n   */\n  activate: function () {\n    if (!this.isAttached() || this.isActive())\n      return;\n    if(this.map && this.pluginInfo && this.pluginInfo.drawingTool) {\n      this.map.pluginRegistry.drawingToolActivate(this);\n    }\n    this.doActivate();\n    this.setActive(true);\n  },\n\n  /**\n   *  activate  deactive   \n   * @name plugin_state_changed\n   * @event\n   * @memberOf olleh.maps.PluginRegistry.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   * active    fire .\n   * doActivate()          activate()   . \n   * @param active\n   * @private \n   */\n  setActive: function(active) {\n    this._active = active;\n    if(this.map) {\n      this.map.pluginRegistry.fireEvent('plugin_state_changed', {\n        plugin: this,\r\n        active: active\r\n      });\n    }\n  },\n\n  /**\n   * Plugin  .    .\n   */\n  deactivate: function () {\n    if (!this.isAttached() || !this.isActive())\n      return;\n    this.doDeactivate();\n    this.setActive(false);\n  },\n\n  /**\n   * Plugin     . Plugin        .\n   * @private \n   */\n  doActivate: function () {\n    // Clients should implments this\n  },\n\n  /**\n   * Plugin     . Plugin        .\n   * @private\n   */\n  doDeactivate: function () {\r\n    // Clients should implments this\n  }\n\n});\n/**\r\n *             \r\n *     .\r\n * \r\n *             \r\n *             .\r\n *             \r\n *           .<p/>\r\n * \r\n * ,              \r\n *            .<p/>\r\n * \r\n * {@link olleh.maps.Initializable}        \r\n *    {@link olleh.maps.Initializable#init}  \r\n *       callback  .  {@link olleh.maps.Initializable#init} \r\n *              .<p/>\r\n\r\n *   olleh.maps.Initializable      setMap \r\n *  foo.Bar  foo.Baz  opts property \r\n * setMap           . <p/>\r\n *        init    \r\n *      . \r\n * @example\r\n * $('foo.Bar').extend(olleh.maps.Initializable).define({\r\n *   Bar: function (opts) {\r\n *     this.opts = opts;\r\n *     //this.setMap(opts.map); <-- erroneous use\r\n *   },\r\n *   \r\n *   init: function () { // called back after instance construction\r\n *     this.setMap(this.opts.map);\r\n *   },\r\n *   \r\n *   setMap: function (map) {\r\n *     ...\r\n *   },\r\n *   \r\n *   ...\r\n * });\r\n * \r\n * $('foo.Baz').extend(foo.Bar).define({\r\n *   Baz: function (opts) {\r\n *     // tweak opts properties\r\n *     this.opts.xxx = ...\r\n *   }\r\n * });\r\n */\r\n$class('olleh.maps.Initializable').define({\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  Initializable: function () {\r\n    var $constructor = this.$constructor;\r\n    if ($constructor) {\r\n      // wrap origin constructor and do indirect call\r\n      this.$constructor = function () {\r\n        $constructor.apply(this, arguments);\r\n        this.init();\r\n      };\r\n    } else {\r\n      this.$constructor = this.init;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *         callback . Initializable \r\n   *   init         . \r\n   */\r\n  init: function () {\r\n    // do nothing\r\n  }\r\n});/*\nAuthor:       Mike Adair madairATdmsolutions.ca\n              Richard Greenwood rich@greenwoodmap.com\nLicense:      LGPL as per: http://www.gnu.org/copyleft/lesser.html\n\n$Id: Proj.js 2956 2007-07-09 12:17:52Z steven $\n*/\n\n/**\n * Namespace: Proj4js\n *\n * Proj4js is a JavaScript library to transform point coordinates from one \n * coordinate system to another, including datum transformations.\n *\n * This library is a port of both the Proj.4 and GCTCP C libraries to JavaScript. \n * Enabling these transformations in the browser allows geographic data stored \n * in different projections to be combined in browser-based web mapping \n * applications.\n * \n * Proj4js must have access to coordinate system initialization strings (which\n * are the same as for PROJ.4 command line).  Thes can be included in your \n * application using a <script> tag or Proj4js can load CS initialization \n * strings from a local directory or a web service such as spatialreference.org.\n *\n * Similarly, Proj4js must have access to projection transform code.  These can\n * be included individually using a <script> tag in your page, built into a \n * custom build of Proj4js or loaded dynamically at run-time.  Using the\n * -combined and -compressed versions of Proj4js includes all projection class\n * code by default.\n *\n * Note that dynamic loading of defs and code happens ascynchrously, check the\n * Proj.readyToUse flag before using the Proj object.  If the defs and code\n * required by your application are loaded through script tags, dynamic loading\n * is not required and the Proj object will be readyToUse on return from the \n * constructor.\n * \n * All coordinates are handled as points which have a .x and a .y property\n * which will be modified in place.\n *\n * Override Proj4js.reportError for output of alerts and warnings.\n *\n * See http://trac.osgeo.org/proj4js/wiki/UserGuide for full details.\n*/\n\n/**\n * Global namespace object for Proj4js library\n */\nvar Proj4js = {\n\n    /**\n     * Property: defaultDatum\n     * The datum to use when no others a specified\n     */\n    defaultDatum: 'WGS84',                  //default datum\n\n    /** \n    * Method: transform(source, dest, point)\n    * Transform a point coordinate from one map projection to another.  This is\n    * really the only public method you should need to use.\n    *\n    * Parameters:\n    * source - {Proj4js.Proj} source map projection for the transformation\n    * dest - {Proj4js.Proj} destination map projection for the transformation\n    * point - {Object} point to transform, may be geodetic (long, lat) or\n    *     projected Cartesian (x,y), but should always have x,y properties.\n    */\n    transform: function(source, dest, point) {\n        if (!source.readyToUse) {\n            this.reportError(\"Proj4js initialization for:\"+source.srsCode+\" not yet complete\");\n            return point;\n        }\n        if (!dest.readyToUse) {\n            this.reportError(\"Proj4js initialization for:\"+dest.srsCode+\" not yet complete\");\n            return point;\n        }\n        \n        // Workaround for datum shifts towgs84, if either source or destination projection is not wgs84\n        if (source.datum && dest.datum && (\n            ((source.datum.datum_type == Proj4js.common.PJD_3PARAM || source.datum.datum_type == Proj4js.common.PJD_7PARAM) && dest.datumCode != \"WGS84\") ||\n            ((dest.datum.datum_type == Proj4js.common.PJD_3PARAM || dest.datum.datum_type == Proj4js.common.PJD_7PARAM) && source.datumCode != \"WGS84\"))) {\n            var wgs84 = Proj4js.WGS84;\n            this.transform(source, wgs84, point);\n            source = wgs84;\n        }\n\n        // DGR, 2010/11/12\n        if (source.axis!=\"enu\") {\n            this.adjust_axis(source,false,point);\n        }\n\n        // Transform source points to long/lat, if they aren't already.\n        if ( source.projName==\"longlat\") {\n            point.x *= Proj4js.common.D2R;  // convert degrees to radians\n            point.y *= Proj4js.common.D2R;\n        } else {\n            if (source.to_meter) {\n                point.x *= source.to_meter;\n                point.y *= source.to_meter;\n            }\n            source.inverse(point); // Convert Cartesian to longlat\n        }\n\n        // Adjust for the prime meridian if necessary\n        if (source.from_greenwich) { \n            point.x += source.from_greenwich; \n        }\n\n        // Convert datums if needed, and if possible.\n        point = this.datum_transform( source.datum, dest.datum, point );\n\n        // Adjust for the prime meridian if necessary\n        if (dest.from_greenwich) {\n            point.x -= dest.from_greenwich;\n        }\n\n        if( dest.projName==\"longlat\" ) {             \n            // convert radians to decimal degrees\n            point.x *= Proj4js.common.R2D;\n            point.y *= Proj4js.common.R2D;\n        } else  {               // else project\n            dest.forward(point);\n            if (dest.to_meter) {\n                point.x /= dest.to_meter;\n                point.y /= dest.to_meter;\n            }\n        }\n\n        // DGR, 2010/11/12\n        if (dest.axis!=\"enu\") {\n            this.adjust_axis(dest,true,point);\n        }\n\n        return point;\n    }, // transform()\n\n    /** datum_transform()\n      source coordinate system definition,\n      destination coordinate system definition,\n      point to transform in geodetic coordinates (long, lat, height)\n    */\n    datum_transform : function( source, dest, point ) {\n\n      // Short cut if the datums are identical.\n      if( source.compare_datums( dest ) ) {\n          return point; // in this case, zero is sucess,\n                    // whereas cs_compare_datums returns 1 to indicate TRUE\n                    // confusing, should fix this\n      }\n\n      // Explicitly skip datum transform by setting 'datum=none' as parameter for either source or dest\n      if( source.datum_type == Proj4js.common.PJD_NODATUM\n          || dest.datum_type == Proj4js.common.PJD_NODATUM) {\n          return point;\n      }\n\n      // Do we need to go through geocentric coordinates?\n      if( source.es != dest.es || source.a != dest.a\n          || source.datum_type == Proj4js.common.PJD_3PARAM\n          || source.datum_type == Proj4js.common.PJD_7PARAM\n          || dest.datum_type == Proj4js.common.PJD_3PARAM\n          || dest.datum_type == Proj4js.common.PJD_7PARAM)\n      {\n\n        // Convert to geocentric coordinates.\n        source.geodetic_to_geocentric( point );\n        // CHECK_RETURN;\n\n        // Convert between datums\n        if( source.datum_type == Proj4js.common.PJD_3PARAM || source.datum_type == Proj4js.common.PJD_7PARAM ) {\n          source.geocentric_to_wgs84(point);\n          // CHECK_RETURN;\n        }\n\n        if( dest.datum_type == Proj4js.common.PJD_3PARAM || dest.datum_type == Proj4js.common.PJD_7PARAM ) {\n          dest.geocentric_from_wgs84(point);\n          // CHECK_RETURN;\n        }\n\n        // Convert back to geodetic coordinates\n        dest.geocentric_to_geodetic( point );\n          // CHECK_RETURN;\n      }\n\n      return point;\n    }, // cs_datum_transform\n\n    /**\n     * Function: adjust_axis\n     * Normalize or de-normalized the x/y/z axes.  The normal form is \"enu\"\n     * (easting, northing, up).\n     * Parameters:\n     * crs {Proj4js.Proj} the coordinate reference system\n     * denorm {Boolean} when false, normalize\n     * point {Object} the coordinates to adjust\n     */\n    adjust_axis: function(crs, denorm, point) {\n        var xin= point.x, yin= point.y, zin= point.z || 0.0;\n        var v, t;\n        for (var i= 0; i<3; i++) {\n            if (denorm && i==2 && point.z===undefined) { continue; }\n                 if (i==0) { v= xin; t= 'x'; }\n            else if (i==1) { v= yin; t= 'y'; }\n            else           { v= zin; t= 'z'; }\n            switch(crs.axis[i]) {\n            case 'e':\n                point[t]= v;\n                break;\n            case 'w':\n                point[t]= -v;\n                break;\n            case 'n':\n                point[t]= v;\n                break;\n            case 's':\n                point[t]= -v;\n                break;\n            case 'u':\n                if (point[t]!==undefined) { point.z= v; }\n                break;\n            case 'd':\n                if (point[t]!==undefined) { point.z= -v; }\n                break;\n            default :\n                alert(\"ERROR: unknow axis (\"+crs.axis[i]+\") - check definition of \"+crs.projName);\n                return null;\n            }\n        }\n        return point;\n    },\n\n    /**\n     * Function: reportError\n     * An internal method to report errors back to user. \n     * Override this in applications to report error messages or throw exceptions.\n     */\n    reportError: function(msg) {\n      //console.log(msg);\n    },\n\n/**\n *\n * Title: Private Methods\n * The following properties and methods are intended for internal use only.\n *\n * This is a minimal implementation of JavaScript inheritance methods so that \n * Proj4js can be used as a stand-alone library.\n * These are copies of the equivalent OpenLayers methods at v2.7\n */\n \n/**\n * Function: extend\n * Copy all properties of a source object to a destination object.  Modifies\n *     the passed in destination object.  Any properties on the source object\n *     that are set to undefined will not be (re)set on the destination object.\n *\n * Parameters:\n * destination - {Object} The object that will be modified\n * source - {Object} The object with properties to be set on the destination\n *\n * Returns:\n * {Object} The destination object.\n */\n    extend: function(destination, source) {\n      destination = destination || {};\n      if(source) {\n          for(var property in source) {\n              var value = source[property];\n              if(value !== undefined) {\n                  destination[property] = value;\n              }\n          }\n      }\n      return destination;\n    },\n\n/**\n * Constructor: Class\n * Base class used to construct all other classes. Includes support for \n *     multiple inheritance. \n *  \n */\n    Class: function() {\n      var Class = function() {\n          this.initialize.apply(this, arguments);\n      };\n  \n      var extended = {};\n      var parent;\n      for(var i=0; i<arguments.length; ++i) {\n          if(typeof arguments[i] == \"function\") {\n              // get the prototype of the superclass\n              parent = arguments[i].prototype;\n          } else {\n              // in this case we're extending with the prototype\n              parent = arguments[i];\n          }\n          Proj4js.extend(extended, parent);\n      }\n      Class.prototype = extended;\n      \n      return Class;\n    },\n\n    /**\n     * Function: bind\n     * Bind a function to an object.  Method to easily create closures with\n     *     'this' altered.\n     * \n     * Parameters:\n     * func - {Function} Input function.\n     * object - {Object} The object to bind to the input function (as this).\n     * \n     * Returns:\n     * {Function} A closure with 'this' set to the passed in object.\n     */\n    bind: function(func, object) {\n        // create a reference to all arguments past the second one\n        var args = Array.prototype.slice.apply(arguments, [2]);\n        return function() {\n            // Push on any additional arguments from the actual function call.\n            // These will come after those sent to the bind call.\n            var newArgs = args.concat(\n                Array.prototype.slice.apply(arguments, [0])\n            );\n            return func.apply(object, newArgs);\n        };\n    },\n    \n/**\n * The following properties and methods handle dynamic loading of JSON objects.\n */\n \n    /**\n     * Property: scriptName\n     * {String} The filename of this script without any path.\n     */\n    scriptName: \"proj4js.js\",\n\n    /**\n     * Property: defsLookupService\n     * AJAX service to retreive projection definition parameters from\n     */\n    defsLookupService: 'http://spatialreference.org/ref',\n\n    /**\n     * Property: libPath\n     * internal: http server path to library code.\n     */\n    libPath: null,\n\n    /**\n     * Function: getScriptLocation\n     * Return the path to this script.\n     *\n     * Returns:\n     * Path to this script\n     */\n    getScriptLocation: function () {\n        if (this.libPath) return this.libPath;\n        var scriptName = this.scriptName;\n        var scriptNameLen = scriptName.length;\n\n        var scripts = document.getElementsByTagName('script');\n        for (var i = 0; i < scripts.length; i++) {\n            var src = scripts[i].getAttribute('src');\n            if (src) {\n                var index = src.lastIndexOf(scriptName);\n                // is it found, at the end of the URL?\n                if ((index > -1) && (index + scriptNameLen == src.length)) {\n                    this.libPath = src.slice(0, -scriptNameLen);\n                    break;\n                }\n            }\n        }\n        return this.libPath||\"\";\n    },\n\n    /**\n     * Function: loadScript\n     * Load a JS file from a URL into a <script> tag in the page.\n     * \n     * Parameters:\n     * url - {String} The URL containing the script to load\n     * onload - {Function} A method to be executed when the script loads successfully\n     * onfail - {Function} A method to be executed when there is an error loading the script\n     * loadCheck - {Function} A boolean method that checks to see if the script \n     *            has loaded.  Typically this just checks for the existance of\n     *            an object in the file just loaded.\n     */\n    loadScript: function(url, onload, onfail, loadCheck) {\n      var script = document.createElement('script');\n      script.defer = false;\n      script.type = \"text/javascript\";\n      script.id = url;\n      script.src = url;\n      script.onload = onload;\n      script.onerror = onfail;\n      script.loadCheck = loadCheck;\n      if (/MSIE/.test(navigator.userAgent)) {\n        script.onreadystatechange = this.checkReadyState;\n      }\n      document.getElementsByTagName('head')[0].appendChild(script);\n    },\n    \n    /**\n     * Function: checkReadyState\n     * IE workaround since there is no onerror handler.  Calls the user defined \n     * loadCheck method to determine if the script is loaded.\n     * \n     */\n    checkReadyState: function() {\n      if (this.readyState == 'loaded') {\n        if (!this.loadCheck()) {\n          this.onerror();\n        } else {\n          this.onload();\n        }\n      }\n    }\n};\n\n/**\n * Class: Proj4js.Proj\n *\n * Proj objects provide transformation methods for point coordinates\n * between geodetic latitude/longitude and a projected coordinate system. \n * once they have been initialized with a projection code.\n *\n * Initialization of Proj objects is with a projection code, usually EPSG codes,\n * which is the key that will be used with the Proj4js.defs array.\n * \n * The code passed in will be stripped of colons and converted to uppercase\n * to locate projection definition files.\n *\n * A projection object has properties for units and title strings.\n */\nProj4js.Proj = Proj4js.Class({\n\n  /**\n   * Property: readyToUse\n   * Flag to indicate if initialization is complete for this Proj object\n   */\n  readyToUse: false,   \n  \n  /**\n   * Property: title\n   * The title to describe the projection\n   */\n  title: null,  \n  \n  /**\n   * Property: projName\n   * The projection class for this projection, e.g. lcc (lambert conformal conic,\n   * or merc for mercator).  These are exactly equivalent to their Proj4 \n   * counterparts.\n   */\n  projName: null,\n  /**\n   * Property: units\n   * The units of the projection.  Values include 'm' and 'degrees'\n   */\n  units: null,\n  /**\n   * Property: datum\n   * The datum specified for the projection\n   */\n  datum: null,\n  /**\n   * Property: x0\n   * The x coordinate origin\n   */\n  x0: 0,\n  /**\n   * Property: y0\n   * The y coordinate origin\n   */\n  y0: 0,\n  /**\n   * Property: localCS\n   * Flag to indicate if the projection is a local one in which no transforms\n   * are required.\n   */\n  localCS: false,\n\n  /**\n  * Property: queue\n  * Buffer (FIFO) to hold callbacks waiting to be called when projection loaded.\n  */\n  queue: null,\n\n  /**\n  * Constructor: initialize\n  * Constructor for Proj4js.Proj objects\n  *\n  * Parameters:\n  * srsCode - a code for map projection definition parameters.  These are usually\n  * (but not always) EPSG codes.\n  */\n  initialize: function(srsCode, callback) {\n      this.srsCodeInput = srsCode;\n      \n      //Register callbacks prior to attempting to process definition\n      this.queue = [];\n      if( callback ){\n           this.queue.push( callback );\n      }\n      \n      //check to see if this is a WKT string\n      if ((srsCode.indexOf('GEOGCS') >= 0) ||\n          (srsCode.indexOf('GEOCCS') >= 0) ||\n          (srsCode.indexOf('PROJCS') >= 0) ||\n          (srsCode.indexOf('LOCAL_CS') >= 0)) {\n            this.parseWKT(srsCode);\n            this.deriveConstants();\n            this.loadProjCode(this.projName);\n            return;\n      }\n      \n      // DGR 2008-08-03 : support urn and url\n      if (srsCode.indexOf('urn:') == 0) {\n          //urn:ORIGINATOR:def:crs:CODESPACE:VERSION:ID\n          var urn = srsCode.split(':');\n          if ((urn[1] == 'ogc' || urn[1] =='x-ogc') &&\n              (urn[2] =='def') &&\n              (urn[3] =='crs')) {\n              srsCode = urn[4]+':'+urn[urn.length-1];\n          }\n      } else if (srsCode.indexOf('http://') == 0) {\n          //url#ID\n          var url = srsCode.split('#');\n          if (url[0].match(/epsg.org/)) {\n            // http://www.epsg.org/#\n            srsCode = 'EPSG:'+url[1];\n          } else if (url[0].match(/RIG.xml/)) {\n            //http://librairies.ign.fr/geoportail/resources/RIG.xml#\n            //http://interop.ign.fr/registers/ign/RIG.xml#\n            srsCode = 'IGNF:'+url[1];\n          }\n      }\n      this.srsCode = srsCode.toUpperCase();\n      if (this.srsCode.indexOf(\"EPSG\") == 0) {\n          this.srsCode = this.srsCode;\n          this.srsAuth = 'epsg';\n          this.srsProjNumber = this.srsCode.substring(5);\n      // DGR 2007-11-20 : authority IGNF\n      } else if (this.srsCode.indexOf(\"IGNF\") == 0) {\n          this.srsCode = this.srsCode;\n          this.srsAuth = 'IGNF';\n          this.srsProjNumber = this.srsCode.substring(5);\n      // DGR 2008-06-19 : pseudo-authority CRS for WMS\n      } else if (this.srsCode.indexOf(\"CRS\") == 0) {\n          this.srsCode = this.srsCode;\n          this.srsAuth = 'CRS';\n          this.srsProjNumber = this.srsCode.substring(4);\n      } else {\n          this.srsAuth = '';\n          this.srsProjNumber = this.srsCode;\n      }\n      \n      this.loadProjDefinition();\n  },\n  \n/**\n * Function: loadProjDefinition\n *    Loads the coordinate system initialization string if required.\n *    Note that dynamic loading happens asynchronously so an application must \n *    wait for the readyToUse property is set to true.\n *    To prevent dynamic loading, include the defs through a script tag in\n *    your application.\n *\n */\n    loadProjDefinition: function() {\n      //check in memory\n      if (Proj4js.defs[this.srsCode]) {\n        this.defsLoaded();\n        return;\n      }\n\n      //else check for def on the server\n      var url = Proj4js.getScriptLocation() + 'defs/' + this.srsAuth.toUpperCase() + this.srsProjNumber + '.js';\n      Proj4js.loadScript(url, \n                Proj4js.bind(this.defsLoaded, this),\n                Proj4js.bind(this.loadFromService, this),\n                Proj4js.bind(this.checkDefsLoaded, this) );\n    },\n\n/**\n * Function: loadFromService\n *    Creates the REST URL for loading the definition from a web service and \n *    loads it.\n *\n */\n    loadFromService: function() {\n      //else load from web service\n      var url = Proj4js.defsLookupService +'/' + this.srsAuth +'/'+ this.srsProjNumber + '/proj4js/';\n      Proj4js.loadScript(url, \n            Proj4js.bind(this.defsLoaded, this),\n            Proj4js.bind(this.defsFailed, this),\n            Proj4js.bind(this.checkDefsLoaded, this) );\n    },\n\n/**\n * Function: defsLoaded\n * Continues the Proj object initilization once the def file is loaded\n *\n */\n    defsLoaded: function() {\n      this.parseDefs();\n      this.loadProjCode(this.projName);\n    },\n    \n/**\n * Function: checkDefsLoaded\n *    This is the loadCheck method to see if the def object exists\n *\n */\n    checkDefsLoaded: function() {\n      if (Proj4js.defs[this.srsCode]) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n /**\n * Function: defsFailed\n *    Report an error in loading the defs file, but continue on using WGS84\n *\n */\n   defsFailed: function() {\n      Proj4js.reportError('failed to load projection definition for: '+this.srsCode);\n      Proj4js.defs[this.srsCode] = Proj4js.defs['WGS84'];  //set it to something so it can at least continue\n      this.defsLoaded();\n    },\n\n/**\n * Function: loadProjCode\n *    Loads projection class code dynamically if required.\n *     Projection code may be included either through a script tag or in\n *     a built version of proj4js\n *\n */\n    loadProjCode: function(projName) {\n      if (Proj4js.Proj[projName]) {\n        this.initTransforms();\n        return;\n      }\n\n      //the URL for the projection code\n      var url = Proj4js.getScriptLocation() + 'projCode/' + projName + '.js';\n      Proj4js.loadScript(url, \n              Proj4js.bind(this.loadProjCodeSuccess, this, projName),\n              Proj4js.bind(this.loadProjCodeFailure, this, projName), \n              Proj4js.bind(this.checkCodeLoaded, this, projName) );\n    },\n\n /**\n * Function: loadProjCodeSuccess\n *    Loads any proj dependencies or continue on to final initialization.\n *\n */\n    loadProjCodeSuccess: function(projName) {\n      if (Proj4js.Proj[projName].dependsOn){\n        this.loadProjCode(Proj4js.Proj[projName].dependsOn);\n      } else {\n        this.initTransforms();\n      }\n    },\n\n /**\n * Function: defsFailed\n *    Report an error in loading the proj file.  Initialization of the Proj\n *    object has failed and the readyToUse flag will never be set.\n *\n */\n    loadProjCodeFailure: function(projName) {\n      Proj4js.reportError(\"failed to find projection file for: \" + projName);\n      //TBD initialize with identity transforms so proj will still work?\n    },\n    \n/**\n * Function: checkCodeLoaded\n *    This is the loadCheck method to see if the projection code is loaded\n *\n */\n    checkCodeLoaded: function(projName) {\n      if (Proj4js.Proj[projName]) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n/**\n * Function: initTransforms\n *    Finalize the initialization of the Proj object\n *\n */\n    initTransforms: function() {\n      Proj4js.extend(this, Proj4js.Proj[this.projName]);\n      this.init();\n      this.readyToUse = true;\n      if( this.queue ) {\n        var item;\n        while( (item = this.queue.shift()) ) {\n          item.call( this, this );\n        }\n      }\n  },\n\n/**\n * Function: parseWKT\n * Parses a WKT string to get initialization parameters\n *\n */\n wktRE: /^(\\w+)\\[(.*)\\]$/,\n parseWKT: function(wkt) {\n    var wktMatch = wkt.match(this.wktRE);\n    if (!wktMatch) return;\n    var wktObject = wktMatch[1];\n    var wktContent = wktMatch[2];\n    var wktTemp = wktContent.split(\",\");\n    var wktName;\n    if (wktObject.toUpperCase() == \"TOWGS84\") {\n      wktName = wktObject;  //no name supplied for the TOWGS84 array\n    } else {\n      wktName = wktTemp.shift();\n    }\n    wktName = wktName.replace(/^\\\"/,\"\");\n    wktName = wktName.replace(/\\\"$/,\"\");\n    \n    /*\n    wktContent = wktTemp.join(\",\");\n    var wktArray = wktContent.split(\"],\");\n    for (var i=0; i<wktArray.length-1; ++i) {\n      wktArray[i] += \"]\";\n    }\n    */\n    \n    var wktArray = new Array();\n    var bkCount = 0;\n    var obj = \"\";\n    for (var i=0; i<wktTemp.length; ++i) {\n      var token = wktTemp[i];\n      for (var j=0; j<token.length; ++j) {\n        if (token.charAt(j) == \"[\") ++bkCount;\n        if (token.charAt(j) == \"]\") --bkCount;\n      }\n      obj += token;\n      if (bkCount === 0) {\n        wktArray.push(obj);\n        obj = \"\";\n      } else {\n        obj += \",\";\n      }\n    }\n    \n    //do something based on the type of the wktObject being parsed\n    //add in variations in the spelling as required\n    switch (wktObject) {\n      case 'LOCAL_CS':\n        this.projName = 'identity';\n        this.localCS = true;\n        this.srsCode = wktName;\n        break;\n      case 'GEOGCS':\n        this.projName = 'longlat';\n        this.geocsCode = wktName;\n        if (!this.srsCode) this.srsCode = wktName;\n        break;\n      case 'PROJCS':\n        this.srsCode = wktName;\n        break;\n      case 'GEOCCS':\n        break;\n      case 'PROJECTION':\n        this.projName = Proj4js.wktProjections[wktName];\n        break;\n      case 'DATUM':\n        this.datumName = wktName;\n        break;\n      case 'LOCAL_DATUM':\n        this.datumCode = 'none';\n        break;\n      case 'SPHEROID':\n        this.ellps = wktName;\n        this.a = parseFloat(wktArray.shift());\n        this.rf = parseFloat(wktArray.shift());\n        break;\n      case 'PRIMEM':\n        this.from_greenwich = parseFloat(wktArray.shift()); //to radians?\n        break;\n      case 'UNIT':\n        this.units = wktName;\n        this.unitsPerMeter = parseFloat(wktArray.shift());\n        break;\n      case 'PARAMETER':\n        var name = wktName.toLowerCase();\n        var value = parseFloat(wktArray.shift());\n        //there may be many variations on the wktName values, add in case\n        //statements as required\n        switch (name) {\n          case 'false_easting':\n            this.x0 = value;\n            break;\n          case 'false_northing':\n            this.y0 = value;\n            break;\n          case 'scale_factor':\n            this.k0 = value;\n            break;\n          case 'central_meridian':\n            this.long0 = value*Proj4js.common.D2R;\n            break;\n          case 'latitude_of_origin':\n            this.lat0 = value*Proj4js.common.D2R;\n            break;\n          case 'more_here':\n            break;\n          default:\n            break;\n        }\n        break;\n      case 'TOWGS84':\n        this.datum_params = wktArray;\n        break;\n      //DGR 2010-11-12: AXIS\n      case 'AXIS':\n        var name= wktName.toLowerCase();\n        var value= wktArray.shift();\n        switch (value) {\n          case 'EAST' : value= 'e'; break;\n          case 'WEST' : value= 'w'; break;\n          case 'NORTH': value= 'n'; break;\n          case 'SOUTH': value= 's'; break;\n          case 'UP'   : value= 'u'; break;\n          case 'DOWN' : value= 'd'; break;\n          case 'OTHER':\n          default     : value= ' '; break;//FIXME\n        }\n        if (!this.axis) { this.axis= \"enu\"; }\n        switch(name) {\n          case 'x': this.axis=                         value + this.axis.substr(1,2); break;\n          case 'y': this.axis= this.axis.substr(0,1) + value + this.axis.substr(2,1); break;\n          case 'z': this.axis= this.axis.substr(0,2) + value                        ; break;\n          default : break;\n        }\n      case 'MORE_HERE':\n        break;\n      default:\n        break;\n    }\n    for (var i=0; i<wktArray.length; ++i) {\n      this.parseWKT(wktArray[i]);\n    }\n },\n\n/**\n * Function: parseDefs\n * Parses the PROJ.4 initialization string and sets the associated properties.\n *\n */\n  parseDefs: function() {\n      this.defData = Proj4js.defs[this.srsCode];\n      var paramName, paramVal;\n      if (!this.defData) {\n        return;\n      }\n      var paramArray=this.defData.split(\"+\");\n\n      for (var prop=0; prop<paramArray.length; prop++) {\n          var property = paramArray[prop].split(\"=\");\n          paramName = property[0].toLowerCase();\n          paramVal = property[1];\n\n          switch (paramName.replace(/\\s/gi,\"\")) {  // trim out spaces\n              case \"\": break;   // throw away nameless parameter\n              case \"title\":  this.title = paramVal; break;\n              case \"proj\":   this.projName =  paramVal.replace(/\\s/gi,\"\"); break;\n              case \"units\":  this.units = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"datum\":  this.datumCode = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"nadgrids\": this.nagrids = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"ellps\":  this.ellps = paramVal.replace(/\\s/gi,\"\"); break;\n              case \"a\":      this.a =  parseFloat(paramVal); break;  // semi-major radius\n              case \"b\":      this.b =  parseFloat(paramVal); break;  // semi-minor radius\n              // DGR 2007-11-20\n              case \"rf\":     this.rf = parseFloat(paramVal); break; // inverse flattening rf= a/(a-b)\n              case \"lat_0\":  this.lat0 = paramVal*Proj4js.common.D2R; break;        // phi0, central latitude\n              case \"lat_1\":  this.lat1 = paramVal*Proj4js.common.D2R; break;        //standard parallel 1\n              case \"lat_2\":  this.lat2 = paramVal*Proj4js.common.D2R; break;        //standard parallel 2\n              case \"lat_ts\": this.lat_ts = paramVal*Proj4js.common.D2R; break;      // used in merc and eqc\n              case \"lon_0\":  this.long0 = paramVal*Proj4js.common.D2R; break;       // lam0, central longitude\n              case \"alpha\":  this.alpha =  parseFloat(paramVal)*Proj4js.common.D2R; break;  //for somerc projection\n              case \"lonc\":   this.longc = paramVal*Proj4js.common.D2R; break;       //for somerc projection\n              case \"x_0\":    this.x0 = parseFloat(paramVal); break;  // false easting\n              case \"y_0\":    this.y0 = parseFloat(paramVal); break;  // false northing\n              case \"k_0\":    this.k0 = parseFloat(paramVal); break;  // projection scale factor\n              case \"k\":      this.k0 = parseFloat(paramVal); break;  // both forms returned\n              case \"r_a\":    this.R_A = true; break;                 // sphere--area of ellipsoid\n              case \"zone\":   this.zone = parseInt(paramVal,10); break;  // UTM Zone\n              case \"south\":   this.utmSouth = true; break;  // UTM north/south\n              case \"towgs84\":this.datum_params = paramVal.split(\",\"); break;\n              case \"to_meter\": this.to_meter = parseFloat(paramVal); break; // cartesian scaling\n              case \"from_greenwich\": this.from_greenwich = paramVal*Proj4js.common.D2R; break;\n              // DGR 2008-07-09 : if pm is not a well-known prime meridian take\n              // the value instead of 0.0, then convert to radians\n              case \"pm\":     paramVal = paramVal.replace(/\\s/gi,\"\");\n                             this.from_greenwich = Proj4js.PrimeMeridian[paramVal] ?\n                                Proj4js.PrimeMeridian[paramVal] : parseFloat(paramVal);\n                             this.from_greenwich *= Proj4js.common.D2R; \n                             break;\n              // DGR 2010-11-12: axis\n              case \"axis\":   paramVal = paramVal.replace(/\\s/gi,\"\");\n                             var legalAxis= \"ewnsud\";\n                             if (paramVal.length==3 &&\n                                 legalAxis.indexOf(paramVal.substr(0,1))!=-1 &&\n                                 legalAxis.indexOf(paramVal.substr(1,1))!=-1 &&\n                                 legalAxis.indexOf(paramVal.substr(2,1))!=-1) {\n                                this.axis= paramVal;\n                             } //FIXME: be silent ?\n                             break;\n              case \"no_defs\": break; \n              default: //alert(\"Unrecognized parameter: \" + paramName);\n          } // switch()\n      } // for paramArray\n      this.deriveConstants();\n  },\n\n/**\n * Function: deriveConstants\n * Sets several derived constant values and initialization of datum and ellipse\n *     parameters.\n *\n */\n  deriveConstants: function() {\n      if (this.nagrids == '@null') this.datumCode = 'none';\n      if (this.datumCode && this.datumCode != 'none') {\n        var datumDef = Proj4js.Datum[this.datumCode];\n        if (datumDef) {\n          this.datum_params = datumDef.towgs84 ? datumDef.towgs84.split(',') : null;\n          this.ellps = datumDef.ellipse;\n          this.datumName = datumDef.datumName ? datumDef.datumName : this.datumCode;\n        }\n      }\n      if (!this.a) {    // do we have an ellipsoid?\n          var ellipse = Proj4js.Ellipsoid[this.ellps] ? Proj4js.Ellipsoid[this.ellps] : Proj4js.Ellipsoid['WGS84'];\n          Proj4js.extend(this, ellipse);\n      }\n      if (this.rf && !this.b) this.b = (1.0 - 1.0/this.rf) * this.a;\n      if (this.rf === 0 || Math.abs(this.a - this.b)<Proj4js.common.EPSLN) {\n        this.sphere = true;\n        this.b= this.a;\n      }\n      this.a2 = this.a * this.a;          // used in geocentric\n      this.b2 = this.b * this.b;          // used in geocentric\n      this.es = (this.a2-this.b2)/this.a2;  // e ^ 2\n      this.e = Math.sqrt(this.es);        // eccentricity\n      if (this.R_A) {\n        this.a *= 1. - this.es * (Proj4js.common.SIXTH + this.es * (Proj4js.common.RA4 + this.es * Proj4js.common.RA6));\n        this.a2 = this.a * this.a;\n        this.b2 = this.b * this.b;\n        this.es = 0.;\n      }\n      this.ep2=(this.a2-this.b2)/this.b2; // used in geocentric\n      if (!this.k0) this.k0 = 1.0;    //default value\n      //DGR 2010-11-12: axis\n      if (!this.axis) { this.axis= \"enu\"; }\n\n      this.datum = new Proj4js.datum(this);\n  }\n});\n\nProj4js.Proj.longlat = {\n  init: function() {\n    //no-op for longlat\n  },\n  forward: function(pt) {\n    //identity transform\n    return pt;\n  },\n  inverse: function(pt) {\n    //identity transform\n    return pt;\n  }\n};\nProj4js.Proj.identity = Proj4js.Proj.longlat;\n\n/**\n  Proj4js.defs is a collection of coordinate system definition objects in the \n  PROJ.4 command line format.\n  Generally a def is added by means of a separate .js file for example:\n\n    <SCRIPT type=\"text/javascript\" src=\"defs/EPSG26912.js\"></SCRIPT>\n\n  def is a CS definition in PROJ.4 WKT format, for example:\n    +proj=\"tmerc\"   //longlat, etc.\n    +a=majorRadius\n    +b=minorRadius\n    +lat0=somenumber\n    +long=somenumber\n*/\nProj4js.defs = {\n  // These are so widely used, we'll go ahead and throw them in\n  // without requiring a separate .js file\n  'WGS84': \"+title=long/lat:WGS84 +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees\",\n  'EPSG:4326': \"+title=long/lat:WGS84 +proj=longlat +a=6378137.0 +b=6356752.31424518 +ellps=WGS84 +datum=WGS84 +units=degrees\",\n  'EPSG:4269': \"+title=long/lat:NAD83 +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees\",\n  'EPSG:3875': \"+title= Google Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs\"\n};\nProj4js.defs['EPSG:3785'] = Proj4js.defs['EPSG:3875'];  //maintain backward compat, official code is 3875\nProj4js.defs['GOOGLE'] = Proj4js.defs['EPSG:3875'];\nProj4js.defs['EPSG:900913'] = Proj4js.defs['EPSG:3875'];\nProj4js.defs['EPSG:102113'] = Proj4js.defs['EPSG:3875'];\n\nProj4js.common = {\n  PI : 3.141592653589793238, //Math.PI,\n  HALF_PI : 1.570796326794896619, //Math.PI*0.5,\n  TWO_PI : 6.283185307179586477, //Math.PI*2,\n  FORTPI : 0.78539816339744833,\n  R2D : 57.29577951308232088,\n  D2R : 0.01745329251994329577,\n  SEC_TO_RAD : 4.84813681109535993589914102357e-6, /* SEC_TO_RAD = Pi/180/3600 */\n  EPSLN : 1.0e-10,\n  MAX_ITER : 20,\n  // following constants from geocent.c\n  COS_67P5 : 0.38268343236508977,  /* cosine of 67.5 degrees */\n  AD_C : 1.0026000,                /* Toms region 1 constant */\n\n  /* datum_type values */\n  PJD_UNKNOWN  : 0,\n  PJD_3PARAM   : 1,\n  PJD_7PARAM   : 2,\n  PJD_GRIDSHIFT: 3,\n  PJD_WGS84    : 4,   // WGS84 or equivalent\n  PJD_NODATUM  : 5,   // WGS84 or equivalent\n  SRS_WGS84_SEMIMAJOR : 6378137.0,  // only used in grid shift transforms\n\n  // ellipoid pj_set_ell.c\n  SIXTH : .1666666666666666667, /* 1/6 */\n  RA4   : .04722222222222222222, /* 17/360 */\n  RA6   : .02215608465608465608, /* 67/3024 */\n  RV4   : .06944444444444444444, /* 5/72 */\n  RV6   : .04243827160493827160, /* 55/1296 */\n\n// Function to compute the constant small m which is the radius of\n//   a parallel of latitude, phi, divided by the semimajor axis.\n// -----------------------------------------------------------------\n  msfnz : function(eccent, sinphi, cosphi) {\n      var con = eccent * sinphi;\n      return cosphi/(Math.sqrt(1.0 - con * con));\n  },\n\n// Function to compute the constant small t for use in the forward\n//   computations in the Lambert Conformal Conic and the Polar\n//   Stereographic projections.\n// -----------------------------------------------------------------\n  tsfnz : function(eccent, phi, sinphi) {\n    var con = eccent * sinphi;\n    var com = .5 * eccent;\n    con = Math.pow(((1.0 - con) / (1.0 + con)), com);\n    return (Math.tan(.5 * (this.HALF_PI - phi))/con);\n  },\n\n// Function to compute the latitude angle, phi2, for the inverse of the\n//   Lambert Conformal Conic and Polar Stereographic projections.\n// ----------------------------------------------------------------\n  phi2z : function(eccent, ts) {\n    var eccnth = .5 * eccent;\n    var con, dphi;\n    var phi = this.HALF_PI - 2 * Math.atan(ts);\n    for (var i = 0; i <= 15; i++) {\n      con = eccent * Math.sin(phi);\n      dphi = this.HALF_PI - 2 * Math.atan(ts *(Math.pow(((1.0 - con)/(1.0 + con)),eccnth))) - phi;\n      phi += dphi;\n      if (Math.abs(dphi) <= .0000000001) return phi;\n    }\n    alert(\"phi2z has NoConvergence\");\n    return (-9999);\n  },\n\n/* Function to compute constant small q which is the radius of a \n   parallel of latitude, phi, divided by the semimajor axis. \n------------------------------------------------------------*/\n  qsfnz : function(eccent,sinphi) {\n    var con;\n    if (eccent > 1.0e-7) {\n      con = eccent * sinphi;\n      return (( 1.0- eccent * eccent) * (sinphi /(1.0 - con * con) - (.5/eccent)*Math.log((1.0 - con)/(1.0 + con))));\n    } else {\n      return(2.0 * sinphi);\n    }\n  },\n\n/* Function to eliminate roundoff errors in asin\n----------------------------------------------*/\n  asinz : function(x) {\n    if (Math.abs(x)>1.0) {\n      x=(x>1.0)?1.0:-1.0;\n    }\n    return Math.asin(x);\n  },\n\n// following functions from gctpc cproj.c for transverse mercator projections\n  e0fn : function(x) {return(1.0-0.25*x*(1.0+x/16.0*(3.0+1.25*x)));},\n  e1fn : function(x) {return(0.375*x*(1.0+0.25*x*(1.0+0.46875*x)));},\n  e2fn : function(x) {return(0.05859375*x*x*(1.0+0.75*x));},\n  e3fn : function(x) {return(x*x*x*(35.0/3072.0));},\n  mlfn : function(e0,e1,e2,e3,phi) {return(e0*phi-e1*Math.sin(2.0*phi)+e2*Math.sin(4.0*phi)-e3*Math.sin(6.0*phi));},\n\n  srat : function(esinp, exp) {\n    return(Math.pow((1.0-esinp)/(1.0+esinp), exp));\n  },\n\n// Function to return the sign of an argument\n  sign : function(x) { if (x < 0.0) return(-1); else return(1);},\n\n// Function to adjust longitude to -180 to 180; input in radians\n  adjust_lon : function(x) {\n    x = (Math.abs(x) < this.PI) ? x: (x - (this.sign(x)*this.TWO_PI) );\n    return x;\n  },\n\n// IGNF - DGR : algorithms used by IGN France\n\n// Function to adjust latitude to -90 to 90; input in radians\n  adjust_lat : function(x) {\n    x= (Math.abs(x) < this.HALF_PI) ? x: (x - (this.sign(x)*this.PI) );\n    return x;\n  },\n\n// Latitude Isometrique - close to tsfnz ...\n  latiso : function(eccent, phi, sinphi) {\n    if (Math.abs(phi) > this.HALF_PI) return +Number.NaN;\n    if (phi==this.HALF_PI) return Number.POSITIVE_INFINITY;\n    if (phi==-1.0*this.HALF_PI) return -1.0*Number.POSITIVE_INFINITY;\n\n    var con= eccent*sinphi;\n    return Math.log(Math.tan((this.HALF_PI+phi)/2.0))+eccent*Math.log((1.0-con)/(1.0+con))/2.0;\n  },\n\n  fL : function(x,L) {\n    return 2.0*Math.atan(x*Math.exp(L)) - this.HALF_PI;\n  },\n\n// Inverse Latitude Isometrique - close to ph2z\n  invlatiso : function(eccent, ts) {\n    var phi= this.fL(1.0,ts);\n    var Iphi= 0.0;\n    var con= 0.0;\n    do {\n      Iphi= phi;\n      con= eccent*Math.sin(Iphi);\n      phi= this.fL(Math.exp(eccent*Math.log((1.0+con)/(1.0-con))/2.0),ts);\n    } while (Math.abs(phi-Iphi)>1.0e-12);\n    return phi;\n  },\n\n// Needed for Gauss Schreiber\n// Original:  Denis Makarov (info@binarythings.com)\n// Web Site:  http://www.binarythings.com\n  sinh : function(x)\n  {\n    var r= Math.exp(x);\n    r= (r-1.0/r)/2.0;\n    return r;\n  },\n\n  cosh : function(x)\n  {\n    var r= Math.exp(x);\n    r= (r+1.0/r)/2.0;\n    return r;\n  },\n\n  tanh : function(x)\n  {\n    var r= Math.exp(x);\n    r= (r-1.0/r)/(r+1.0/r);\n    return r;\n  },\n\n  asinh : function(x)\n  {\n    var s= (x>= 0? 1.0:-1.0);\n    return s*(Math.log( Math.abs(x) + Math.sqrt(x*x+1.0) ));\n  },\n\n  acosh : function(x)\n  {\n    return 2.0*Math.log(Math.sqrt((x+1.0)/2.0) + Math.sqrt((x-1.0)/2.0));\n  },\n\n  atanh : function(x)\n  {\n    return Math.log((x-1.0)/(x+1.0))/2.0;\n  },\n\n// Grande Normale\n  gN : function(a,e,sinphi)\n  {\n    var temp= e*sinphi;\n    return a/Math.sqrt(1.0 - temp*temp);\n  },\n  \n  //code from the PROJ.4 pj_mlfn.c file;  this may be useful for other projections\n  pj_enfn: function(es) {\n    var en = new Array();\n    en[0] = this.C00 - es * (this.C02 + es * (this.C04 + es * (this.C06 + es * this.C08)));\n    en[1] = es * (this.C22 - es * (this.C04 + es * (this.C06 + es * this.C08)));\n    var t = es * es;\n    en[2] = t * (this.C44 - es * (this.C46 + es * this.C48));\n    t *= es;\n    en[3] = t * (this.C66 - es * this.C68);\n    en[4] = t * es * this.C88;\n    return en;\n  },\n  \n  pj_mlfn: function(phi, sphi, cphi, en) {\n    cphi *= sphi;\n    sphi *= sphi;\n    return(en[0] * phi - cphi * (en[1] + sphi*(en[2]+ sphi*(en[3] + sphi*en[4]))));\n  },\n  \n  pj_inv_mlfn: function(arg, es, en) {\n    var k = 1./(1.-es);\n    var phi = arg;\n    for (var i = Proj4js.common.MAX_ITER; i ; --i) { /* rarely goes over 2 iterations */\n      var s = Math.sin(phi);\n      var t = 1. - es * s * s;\n      //t = this.pj_mlfn(phi, s, Math.cos(phi), en) - arg;\n      //phi -= t * (t * Math.sqrt(t)) * k;\n      t = (this.pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;\n      phi -= t;\n      if (Math.abs(t) < Proj4js.common.EPSLN)\n        return phi;\n    }\n    Proj4js.reportError(\"cass:pj_inv_mlfn: Convergence error\");\n    return phi;\n  },\n\n/* meridinal distance for ellipsoid and inverse\n**\t8th degree - accurate to < 1e-5 meters when used in conjuction\n**\t\twith typical major axis values.\n**\tInverse determines phi to EPS (1e-11) radians, about 1e-6 seconds.\n*/\n  C00: 1.0,\n  C02: .25,\n  C04: .046875,\n  C06: .01953125,\n  C08: .01068115234375,\n  C22: .75,\n  C44: .46875,\n  C46: .01302083333333333333,\n  C48: .00712076822916666666,\n  C66: .36458333333333333333,\n  C68: .00569661458333333333,\n  C88: .3076171875  \n\n};\n\n/** datum object\n*/\nProj4js.datum = Proj4js.Class({\n\n  initialize : function(proj) {\n    this.datum_type = Proj4js.common.PJD_WGS84;   //default setting\n    if (proj.datumCode && proj.datumCode == 'none') {\n      this.datum_type = Proj4js.common.PJD_NODATUM;\n    }\n    if (proj && proj.datum_params) {\n      for (var i=0; i<proj.datum_params.length; i++) {\n        proj.datum_params[i]=parseFloat(proj.datum_params[i]);\n      }\n      if (proj.datum_params[0] != 0 || proj.datum_params[1] != 0 || proj.datum_params[2] != 0 ) {\n        this.datum_type = Proj4js.common.PJD_3PARAM;\n      }\n      if (proj.datum_params.length > 3) {\n        if (proj.datum_params[3] != 0 || proj.datum_params[4] != 0 ||\n            proj.datum_params[5] != 0 || proj.datum_params[6] != 0 ) {\n          this.datum_type = Proj4js.common.PJD_7PARAM;\n          proj.datum_params[3] *= Proj4js.common.SEC_TO_RAD;\n          proj.datum_params[4] *= Proj4js.common.SEC_TO_RAD;\n          proj.datum_params[5] *= Proj4js.common.SEC_TO_RAD;\n          proj.datum_params[6] = (proj.datum_params[6]/1000000.0) + 1.0;\n        }\n      }\n    }\n    if (proj) {\n      this.a = proj.a;    //datum object also uses these values\n      this.b = proj.b;\n      this.es = proj.es;\n      this.ep2 = proj.ep2;\n      this.datum_params = proj.datum_params;\n    }\n  },\n\n  /****************************************************************/\n  // cs_compare_datums()\n  //   Returns TRUE if the two datums match, otherwise FALSE.\n  compare_datums : function( dest ) {\n    if( this.datum_type != dest.datum_type ) {\n      return false; // false, datums are not equal\n    } else if( this.a != dest.a || Math.abs(this.es-dest.es) > 0.000000000050 ) {\n      // the tolerence for es is to ensure that GRS80 and WGS84\n      // are considered identical\n      return false;\n    } else if( this.datum_type == Proj4js.common.PJD_3PARAM ) {\n      return (this.datum_params[0] == dest.datum_params[0]\n              && this.datum_params[1] == dest.datum_params[1]\n              && this.datum_params[2] == dest.datum_params[2]);\n    } else if( this.datum_type == Proj4js.common.PJD_7PARAM ) {\n      return (this.datum_params[0] == dest.datum_params[0]\n              && this.datum_params[1] == dest.datum_params[1]\n              && this.datum_params[2] == dest.datum_params[2]\n              && this.datum_params[3] == dest.datum_params[3]\n              && this.datum_params[4] == dest.datum_params[4]\n              && this.datum_params[5] == dest.datum_params[5]\n              && this.datum_params[6] == dest.datum_params[6]);\n    } else if ( this.datum_type == Proj4js.common.PJD_GRIDSHIFT ||\n                dest.datum_type == Proj4js.common.PJD_GRIDSHIFT ) {\n      alert(\"ERROR: Grid shift transformations are not implemented.\");\n      return false;\n    } else {\n      return true; // datums are equal\n    }\n  }, // cs_compare_datums()\n\n  /*\n   * The function Convert_Geodetic_To_Geocentric converts geodetic coordinates\n   * (latitude, longitude, and height) to geocentric coordinates (X, Y, Z),\n   * according to the current ellipsoid parameters.\n   *\n   *    Latitude  : Geodetic latitude in radians                     (input)\n   *    Longitude : Geodetic longitude in radians                    (input)\n   *    Height    : Geodetic height, in meters                       (input)\n   *    X         : Calculated Geocentric X coordinate, in meters    (output)\n   *    Y         : Calculated Geocentric Y coordinate, in meters    (output)\n   *    Z         : Calculated Geocentric Z coordinate, in meters    (output)\n   *\n   */\n  geodetic_to_geocentric : function(p) {\n    var Longitude = p.x;\n    var Latitude = p.y;\n    var Height = p.z ? p.z : 0;   //Z value not always supplied\n    var X;  // output\n    var Y;\n    var Z;\n\n    var Error_Code=0;  //  GEOCENT_NO_ERROR;\n    var Rn;            /*  Earth radius at location  */\n    var Sin_Lat;       /*  Math.sin(Latitude)  */\n    var Sin2_Lat;      /*  Square of Math.sin(Latitude)  */\n    var Cos_Lat;       /*  Math.cos(Latitude)  */\n\n    /*\n    ** Don't blow up if Latitude is just a little out of the value\n    ** range as it may just be a rounding issue.  Also removed longitude\n    ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.\n    */\n    if( Latitude < -Proj4js.common.HALF_PI && Latitude > -1.001 * Proj4js.common.HALF_PI ) {\n        Latitude = -Proj4js.common.HALF_PI;\n    } else if( Latitude > Proj4js.common.HALF_PI && Latitude < 1.001 * Proj4js.common.HALF_PI ) {\n        Latitude = Proj4js.common.HALF_PI;\n    } else if ((Latitude < -Proj4js.common.HALF_PI) || (Latitude > Proj4js.common.HALF_PI)) {\n      /* Latitude out of range */\n      Proj4js.reportError('geocent:lat out of range:'+Latitude);\n      return null;\n    }\n\n    if (Longitude > Proj4js.common.PI) Longitude -= (2*Proj4js.common.PI);\n    Sin_Lat = Math.sin(Latitude);\n    Cos_Lat = Math.cos(Latitude);\n    Sin2_Lat = Sin_Lat * Sin_Lat;\n    Rn = this.a / (Math.sqrt(1.0e0 - this.es * Sin2_Lat));\n    X = (Rn + Height) * Cos_Lat * Math.cos(Longitude);\n    Y = (Rn + Height) * Cos_Lat * Math.sin(Longitude);\n    Z = ((Rn * (1 - this.es)) + Height) * Sin_Lat;\n\n    p.x = X;\n    p.y = Y;\n    p.z = Z;\n    return Error_Code;\n  }, // cs_geodetic_to_geocentric()\n\n\n  geocentric_to_geodetic : function (p) {\n/* local defintions and variables */\n/* end-criterium of loop, accuracy of sin(Latitude) */\nvar genau = 1.E-12;\nvar genau2 = (genau*genau);\nvar maxiter = 30;\n\n    var P;        /* distance between semi-minor axis and location */\n    var RR;       /* distance between center and location */\n    var CT;       /* sin of geocentric latitude */\n    var ST;       /* cos of geocentric latitude */\n    var RX;\n    var RK;\n    var RN;       /* Earth radius at location */\n    var CPHI0;    /* cos of start or old geodetic latitude in iterations */\n    var SPHI0;    /* sin of start or old geodetic latitude in iterations */\n    var CPHI;     /* cos of searched geodetic latitude */\n    var SPHI;     /* sin of searched geodetic latitude */\n    var SDPHI;    /* end-criterium: addition-theorem of sin(Latitude(iter)-Latitude(iter-1)) */\n    var At_Pole;     /* indicates location is in polar region */\n    var iter;        /* # of continous iteration, max. 30 is always enough (s.a.) */\n\n    var X = p.x;\n    var Y = p.y;\n    var Z = p.z ? p.z : 0.0;   //Z value not always supplied\n    var Longitude;\n    var Latitude;\n    var Height;\n\n    At_Pole = false;\n    P = Math.sqrt(X*X+Y*Y);\n    RR = Math.sqrt(X*X+Y*Y+Z*Z);\n\n/*      special cases for latitude and longitude */\n    if (P/this.a < genau) {\n\n/*  special case, if P=0. (X=0., Y=0.) */\n        At_Pole = true;\n        Longitude = 0.0;\n\n/*  if (X,Y,Z)=(0.,0.,0.) then Height becomes semi-minor axis\n *  of ellipsoid (=center of mass), Latitude becomes PI/2 */\n        if (RR/this.a < genau) {\n            Latitude = Proj4js.common.HALF_PI;\n            Height   = -this.b;\n            return;\n        }\n    } else {\n/*  ellipsoidal (geodetic) longitude\n *  interval: -PI < Longitude <= +PI */\n        Longitude=Math.atan2(Y,X);\n    }\n\n/* --------------------------------------------------------------\n * Following iterative algorithm was developped by\n * \"Institut fr Erdmessung\", University of Hannover, July 1988.\n * Internet: www.ife.uni-hannover.de\n * Iterative computation of CPHI,SPHI and Height.\n * Iteration of CPHI and SPHI to 10**-12 radian resp.\n * 2*10**-7 arcsec.\n * --------------------------------------------------------------\n */\n    CT = Z/RR;\n    ST = P/RR;\n    RX = 1.0/Math.sqrt(1.0-this.es*(2.0-this.es)*ST*ST);\n    CPHI0 = ST*(1.0-this.es)*RX;\n    SPHI0 = CT*RX;\n    iter = 0;\n\n/* loop to find sin(Latitude) resp. Latitude\n * until |sin(Latitude(iter)-Latitude(iter-1))| < genau */\n    do\n    {\n        iter++;\n        RN = this.a/Math.sqrt(1.0-this.es*SPHI0*SPHI0);\n\n/*  ellipsoidal (geodetic) height */\n        Height = P*CPHI0+Z*SPHI0-RN*(1.0-this.es*SPHI0*SPHI0);\n\n        RK = this.es*RN/(RN+Height);\n        RX = 1.0/Math.sqrt(1.0-RK*(2.0-RK)*ST*ST);\n        CPHI = ST*(1.0-RK)*RX;\n        SPHI = CT*RX;\n        SDPHI = SPHI*CPHI0-CPHI*SPHI0;\n        CPHI0 = CPHI;\n        SPHI0 = SPHI;\n    }\n    while (SDPHI*SDPHI > genau2 && iter < maxiter);\n\n/*      ellipsoidal (geodetic) latitude */\n    Latitude=Math.atan(SPHI/Math.abs(CPHI));\n\n    p.x = Longitude;\n    p.y = Latitude;\n    p.z = Height;\n    return p;\n  }, // cs_geocentric_to_geodetic()\n\n  /** Convert_Geocentric_To_Geodetic\n   * The method used here is derived from 'An Improved Algorithm for\n   * Geocentric to Geodetic Coordinate Conversion', by Ralph Toms, Feb 1996\n   */\n  geocentric_to_geodetic_noniter : function (p) {\n    var X = p.x;\n    var Y = p.y;\n    var Z = p.z ? p.z : 0;   //Z value not always supplied\n    var Longitude;\n    var Latitude;\n    var Height;\n\n    var W;        /* distance from Z axis */\n    var W2;       /* square of distance from Z axis */\n    var T0;       /* initial estimate of vertical component */\n    var T1;       /* corrected estimate of vertical component */\n    var S0;       /* initial estimate of horizontal component */\n    var S1;       /* corrected estimate of horizontal component */\n    var Sin_B0;   /* Math.sin(B0), B0 is estimate of Bowring aux variable */\n    var Sin3_B0;  /* cube of Math.sin(B0) */\n    var Cos_B0;   /* Math.cos(B0) */\n    var Sin_p1;   /* Math.sin(phi1), phi1 is estimated latitude */\n    var Cos_p1;   /* Math.cos(phi1) */\n    var Rn;       /* Earth radius at location */\n    var Sum;      /* numerator of Math.cos(phi1) */\n    var At_Pole;  /* indicates location is in polar region */\n\n    X = parseFloat(X);  // cast from string to float\n    Y = parseFloat(Y);\n    Z = parseFloat(Z);\n\n    At_Pole = false;\n    if (X != 0.0)\n    {\n        Longitude = Math.atan2(Y,X);\n    }\n    else\n    {\n        if (Y > 0)\n        {\n            Longitude = Proj4js.common.HALF_PI;\n        }\n        else if (Y < 0)\n        {\n            Longitude = -Proj4js.common.HALF_PI;\n        }\n        else\n        {\n            At_Pole = true;\n            Longitude = 0.0;\n            if (Z > 0.0)\n            {  /* north pole */\n                Latitude = Proj4js.common.HALF_PI;\n            }\n            else if (Z < 0.0)\n            {  /* south pole */\n                Latitude = -Proj4js.common.HALF_PI;\n            }\n            else\n            {  /* center of earth */\n                Latitude = Proj4js.common.HALF_PI;\n                Height = -this.b;\n                return;\n            }\n        }\n    }\n    W2 = X*X + Y*Y;\n    W = Math.sqrt(W2);\n    T0 = Z * Proj4js.common.AD_C;\n    S0 = Math.sqrt(T0 * T0 + W2);\n    Sin_B0 = T0 / S0;\n    Cos_B0 = W / S0;\n    Sin3_B0 = Sin_B0 * Sin_B0 * Sin_B0;\n    T1 = Z + this.b * this.ep2 * Sin3_B0;\n    Sum = W - this.a * this.es * Cos_B0 * Cos_B0 * Cos_B0;\n    S1 = Math.sqrt(T1*T1 + Sum * Sum);\n    Sin_p1 = T1 / S1;\n    Cos_p1 = Sum / S1;\n    Rn = this.a / Math.sqrt(1.0 - this.es * Sin_p1 * Sin_p1);\n    if (Cos_p1 >= Proj4js.common.COS_67P5)\n    {\n        Height = W / Cos_p1 - Rn;\n    }\n    else if (Cos_p1 <= -Proj4js.common.COS_67P5)\n    {\n        Height = W / -Cos_p1 - Rn;\n    }\n    else\n    {\n        Height = Z / Sin_p1 + Rn * (this.es - 1.0);\n    }\n    if (At_Pole == false)\n    {\n        Latitude = Math.atan(Sin_p1 / Cos_p1);\n    }\n\n    p.x = Longitude;\n    p.y = Latitude;\n    p.z = Height;\n    return p;\n  }, // geocentric_to_geodetic_noniter()\n\n  /****************************************************************/\n  // pj_geocentic_to_wgs84( p )\n  //  p = point to transform in geocentric coordinates (x,y,z)\n  geocentric_to_wgs84 : function ( p ) {\n\n    if( this.datum_type == Proj4js.common.PJD_3PARAM )\n    {\n      // if( x[io] == HUGE_VAL )\n      //    continue;\n      p.x += this.datum_params[0];\n      p.y += this.datum_params[1];\n      p.z += this.datum_params[2];\n\n    }\n    else if (this.datum_type == Proj4js.common.PJD_7PARAM)\n    {\n      var Dx_BF =this.datum_params[0];\n      var Dy_BF =this.datum_params[1];\n      var Dz_BF =this.datum_params[2];\n      var Rx_BF =this.datum_params[3];\n      var Ry_BF =this.datum_params[4];\n      var Rz_BF =this.datum_params[5];\n      var M_BF  =this.datum_params[6];\n      // if( x[io] == HUGE_VAL )\n      //    continue;\n      var x_out = M_BF*(       p.x - Rz_BF*p.y + Ry_BF*p.z) + Dx_BF;\n      var y_out = M_BF*( Rz_BF*p.x +       p.y - Rx_BF*p.z) + Dy_BF;\n      var z_out = M_BF*(-Ry_BF*p.x + Rx_BF*p.y +       p.z) + Dz_BF;\n      p.x = x_out;\n      p.y = y_out;\n      p.z = z_out;\n    }\n  }, // cs_geocentric_to_wgs84\n\n  /****************************************************************/\n  // pj_geocentic_from_wgs84()\n  //  coordinate system definition,\n  //  point to transform in geocentric coordinates (x,y,z)\n  geocentric_from_wgs84 : function( p ) {\n\n    if( this.datum_type == Proj4js.common.PJD_3PARAM )\n    {\n      //if( x[io] == HUGE_VAL )\n      //    continue;\n      p.x -= this.datum_params[0];\n      p.y -= this.datum_params[1];\n      p.z -= this.datum_params[2];\n\n    }\n    else if (this.datum_type == Proj4js.common.PJD_7PARAM)\n    {\n      var Dx_BF =this.datum_params[0];\n      var Dy_BF =this.datum_params[1];\n      var Dz_BF =this.datum_params[2];\n      var Rx_BF =this.datum_params[3];\n      var Ry_BF =this.datum_params[4];\n      var Rz_BF =this.datum_params[5];\n      var M_BF  =this.datum_params[6];\n      var x_tmp = (p.x - Dx_BF) / M_BF;\n      var y_tmp = (p.y - Dy_BF) / M_BF;\n      var z_tmp = (p.z - Dz_BF) / M_BF;\n      //if( x[io] == HUGE_VAL )\n      //    continue;\n\n      p.x =        x_tmp + Rz_BF*y_tmp - Ry_BF*z_tmp;\n      p.y = -Rz_BF*x_tmp +       y_tmp + Rx_BF*z_tmp;\n      p.z =  Ry_BF*x_tmp - Rx_BF*y_tmp +       z_tmp;\n    } //cs_geocentric_from_wgs84()\n  }\n});\n\n/** point object, nothing fancy, just allows values to be\n    passed back and forth by reference rather than by value.\n    Other point classes may be used as long as they have\n    x and y properties, which will get modified in the transform method.\n*/\nProj4js.Point = Proj4js.Class({\n\n    /**\n     * Constructor: Proj4js.Point\n     *\n     * Parameters:\n     * - x {float} or {Array} either the first coordinates component or\n     *     the full coordinates\n     * - y {float} the second component\n     * - z {float} the third component, optional.\n     */\n    initialize : function(x,y,z) {\n      if (typeof x == 'object') {\n        this.x = x[0];\n        this.y = x[1];\n        this.z = x[2] || 0.0;\n      } else if (typeof x == 'string' && typeof y == 'undefined') {\n        var coords = x.split(',');\n        this.x = parseFloat(coords[0]);\n        this.y = parseFloat(coords[1]);\n        this.z = parseFloat(coords[2]) || 0.0;\n      } else {\n        this.x = x;\n        this.y = y;\n        this.z = z || 0.0;\n      }\n    },\n\n    /**\n     * APIMethod: clone\n     * Build a copy of a Proj4js.Point object.\n     *\n     * Return:\n     * {Proj4js}.Point the cloned point.\n     */\n    clone : function() {\n      return new Proj4js.Point(this.x, this.y, this.z);\n    },\n\n    /**\n     * APIMethod: toString\n     * Return a readable string version of the point\n     *\n     * Return:\n     * {String} String representation of Proj4js.Point object. \n     *           (ex. <i>\"x=5,y=42\"</i>)\n     */\n    toString : function() {\n        return (\"x=\" + this.x + \",y=\" + this.y);\n    },\n\n    /** \n     * APIMethod: toShortString\n     * Return a short string version of the point.\n     *\n     * Return:\n     * {String} Shortened String representation of Proj4js.Point object. \n     *         (ex. <i>\"5, 42\"</i>)\n     */\n    toShortString : function() {\n        return (this.x + \", \" + this.y);\n    }\n});\n\nProj4js.PrimeMeridian = {\n    \"greenwich\": 0.0,               //\"0dE\",\n    \"lisbon\":     -9.131906111111,   //\"9d07'54.862\\\"W\",\n    \"paris\":       2.337229166667,   //\"2d20'14.025\\\"E\",\n    \"bogota\":    -74.080916666667,  //\"74d04'51.3\\\"W\",\n    \"madrid\":     -3.687938888889,  //\"3d41'16.58\\\"W\",\n    \"rome\":       12.452333333333,  //\"12d27'8.4\\\"E\",\n    \"bern\":        7.439583333333,  //\"7d26'22.5\\\"E\",\n    \"jakarta\":   106.807719444444,  //\"106d48'27.79\\\"E\",\n    \"ferro\":     -17.666666666667,  //\"17d40'W\",\n    \"brussels\":    4.367975,        //\"4d22'4.71\\\"E\",\n    \"stockholm\":  18.058277777778,  //\"18d3'29.8\\\"E\",\n    \"athens\":     23.7163375,       //\"23d42'58.815\\\"E\",\n    \"oslo\":       10.722916666667   //\"10d43'22.5\\\"E\"\n};\n\nProj4js.Ellipsoid = {\n  \"MERIT\": {a:6378137.0, rf:298.257, ellipseName:\"MERIT 1983\"},\n  \"SGS85\": {a:6378136.0, rf:298.257, ellipseName:\"Soviet Geodetic System 85\"},\n  \"GRS80\": {a:6378137.0, rf:298.257222101, ellipseName:\"GRS 1980(IUGG, 1980)\"},\n  \"IAU76\": {a:6378140.0, rf:298.257, ellipseName:\"IAU 1976\"},\n  \"airy\": {a:6377563.396, b:6356256.910, ellipseName:\"Airy 1830\"},\n  \"APL4.\": {a:6378137, rf:298.25, ellipseName:\"Appl. Physics. 1965\"},\n  \"NWL9D\": {a:6378145.0, rf:298.25, ellipseName:\"Naval Weapons Lab., 1965\"},\n  \"mod_airy\": {a:6377340.189, b:6356034.446, ellipseName:\"Modified Airy\"},\n  \"andrae\": {a:6377104.43, rf:300.0, ellipseName:\"Andrae 1876 (Den., Iclnd.)\"},\n  \"aust_SA\": {a:6378160.0, rf:298.25, ellipseName:\"Australian Natl & S. Amer. 1969\"},\n  \"GRS67\": {a:6378160.0, rf:298.2471674270, ellipseName:\"GRS 67(IUGG 1967)\"},\n  \"bessel\": {a:6377397.155, rf:299.1528128, ellipseName:\"Bessel 1841\"},\n  \"bess_nam\": {a:6377483.865, rf:299.1528128, ellipseName:\"Bessel 1841 (Namibia)\"},\n  \"clrk66\": {a:6378206.4, b:6356583.8, ellipseName:\"Clarke 1866\"},\n  \"clrk80\": {a:6378249.145, rf:293.4663, ellipseName:\"Clarke 1880 mod.\"},\n  \"CPM\": {a:6375738.7, rf:334.29, ellipseName:\"Comm. des Poids et Mesures 1799\"},\n  \"delmbr\": {a:6376428.0, rf:311.5, ellipseName:\"Delambre 1810 (Belgium)\"},\n  \"engelis\": {a:6378136.05, rf:298.2566, ellipseName:\"Engelis 1985\"},\n  \"evrst30\": {a:6377276.345, rf:300.8017, ellipseName:\"Everest 1830\"},\n  \"evrst48\": {a:6377304.063, rf:300.8017, ellipseName:\"Everest 1948\"},\n  \"evrst56\": {a:6377301.243, rf:300.8017, ellipseName:\"Everest 1956\"},\n  \"evrst69\": {a:6377295.664, rf:300.8017, ellipseName:\"Everest 1969\"},\n  \"evrstSS\": {a:6377298.556, rf:300.8017, ellipseName:\"Everest (Sabah & Sarawak)\"},\n  \"fschr60\": {a:6378166.0, rf:298.3, ellipseName:\"Fischer (Mercury Datum) 1960\"},\n  \"fschr60m\": {a:6378155.0, rf:298.3, ellipseName:\"Fischer 1960\"},\n  \"fschr68\": {a:6378150.0, rf:298.3, ellipseName:\"Fischer 1968\"},\n  \"helmert\": {a:6378200.0, rf:298.3, ellipseName:\"Helmert 1906\"},\n  \"hough\": {a:6378270.0, rf:297.0, ellipseName:\"Hough\"},\n  \"intl\": {a:6378388.0, rf:297.0, ellipseName:\"International 1909 (Hayford)\"},\n  \"kaula\": {a:6378163.0, rf:298.24, ellipseName:\"Kaula 1961\"},\n  \"lerch\": {a:6378139.0, rf:298.257, ellipseName:\"Lerch 1979\"},\n  \"mprts\": {a:6397300.0, rf:191.0, ellipseName:\"Maupertius 1738\"},\n  \"new_intl\": {a:6378157.5, b:6356772.2, ellipseName:\"New International 1967\"},\n  \"plessis\": {a:6376523.0, rf:6355863.0, ellipseName:\"Plessis 1817 (France)\"},\n  \"krass\": {a:6378245.0, rf:298.3, ellipseName:\"Krassovsky, 1942\"},\n  \"SEasia\": {a:6378155.0, b:6356773.3205, ellipseName:\"Southeast Asia\"},\n  \"walbeck\": {a:6376896.0, b:6355834.8467, ellipseName:\"Walbeck\"},\n  \"WGS60\": {a:6378165.0, rf:298.3, ellipseName:\"WGS 60\"},\n  \"WGS66\": {a:6378145.0, rf:298.25, ellipseName:\"WGS 66\"},\n  \"WGS72\": {a:6378135.0, rf:298.26, ellipseName:\"WGS 72\"},\n  \"WGS84\": {a:6378137.0, rf:298.257223563, ellipseName:\"WGS 84\"},\n  \"sphere\": {a:6370997.0, b:6370997.0, ellipseName:\"Normal Sphere (r=6370997)\"}\n};\n\nProj4js.Datum = {\n  \"WGS84\": {towgs84: \"0,0,0\", ellipse: \"WGS84\", datumName: \"WGS84\"},\n  \"GGRS87\": {towgs84: \"-199.87,74.79,246.62\", ellipse: \"GRS80\", datumName: \"Greek_Geodetic_Reference_System_1987\"},\n  \"NAD83\": {towgs84: \"0,0,0\", ellipse: \"GRS80\", datumName: \"North_American_Datum_1983\"},\n  \"NAD27\": {nadgrids: \"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat\", ellipse: \"clrk66\", datumName: \"North_American_Datum_1927\"},\n  \"potsdam\": {towgs84: \"606.0,23.0,413.0\", ellipse: \"bessel\", datumName: \"Potsdam Rauenberg 1950 DHDN\"},\n  \"carthage\": {towgs84: \"-263.0,6.0,431.0\", ellipse: \"clark80\", datumName: \"Carthage 1934 Tunisia\"},\n  \"hermannskogel\": {towgs84: \"653.0,-212.0,449.0\", ellipse: \"bessel\", datumName: \"Hermannskogel\"},\n  \"ire65\": {towgs84: \"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\", ellipse: \"mod_airy\", datumName: \"Ireland 1965\"},\n  \"nzgd49\": {towgs84: \"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993\", ellipse: \"intl\", datumName: \"New Zealand Geodetic Datum 1949\"},\n  \"OSGB36\": {towgs84: \"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894\", ellipse: \"airy\", datumName: \"Airy 1830\"}\n};\n\nProj4js.WGS84 = new Proj4js.Proj('WGS84');\nProj4js.Datum['OSB36'] = Proj4js.Datum['OSGB36']; //as returned from spatialreference.org\n\n//lookup table to go from the projection name in WKT to the Proj4js projection name\n//build this out as required\nProj4js.wktProjections = {\n  \"Lambert Tangential Conformal Conic Projection\": \"lcc\",\n  \"Mercator\": \"merc\",\n  \"Popular Visualisation Pseudo Mercator\": \"merc\",\n  \"Mercator_1SP\": \"merc\",\n  \"Transverse_Mercator\": \"tmerc\",\n  \"Transverse Mercator\": \"tmerc\",\n  \"Lambert Azimuthal Equal Area\": \"laea\",\n  \"Universal Transverse Mercator System\": \"utm\"\n};\n\n\n/*******************************************************************************\r\nNAME                            TRANSVERSE MERCATOR\r\n\r\nPURPOSE:\tTransforms input longitude and latitude to Easting and\r\n\t\tNorthing for the Transverse Mercator projection.  The\r\n\t\tlongitude and latitude must be in radians.  The Easting\r\n\t\tand Northing values will be returned in meters.\r\n\r\nALGORITHM REFERENCES\r\n\r\n1.  Snyder, John P., \"Map Projections--A Working Manual\", U.S. Geological\r\n    Survey Professional Paper 1395 (Supersedes USGS Bulletin 1532), United\r\n    State Government Printing Office, Washington D.C., 1987.\r\n\r\n2.  Snyder, John P. and Voxland, Philip M., \"An Album of Map Projections\",\r\n    U.S. Geological Survey Professional Paper 1453 , United State Government\r\n    Printing Office, Washington D.C., 1989.\r\n*******************************************************************************/\r\n\r\n\r\n/**\r\n  Initialize Transverse Mercator projection\r\n*/\r\n\r\nProj4js.Proj.tmerc = {\r\n  init : function() {\r\n    this.e0 = Proj4js.common.e0fn(this.es);\r\n    this.e1 = Proj4js.common.e1fn(this.es);\r\n    this.e2 = Proj4js.common.e2fn(this.es);\r\n    this.e3 = Proj4js.common.e3fn(this.es);\r\n    this.ml0 = this.a * Proj4js.common.mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\r\n  },\r\n\r\n  /**\r\n    Transverse Mercator Forward  - long/lat to x/y\r\n    long/lat in radians\r\n  */\r\n  forward : function(p) {\r\n    var lon = p.x;\r\n    var lat = p.y;\r\n\r\n    var delta_lon = Proj4js.common.adjust_lon(lon - this.long0); // Delta longitude\r\n    var con;    // cone constant\r\n    var x, y;\r\n    var sin_phi=Math.sin(lat);\r\n    var cos_phi=Math.cos(lat);\r\n\r\n    if (this.sphere) {  /* spherical form */\r\n      var b = cos_phi * Math.sin(delta_lon);\r\n      if ((Math.abs(Math.abs(b) - 1.0)) < .0000000001)  {\r\n        Proj4js.reportError(\"tmerc:forward: Point projects into infinity\");\r\n        return(93);\r\n      } else {\r\n        x = .5 * this.a * this.k0 * Math.log((1.0 + b)/(1.0 - b));\r\n        con = Math.acos(cos_phi * Math.cos(delta_lon)/Math.sqrt(1.0 - b*b));\r\n        if (lat < 0) con = - con;\r\n        y = this.a * this.k0 * (con - this.lat0);\r\n      }\r\n    } else {\r\n      var al  = cos_phi * delta_lon;\r\n      var als = Math.pow(al,2);\r\n      var c   = this.ep2 * Math.pow(cos_phi,2);\r\n      var tq  = Math.tan(lat);\r\n      var t   = Math.pow(tq,2);\r\n      con = 1.0 - this.es * Math.pow(sin_phi,2);\r\n      var n   = this.a / Math.sqrt(con);\r\n      var ml  = this.a * Proj4js.common.mlfn(this.e0, this.e1, this.e2, this.e3, lat);\r\n\r\n      x = this.k0 * n * al * (1.0 + als / 6.0 * (1.0 - t + c + als / 20.0 * (5.0 - 18.0 * t + Math.pow(t,2) + 72.0 * c - 58.0 * this.ep2))) + this.x0;\r\n      y = this.k0 * (ml - this.ml0 + n * tq * (als * (0.5 + als / 24.0 * (5.0 - t + 9.0 * c + 4.0 * Math.pow(c,2) + als / 30.0 * (61.0 - 58.0 * t + Math.pow(t,2) + 600.0 * c - 330.0 * this.ep2))))) + this.y0;\r\n\r\n    }\r\n    p.x = x; p.y = y;\r\n    return p;\r\n  }, // tmercFwd()\r\n\r\n  /**\r\n    Transverse Mercator Inverse  -  x/y to long/lat\r\n  */\r\n  inverse : function(p) {\r\n    var con, phi;  /* temporary angles       */\r\n    var delta_phi; /* difference between longitudes    */\r\n    var i;\r\n    var max_iter = 6;      /* maximun number of iterations */\r\n    var lat, lon;\r\n\r\n    if (this.sphere) {   /* spherical form */\r\n      var f = Math.exp(p.x/(this.a * this.k0));\r\n      var g = .5 * (f - 1/f);\r\n      var temp = this.lat0 + p.y/(this.a * this.k0);\r\n      var h = Math.cos(temp);\r\n      con = Math.sqrt((1.0 - h * h)/(1.0 + g * g));\r\n      lat = Proj4js.common.asinz(con);\r\n      if (temp < 0)\r\n        lat = -lat;\r\n      if ((g == 0) && (h == 0)) {\r\n        lon = this.long0;\r\n      } else {\r\n        lon = Proj4js.common.adjust_lon(Math.atan2(g,h) + this.long0);\r\n      }\r\n    } else {    // ellipsoidal form\r\n      var x = p.x - this.x0;\r\n      var y = p.y - this.y0;\r\n\r\n      con = (this.ml0 + y / this.k0) / this.a;\r\n      phi = con;\r\n      for (i=0;true;i++) {\r\n        delta_phi=((con + this.e1 * Math.sin(2.0*phi) - this.e2 * Math.sin(4.0*phi) + this.e3 * Math.sin(6.0*phi)) / this.e0) - phi;\r\n        phi += delta_phi;\r\n        if (Math.abs(delta_phi) <= Proj4js.common.EPSLN) break;\r\n        if (i >= max_iter) {\r\n          Proj4js.reportError(\"tmerc:inverse: Latitude failed to converge\");\r\n          return(95);\r\n        }\r\n      } // for()\r\n      if (Math.abs(phi) < Proj4js.common.HALF_PI) {\r\n        // sincos(phi, &sin_phi, &cos_phi);\r\n        var sin_phi=Math.sin(phi);\r\n        var cos_phi=Math.cos(phi);\r\n        var tan_phi = Math.tan(phi);\r\n        var c = this.ep2 * Math.pow(cos_phi,2);\r\n        var cs = Math.pow(c,2);\r\n        var t = Math.pow(tan_phi,2);\r\n        var ts = Math.pow(t,2);\r\n        con = 1.0 - this.es * Math.pow(sin_phi,2);\r\n        var n = this.a / Math.sqrt(con);\r\n        var r = n * (1.0 - this.es) / con;\r\n        var d = x / (n * this.k0);\r\n        var ds = Math.pow(d,2);\r\n        lat = phi - (n * tan_phi * ds / r) * (0.5 - ds / 24.0 * (5.0 + 3.0 * t + 10.0 * c - 4.0 * cs - 9.0 * this.ep2 - ds / 30.0 * (61.0 + 90.0 * t + 298.0 * c + 45.0 * ts - 252.0 * this.ep2 - 3.0 * cs)));\r\n        lon = Proj4js.common.adjust_lon(this.long0 + (d * (1.0 - ds / 6.0 * (1.0 + 2.0 * t + c - ds / 20.0 * (5.0 - 2.0 * c + 28.0 * t - 3.0 * cs + 8.0 * this.ep2 + 24.0 * ts))) / cos_phi));\r\n      } else {\r\n        lat = Proj4js.common.HALF_PI * Proj4js.common.sign(y);\r\n        lon = this.long0;\r\n      }\r\n    }\r\n    p.x = lon;\r\n    p.y = lat;\r\n    return p;\r\n  } // tmercInv()\r\n};Proj4js.defs['UTMK'] = '+title=UTMK +proj=tmerc +lat_0=38.0 +lon_0=127.5 +x_0=1000000.0 +y_0=2000000.0 +k=0.9996 +a=6378137.0 +b=6356752.3141403 +ellps=GRS80 +towgs84=0,0,0 +no_defs';\r\nProj4js.defs['KATECH'] = '+title=KATECH +proj=tmerc +lat_0=38.0 +lon_0=128.0 +x_0=400000.0 +y_0=600000.0 +k=0.9999 +a=6377397.155 +b=6356078.9633422494 +ellps=bessel +towgs84=-115.80,474.99,674.11,1.16,-2.31,-1.63,6.43 +no_defs';\r\n/**\r\n *   . Coord     ,\r\n *       .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Coord').define({\r\n\r\n  $static: {\r\n    /**\r\n     * {@link olleh.maps.Coord#almostEquals}    .  .\r\n     * @constant\r\n     * @type Number\r\n     */\r\n    DEFAULT_EPSILON_IN_METER: 0.001 // 1 mm\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   */\r\n  Coord: function () {\r\n    if (this.$classname === 'olleh.maps.Coord') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.Coord directly.');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * x.\r\n   * @name x\r\n   * @memberof olleh.maps.Coord.prototype\r\n   * @field\r\n   * @type Number\r\n   * @readonly\r\n   */\r\n\r\n  /**\r\n   * y.\r\n   * @name y\r\n   * @memberof olleh.maps.Coord.prototype\r\n   * @field\r\n   * @type Number\r\n   * @readonly\r\n   */\r\n\r\n  /**\r\n   *     .     . \r\n   * @param {olleh.maps.Coord} other   .\r\n   * @returns {Boolean}   true,    false.\r\n   */\r\n  equals: function (other) {\r\n    return other && this.x === other.x && this.y === other.y && other.getClass() === this.getClass();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *          .\r\n   *           . \r\n   * @param {olleh.maps.Coord} other   \r\n   * @param {Number} [epsilonInMeter=olleh.maps.Coord.DEFAULT_EPSILON_IN_METER]  .  .\r\n   * @returns {Boolean}      true,    false.\r\n   */\r\n  almostEquals: function (other, epsilonInMeter) {\r\n    return this.distanceTo(other) < (epsilonInMeter || olleh.maps.Coord.DEFAULT_EPSILON_IN_METER);\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @param {olleh.maps.Coord} other  .\r\n   * @returns {Number}   .  .\r\n   */\r\n  distanceTo: function (other) {\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other ? other.asDefault() : {\r\n      x: 0,\r\n      y: 0\r\n    };\r\n    var diff = {\r\n      x: utmkThis.x - utmkOther.x,\r\n      y: utmkThis.y - utmkOther.y\r\n    };\r\n    return Math.sqrt(Math.abs(diff.x * diff.x + diff.y * diff.y));\r\n  },\r\n  \r\n  /**\r\n   *  x, y      .\r\n   * @returns {Object} Plain-old JavaScript Object \r\n   */\r\n  xy: function () {\r\n    return {\r\n      x: this.x,\r\n      y: this.y\r\n    };\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @private\r\n   * @param {cls} Type   .\r\n   * @returns {olleh.maps.Coord}  .\r\n   */\r\n  transform: function (Type) {\r\n    if (this.getClass() === Type) {\r\n      return this;\r\n    }\r\n    return new Type(Proj4js.transform(this.getClass().PROJ, Type.PROJ, this.xy()));\r\n  },\r\n\r\n  /**\r\n   *     {@link olleh.maps.UTMK}  .\r\n   * @returns {olleh.maps.UTMK}  .\r\n   */\r\n  asDefault: function () {\r\n    return olleh.maps.UTMK.valueOf(this);\r\n  },\r\n  \r\n  /**\r\n   * Coord  .\r\n   * @returns {olleh.maps.Coord}  \r\n   */\r\n  clone: function () {\r\n    return new this.constructor(this.xy());\r\n  }\r\n\r\n});\r\n/**\r\n * UTM-K     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.UTMK').extend(olleh.maps.Coord).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type Proj4js.Proj\r\n     */\r\n    PROJ: new Proj4js.Proj('UTMK'),\r\n    \r\n    _projs: {},\r\n    \r\n    /**\r\n     *   UTM-K   .\r\n     * @param {olleh.maps.Coord} coord   .\r\n     * @returns {olleh.maps.UTMK}  .\r\n     *//**\r\n     *     UTM-K    .\r\n     * {@link olleh.maps.LatLng}, {@link olleh.maps.Katech}   \r\n     *      ,   \r\n     *    {@link olleh.maps.UTMK.valueOf(coord)} \r\n     *  .\r\n     * @param {Object} xy x y   .\r\n     * @param {Number} xy.x x.\r\n     * @param {Number} xy.y y.\r\n     * @param {String} crs   Proj4js CRS .\r\n     * @returns {olleh.maps.UTMK}  .\r\n     * @see http://trac.osgeo.org/proj4js/wiki/UserGuide\r\n     *//**\r\n     *     UTM-K    .\r\n     * {@link olleh.maps.LatLng}, {@link olleh.maps.Katech}   \r\n     *      ,   \r\n     *    {@link olleh.maps.UTMK.valueOf(coord)} \r\n     *  .\r\n     * @param {Number} x x.\r\n     * @param {Number} y y.\r\n     * @param {String} crs   Proj4js CRS .\r\n     * @returns {olleh.maps.UTMK}  .\r\n     * @see http://trac.osgeo.org/proj4js/wiki/UserGuide\r\n     */\r\n    valueOf: function () {\r\n      var proj, xy, crs;\r\n      switch (arguments.length) {\r\n      case 0:\r\n        return olleh.maps.UTMK;\r\n      case 1:\r\n        return arguments[0].transform(olleh.maps.UTMK);\r\n      case 2:\r\n        xy = arguments[0];\r\n        crs = arguments[1];\r\n        break;\r\n      default:\r\n        xy = {\r\n          x: arguments[0],\r\n          y: arguments[1]\r\n        };\r\n        crs = arguments[2];\r\n        break;\r\n      } \r\n\r\n      if (crs != 'UTMK') {\r\n        proj = olleh.maps.UTMK._projs[crs];\r\n        if (!proj) {\r\n          proj = olleh.maps.UTMK._projs[crs] = new Proj4js.Proj(crs);\r\n        }\r\n        xy = Proj4js.transform(proj, olleh.maps.UTMK.PROJ, xy);\r\n      }\r\n      \r\n      return new olleh.maps.UTMK(xy);\r\n    }\r\n\r\n  },\r\n  \r\n  /**\r\n   *  UTMK  .\r\n   * @param {Object} xy x y   .\r\n   * @function UTMK\r\n   * @memberof olleh.maps.UTMK\r\n   * @instance\r\n   */\r\n  /**\r\n   * UTMK  .\r\n   * @param {Number} x x.\r\n   * @param {Number} y y.\r\n   */\r\n  UTMK: function (arg0, arg1) {\r\n    if (arguments.length > 1) {\r\n      this.x = +arg0;\r\n      this.y = +arg1;\r\n    } else {\r\n      this.x = +arg0.x;\r\n      this.y = +arg0.y;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  UTMK   .<br/>\r\n   *  {x: 957085.70, y: 1944017.52} .\r\n   * @returns   \r\n   */\r\n  toString: function () {\r\n    return '{x: ' + this.x + ', y: ' + this.y + '}';\r\n  },\r\n\r\n  /**\r\n   *     {@link olleh.maps.UTMK}  .\r\n   * @returns {olleh.maps.UTMK}  .\r\n   */\r\n  asDefault: function () {\r\n    // asDefault()       \r\n    return this;\r\n  }\r\n  \r\n});\r\n/** \r\n * LatLng(WGS84)     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.LatLng').extend(olleh.maps.Coord).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type Proj4js.Proj\r\n     */\r\n    PROJ: new Proj4js.Proj('WGS84'),\r\n    \r\n    /**\r\n     *   LatLng   .\r\n     * @param {olleh.maps.Coord}   .\r\n     * @returns {olleh.maps.LatLng}  .\r\n     */\r\n   valueOf: function (coord) {\r\n     if (!arguments.length) {\r\n       return olleh.maps.LatLng;\r\n     }\r\n      return coord.transform(olleh.maps.LatLng);\r\n    }\r\n  },\r\n\r\n\r\n  /**\r\n   *  LatLng  .\r\n   * @param {Object} xy x y   .\r\n   * @function LatLng\r\n   * @memberof olleh.maps.LatLng\r\n   * @instance\r\n   */\r\n  /**\r\n   *  LatLng  .\r\n   * @param {Object} latlng lat lng   .\r\n   * @function LatLng\r\n   * @memberof olleh.maps.LatLng\r\n   * @instance\r\n   */\r\n  /**\r\n   * LatLng  .   y, x  .\r\n   * @param {Number} y y(Latitude).\r\n   * @param {Number} x x(Longitude).\r\n   */\r\n  LatLng: function (arg0, arg1) {\r\n    if (arguments.length > 1) {\r\n      this.y = +arg0;\r\n      this.x = +arg1;\r\n    } else if (arg0.lat !== undefined) {\r\n      this.y = +arg0.lat;\r\n      this.x = +arg0.lng;\r\n    } else {\r\n      this.y = +arg0.y;\r\n      this.x = +arg0.x;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  LatLng(WGS84)   .<br/>\r\n   *  {lat: 37.494416325586315, lng: 127.0145272694056} .\r\n   * @returns   \r\n   */\r\n  toString: function () {\r\n    return '{lat: ' + this.y + ', lng: ' + this.x + '}';\r\n  }\r\n});\r\n/**\r\n * Katech     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Katech').extend(olleh.maps.Coord).define({\r\n\r\n  $static:  {\r\n    /**\r\n     * @constant\r\n     * @type Proj4js.Proj\r\n     */\r\n    PROJ: new Proj4js.Proj('KATECH'),\r\n    \r\n    /**\r\n     *  Katech  .\r\n     * @param {olleh.maps.Coord}   .\r\n     * @returns {olleh.maps.Katech}  .\r\n     */\r\n    valueOf: function (coord) {\r\n      if (!arguments.length) {\r\n        return olleh.maps.Katech;\r\n      }\r\n      return coord.transform(olleh.maps.Katech);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  Katech  .\r\n   * @param {Object} xy x y   .\r\n   * @function Katech\r\n   * @memberof olleh.maps.Katech\r\n   * @instance\r\n   */\r\n  /**\r\n   * Katech  .\r\n   * @param {Number} x x.\r\n   * @param {Number} y y.\r\n   */\r\n  Katech: function (arg0, arg1) {\r\n    if (arguments.length > 1) {\r\n      this.x = +arg0;\r\n      this.y = +arg1;\r\n    } else {\r\n      this.x = +arg0.x;\r\n      this.y = +arg0.y;\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *     class.   {@link olleh.maps.Coord} class  .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Path').define({\r\n\r\n  /**\r\n   * ,  coords    .\r\n   * @param {Array.<olleh.maps.Coord>} [coords] {@link olleh.maps.Coord} \r\n   */\r\n  Path: function (coords) {\r\n    this._coords = coords || [];\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   */\r\n  clear: function () {\r\n    this._coords = [];\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @returns {Array.<olleh.maps.Coord>}\r\n   */\r\n  getCoords: function () {\r\n    return this._coords;\r\n  },\r\n\r\n  /**\r\n   * i   .\r\n   * @param {Number} i\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getAt: function (i) {\r\n    return this._coords[i];\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @return {Number}\r\n   */\r\n  getLength: function () {\r\n    return this._coords.length;\r\n  },\r\n\r\n  /**\r\n   *  coord  i   .\r\n   * @param {Number} i \r\n   * @param {olleh.maps.Coord} coord \r\n   */\r\n  insertAt: function (i, coord) {\r\n    this._coords.splice(i, 0, coord);\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {olleh.maps.Coord}   \r\n   */\r\n  pop: function () {\r\n    var last = this._coords.pop();\r\n    this._notifyListeners();\r\n    return last;\r\n  },\r\n\r\n  /**\r\n   *  coord   .\r\n   * @param {olleh.maps.Coord} coord\r\n   */\r\n  push: function (coord) {\r\n    this._coords.push(coord);\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   * i   .\r\n   * @param {Number} i\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  removeAt: function (i) {\r\n    return this._coords.splice(i, 1)[0];\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   * i   coord  .\r\n   * @param {Number} i\r\n   * @param {olleh.maps.Coord} coord\r\n   */\r\n  setAt: function (i, coord) {\r\n    this._coords[i] = coord;\r\n    this._notifyListeners();\r\n  },\r\n\r\n  /**\r\n   *  Path    callbackFn  . \r\n   * @param {Function} callbackFn function(path) - path: this object (olleh.maps.Path) \r\n   */\r\n  onChange: function (callbackFn, ctx) {\r\n    var listener = this._getEventListener(callbackFn, true);\r\n    var idx = olleh.maps.util.indexOf(listener.ctxs, ctx);\r\n    if (idx === -1) {\r\n      listener.ctxs.push(ctx);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * onChange()   callbackFn  .\r\n   * @param {Function} callbackFn \r\n   * @param {Object} ctx \r\n   */\r\n  unsubscribeChange: function (callbackFn, ctx) {\r\n    var listener = this._getEventListener(callbackFn, false);\r\n    if (listener) {\r\n      var idx = olleh.maps.util.removeFromArray(listener.ctxs, ctx);\r\n      if (idx > -1 && listener.ctxs.length === 0) {\r\n        olleh.maps.util.removeFromArray(this._listeners, listener);\r\n      }\r\n    }\r\n  },\r\n\r\n  _notifyListeners: function () {\r\n    if (!this._listeners) {\r\n      return;\r\n    }\r\n    for ( var i = 0, len = this._listeners.length; i < len; i++) {\r\n      var listener = this._listeners[i];\r\n      var callbackFn = listener.callbackFn;\r\n      var ctxs = listener.ctxs;\r\n      for ( var j = 0, len = ctxs.length; j < len; j++) {\r\n        callbackFn.call(ctxs[j], this);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @param {Function} callbackFn\r\n   * @param {Boolean} create\r\n   * @returns {Object} callbackFn: Function, ctxs: {Array} \r\n   */\r\n  _getEventListener: function (callbackFn, create) {\r\n    var listener;\r\n    var listeners = this._listeners;\r\n    if (listeners) {\r\n      for ( var i = 0, len = listeners.length; i < len; i++) {\r\n        if (listeners[i].callbackFn === callbackFn) {\r\n          listener = listeners[i];\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    if (!listener && create) {\r\n      if(!listeners) {\r\n        this._listeners = [];\r\n      }\r\n      listener = {\r\n        callbackFn: callbackFn,\r\n        ctxs: []\r\n      };\r\n      this._listeners.push(listener);\r\n    }\r\n    return listener;\r\n  },\r\n  \r\n  /**\r\n   *  Coord  .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getFirst: function() {\r\n    return this.getAt(0);\r\n  },\r\n  \r\n  /**\r\n   *  Coord  .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getLast: function() {\r\n    return this.getAt(this.getLength() - 1);\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @returns {Number}\r\n   */\r\n  getDistance: function() {\r\n    var coords = this._coords;\r\n    if(coords.length < 2)\r\n      return 0;\r\n    var distance = 0;\r\n    for(var i = 1 ; i < coords.length; i++) {\r\n      distance += coords[i - 1].distanceTo(coords[i]);  \r\n    } \r\n    return distance;\r\n  },\r\n  \r\n  /**\r\n   * path  polygon    .\r\n   * @see http://www.mathopenref.com/coordpolygonarea2.html\r\n   */\r\n  getArea: function() {\r\n    var coords = this._coords;\r\n    if(coords.length < 3)\r\n      return 0;\r\n    var j = coords.length - 1;\r\n    var area = 0;\r\n    for (var i = 0; i < coords.length ; i++) {\r\n      var coord1 = coords[j];\r\n      var coord2 = coords[i];\r\n      area += (coord1.x + coord2.x) * (coord1.y - coord2.y);\r\n      j = i;\r\n    }\r\n    area /= 2;\r\n    if(area < 0)\r\n      area = -area;\r\n    return area;\r\n  },\r\n  \r\n  /**\r\n   * Path    .\r\n   * @returns {class}  .\r\n   */\r\n  getType: function () {\r\n    if(this._coords.length === 0)\r\n      return null;\r\n    return this._coords[0].getClass();\r\n  },\r\n  \r\n  /**\r\n   * Path  Polygon    .\r\n   * @returns {olleh.maps.Coord} \r\n   */\r\n  getCenteroid: function() {\r\n    var coords = this._coords;\r\n    var len = coords.length;\r\n    if(len === 0)\r\n      return null;\r\n    if(len === 1)\r\n      return coords[0];\r\n    var sumX = 0.0;\r\n    var sumY = 0.0;\r\n    for (var i=0, j=len-1 ; i < len ; i++ ){\r\n      var b = coords[j];\r\n      var c = coords[i];\r\n      sumX += (b.x + c.x) * (b.x * c.y - c.x * b.y);\r\n      sumY += (b.y + c.y) * (b.x * c.y - c.x * b.y);\r\n      j = i;\r\n    }\r\n    var area = this.getArea();\r\n    var x = sumX / (6 * area);\r\n    var y = sumY / (6 * area);\r\n    var center = new (this.getType())({x: x, y: y});\r\n    return center;\r\n  },\r\n\r\n  /**\r\n   * Path  bounds  .\r\n   * @returns {olleh.maps.Bounds} bounds\r\n   */\r\n  getBounds: function() {\r\n    var coords = this._coords;\r\n    if (!coords.length) {\r\n      return null;\r\n    }\r\n    \r\n    var left = Infinity, bottom = Infinity, right = 0, top = 0;\r\n    for (var i = 0; i < this.getLength(); i++) {\r\n      var coord = this.getAt(i);\r\n      if (left > coord.x) {\r\n        left = coord.x;\r\n      }\r\n      if (bottom > coord.y) {\r\n        bottom = coord.y;\r\n      }\r\n      if (right < coord.x) {\r\n        right = coord.x;\r\n      }\r\n      if (top < coord.y) {\r\n        top = coord.y;\r\n      }\r\n    }\r\n\r\n    var Type = this.getType();\r\n    var leftBottom = new Type({x: left, y: bottom});\r\n    var rightTop = new Type({x: right, y: top});\r\n    return new olleh.maps.Bounds(leftBottom, rightTop);\r\n  },\r\n  \r\n  /**\r\n   * Path  coord    .\r\n   * @param {olleh.maps.Coord} coord \r\n   * @param {Boolean} [closedPath=false] true      closedPath  . \r\n   * @returns {Number} \r\n   */\r\n  distanceTo: function(coord, closedPath) {\r\n    coord = coord.asDefault();\r\n    var coords = this._coords;\r\n    var dist;\r\n    for(var i=0; i<coords.length; i++) {\r\n      var coord1;\r\n      var coord2;\r\n      if(i==coords.length-1) {\r\n        if(closedPath) {\r\n          coord1 = coords[i].asDefault();\r\n          coord2 = coords[0].asDefault();\r\n        } else {\r\n          break;\r\n        }\r\n      } else {\r\n        coord1 = coords[i].asDefault();\r\n        coord2 = coords[i+1].asDefault();\r\n      }\r\n      var d = this._distanceToSegment(coord, {x1:coord1.x, y1:coord1.y, x2:coord2.x, y2:coord2.y });\r\n      if(dist === undefined || d < dist) {\r\n        dist = d;\r\n      }\r\n    }\r\n    return dist;\r\n  },\r\n  \r\n  /**\r\n   * point  segment   .\r\n   * @param {olleh.maps.Coord} coord\r\n   * @param {Object} {x1,y1,x2,y2} x1,y1  x2,y2   \r\n   * @returns {Number} \r\n   * @private \r\n   */\r\n  _distanceToSegment: function(point, segment) {\r\n    var x0 = point.x;\r\n    var y0 = point.y;\r\n    var x1 = segment.x1;\r\n    var y1 = segment.y1;\r\n    var x2 = segment.x2;\r\n    var y2 = segment.y2;\r\n    var dx = x2 - x1;\r\n    var dy = y2 - y1;\r\n    var along = ((dx * (x0 - x1)) + (dy * (y0 - y1))) /\r\n                (Math.pow(dx, 2) + Math.pow(dy, 2));\r\n    var x, y;\r\n    if(along <= 0.0) {\r\n        x = x1;\r\n        y = y1;\r\n    } else if(along >= 1.0) {\r\n        x = x2;\r\n        y = y2;\r\n    } else {\r\n        x = x1 + along * dx;\r\n        y = y1 + along * dy;\r\n    }\r\n    return Math.sqrt(Math.pow(x - x0, 2) + Math.pow(y - y0, 2));\r\n  },\r\n  \r\n  /**\r\n   * Path     douglas-peucker  . <br>\r\n   * douglas-peucker : http://en.wikipedia.org/wiki/Ramer%E2%80%93Douglas%E2%80%93Peucker_algorithm\r\n   * @param {Number} tolerance dp  threshold\r\n   * @returns {olleh.maps.Path}  path  \r\n   */\r\n  simplify: function(tolerance) {\r\n    var coords = this._coords;\r\n    if(coords.length < 3)\r\n      return this;\r\n    var firstPoint = 0;\r\n    var lastPoint = coords.length - 1;\r\n    var pointIndexsToKeep = [];\r\n    \r\n    pointIndexsToKeep.push(firstPoint);\r\n    pointIndexsToKeep.push(lastPoint);\r\n\r\n    while (coords[firstPoint].equals(coords[lastPoint])) {\r\n        lastPoint--;\r\n        pointIndexsToKeep.push(lastPoint);\r\n    }\r\n    \r\n    this._douglasPeuckerReduction(coords, firstPoint, lastPoint, tolerance, pointIndexsToKeep);\r\n    \r\n    var returnPoints = [];\r\n    pointIndexsToKeep.sort(function(a, b){\r\n        return (a-b);\r\n    });\r\n    for (var index = 0; index < pointIndexsToKeep.length; index++) {\r\n        returnPoints.push(coords[pointIndexsToKeep[index]]);\r\n    }\r\n    return new olleh.maps.Path(returnPoints);\r\n  },\r\n  \r\n  _douglasPeuckerReduction: function(coords, firstPoint, lastPoint, tolerance, pointIndexsToKeep) {\r\n    var maxDistance = 0;\r\n    var indexFarthest = 0;\r\n\r\n    for (var index = firstPoint, distance; index < lastPoint; index++) {\r\n        distance = this._perpendicularDistance(coords[firstPoint], coords[lastPoint], coords[index]);\r\n        if (distance > maxDistance) {\r\n            maxDistance = distance;\r\n            indexFarthest = index;\r\n        }\r\n    }\r\n\r\n    if (maxDistance > tolerance && indexFarthest != firstPoint) {\r\n        pointIndexsToKeep.push(indexFarthest);\r\n        this._douglasPeuckerReduction(coords, firstPoint, indexFarthest, tolerance, pointIndexsToKeep);\r\n        this._douglasPeuckerReduction(coords, indexFarthest, lastPoint, tolerance, pointIndexsToKeep);\r\n    }\r\n  },\r\n  \r\n  _perpendicularDistance: function(point1, point2, point){\r\n      var area = Math.abs(0.5 * (point1.x * point2.y + point2.x * point.y + point.x * point1.y - point2.x * point1.y - point.x * point2.y - point1.x * point.y));\r\n      var bottom = Math.sqrt(Math.pow(point1.x - point2.x, 2) + Math.pow(point1.y - point2.y, 2));\r\n      var height = area / bottom * 2;\r\n      return height;\r\n  }\r\n\r\n});\n/**\r\n *     .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Bounds').define({\r\n\r\n  /**\r\n   * ,  leftBottom,rightTop    .\r\n   * @param {olleh.maps.Coord} leftBottom   .\r\n   * @param {olleh.maps.Coord} rightTop   . <code>leftBottom</code>    .\r\n   */\r\n  Bounds: function (leftBottom, rightTop) {\r\n    if (leftBottom.getClass() != rightTop.getClass()) {\r\n      throw new TypeError('Coordinate system mismatch: ' + leftBottom.$classname + ', ' + rightTop.$classname);\r\n    }\r\n    \r\n    /**\r\n     *   .     .\r\n     * @type olleh.maps.Coord\r\n     */\r\n    this.leftBottom = leftBottom;\r\n\r\n    /**\r\n     *   .     .\r\n     * @type olleh.maps.Coord\r\n     */\r\n    this.rightTop = rightTop;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {cls}  .\r\n   */\r\n  getType: function () {\r\n    return this.leftBottom.getClass();\r\n  },\r\n\r\n  /**\r\n   *     .     . \r\n   * @param {olleh.maps.Bounds} other   .\r\n   * @returns {Boolean}   true,    false.\r\n   */\r\n  equals: function (other) {\r\n    return this.leftBottom.equals(other.leftBottom)\r\n        && this.rightTop.equals(other.rightTop);\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *        . \r\n   * @param {olleh.maps.Bounds} other   \r\n   * @param {Number} [epsilonInMeter]  .  .\r\n   * @returns {Boolean}      true,    false.\r\n   * @see olleh.maps.Coord#almostEquals()\r\n   */\r\n  almostEquals: function (other, epsilonInMeter) {\r\n    return this.leftBottom.almostEquals(other.leftBottom, epsilonInMeter)\r\n        && this.rightTop.almostEquals(other.rightTop, epsilonInMeter);\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getLeft: function () {\r\n    return this.leftBottom.x;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getBottom: function () {\r\n    return this.leftBottom.y;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getRight: function () {\r\n    return this.rightTop.x;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {Number}  .\r\n   */\r\n  getTop: function () {\r\n    return this.rightTop.y;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.Coord}  .\r\n   */\r\n  getLeftTopCoord: function() {\r\n    return new (this.getType())({x: this.getLeft(), y: this.getTop()});\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.Coord}  .\r\n   */\r\n  getRightBottomCoord: function() {\r\n    return new (this.getType())({x: this.getRight(), y: this.getBottom()});\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Number} .  .\r\n   */\r\n  getWidth: function () {\r\n    var utmkBounds = this.asDefault();\r\n    return utmkBounds.getRight() - utmkBounds.getLeft();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Number} .  .\r\n   */\r\n  getHeight: function () {\r\n    var utmkBounds = this.asDefault();\r\n    return utmkBounds.getTop() - utmkBounds.getBottom();\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.UTMK}   .   {@link olleh.maps.UTMK} .\r\n   */\r\n  getCenter: function () {\r\n    var utmkThis = this.asDefault();\r\n    var coord = new olleh.maps.UTMK((utmkThis.getLeft() + utmkThis.getRight()) / 2,\r\n        (utmkThis.getBottom() + utmkThis.getTop()) / 2); \r\n    return coord;\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   * @param {olleh.maps.Bounds|olleh.maps.Coord} other    .\r\n   * @returns {Boolean}       true,    false.\r\n   */\r\n  intersects: function (other) {\r\n    if(!other)\r\n      return false;\r\n    if (other.x !== undefined && other.y !== undefined) {\r\n      return this._containsCoord(other);\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return utmkThis.getLeft() <= utmkOther.getRight()\r\n        && utmkThis.getBottom() <= utmkOther.getTop()\r\n        && utmkThis.getRight() >= utmkOther.getLeft()\r\n        && utmkThis.getTop() >= utmkOther.getBottom();\r\n  },\r\n\r\n  /**\r\n   *        .\r\n   * @param {olleh.maps.Bounds|olleh.maps.Coord} other    .\r\n   * @returns {Boolean}       true,    false.\r\n   */\r\n  contains: function (other) {\r\n    if(!other)\r\n      return false;\r\n    if (other.x !== undefined && other.y !== undefined) {\r\n      return this._containsCoord(other);\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return utmkThis.getLeft() <= utmkOther.getLeft()\r\n        && utmkThis.getBottom() <= utmkOther.getBottom()\r\n        && utmkThis.getRight() >= utmkOther.getRight()\r\n        && utmkThis.getTop() >= utmkOther.getTop();\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @private\r\n   * @param {olleh.maps.Coord} coord  .\r\n   * @returns {Boolean}     true,    false.\r\n   */\r\n  _containsCoord: function (coord) {\r\n    var utmkThis = this.asDefault();\r\n    var utmkCoord = coord.asDefault();\r\n    return utmkThis.getLeft() <= utmkCoord.x\r\n        && utmkThis.getBottom() <= utmkCoord.y\r\n        && utmkThis.getRight() >= utmkCoord.x\r\n        && utmkThis.getTop() >= utmkCoord.y;\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @param {olleh.maps.Bounds} other  .\r\n   * @returns {olleh.maps.Bounds}    .   {@link olleh.maps.UTMK} .      <code>null</code> .\r\n   */\r\n  intersection: function (other) {\r\n    if (!this.intersects(other)) {\r\n      return null;\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(Math.max(utmkThis.getLeft(), utmkOther.getLeft()), Math.max(utmkThis.getBottom(), utmkOther.getBottom())),\r\n        new olleh.maps.UTMK(Math.min(utmkThis.getRight(), utmkOther.getRight()), Math.min(utmkThis.getTop(), utmkOther.getTop()))\r\n    );\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @param {olleh.maps.Bounds|olleh.maps.Coord} other    .\r\n   * @returns {olleh.maps.Bounds}      .   {@link olleh.maps.UTMK} .          .\r\n   */\r\n  union: function (other) {\r\n    if (this.contains(other)) {\r\n      return this;\r\n    }\r\n    if (other.x !== undefined && other.y !== undefined) {\r\n      return this._unionCoord(other);\r\n    }\r\n    var utmkThis = this.asDefault();\r\n    var utmkOther = other.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(Math.min(utmkThis.getLeft(), utmkOther.getLeft()), Math.min(utmkThis.getBottom(), utmkOther.getBottom())),\r\n        new olleh.maps.UTMK(Math.max(utmkThis.getRight(), utmkOther.getRight()), Math.max(utmkThis.getTop(), utmkOther.getTop()))\r\n    );\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @private\r\n   * @param {olleh.maps.Coord} other    .\r\n   * @returns {olleh.maps.Bounds}      .   {@link olleh.maps.UTMK} .\r\n   */\r\n  _unionCoord: function (coord) {\r\n    var utmkThis = this.asDefault();\r\n    var utmkCoord = coord.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(Math.min(utmkThis.getLeft(), utmkCoord.x), Math.min(utmkThis.getBottom(), utmkCoord.y)),\r\n        new olleh.maps.UTMK(Math.max(utmkThis.getRight(), utmkCoord.x), Math.max(utmkThis.getTop(), utmkCoord.y))\r\n    );\r\n  },\r\n  \r\n  /**\r\n   *         . \r\n   * @param {Number} width   .  .\r\n   * @param {Number} height   .  .\r\n   * @returns {olleh.maps.Bounds}  .   {@link olleh.maps.UTMK} .\r\n   */\r\n  expand: function (width, height) {\r\n    var utmkThis = this.asDefault();\r\n    return new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(utmkThis.getLeft() - width / 2, utmkThis.getBottom() - height / 2),\r\n        new olleh.maps.UTMK(utmkThis.getRight() + width / 2, utmkThis.getTop() + height / 2)\r\n    );\r\n  },\r\n  \r\n  /**\r\n   *       .\r\n   * @param {cls} Type   .\r\n   * @returns {olleh.maps.Bounds}  .\r\n   * @see olleh.maps.Coord.valueOf()\r\n   */\r\n  transform: function (Type) {\r\n    if (this.getType() === Type) {\r\n      return this;\r\n    }\r\n    return new olleh.maps.Bounds(Type.valueOf(this.leftBottom), Type.valueOf(this.rightTop));\r\n  },\r\n  \r\n  /**\r\n   *      {@link olleh.maps.UTMK}  .\r\n   * @returns {olleh.maps.Bounds}  .\r\n   * @see olleh.maps.Coord#asDefault()\r\n   */\r\n  asDefault: function () {\r\n    return this.transform(olleh.maps.UTMK);\r\n  }\r\n\r\n});\r\n/**\r\n *    .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Point').define({\r\n  \r\n  $static: {\r\n    zero: function () {\r\n      return olleh.maps.Point._zero || (olleh.maps.Point._zero = new olleh.maps.Point(0, 0));\r\n    }\r\n  },\r\n\r\n  /**\r\n   * ,  x, y    .\r\n   * @param {Number} x  x .  .\r\n   * @param {Number} y  y .  .\r\n   */\r\n  Point: function (x, y) {\r\n    /**\r\n     *  x .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.x = +x;\r\n\r\n    /**\r\n     *  y .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.y = +y;\r\n  },\r\n  \r\n  /**\r\n   * clone this object\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  clone: function () {\r\n    return new olleh.maps.Point(this.x, this.y);\r\n  },\r\n  \r\n  /**\r\n   * Test for equality\r\n   * @param {olleh.maps.Point} other\r\n   * @returns {Boolean}\r\n   */\r\n  equals: function (other) {\r\n    return this.x === other.x && this.y === other.y;\r\n  },\r\n\r\n  /**\r\n   * point       return . \r\n   * @param {olleh.maps.Point} point\r\n   * @returns {olleh.maps.Point} newly created Point\r\n   */\r\n  //non-destructive, returns a new point\r\n  add: function (point) {\r\n    return this.clone()._add(point);\r\n  },\r\n\r\n  /**\r\n   * arg0 Point   arg0, arg1   x,y  . \r\n   * this   .\r\n   * @param {olleh.maps.Ponint | Number} arg0\r\n   * @param {Number} arg1 (optional)\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  // destructive, used directly for performance in situations where it's safe to modify existing point\r\n  _add: function (arg0, arg1) {\r\n    if(arguments.length === 1) {\r\n      this.x += arg0.x;\r\n      this.y += arg0.y;\r\n    } else {\r\n      this.x += arg0;\r\n      this.y += arg1;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * point     return .\r\n   * @param {olleh.maps.Point} point\r\n   * @returns {olleh.maps.Point} newly created Point\r\n   */\r\n  subtract: function (point) {\r\n    return this.clone()._subtract(point);\r\n  },\r\n\r\n  /**\r\n   * arg0 Point   arg0, arg1   x,y  .\r\n   * this   .\r\n   * @param {olleh.maps.Ponint | Number} arg0\r\n   * @param {Number} arg1 (optional)\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _subtract: function (arg0, arg1) {\r\n    if(arguments.length === 1) {\r\n      this.x -= arg0.x;\r\n      this.y -= arg0.y;\r\n    } else {\r\n      this.x -= arg0;\r\n      this.y -= arg1;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x, y  num    Point  return\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  divideBy: function (num) {\r\n    return this.clone()._divideBy(num);\r\n  },\r\n\r\n  /**\r\n   * this  x, y  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point} this \r\n   */\r\n  _divideBy: function (num) {\r\n    this.x /= num;\r\n    this.y /= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x, y  num    Point  return\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  multiplyBy: function (num) {\r\n    return this.clone()._multiplyBy(num);\r\n  },\r\n\r\n  /**\r\n   * this  x, y  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _multiplyBy: function (num) {\r\n    this.x *= num;\r\n    this.y *= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x,y    Point  \r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  round: function () {\r\n    return this.clone()._round();\r\n  },\r\n\r\n  /**\r\n   * x,y  .\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _round: function () {\r\n    this.x = Math.round(this.x);\r\n    this.y = Math.round(this.y);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * x,y    Point  \r\n   * @returns {olleh.maps.Point}   \r\n   */\r\n  floor: function () {\r\n    return this.clone()._floor();\r\n  },\r\n\r\n  /**\r\n   * x,y  .\r\n   * @returns {olleh.maps.Point} this object\r\n   */\r\n  _floor: function () {\r\n    this.x = Math.floor(this.x);\r\n    this.y = Math.floor(this.y);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Calculates the distance from this Point to the one specified.\r\n   * @param {olleh.maps.Point} point \r\n   * @returns {Number}\r\n   */\r\n  distanceTo: function (point) {\r\n    var x = point.x - this.x,\r\n      y = point.y - this.y;\r\n    return Math.sqrt(x * x + y * y);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  toCSSString: function () {\r\n    return this.x + 'px ' +  this.y + 'px';\r\n  }\r\n\r\n});\r\n/**\r\n *    .\r\n * @group Base\r\n */\r\n$class('olleh.maps.Size').define({\r\n\r\n  $static: {\r\n    zero: function () {\r\n      return olleh.maps.Size._zero || (olleh.maps.Size._zero = new olleh.maps.Size(0, 0));\r\n    },\r\n\r\n    full: function () {\r\n      return olleh.maps.Size._full || (olleh.maps.Size._full = new olleh.maps.Size(100, 100, '%'));\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * ,  width, height    .\r\n   * @param {Number} width  .\r\n   * @param {Number} height  .\r\n   * @param {String} [unit=px]   .\r\n   */\r\n  Size: function (width, height, unit) {\r\n    /**\r\n     *  .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.width = +width;\r\n    \r\n    /**\r\n     *  .\r\n     * @type Number\r\n     * @readonly\r\n     */\r\n    this.height = +height;\r\n\r\n    /**\r\n     *   .\r\n     * @type String\r\n     * @readonly\r\n     */\r\n    this.unit = unit || 'px';\r\n  },\r\n  \r\n  /**\r\n   * clone this object\r\n   * @returns {olleh.maps.Size}\r\n   */\r\n  clone: function () {\r\n    return new olleh.maps.Size(this.width, this.height, this.unit);\r\n  },\r\n  \r\n  /**\r\n   * Test for equality\r\n   * @param {olleh.maps.Size} other\r\n   * @returns {Boolean}\r\n   */\r\n  equals: function (other) {\r\n    return this.width === other.width && this.height === other.height && this.unit === other.unit;\r\n  },\r\n\r\n  /**\r\n   * size  width, height    .\r\n   * @param {olleh.maps.Size} size\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  add: function (size) {\r\n    return this.clone()._add(size);\r\n  },\r\n  \r\n  /**\r\n   * destructive, used directly for performance in situations where it's safe to modify existing Size\r\n   * @param arg0 {Number | olleh.maps.Size} arg0\r\n   * @param arg1 {Number} [arg1]\r\n   * @returns {olleh.maps.Size}\r\n   * @private\r\n   */\r\n  _add: function(arg0, arg1) {\r\n    if (arguments.length === 1) {\r\n      if (this.unit != arg0.unit) {\r\n        throw new TypeError('Unit mismatch: ' + this.unit + ', ' + arg0.unit);\r\n      }\r\n      this.width += arg0.width;\r\n      this.height += arg0.height;\r\n    } else {\r\n      this.width += arg0;\r\n      this.height += arg1;\r\n    }\r\n    return this;\r\n  },\r\n  \r\n\r\n  /**\r\n   * size  width, height    .\r\n   * @param {olleh.maps.Size} size\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  subtract: function (size) {\r\n    return this.clone()._subtract(size);\r\n  },\r\n  \r\n  /**\r\n   * destructive, used directly for performance in situations where it's safe to modify existing Size\r\n   * @param arg0 {Number | olleh.maps.Size} arg0\r\n   * @param arg1 {Number} [arg1]\r\n   * @returns {olleh.maps.Size}\r\n   * @private\r\n   */\r\n  _subtract: function (arg0, arg1) {\r\n    if (arguments.length === 1) {\r\n      if (arg0.unit != this.unit) {\r\n        throw new TypeError(\"unit\");\r\n      }\r\n      this.width -= arg0.width;\r\n      this.height -= arg0.height;\r\n    } else {\r\n      this.width -= arg0;\r\n      this.height -= arg1;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  divideBy: function (num) {\r\n    return this.clone()._divideBy(num);\r\n  },\r\n  \r\n  _divideBy: function (num) {\r\n    this.width /= num;\r\n    this.height /= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  num  .\r\n   * @param {Number} num\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  multiplyBy: function (num) {\r\n    return this.clone()._multiplyBy(num);\r\n  },\r\n  \r\n  _multiplyBy: function (num) {\r\n    this.width *= num;\r\n    this.height *= num;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  .\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  round: function () {\r\n    return this.clone()._round();\r\n  },\r\n  \r\n  _round: function () {\r\n    this.width = Math.round(this.width);\r\n    this.height = Math.round(this.height);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * this  width, height  .\r\n   * @returns {olleh.maps.Size} this object\r\n   */\r\n  floor: function () {\r\n    return this.clone()._floor();\r\n  },\r\n  \r\n  _floor: function () {\r\n    this.width = Math.floor(this.width);\r\n    this.height = Math.floor(this.height);\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  toCSSString: function () {\r\n    return this.width + this.unit + ' ' +  this.height + this.unit;\r\n  },\r\n  \r\n  /**\r\n   * width => point.x, height => point.y\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  asPoint: function() {\r\n    if (this.unit != 'px') {\r\n      throw new TypeError('Unit must be a px: ' + this.unit);\r\n    }\r\n    return new olleh.maps.Point(this.width, this.height);\r\n  }\r\n\r\n});\n/**\r\n * HTML          .\r\n */\r\n$class('olleh.maps.Element').define({\r\n  \r\n  $static: {\r\n    /**\r\n     *     HTML \r\n     *   {@link olleh.maps.Element}   .\r\n     * @param {String} tagName  .\r\n     * @returns {olleh.maps.Element}  {@link olleh.maps.Element} .\r\n     */\r\n    create: function (tagName) {\r\n      if (!tagName) return null;\r\n      var element = new olleh.maps.Element(document.createElement(tagName));\r\n      var browser = olleh.maps.browser;\r\n      if (browser.browserName === browser.BROWSER_NAME.ie) {\r\n        element.elem.setAttribute('unselectable', 'on');\r\n      }\r\n      return element;\r\n    }\r\n    \r\n  },\r\n  \r\n  /**\r\n   * ,  elem    .\r\n   * @param {HTMLElement} elem HTML .\r\n   */\r\n  Element: function (elem) {\r\n    /**\r\n     * HTML .\r\n     * @readonly\r\n     * @type HTMLElement\r\n     */\r\n    this.elem = elem;\r\n  },\r\n  \r\n  /**\r\n   * HTML   .\r\n   * @param {String} name  .\r\n   * @returns {String}  .\r\n   */\r\n  getProperty: function (name) {\r\n    return this.elem[name];\r\n  },\r\n  \r\n  /**\r\n   * HTML   .\r\n   * @param {String} name  .\r\n   * @param {String} value  .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  setProperty: function (name, value) {\r\n    this.elem[name] = value;\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * HTML      .\r\n   * @param {Object} properties key-value    .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  setProperties: function (properties) {\r\n    var k;\r\n    for (k in properties) {\r\n      this.setProperty(k, properties[k]);\r\n    }\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * HTML  CSS  .\r\n   * @param {String} style  .\r\n   * @returns {String}  .\r\n   */\r\n  getStyle: function (style) {\r\n    return olleh.maps.util.dom.getStyle(this.elem, style);\r\n  },\r\n  \r\n  /**\r\n   * HTML  CSS  .\r\n   * @param {String} name  .\r\n   * @param {String} value  .\r\n   */\r\n  setStyle: function (name, value) {\r\n    olleh.maps.util.dom.setStyle(this.elem, name, value);\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * HTML   CSS    .\r\n   * @param {Object} styles key-value    .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  setStyles: function (styles) {\r\n    var k;\r\n    for (k in styles) {\r\n      this.setStyle(k, styles[k]);\r\n    }\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   * CSS className .\r\n   * @param {String} className CSS  \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  addClass: function (className) {\r\n    olleh.maps.util.dom.addClass(this.elem, className);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * CSS className     .\r\n   * @param {String} className CSS \r\n   * @returns {Boolean}  className  \r\n   * true .\r\n   */\r\n  hasClass: function (className) {\r\n    return olleh.maps.util.dom.hasClass(this.elem, className);\r\n  },\r\n\r\n  /**\r\n   * CSS className .\r\n   * @param {String} className css  \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  removeClass: function (className) {\r\n    olleh.maps.util.dom.removeClass(this.elem, className);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * oldClassName   newClassName   .<p/>\r\n   *  oldClassName    newClassName  .\r\n   * @param {String} oldClassName    \r\n   * @param {String} newClassName    \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  replaceClass: function (oldClassName, newClassName) {\r\n    olleh.maps.util.dom.replaceClass(this.elem, oldClassName, newClassName);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * @param {String} name    \r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  toggleClass: function (name) {\r\n    olleh.maps.util.dom.toggleClass(this.elem, name);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Element|HTMLElement} elem   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  appendChild: function (elem) {\r\n    this.elem.appendChild(elem.elem || elem);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Element|HTMLElement} elem   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  removeChild: function (elem) {\r\n    this.elem.removeChild(elem.elem || elem);\r\n    return this;\r\n  },\r\n  \r\n  /**\r\n   *  HTML   child .\r\n   * @param {olleh.maps.Element|HTMLElement} elem  HTML  \r\n   * @returns {Boolean}  (elm)  \r\n   * true .\r\n   */\r\n  pushElement: function (elem) {\r\n    return olleh.maps.util.dom.pushElement(this.elem, elem.elem || elem);\r\n  },\r\n\r\n  /**\r\n   * Child   child    .\r\n   * @param {olleh.maps.Element|HTMLElement} elem  DOM \r\n   * @returns {HTMLElement}\r\n   */\r\n  popElement: function (elem) {\r\n    return olleh.maps.util.dom.popElement(this.elem, elem.elem || elem);\r\n  },\r\n\r\n  /**\r\n   * HTML   CSS  .     .\r\n   * @param {String} name  .\r\n   * @returns {String}   .\r\n   */\r\n  getComputedStyle: function (name) {\r\n    return olleh.maps.util.dom.getComputedStyle(this.elem, name);\r\n  },\r\n\r\n  /**\r\n   *   .   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  forceReflow: function () {\r\n    var _ = this.elem.clientWidth;\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * HTML    .\r\n   * @param {String} type  .\r\n   * @param {Function} fn   .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  addEventListener: function (type, fn) {\r\n    var elem = this.elem;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(type, fn, false);\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + type, fn);\r\n    } else {\r\n      elem['on' + type] = fn;\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * HTML    .\r\n   * @param {String} type  .\r\n   * @param {Function} fn    .\r\n   * @returns {olleh.maps.Element}  .\r\n   */\r\n  removeEventListener: function (type, fn) {\r\n    var elem = this.elem;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(type, fn, false);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + type, fn);\r\n    } else {\r\n      elem['on' + type] = null;\r\n    }\r\n    return this;\r\n  }\r\n});\r\n/**\r\n * <code>backgroundSize</code> CSS    (IE 8 )\r\n *            .<br/>\r\n * \r\n *   <code>backgroundImage</code>, <code>backgroundPosition</code>,\r\n * <code>backgroundSize</code>         .\r\n *  <code>backgroundSize</code>  \r\n *   <code>overflow:hidden</code>  <code>div</code> \r\n *   <code>img</code>     <code>src</code> \r\n * <code>backgroundImage</code>, (<code>left</code>/<code>top</code>)\r\n * <code>backgroundPosition</code>, (<code>width</code>/<code>height</code>)\r\n * <code>backgroundSize</code>    .<br/>\r\n * \r\n *        ,\r\n *           .\r\n */\r\n$class('olleh.maps.SpritedImage').extend(olleh.maps.Element).define({\r\n  \r\n  /**\r\n   * .   <code>div</code>  .  \r\n   * <code>backgroundSize</code>   <code>div</code> \r\n   * <code>img</code>   .  \r\n   */\r\n  SpritedImage: function () {\r\n    this.elem = document.createElement('div');\r\n    this.setStyles({\r\n      position: 'absolute',\r\n      backgroundColor: 'transparent',\r\n      backgroundRepeat: 'no-repeat'\r\n    });\r\n    if (!olleh.maps.browser.style.backgroundSize) {\r\n      this.setStyle('overflow', 'hidden');\r\n      this._img = olleh.maps.Element.create('img').setStyle('position', 'absolute');\r\n      this.appendChild(this._img);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  .    <code>div</code>    .\r\n   * @param {String} url  URL.\r\n   * @param {olleh.maps.Point} [origin]     . \r\n   * @param {olleh.maps.Size} [scaledSize]      .\r\n   * @returns {olleh.maps.SpritedImage}  .\r\n   */\r\n  setImage: function (url, origin, scaledSize) {\r\n    if (this._img) {\r\n      this._img.setStyles({\r\n        left: origin ? -origin.x + 'px' : '0',\r\n        top: origin ? -origin.y + 'px' : '0',\r\n        width: scaledSize ? scaledSize.width + scaledSize.unit : origin ? '' : '100%',\r\n        height: scaledSize ? scaledSize.height + scaledSize.unit : origin ? '' : '100%'\r\n      }).setProperty('src', url);\r\n    } else {\r\n      this.setStyles({\r\n        backgroundImage: 'url(' + url + ')',\r\n        backgroundPosition: origin ? -origin.x + 'px ' + -origin.y + 'px' : '',\r\n        backgroundSize: scaledSize ? scaledSize.toCSSString() : origin ? 'auto' : '100% 100%'\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n  \r\n});/**\r\n *    .\r\n *     t  x   .\r\n * t x  0~1   . \r\n */\r\n$class('olleh.maps.fx.timing.Timing').define({\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  Timing: function () {\r\n    if (this.$classname === 'olleh.maps.fx.timing.Timing') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.fx.timing.Timing directly.');\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * CSS3 transition     .\r\n   * null   CSS3 transition      .\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   * CSS3 transition        .\r\n   *  y=x    . \r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return null;\r\n  },\r\n\r\n  /**\r\n   *  t  x    .  \r\n   * @returns {Function}  .\r\n   */\r\n  getFn: function () {\r\n    if (!this._fn) {\r\n      this._fn = this.genFn();\r\n    }\r\n    return this._fn;\r\n  },\r\n\r\n  /**\r\n   *  t  x    .      .\r\n   * @private  \r\n   * @returns {Function}  .\r\n   */\r\n  genFn: function () {\r\n    return null;\r\n  }\r\n  \r\n});\r\n/**\r\n * y=x     .\r\n */\r\n$class('olleh.maps.fx.timing.Linear').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'linear';\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return this.getCSSName();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function(t) {\r\n      return t;\r\n    };\r\n  }\r\n  \r\n});\r\n/**\r\n * 3      .\r\n */\r\n$class('olleh.maps.fx.timing.CubicBezier').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   *   .\r\n   * @param {Number} x1 p1 x.\r\n   * @param {Number} y1 p1 y.\r\n   * @param {Number} x2 p2 x.\r\n   * @param {Number} y2 p2 y.\r\n   */\r\n  CubicBezier: function (x1, y1, x2, y2) {\r\n    this.x1 = x1;\r\n    this.y1 = y1;\r\n    this.x2 = x2;\r\n    this.y2 = y2;\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'cubic-bezier(' + this.x1 + ',' + this.y1 + ',' + this.x2 + ',' + this.y2 + ')';\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return 'cubic-bezier(' + (1 - this.x2) + ',' + (1 - this.y2) + ',' + (1 - this.x1) + ',' + (1 - this.y1) + ')';\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   * @see http://blogs.msdn.com/b/eternalcoding/archive/2011/12/06/css3-transitions.aspx \r\n   */\r\n  genFn: function () {\r\n    var x1 = this.x1, y1 = this.y1, x2 = this.x2, y2 = this.y2;\r\n    return function (t) {\r\n      var i, f0, f1, f2, refinedT, refinedT2, refinedT3, x, slope;\r\n      if (t == 0)\r\n        return 0;\r\n      f0 = 1 - 3 * x2 + 3 * x1;\r\n      f1 = 3 * x2 - 6 * x1;\r\n      f2 = 3 * x1;\r\n      refinedT = t;\r\n      for (i = 0; i < 5; i++) {\r\n        refinedT2 = refinedT * refinedT;\r\n        refinedT3 = refinedT2 * refinedT;\r\n        x = f0 * refinedT3 + f1 * refinedT2 + f2 * refinedT;\r\n        slope = 1.0 / (3.0 * f0 * refinedT2 + 2.0 * f1 * refinedT + f2);\r\n        refinedT -= (x - t) * slope;\r\n        refinedT = Math.min(1, Math.max(0, refinedT));\r\n      }\r\n      return 3 * Math.pow(1 - refinedT, 2) * refinedT * y1 + 3\r\n          * (1 - refinedT) * Math.pow(refinedT, 2) * y2\r\n          + Math.pow(refinedT, 3);\r\n    };\r\n  }\r\n  \r\n});\r\n/**\r\n * 3      .  CSS3 transition  .\r\n */\r\n$class('olleh.maps.fx.timing.CubicBezierBasedTiming').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  CubicBezierBasedTiming: function () {\r\n    if (this.$classname === 'olleh.maps.fx.timing.CubicBezierBasedTiming') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.fx.timing.CubicBezierBasedTiming directly.');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getBackwardCSSName: function () {\r\n    return this._curve.getBackwardCSSName();\r\n  },\r\n\r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getFn: function () {\r\n    return this._curve.getFn();\r\n  }\r\n  \r\n});\r\n/**\r\n * Ease    .\r\n */\r\n$class('olleh.maps.fx.timing.Ease').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  Ease: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0.25, 0.1, 0.25, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease';\r\n  }\r\n  \r\n});\r\n/**\r\n * Ease-in    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseIn').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  EaseIn: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0.42, 0, 1, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease-in';\r\n  }\r\n  \r\n});\r\n\r\n/**\r\n * Ease-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseOut').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  EaseOut: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0, 0, 0.58, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease-out';\r\n  }\r\n  \r\n});\r\n/**\r\n * Ease-in-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseInOut').extend(olleh.maps.fx.timing.CubicBezierBasedTiming).define({\r\n  \r\n  /**\r\n   *   .\r\n   */\r\n  EaseInOut: function() {\r\n    this._curve = new olleh.maps.fx.timing.CubicBezier(0.42, 0, 0.58, 1);\r\n  },\r\n  \r\n  /**\r\n   * @returns {String}\r\n   */\r\n  getCSSName: function () {\r\n    return 'ease-in-out';\r\n  }\r\n  \r\n});\r\n/**\r\n *       .\r\n */\r\nolleh.maps.namespace('olleh.maps.fx.timing', {\r\n  /**\r\n   * @type {olleh.maps.fx.timing.Linear}\r\n   */\r\n  linear: new olleh.maps.fx.timing.Linear(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.Ease}\r\n   */\r\n  ease: new olleh.maps.fx.timing.Ease(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.EaseIn}\r\n   */\r\n  easeIn: new olleh.maps.fx.timing.EaseIn(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.EaseOut}\r\n   */\r\n  easeOut: new olleh.maps.fx.timing.EaseOut(),\r\n  /**\r\n   * @type {olleh.maps.fx.timing.EaseInOut}\r\n   */\r\n  easeInOut: new olleh.maps.fx.timing.EaseInOut()\r\n});\r\n///////////////////////////\r\n//  Animation    //\r\n///////////////////////////\r\n/**\r\n * {@link olleh.maps.fx.Animation} \r\n * @typedef olleh.maps.fx.AnimationOptions \r\n * @property {Object} [from]    . Key-value .\r\n *                 .\r\n * @property {Object} to  . Key-value .\r\n * @property {Number} [duration={@link olleh.maps.fx.Animation#DEFAULT_DURATION}]  .   .\r\n * @property {olleh.maps.fx.timing.Timing} [timing={@link olleh.maps.fx.Animation#DEFAULT_TIMING}]  .\r\n * @property {Number} [repeat=1]   .\r\n *         <code>1</code>, {@link olleh.maps.fx.Animation#REPEAT_FOREVER}   .\r\n * @property {Boolean} [comeback=false]       .\r\n *        <code>true</code>  <code>duration/2</code>   \r\n *              .\r\n * @property {Function} [callback]  .      .\r\n *            <code>true</code>, {@link olleh.maps.fx.Animator#stop()}\r\n *           <code>false</code>  .\r\n * @property {Object} [ctx]   .     <code>HTMLElement</code>  .\r\n * @property {olleh.maps.fx.Pulse|olleh.maps.fx.PulseAnimator|boolean} [pulse]   .\r\n *        {@link olleh.maps.fx.Pulse}    ,\r\n *        {@link olleh.maps.fx.PulseAnimator}      ,\r\n *        <code>true</code>      .\r\n *        <code>null</code>  <code>false</code>     CSS   \r\n *        CSS        .\r\n */\r\n\r\n/**\r\n *   \r\n */\r\n$class('olleh.maps.fx.Animation').define({\r\n  \r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type Number\r\n     */\r\n    DEFAULT_DURATION: .3,\r\n    \r\n    /**\r\n     * @constant\r\n     * @type olleh.maps.fx.timing.Timing\r\n     */\r\n    DEFAULT_TIMING: olleh.maps.fx.timing.ease,\r\n    \r\n    /**\r\n     * @constant\r\n     * @type Number\r\n     */\r\n    REPEAT_FOREVER: -1\r\n  },\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.fx.AnimationOptions} opts .\r\n   */\r\n  Animation: function (opts) {\r\n    this.from = {};\r\n    this.to = {};\r\n    this.duration = olleh.maps.fx.Animation.DEFAULT_DURATION;\r\n    this.timing = olleh.maps.fx.Animation.DEFAULT_TIMING;\r\n    this.repeat = 1;\r\n    this.comeback = false;\r\n    this.callback = null;\r\n    this.ctx = null;\r\n    this.pulse = null;\r\n    olleh.maps.mixin(this, opts, true, ['from', 'to', 'duration', 'timing', 'repeat', 'comeback', 'callback', 'ctx', 'pulse']);\r\n  },\r\n  \r\n  /**\r\n   *      Animator .\r\n   *  ,       Animator  .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  newAnimator: function (elem, opts) {\r\n    var Animator;\r\n    \r\n    opts = olleh.maps.mixin({\r\n      duration: this.duration,\r\n      timing: this.timing,\r\n      repeat: this.repeat,\r\n      comeback: this.comeback,\r\n      callback: this.callback,\r\n      ctx: this.ctx,\r\n      pulse: this.pulse\r\n    }, opts, true);\r\n    \r\n    opts.from = olleh.maps.mixin(olleh.maps.util.clone(this.from), opts.from || {}, 'remix');\r\n    opts.to = olleh.maps.mixin(olleh.maps.util.clone(this.to), opts.to || {}, 'remix');\r\n\r\n    if (opts.duration == 0) {\r\n      Animator = olleh.maps.fx.NoAnimationAnimator;\r\n    } else if (!opts.pulse && olleh.maps.browser.style.transition && opts.timing.getCSSName()) {\r\n      Animator = olleh.maps.fx.CSSAnimator;\r\n    } else {\r\n      Animator = olleh.maps.fx.PulseAnimator;\r\n    }\r\n    \r\n    return new Animator(elem, opts);\r\n  },\r\n  \r\n  /**\r\n   * {@link olleh.maps.fx.Animation#newAnimator()} \r\n   *    {@link olleh.maps.fx.Animator#start}  .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  animate: function (elem, opts) {\r\n    var a = this.newAnimator(elem, opts);\r\n    a.start();\r\n    return a;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.fx.Animation#newAnimator()} \r\n   *    {@link olleh.maps.fx.Animator#startSync}  .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  animateSync: function (elem, opts) {\r\n    var a = this.newAnimator(elem, opts);\r\n    a.startSync();\r\n    return a;\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   * @param {HTMLElement} elem   .\r\n   * @param {olleh.maps.fx.AnimationOptions} [opts] .      .  duration .\r\n   * @returns {olleh.maps.fx.Animator}\r\n   */\r\n  applyImmediately: function (elem, opts) {\r\n    opts || (opts = {});\r\n    opts.duration = 0;\r\n    return this.animate(elem, opts);\r\n  }\r\n  \r\n});\r\n/**\r\n * {@link olleh.maps.fx.PulseAnimator}        . \r\n *       \r\n *  {@link olleh.maps.fx.Animator}      , \r\n * CSS3 transition           .\r\n */\r\n$class('olleh.maps.fx.Pulse').define({\r\n  \r\n  /**\r\n   *   .\r\n   * @param {Number} period  ,  .\r\n   */\r\n  Pulse: function (period) {\r\n    /**\r\n     *  ,  .\r\n     * @readonly\r\n     * @type Number\r\n     */\r\n    this.period = period;\r\n    \r\n    this._jobs = [];\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.fx.PulseAnimator} fn\r\n   */\r\n  add: function (fn, initTime) {\r\n    this._jobs.push(fn);\r\n    if (this._jobs.length == 1) {\r\n      this.start(initTime);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.fx.PulseAnimator} fn\r\n   */\r\n  remove: function (fn) {\r\n    olleh.maps.util.removeFromArray(this._jobs, fn);\r\n    if (this._jobs.length == 0) {\r\n      this.stop();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {Boolean}   <code>true</code>,    <code>false</code>.\r\n   */\r\n  isPlaying: function () {\r\n    return !!this._af;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   */\r\n  start: function (initTime) {\r\n    if (!this._af) {\r\n      this.startTime = olleh.maps.fx.now();\r\n      if (initTime) {\r\n        this.startTime -= initTime * 1000;\r\n      }\r\n      this._af = olleh.maps.util.deferAF(this._step, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   */\r\n  stop: function () {\r\n    if (this._af) {\r\n      window.cancelAnimationFrame(this._af);\r\n      this._af = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {Number} time\r\n   */\r\n  _step: function (time) {\r\n    var i, playTime;\r\n\r\n    if (this._jobs.length == 0) {\r\n      this.stop();\r\n      return;\r\n    }\r\n\r\n    this._af = olleh.maps.util.deferAF(this._step, this);\r\n    \r\n    // See #2718\r\n    if (!olleh.maps.fx.useAFTime) {\r\n      time = olleh.maps.fx.now();\r\n    }\r\n\r\n    playTime = (time - this.startTime) / 1000;\r\n    \r\n    //    \r\n    if (playTime >= this.period) {\r\n      playTime = this.period;\r\n      this.startTime = time;\r\n    }\r\n\r\n    for (i = this._jobs.length - 1; i >= 0; i--) {\r\n      this._jobs[i](playTime);\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *    <code>setTimeout</code>         .\r\n *         .\r\n */\r\n$class('olleh.maps.fx.AnimatorBuffer').define({\r\n\r\n  /**\r\n   *   .\r\n   * @private\r\n   */\r\n  AnimatorBuffer: function () {\r\n    this._animators = [];\r\n    this._timer = null;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   *  <code>setTimeout</code>  {@link olleh.maps.fx.AnimatorBuffer#flush} .\r\n   * @param {olleh.maps.fx.Animator} animator\r\n   */\r\n  add: function (animator) {\r\n    this._animators.push(animator);\r\n    if (!this._timer) {\r\n      this._timer = olleh.maps.util.defer(this.flush, this);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *      {@link olleh.maps.fx.Animator#startSync} .\r\n   */\r\n  flush: function () {\r\n    var i, l;\r\n    for (i = 0, l = this._animators.length; i < l; i++) {\r\n      this._animators[i].startSync();\r\n    }\r\n    this._animators = [];\r\n    if (this._timer) {\r\n      window.clearTimeout(this._timer);\r\n      this._timer = null;\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *  .  HTML      .\r\n * {@link olleh.maps.fx.Animation}   ,     .\r\n */\r\n$class('olleh.maps.fx.Animator').define({\r\n\r\n  /**\r\n   * .     .\r\n   * @private\r\n   * @param {olleh.maps.Element|HTMLElement} elem   HTML .\r\n   * @param {olleh.maps.fx.AnimationOptions} opts  .\r\n   */\r\n  Animator: function (elem, opts) {\r\n    /**\r\n     *   HTML .\r\n     * @readonly\r\n     * @type olleh.maps.Element\r\n     */\r\n    this.element = elem instanceof olleh.maps.Element ? elem : new olleh.maps.Element(elem);\r\n\r\n    olleh.maps.mixin(this, opts || {}, true, ['from', 'to', 'duration', 'timing', 'repeat', 'comeback', 'callback', 'ctx', 'pulse']);\r\n\r\n    /**\r\n     *  . <code>ready</code>, <code>started</code>, <code>paused</code>, <code>finished</code>    .\r\n     * @readonly\r\n     * @type String\r\n     */\r\n    this.status = 'ready';\r\n  },\r\n\r\n  /**\r\n   *  .     \r\n   *     .\r\n   *  duration    \r\n   *    (t=1)   .\r\n   */\r\n  start: function () {\r\n    if (this.status !== 'ready') {\r\n      return;\r\n    }\r\n    if (this.duration == 0) {\r\n      this.startSync();\r\n    } else {\r\n      olleh.maps.fx.animatorBuffer.add(this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.fx.Animator#start}    .\r\n   *       .\r\n   */\r\n  startSync: function () {\r\n    var k;\r\n\r\n    if (this.status !== 'ready') {\r\n      return;\r\n    }\r\n    \r\n    if (this.comeback) {\r\n      for (k in this.to) {\r\n        if (this.to[k] == undefined || !this.to.hasOwnProperty(k)) {\r\n          continue;\r\n        }\r\n        if (!this.from[k]) {\r\n          this.from[k] = this.element.getComputedStyle(k);\r\n          olleh.maps.log.info('Initial style \"' + k + '\" is not defined; can cause performance issue', this);\r\n        }\r\n      }\r\n    }\r\n    \r\n    this.status = 'started';\r\n    this.doInit();\r\n    this.doCycle();\r\n  },\r\n\r\n  /**\r\n   *  .   \r\n   *    (t=1)   .\r\n   */\r\n  stop: function () {\r\n    if (this.status === 'finished') {\r\n      return;\r\n    }\r\n    \r\n    if (this.status === 'ready') {\r\n      this.element.setStyles(this.to);\r\n    } else {\r\n      this.doStop();\r\n      this.doClean();\r\n    }\r\n    \r\n    this.status = 'finished';\r\n    \r\n    if (this.callback) {\r\n      this.callback.call(this.ctx || this.element.elem, false);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   */\r\n  stopRepeat: function () {\r\n    if (this.status === 'finished') {\r\n      return;\r\n    }\r\n    this.repeat = false;\r\n  },\r\n\r\n  /**\r\n   *   .      .\r\n   * @returns {Object}    key-value   .\r\n   */\r\n  pause: function () {\r\n    if (this.status !== 'started') {\r\n      return;\r\n    }\r\n    this.status = 'paused';\r\n    return this.doPause();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  resume: function () {\r\n    if (this.status !== 'paused') {\r\n      return;\r\n    }\r\n    this.status = 'started';\r\n    this.doResume();\r\n  },\r\n  \r\n  /**\r\n   *        .\r\n   *   .\r\n   */\r\n  cancel: function () {\r\n    if (this.status === 'ready') {\r\n      this.status = 'finished';\r\n      return;\r\n    }\r\n    if (this.status === 'finished') {\r\n      return;\r\n    }\r\n    this.status = 'finished';\r\n    this.doCancel();\r\n    this.doClean();\r\n    //   \r\n  },\r\n\r\n  /**\r\n   *     .      .\r\n   *   .\r\n   * @returns {Object}    key-value   .\r\n   */\r\n  abort: function () {\r\n    if (this.status !== 'finished') {\r\n      this.status = 'finished';\r\n    }\r\n    return this.doPause();\r\n  },\r\n  \r\n  /**\r\n   *    . abort()    .\r\n   *           .   .\r\n   *            .\r\n   * @returns {Object}    key-value   .\r\n   */\r\n  ignore: function () {\r\n    if (this.status !== 'finished') {\r\n      this.status = 'finished';\r\n    }\r\n    return this.doIgnore();\r\n  },\r\n  \r\n  /**\r\n   * @returns {Boolean}    .\r\n   */\r\n  finishCycle: function () {\r\n    if (this.repeat === -1 && this.duration > 0) {\r\n      this.doCycle();\r\n    } else if (this.repeat > 1) {\r\n      this.repeat--;\r\n      this.doCycle();\r\n    } else {\r\n      this.doClean();\r\n      this.status = 'finished';\r\n    }\r\n    \r\n    if (this.callback) {\r\n      this.callback.call(this.ctx || this.element.elem, true);\r\n    }\r\n  }\r\n\r\n});\r\n/**\r\n *        {@link olleh.maps.fx.Animator} .\r\n *     . \r\n */\r\n$class('olleh.maps.fx.NoAnimationAnimator').extend(olleh.maps.fx.Animator).define({\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doInit: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCycle: function () {\r\n    if (!this.comeback) {\r\n      this.element.setStyles(this.to);\r\n    }\r\n    this.finishCycle();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doClean: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doPause: function () {\r\n    return this.to;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doResume: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCancel: function () {\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doIgnore: function () {\r\n    return this.to;\r\n  }\r\n  \r\n});\r\n/**\n * CSS3 transition    {@link olleh.maps.fx.Animator} .\n *     .\n */\n$class('olleh.maps.fx.CSSAnimator').extend(olleh.maps.fx.Animator).define({\n\n  /**\n   * .     .\n   * @private\n   * @param {HTMLElement} elem   HTML .\n   * @param {olleh.maps.fx.AnimationOptions} opts  .\n   */\n  CSSAnimator: function (elem, opts) {\n    var browser = olleh.maps.browser;\n\n    this._styleName = browser.style.transition;\n    this._eventType = browser.event.transitionend;\n    this._bound_onTransitionend = this._onTransitionend.bind(this);\n    this._isForward = true;\n  },\n\n  /**\n   * @private\n   */\n  doInit: function () {\n  },\n\n  /**\n   * @private\n   */\n  doClean: function () {\n    if (this._listening) {\n      this.element.setStyle(this._styleName, '');\n      this.element.removeEventListener(this._eventType, this._bound_onTransitionend);\n      this._listening = false;\n    }\n    this._clearEventFallback();\n  },\n\n  /**\n   * @private\n   */\n  doCycle: function () {\n    //     .\n    //  CSS        t = 0 .\n    //   t = 0.7      \n    // 0.3  t = 0.7 -> 1   \n    // CSS   0.3  t = 0 -> 1  .\n    this._startTimestamp = +Date.now();\n    this._playedTimestamp = 0;\n    this._receivedEvent = 0;\n\n    this._startTransition(this.comeback ? this.duration / 2 : this.duration);\n  },\n\n  /**\n   * @private\n   */\n  doStop: function () {\n    var k;\n    if (this.comeback && this._isForward) {\n      for (k in this.to) {\n        this.element.setStyle(k, this.from[k]);\n      }\n    }\n  },\n\n  /**\n   * @private\n   * @returns {Object}\n   */\n  doPause: function () {\n    var k, styles;\n    \n    if (!this._pausedStyles) {\n      olleh.maps.log.info('CSS animator paused; can cause performance issue', this);\n      \n      styles = {};\n      for (k in this.to) {\n        styles[k] = this.element.getComputedStyle(k);\n        this.element.setStyle(k, styles[k]);\n      }\n      \n      this.doClean();\n      this._playedTimestamp += +Date.now() - this._startTimestamp;\n      this._pausedStyles = styles;\n    }\n    \n    this._clearEventFallback();\n    \n    return this._pausedStyles;\n  },\n\n  /**\n   * @private\n   */\n  doResume: function () {\n    this._pausedStyles = null;\n    this._startTimestamp = +Date.now();\n    this._startTransition(((this.comeback ? this.duration / 2 : this.duration) - this._playedTimestamp / 1000));\n  },\n\n  /**\n   * @private\n   */\n  doCancel: function () {\n    var k;\n    for (k in this.to) {\n      this.element.setStyle(k, this.from[k]);\n    }\n  },\n\n  /**\n   * @private\n   * @returns {Object}\n   */\n  doIgnore: function () {\n    if (this._listening) {\n      this.element.removeEventListener(this._eventType, this._bound_onTransitionend);\n      this._listening = false;\n    }\n    this._clearEventFallback();\n    return this[this._isForward ? 'to' : 'from'];\n  },\n\n  /**\n   * @private\n   * @param {Number} duration\n   */\n  _startTransition: function (duration) {\n    var k, a = [];\n    var styles = this[this._isForward ? 'to' : 'from'];\n    var timing = this._isForward ? this.timing.getCSSName() : this.timing.getBackwardCSSName();\n    var camelCaseToHyphen = olleh.maps.util.dom.camelCaseToHyphen;\n    var browserStyle = olleh.maps.browser.style;\n    \n    //    \n    //   transitionend       \n    this._styleCount = 0;\n    \n    for (k in this.to) {\n      if (styles[k] != this.element.getStyle(k)) {\n        a.push(camelCaseToHyphen(browserStyle[k] ? browserStyle[k] : k) + ' ' + duration + 's ' + timing);\n        this._styleCount++;\n      }\n    }\n    \n    if (this._styleCount > 0) {\n      this.element.addEventListener(this._eventType, this._bound_onTransitionend);\n      this.element.setStyle(this._styleName, a.join(','));\n      this.element.setStyles(styles);\n      this._listening = true;\n    }\n    \n    //         \n    //     ,   transitionend \n    //   _finish()  . _styleCount  \n    //   _finish()  .   \n    // duration + 0.1   _finish()  .\n    this._eventFallback = olleh.maps.util.delay(this._finish, duration * 1000 + 100, this);\n  },\n\n  /**\n   * @private\n   * @param {Event} event\n   */\n  _onTransitionend: function (event) {\n    if (event.target == this.element.elem) {\n      event.stopPropagation();\n      this._receivedEvent++;\n      if (this._receivedEvent == this._styleCount) {\n        this._finish();\n      }\n    }\n  },\n\n  /**\n   * @private\n   */\n  _clearEventFallback: function () {\n    if (this._eventFallback) {\n      window.clearTimeout(this._eventFallback);\n      this._eventFallback = null;\n    }\n  },\n  \n  /**\n   * @private\n   */\n  _finish: function () {\n    this._clearEventFallback();\n    if (this.comeback && this._isForward) {\n      this._isForward = false;\n      this.doCycle();\n    } else {\n      this._isForward = true;\n      this.finishCycle();\n    }\n  }\n\n});\n/**\r\n * {@link olleh.maps.fx.Pulse}    {@link olleh.maps.fx.Animator} .\r\n *     .\r\n */\r\n$class('olleh.maps.fx.PulseAnimator').extend(olleh.maps.fx.Animator).define({\r\n\r\n  /**\r\n   * .     .\r\n   * @private\r\n   * @param {HTMLElement} elem   HTML .\r\n   * @param {olleh.maps.fx.AnimationOptions} opts  .\r\n   */\r\n  PulseAnimator: function (elem, opts) {\r\n    var fn = this.timing.getFn(), pulse = this.pulse;\r\n    \r\n    if (this.comeback) {\r\n      this._fn = function (t) {\r\n        return fn((t > .5 ? 1 - t : t) * 2);\r\n      };\r\n    } else {\r\n      this._fn = fn;\r\n    }\r\n    \r\n    if (pulse && pulse.getPulse) {\r\n      this._pulse = pulse.getPulse();\r\n    } else if (pulse && pulse.add) {\r\n      this._pulse = pulse;\r\n    } else {\r\n      this._pulse = new olleh.maps.fx.Pulse(this.duration);\r\n    }\r\n    \r\n    this._lastStyle = this.from;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.fx.Pulse} pulse\r\n   */\r\n  setPulse: function (pulse) {\r\n    if (this._attached) {\r\n      this._pulse.remove(this);\r\n      pulse.add(this);\r\n    }\r\n    this._pulse = pulse;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.fx.Pulse}\r\n   */\r\n  getPulse: function () {\r\n    return this._pulse;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doInit: function() {\r\n    var k, from, to;\r\n    var parseStyleValue = olleh.maps.util.dom.parseStyleValue;\r\n\r\n    this._bound_step = this.step.bind(this);\r\n    this._from = {};\r\n    this._to = {};\r\n    \r\n    for (k in this.to) {\r\n      if (this.to[k] == undefined || !this.to.hasOwnProperty(k)) {\r\n        continue;\r\n      }\r\n      \r\n      if (this.from[k]) {\r\n        from = parseStyleValue(this.from[k]);\r\n      } else {\r\n        olleh.maps.log.info('Initial style \"' + k + '\" is not defined; can cause performance issue', this);\r\n        from = parseStyleValue(this.element.getComputedStyle(k));\r\n      }\r\n      \r\n      to = parseStyleValue(this.to[k]);\r\n      \r\n      this._from[k] = from;\r\n      this._to[k] = to;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  doClean: function () {\r\n    this._detachPulse();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCycle: function () {\r\n    this._attachPulse();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doStop: function () {\r\n    this._applyStyle(1);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doPause: function () {\r\n    this._detachPulse();\r\n    return this._lastStyle;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doResume: function () {\r\n    this._attachPulse();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  doCancel: function () {\r\n    var k;\r\n    for (k in this.to) {\r\n      this.element.setStyle(k, this.from[k]);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  doIgnore: function () {\r\n    this._detachPulse();\r\n    return this._lastStyle;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _attachPulse: function () {\r\n    if (!this._attached) {\r\n      if (this.duration > this._pulse.period) {\r\n        throw new RangeError('Animator duration must be greater than period: ' + this.duration + ', ' + this._pulse.period);\r\n      }\r\n      this._pulse.add(this._bound_step, this._lastTime);\r\n      this._attached = true;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _detachPulse: function () {\r\n    if (this._attached) {\r\n      this._pulse.remove(this._bound_step);\r\n      this._attached = false;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Number} t\r\n   */\r\n  _applyStyle: function (t) {\r\n    var k, i, j, l, ll, result, params, from, to, fromOpt, toOpt, fromParam, toParam, value, percent = this._fn(t);\r\n    var parsedStyleToString = olleh.maps.util.dom.parsedStyleToString;\r\n\r\n    this._lastStyle = {};\r\n    \r\n    for (k in this._to) {\r\n      result = [];\r\n      from = this._from[k];\r\n      to = this._to[k];\r\n      \r\n      for (i = 0, l = to.length; i < l; i++) {\r\n        fromOpt = from[i];\r\n        toOpt = to[i];\r\n        \r\n        if (toOpt.name) {\r\n          params = [];\r\n          \r\n          for (j = 0, ll = toOpt.params.length; j < ll; j++) {\r\n            fromParam = fromOpt && fromOpt.name ? fromOpt.params[j].value : 0;\r\n            toParam = toOpt.params[j];\r\n            value = fromParam + (toParam.value - fromParam) * percent;\r\n            params.push({\r\n              unit: toParam.unit,\r\n              value: toParam.unit === 'px' ? Math.ceil(value) : value\r\n            });\r\n          }\r\n\r\n          result.push({\r\n            name: toOpt.name,\r\n            params: params\r\n          });\r\n        } else {\r\n          value = fromOpt.value + (toOpt.value - fromOpt.value) * percent;\r\n          result.push({\r\n            unit: toOpt.unit,\r\n            value: toOpt.unit === 'px' ? Math.ceil(value) : value\r\n          });\r\n        }\r\n      }\r\n      \r\n      this._lastStyle[k] = parsedStyleToString(result);\r\n      this.element.setStyle(k, this._lastStyle[k]);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {Number} playTime\r\n   * @returns {Boolean}\r\n   */\r\n  step: function (playTime) {\r\n    if (!this._attached) {\r\n      return;\r\n    }\r\n    \r\n    this._applyStyle(playTime / this.duration);\r\n    \r\n    this._lastTime = playTime;\r\n\r\n    if (playTime == this._pulse.period) {\r\n      this.finishCycle();\r\n    }\r\n  }\r\n  \r\n});\r\n/**\r\n *      <code>requestAnimationFrame</code>        .\r\n *          .\r\n */\r\n$class('olleh.maps.fx.AnimationFrameQueue').define({\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  AnimationFrameQueue: function () {\r\n    this._jobs = [];\r\n    this._enabled = false;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @returns {Boolean}    <code>true</code>,    <code>false</code>.\r\n   */\r\n  isEnabled: function () {\r\n    return this._enabled;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   *      <code>requestAnimationFrame</code>     .\r\n   *       {@link olleh.maps.fx.AnimationFrameQueue#flush} .\r\n   * @param {Boolean} enabled <code>true</code>   ,    .\r\n   */\r\n  setEnabled: function (enabled) {\r\n    if (enabled) {\r\n      this.start();\r\n    } else {\r\n      this.flush();\r\n    }\r\n    this._enabled = enabled;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   */\r\n  flush: function () {\r\n    var job, jobs = this._jobs;\r\n    this.stop();\r\n    while (jobs.length) {\r\n      job = jobs.shift();\r\n      job.fn.apply(job.ctx);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   */\r\n  clear: function () {\r\n    this.stop();\r\n    this._jobs.length = 0;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @param {Function} fn   .\r\n   * @param {Object} ctx    .\r\n   */\r\n  push: function (fn, ctx) {\r\n    if (this._enabled) {\r\n      this._jobs.push({\r\n        fn: fn,\r\n        ctx: ctx\r\n      });\r\n      this.start();\r\n    } else {\r\n      fn.apply(ctx);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  start: function () {\r\n    if (!this._af && this._jobs.length > 0) {\r\n      this._af = olleh.maps.util.deferAF(this._step, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  stop: function () {\r\n    if (this._af) {\r\n      window.cancelAnimationFrame(this._af);\r\n      this._af = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _step: function () {\r\n    var job, jobs = this._jobs;\r\n    \r\n    if (jobs.length == 0) {\r\n      this.stop();\r\n      return;\r\n    }\r\n    \r\n    this._af = olleh.maps.util.deferAF(this._step, this);\r\n    \r\n    job = jobs.shift();\r\n    job.fn.apply(job.ctx);\r\n  }\r\n  \r\n});\r\n/**\r\n * FX .\r\n * @private\r\n */\r\nolleh.maps.namespace('olleh.maps.fx', {\r\n  /**\r\n   *  \r\n   * @private\r\n   * @type olleh.maps.fx.AnimatorBuffer\r\n   */\r\n  animatorBuffer: new olleh.maps.fx.AnimatorBuffer(),\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Number}\r\n   */\r\n  now: function () {\r\n    return +Date.now();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @type {Boolean}\r\n   */\r\n  useAFTime: false\r\n\r\n});\r\n\r\n// See #2718\r\n(function () {\r\n  if (window.performance && window.performance.now) {\r\n    olleh.maps.fx.now = function () {\r\n      return window.performance.now();\r\n    };\r\n    olleh.maps.util.deferAF(function (time) {\r\n      olleh.maps.fx.useAFTime = time && time > 1e12 && olleh.maps.fx.now() > 1e12;\r\n    });\r\n  }\r\n})();/**\r\n * KT    .\r\n * KT     \r\n *  <code>olleh.maps.event.Event</code>  .<p/>\r\n *    {@link olleh.maps.event.EventDelegator} mixin .\r\n * <p/>\r\n * <h3>KT  </h3>\r\n *      .\r\n * {@link olleh.maps.event.EventManager}    hit target ,\r\n * {@link olleh.maps.event.Recognizer}     .\r\n * <p/>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keydown|keydown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keyup|keyup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keypress|keypress}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n *   <li>{@link olleh.maps.Map#event:resize|resize}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousemove|mousemove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousewheel|mousewheel}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchstart|touchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchmove|touchmove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchend|touchend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchcancel|touchcancel}</li>\r\n * </ul>\r\n * <h5>   </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchstart|pinchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinch|pinch}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchend|pinchend}</li>\r\n * </ul>\r\n * <h3>  </h3>\r\n * KT        .\r\n *   {@link olleh.maps.event.EventDelegator#fireEvent} , {@link olleh.maps.event.EventDelegator#onEvent}\r\n *   .\r\n * @example\r\n * marker.onEvent('custom', function (event, payload) {\r\n *   olleh.maps.log.info(payload.x);\r\n * });\r\n * ... \r\n * var customEvent = new olleh.maps.event.Event('custom', marker);\r\n * marker.fireEvent(customEvent, {x: 1, y: 1, z:1});\r\n * \r\n * @summary KT    .\r\n */\r\n$class('olleh.maps.event.Event').define({\r\n  $static: {\r\n    /** \r\n     *   CAPTURE .\r\n     * @type Number\r\n     */\r\n    CAPTURING_PHASE: 1,\r\n    /** \r\n     *   TARGET .\r\n     * @type Number\r\n     */\r\n    AT_TARGET: 2,\r\n    /** \r\n     *   BUBBLING .\r\n     * @type Number\r\n     */\r\n    BUBBLING_PHASE: 3,\r\n    /**\r\n     *  phase  default behavior   . \r\n     * @private\r\n     * @type Number\r\n     */\r\n    DEFAULT_PHASE: 8\r\n  },\r\n  \r\n  /**\r\n   * ,  Event  .\r\n   * @param {String} name  \r\n   * @param {Object} src\r\n   * @param {olleh.maps.event.EventDelegator}  src   {@link olleh.maps.event.EventDelegator} \r\n   * @param {Object} [opts] \r\n   * @param {UIEvent} [opts.originEvent]   \r\n   * @param {HTMLElement} [opts.targetDOM]   Event DOM Element\r\n   * @param {Array.<Touch>} [opts.touches]    Touch \r\n   * @param {Array.<Touch>} [opts.targetTouches]  DOM element  Touch \r\n   * @param {Array.<Touch>} [opts.changedTouches]     Touch \r\n   * @see http://dvcs.w3.org/hg/webevents/raw-file/tip/touchevents.html#idl-def-TouchEvent|w3c TouchEvent\r\n   */\r\n  Event: function (name, src, opts) {\r\n    var maps = olleh.maps; \r\n    \r\n    this._name = name;\r\n    this._src = src;\r\n    this._stopPropagation = false;\r\n    this._stopImmediatePropagation = false;\r\n    this._defaultPrevented = false;\r\n\r\n    /**\r\n     *    .<p/>\r\n     *    {@link olleh.maps.event.Event.CAPTURING_PHASE}, {@link olleh.maps.event.Event.AT_TARGET}, \r\n     * {@link olleh.maps.event.Event.BUBBLING_PHASE}  .\r\n     * @type Number\r\n     * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-Event|w3c Event\r\n     */\r\n    this.eventPhase = 0;\r\n    \r\n    this.pageXY = undefined;\r\n    this._point = undefined;\r\n    this._coord = undefined;\r\n    this._map = undefined;\r\n    \r\n    if (opts) {\r\n      maps.mixin(this, opts, true);\r\n      \r\n      if (this.hasOwnProperty('touches')) { // Touch Event members\r\n        this.targetTouches = this.targetTouches || this.touches;\r\n        this.changedTouches = this.changedTouches || this.touches;\r\n      }\r\n\r\n      /**\r\n       *   Event DOM Element\r\n       * <p />\r\n       * {@link olleh.maps.event.EventDelegator#registerEventDom}   HTMLElement \r\n       * @type HTMLElement\r\n       * @name olleh.maps.event.Event#targetDOM\r\n       * @see olleh.maps.event.EventDelegator#registerEventDom\r\n       */\r\n      /**\r\n       *  \r\n       * <p />\r\n       *     <code>undefined</code>\r\n       * @type UIEvent\r\n       * @name olleh.maps.event.Event#originEvent\r\n       */\r\n      var originEvent = opts.originEvent;\r\n      \r\n      if (originEvent) {\r\n        this.timeStamp = originEvent.timeStamp || +(new Date());\r\n        \r\n        if (maps.isUndefined(opts.pageXY)) {\r\n          \r\n          var x = originEvent.pageX;\r\n          var y = originEvent.pageY;\r\n          \r\n          if (x == null && originEvent.x != null) { // ie9\r\n            var targetDOM = this.targetDOM ? this.targetDOM.ownerDocument || document : document;\r\n            var doc = targetDOM.documentElement;\r\n            var body = doc.body;\r\n            \r\n            x = originEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - \r\n            (doc && doc.clientLeft || body && body.clientLeft || 0);\r\n            y = originEvent.clientY + (doc && doc.scrollTop  || body && body.scrollTop  || 0) - \r\n            (doc && doc.clientTop  || body && body.clientTop  || 0);\r\n          } \r\n          /**\r\n           *   ()  pageX, pageY  \r\n           * @type olleh.maps.Point\r\n           */\r\n          this.pageXY = new maps.Point(x || 0, y || 0);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!this.hasOwnProperty('timeStamp')) {\r\n      /**\r\n       *    timestamp <p/>\r\n       *   {@link #originEvent}     <code>timeStamp</code> .\r\n       * @type Number\r\n       */\r\n      this.timeStamp = +(new Date());\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {String}   \r\n   */\r\n  getName: function () {\r\n    return this._name;\r\n  },\r\n\r\n  /**\r\n   *   ({@link olleh.maps.event.EventDelegator}) .\r\n   * @returns {olleh.maps.event.EventDelegator} EventDelegator  \r\n   */\r\n  getSource: function () {\r\n    return this._src;\r\n  },\r\n\r\n  /**\r\n   * bubbling, capture phase            . \r\n   * @see #stopImmediatePropagation\r\n   * @see http://www.w3.org/TR/2006/WD-DOM-Level-3-Events-20060413/events.html#Events-Event-stopPropagation|w3c Event-stopPropagation\r\n   */ \r\n  stopPropagation: function () {\r\n    this._stopPropagation = true;\r\n  },\r\n\r\n  /**\r\n   * {@link #stopPropagation}      .\r\n   * @see #stopPropagation\r\n   * @see http://www.w3.org/TR/2006/WD-DOM-Level-3-Events-20060413/events.html#Events-Event-stopImmediatePropagation|w3c Event-stopImmediatePropagation\r\n   */ \r\n  stopImmediatePropagation: function () {\r\n    this._stopImmediatePropagation = true;\r\n  },\r\n\r\n  /**\r\n   *  default function   .\r\n   */\r\n  preventDefault: function () {\r\n    this._defaultPrevented = true;\r\n  },\r\n\r\n  /**\r\n   *       viewport pixel  .\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  getPoint: function () {\r\n    var xy = this.pageXY;\r\n    \r\n    if (olleh.maps.isUndefined(xy)) return null;\r\n    \r\n    if (olleh.maps.isUndefined(this._point)) {\r\n      var map = this._getMap();\r\n      if (!map) {\r\n        return (this._point = null);\r\n      }\r\n      var rootXY = map.layerMgr.getViewportOffset();\r\n      this._point = xy.subtract(rootXY);\r\n    }\r\n    return this._point;\r\n  },\r\n  \r\n  /**\r\n   * viewport pixel  coord  .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getCoord: function () {\r\n    if (this._coord !== null) {\r\n      var viewportPx = this.getPoint();\r\n      \r\n      if (!viewportPx) {\r\n        return this._coord = null;\r\n      }\r\n      var map = this._getMap();\r\n      this._coord = map ?  map.layerMgr.getCoordFromViewportPx(viewportPx) : \r\n        null;\r\n    }\r\n    return this._coord;\r\n  },\r\n  \r\n  /**\r\n   *  ({@link olleh.maps.Map}) .\r\n   * @returns {olleh.maps.Map}\r\n   * @private\r\n   */\r\n  _getMap: function () {\r\n    var hit = this._src;\r\n    \r\n    if (!hit || this._map === null) return null;\r\n    \r\n    var bubble = hit.getMap ? hit.getMap() || hit.getBubble() : hit.getBubble();\r\n    var Map = olleh.maps.Map;\r\n    \r\n    while (bubble && !(bubble instanceof Map)) {\r\n      bubble = bubble.getMap ? bubble.getMap() || bubble.getBubble() : bubble.getBubble();\r\n    }\r\n    bubble = bubble || hit;\r\n    \r\n    if (bubble instanceof Map) {\r\n      this._map = bubble; \r\n    } else {\r\n      this._map = null;\r\n    }\r\n    return this._map;\r\n  } \r\n});/**\r\n *      .\r\n *   mixin  {@link #onEvent}, {@link #fireEvent}    . \r\n * <p/>\r\n * <h3>EventDelegator mixin  </h3>\r\n * KT  UI   <code>EventDelegator</code> mixin .\r\n *    mixin . \r\n * <ul>\r\n *   <li>{@link olleh.maps.Map|}</li>\r\n *   <li>{@link olleh.maps.overlay.Marker|}</li>\r\n *   <li>{@link olleh.maps.overlay.InfoWindow|}</li>\r\n * </ul>\r\n * <h3>  API</h3>\r\n *  API   API. \r\n *   API        API .\r\n * <ul>\r\n *   <li>{@link #onEvent}</li>\r\n *   <li>{@link #fireEvent}</li>\r\n * </ul>\r\n * <h3>     API</h3>\r\n *     DOM Element       \r\n * {@link #registerEventDom},   {@link #unregisterEventDom} .\r\n * \r\n * @example\r\n * $class('Foo').mixin(olleh.maps.event.EventDelegator).define({\r\n *   init: function () {\r\n *     this.fooDOM1 = document.createElement('div');\r\n *     this.fooDOM2 = document.createElement('div');\r\n *     this.fooDOM3 = document.createElement('div');\r\n *     ...\r\n *     this.registerEventDom(this.fooDOM1);\r\n *     this.registerEventDom(this.fooDOM2);\r\n *     this.registerEventDom(this.fooDOM3);\r\n *   },\r\n *   \r\n *   $default_click: function (event, payload) {\r\n *     if (event.targetDOM === this.fooDOM1) {\r\n *       olleh.maps.log.info('fooDOM1 clicked');\r\n *     }\r\n *   }\r\n * });\r\n * \r\n * var foo = new Foo();\r\n *\r\n * foo.onEvent('click', function (event, payload) {\r\n *   olleh.maps.log.info(event.targetDOM);\r\n *   foo.fireEvent('customEvent', {customX: 1, customY: 2});\r\n * });\r\n * foo.onEvent('customEvent', function (event, payload) {\r\n *   olleh.maps.log.info(payload.customX + ',' + payload.customY);\r\n * });\r\n * \r\n * @summary EventDelegator       .\r\n *    EventDelegator Bubbling .\r\n */\r\n$class('olleh.maps.event.EventDelegator').define({\r\n  /**\r\n   *        hit test \r\n   *   {@link olleh.maps.event.EventManager}   .\r\n   * <p />\r\n   *      API    .\r\n   * @private\r\n   */\r\n  registerEvent: function () {\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.registry(this);\r\n  },\r\n  \r\n  /**\r\n   *        hit test \r\n   *   {@link olleh.maps.event.EventManager}   .\r\n   * <p />\r\n   *      API    .\r\n   * @param {HTMLElement} elem\r\n   * @private\r\n   */\r\n  registerEventDom: function (elem) {\r\n    if (!elem) return;\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.registryDom(this, elem);\r\n  },\r\n\r\n  /**\r\n   *  <code>elem</code>      .\r\n   * <p />\r\n   *       API    .\r\n   * @param {HTMLElement} elem\r\n   * @see #registerEventDom\r\n   * @private\r\n   */\r\n  unregisterEventDom: function (elem) {\r\n    if (!elem) return;\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.unregistryDom(elem);\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *   {@link olleh.maps.event.EventManager}   .\r\n   * <p />\r\n   *       API    .\r\n   * @see #unregisterEventDom\r\n   * @private\r\n   */\r\n  unregisterEvent: function () {\r\n    var eventMgr = this._getEventManager();\r\n    eventMgr && eventMgr.unregistry(this);\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   *    .      .\r\n   * @returns {String}\r\n   * @private\r\n   */\r\n  getId: function () {\r\n    if (!this.hasOwnProperty('_id') || this._id == null) {\r\n      this._id = olleh.maps.util.genId();\r\n    } \r\n    return this._id;\r\n  },\r\n  \r\n  /**\r\n   *   bubble-target  . \r\n   *  bubble-target    <code>null</code> .\r\n   * <p />\r\n   * bubble-target    .\r\n   * @returns {olleh.maps.event.EventDelegator} bubble-target , \r\n   *   <code>null</code> \r\n   * @private\r\n   */\r\n  getBubble: function () {\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   *         .\r\n   * <p/>\r\n   *   bubbling-up    .\r\n   * <p/>\r\n   *   delay 0    Async     -1\r\n   *  Sync       .\r\n   * <p/>\r\n   *    ,      .\r\n   * @example\r\n   * var marker = new olleh.maps.overlay.Marker({\r\n   *   position: new olleh.maps.UTMK(958094.063532902, 1942790.8261742294),\r\n   *   map: map\r\n   * })\r\n   * \r\n   * var customEvent = new olleh.maps.event.Event('custom1', marker);\r\n   * marker.fireEvent(customEvent, {x: 1, y: 1});\r\n   * marker.fireEvent('custom2', {x: 1, y: 1});\r\n   * \r\n   * @param {String|olleh.maps.event.Event} event    \r\n   * @param {Object} payload      \r\n   * @param {Number} delay     (milliseconds)\r\n   * @see #onEvent\r\n   */\r\n  fireEvent: function (event, payload, delay) {\r\n    if (olleh.maps.isString(event)) {\r\n      event = new olleh.maps.event.Event(event, this);\r\n    }\r\n    if (event._stopPropagation) return false;\r\n\r\n    if (delay >= 0) {\r\n      olleh.maps.util.delay(this._handleFireEvent, delay, this, event, payload);\r\n    } else {\r\n      this._handleFireEvent(event, payload);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *   bubble-up    target \r\n   *        \r\n   * .  bubble-up   target \r\n   *      .\r\n   * @returns {Array.<olleh.maps.event.EventDelegator>}     bubble-up target \r\n   *   \r\n   * @private\r\n   */\r\n  lookupBubbles: function () {\r\n    var results = [];\r\n    var target = this.getBubble();\r\n\r\n    while (target) {\r\n      results.push(target);\r\n      target = target.getBubble();\r\n    }\r\n    return results;\r\n  },\r\n  \r\n  /**\r\n   *     callback  .\r\n   * <p/>\r\n   * callback   {@link #fireEvent}    .\r\n   * @example\r\n   * var map = new olleh.maps.Map(document.getElementById('map'), {\r\n   *  center: new olleh.maps.UTMK(958094.063532902, 1942790.8261742294)\r\n   * });\r\n   * var marker = new olleh.maps.overlay.Marker({\r\n   *   position: new olleh.maps.UTMK(958094.063532902, 1942790.8261742294),\r\n   *   map: map\r\n   * })\r\n   * ...\r\n   *  // marker   map capture     .\r\n   * map.onEvent('click', function (event, payload) {\r\n   *   var src = event.getSource();\r\n   *   olleh.maps.log.info('1 ' + src + ': clicked'); \r\n   * }, this, true);\r\n   *  // marker   marker target    .\r\n   * marker.onEvent('click', function (event, payload) {\r\n   *   var src = event.getSource();\r\n   *   olleh.maps.log.info('2 ' + src + ': clicked');\r\n   * }, this);\r\n   *  // marker   map bubbleup    .\r\n   * map.onEvent('click', function (event, payload) {\r\n   *   var src = event.getSource();\r\n   *   olleh.maps.log.info('3 ' + src + ': clicked'); \r\n   * }, this);\r\n   * @param {String} eventName  \r\n   * @param {Function} callbackFn     callback \r\n   * @param {Object} ctx callback   <code>this</code> .\r\n   *    source   .\r\n   * @param {Boolean} [capture = false]   . \r\n   * <code>true</code> capture    bubble-up . \r\n   * @returns {Boolean}   <code>true</code> \r\n   * @see #fireEvent\r\n   * @see #unsubscribeEvent\r\n   */\r\n  onEvent: function (eventName, callbackFn, ctx, capture) {\r\n\r\n    if (!olleh.maps.isFunction(callbackFn)) {\r\n      throw new TypeError('Specified event listener is not a function: '\r\n          + callbackFn + this.currentStack());\r\n    }\r\n    if (ctx && !olleh.maps.isObject(ctx)) {\r\n      throw new TypeError('Specified event context is not an Object type: '\r\n          + ctx + this.currentStack());\r\n    }\r\n    \r\n    var listener = this._findEventListener(eventName, callbackFn, true);\r\n    // 1(Capture), 2(Bubble), 3 (Both)\r\n    callbackFn.capture |= (capture ? 1 : 2); // BIT-OR operation\r\n    if (listener) {\r\n      ctx = ctx || this;\r\n      if (olleh.maps.util.indexOf(listener.$ctxs, ctx) === -1) {\r\n        listener.$ctxs.push(ctx);\r\n      }\r\n      return true;\r\n    }\r\n    return false;\r\n  },\r\n  \r\n  /**\r\n   *    {@link olleh.maps.event.EventDelegator}\r\n   * propatation.(bubble-up)\r\n   * <p/>\r\n   *       Bubble-up   .\r\n   * <p/>\r\n   *     .   .\r\n   * @param {olleh.maps.event.Event} event \r\n   * @param {Object} [payload]     \r\n   * @returns {Boolean}     <code>true</code> \r\n   * @see #fireEvent\r\n   * @private\r\n   */\r\n  propagateEvent: function (event, payload) {\r\n    if (!event) return false;\r\n    \r\n    var bubble;\r\n    var ns = olleh.maps.event.Event;\r\n    \r\n    this._notifyListeners(event, payload);\r\n    \r\n    if (event.eventPhase !== ns.BUBBLING_PHASE) {\r\n      event.eventPhase = ns.BUBBLING_PHASE;\r\n    }\r\n    // Continue bubbling up if it wasn't stopped or local event wasn't fired\r\n    if (!event._stopPropagation && !event._stopImmediatePropagation) {\r\n      bubble = this.getBubble();\r\n      bubble && bubble.propagateEvent.apply(bubble, arguments);\r\n    }\r\n    return true;\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * <p/>\r\n   * callbackFn  ,     .\r\n   * ctx   callbackFn    .\r\n   * @param {String} eventName  \r\n   * @param {Function} [callbackFn]   \r\n   * @param {Object} [ctx]    <code>this</code> \r\n   * @see #onEvent\r\n   */\r\n  unsubscribeEvent: function (eventName, callbackFn, ctx) {\r\n    var listeners = this._getEventListeners(eventName);\r\n    \r\n    if (!listeners || listeners.length === 0) return;\r\n\r\n    if (callbackFn) {\r\n      var listener = this._findEventListener(eventName, callbackFn);\r\n      \r\n      if (!listener) return;\r\n      \r\n      if (olleh.maps.isUndefined(ctx)) { // removes all the listeners\r\n        listeners.splice(olleh.maps.util.indexOf(listeners, listener), 1);\r\n        return;\r\n      }\r\n      \r\n      var c = olleh.maps.util.indexOf(listener.$ctxs, ctx || this);\r\n      if (c != -1) {\r\n        listener.$ctxs.splice(c, 1); // remove\r\n      }\r\n      if (listener.$ctxs.length === 0) {\r\n        listener.$fn = undefined;\r\n        listeners.splice(olleh.maps.util.indexOf(listeners, listener), 1);\r\n      }\r\n    } else { // removes all the listeners\r\n      this._eventListeners[eventName] = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * , callbackFn    . \r\n   *      .\r\n   * @param {String} name \r\n   * @param {Function} callbackFn    \r\n   * @param {Boolean} create <code>true</code>     .\r\n   * @returns {{$fn: Function, $ctxs: Array}}    context\r\n   *   $fn:    , \r\n   *   $ctxs: $fn  <code>this</code>  context  \r\n   * @private\r\n   */\r\n  _findEventListener: function (name, callbackFn, create) {\r\n    var listeners = this._getEventListeners(name); \r\n    var listener = null;\r\n\r\n    if (!listeners && create) {\r\n      listeners = [];\r\n      this._eventListeners[name] = listeners;\r\n      listener = {$fn: callbackFn, $ctxs: []};\r\n      listeners.push(listener);\r\n      return listener;\r\n    }\r\n    \r\n    for(var i = 0, len = listeners.length; i < len; i++) {\r\n      listener = listeners[i];\r\n      if (listener && listener.$fn === callbackFn) {\r\n        return listener;\r\n      }\r\n    }\r\n\r\n    if (listeners && create) {\r\n      listener = {$fn: callbackFn, $ctxs: []};\r\n      listeners.push(listener);\r\n      return listener;\r\n    }\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   *   callback   . \r\n   * @param {Boolean} [capture = false] true capture\r\n   *       bubble up\r\n   *  .\r\n   * @returns {Array.<{$fn: Function, $ctxs: Array}>}     context  \r\n   *   $fn:    , \r\n   *   $ctxs: $fn  <code>this</code>  context  \r\n   * @private\r\n   */\r\n  _findEventListeners: function (event, capture) {\r\n    var listeners = this._getEventListeners(event.getName());\r\n    var results = [];\r\n    var phase = capture ? 1 : 2;\r\n    for (var i = 0, len = listeners ? listeners.length : 0; i < len; i++) {\r\n      if ((listeners[i].$fn.capture & phase) == phase) { // BIT-AND operation\r\n        results.push(listeners[i]);\r\n      }\r\n    }\r\n    return results;\r\n  },\r\n\r\n  /**\r\n   *      context   .\r\n   * @param {String} eventName\r\n   * @returns {Array.<{$fn: Function, $ctxs: Array}>}    context  \r\n   *   $fn:    , \r\n   *   $ctxs: $fn  <code>this</code>  context  \r\n   * @private\r\n   */\r\n  _getEventListeners: function (eventName) {\r\n    if (!this.hasOwnProperty('_eventListeners')) {\r\n      this._eventListeners = {};\r\n      return null;\r\n    }\r\n    return this._eventListeners[eventName];\r\n  },\r\n  \r\n  /**\r\n   * {@link olleh.maps.event.EventManager} .\r\n   * @returns {olleh.maps.event.EventManager}\r\n   * @private\r\n   * @see #registerEventDom\r\n   * @see #unregisterEventDom\r\n   */\r\n  _getEventManager: function () {\r\n    if (!this.hasOwnProperty('_eventMgr')) {\r\n      var bubble = this.getMap ? this.getMap() || this.getBubble(): this.getBubble();\r\n      var Map = olleh.maps.Map;\r\n  \r\n      while (bubble && !(bubble instanceof Map)) {\r\n        bubble = bubble.getMap ? bubble.getMap() || bubble.getBubble(): bubble.getBubble();\r\n      }\r\n      bubble = bubble || this;\r\n  \r\n      if (bubble instanceof Map) {\r\n        this._eventMgr = bubble.eventMgr;\r\n      } else {\r\n        this._eventMgr = null;\r\n      }\r\n    }\r\n    return this._eventMgr;\r\n  },\r\n  \r\n  /**\r\n   *  fire   \r\n   * <p/>\r\n   * capture   ,\r\n   * target   ,\r\n   *    bubble   .\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} payload\r\n   * @private\r\n   */\r\n  _handleFireEvent: function (event, payload) {\r\n    \r\n    var path = this.lookupBubbles();\r\n    var ns = olleh.maps.event.Event;\r\n    var name = event.getName();\r\n    var ctx, defaultFn, i, len;\r\n    \r\n    event.eventPhase = ns.CAPTURING_PHASE;\r\n\r\n    // capture phase\r\n    while (path.length != 0 && !event._stopPropagation && !event._stopImmediatePropagation) {\r\n      path.pop()._notifyListeners(event);\r\n    }\r\n    if (!event._stopPropagation && !event._stopImmediatePropagation) {\r\n      this._notifyListeners(event, payload); // capture phase(target)\r\n      event.eventPhase = ns.AT_TARGET; // 2; target phase\r\n      this.propagateEvent(event, payload);\r\n    }\r\n    // default\r\n    path = [this].concat(this.lookupBubbles());\r\n    for(i = 0, len = path.length; i < len && !event._defaultPrevented; i++) {\r\n      ctx = path[i];\r\n      \r\n      if (this._checkEvent.apply(ctx, [name, ns.DEFAULT_PHASE])) {\r\n        defaultFn = ctx['$default_' + name];\r\n        defaultFn && defaultFn.apply(ctx, arguments);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *    callback  .\r\n   * @param {olleh.maps.event.Event} event  \r\n   * @param {Object} [payload]    \r\n   * @returns {Number}   \r\n   * @private\r\n   */\r\n  _notifyListeners: function (event, payload) {\r\n    var j, ctxs, ctx, listener, fn;\r\n    var phase = event.eventPhase;\r\n    var capturing = (phase === olleh.maps.event.Event.CAPTURING_PHASE);\r\n    var listeners = this._findEventListeners(event, capturing);\r\n    var i = listeners ? listeners.length : 0;\r\n    var eventName = event.getName();\r\n    \r\n    if (this._checkEvent(eventName, phase)) {\r\n      fn = this[(capturing ? '$capture_' : '$current_') + eventName];\r\n      fn && fn.apply(this, arguments);\r\n    }\r\n\r\n    if (event._stopImmediatePropagation) return true;\r\n    \r\n    while (i--) {\r\n      listener = listeners[i];\r\n      if (!listener) continue;\r\n      try {\r\n        ctxs = listener.$ctxs;\r\n        j = ctxs ? ctxs.length : 0;\r\n        while (j--) {\r\n          ctx = ctxs[j];\r\n          ctx && listener.$fn && listener.$fn.apply(ctx, arguments);\r\n          if (event._stopImmediatePropagation) return true;\r\n        }\r\n      } catch (ex) {\r\n        // If graceful errors is set, log error and continue event callback\r\n        olleh.maps.log.error('Error occured during event listener: ' + ex, this);\r\n        \r\n        if (ex.stack) { // chrome\r\n          olleh.maps.log.error(ex.stack, this);\r\n        } else {\r\n          throw ex;\r\n        }\r\n      }\r\n    }\r\n    return true;\r\n  },\r\n\r\n  /**\r\n   * @param {String} eventName \r\n   * @param {Number} phase  \r\n   * @see olleh.maps.event.Event\r\n   * @private\r\n   */\r\n  _checkEvent: function (eventName, phase) {\r\n    var Event = olleh.maps.event.Event;\r\n    \r\n    // targetting, bubbling  $current .\r\n    if (phase === Event.BUBBLING_PHASE) {\r\n      phase = Event.AT_TARGET;\r\n    }\r\n    var event = this.$EVENTS[eventName];\r\n    \r\n    return !!(event && event | phase);\r\n  },\r\n  \r\n  /**\r\n   *  define   .\r\n   * <p/>\r\n   * $cature_, $current_, $default_    $EVENTS   .\r\n   * @private\r\n   */\r\n  $afterDefine: function () {\r\n    var clazz = this;\r\n    var clazzPrototype = clazz.prototype;\r\n    var Event = olleh.maps.event.Event;\r\n\r\n    clazzPrototype.$EVENTS = {};\r\n    \r\n    var events = clazzPrototype.$EVENTS;\r\n    \r\n    // TODO   refactoring\r\n    for(var k in clazzPrototype) {\r\n      if (k.indexOf('$') != 0) {\r\n        continue;\r\n      }\r\n      var eventName = null;\r\n      if (k.indexOf('capture_') == 1) {\r\n        eventName = k.substring(9);\r\n        events[eventName] = events[eventName] | Event.CAPTURING_PHASE;\r\n      } else if (k.indexOf('current_') == 1) {\r\n        eventName = k.substring(9);\r\n        events[eventName] = events[eventName] | Event.AT_TARGET;\r\n      } else if (k.indexOf('default_') == 1) {\r\n        eventName = k.substring(9);\r\n        events[eventName] = events[eventName] | Event.DEFAULT_PHASE;\r\n      }\r\n    }\r\n  }\r\n});/**\r\n * KT      {@link olleh.maps.event.Event}    {@link olleh.maps.event.EventDelegator}   .\r\n * EventManager    .\r\n * <h3>  </h3>\r\n * KT      DOM element  .\r\n * KT {@link olleh.maps.event.EventDelegator}      EventManager  . \r\n * <p/> \r\n * EventManager   (ie7, ff, safari, chrome)    {@link olleh.maps.event.Event}  ,\r\n *      {@link olleh.maps.event.Event}    .\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keydown|keydown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keyup|keyup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:keypress|keypress}</li>\r\n *   <li>{@link olleh.maps.Map#event:resize|resize}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousemove|mousemove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:mousewheel|mousewheel}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * </ul>\r\n * <h5>  </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchstart|touchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchmove|touchmove}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchend|touchend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:touchcancel|touchcancel}</li>\r\n * </ul>\r\n * <p/>\r\n * <h3>hit Target</h3>\r\n *      DOM element {@link olleh.maps.event.EventDelegator}   .\r\n * EventManger     {@link olleh.maps.event.EventDelegator} .\r\n * <h5>{@link olleh.maps.event.EventDelegator}  </h5>\r\n * {@link #registry}   {@link olleh.maps.event.EventDelegator}     DOM element  .\r\n * <p/>\r\n *  DOM element  DOM element   bubble up    DOM element    .  \r\n * <h5>{@link olleh.maps.event.EventDelegator}  </h5>\r\n *    DOM element     {@link #unregistry}  .\r\n * <h5>hit test</h5>\r\n *   KT  <code>UIEvent#target</code> DOM element KT  DOM element .\r\n *  DOM element bubble up       DOM element {@link olleh.maps.event.EventDelegator}     . \r\n * <p/>\r\n * <h3> </h3>\r\n * KT     . \r\n * <h5>   </h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchstart|pinchstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinch|pinch}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:pinchend|pinchend}</li>\r\n * </ul>\r\n *       EventManager {@link olleh.maps.event.Recognizer}  .\r\n * {@link #addRecognizer}  recognizer  ,\r\n * {@link #findRecognizer}    recognizer       .\r\n * , {@link #removeRecognizer}    recognizer   .\r\n * <p/>\r\n *  EventManager {@link olleh.maps.Map} Signleton , .\r\n * @summary\r\n * KT      {@link olleh.maps.event.Event}    {@link olleh.maps.event.EventDelegator}   . \r\n * @param {olleh.maps.Map} map Map \r\n * @param {HTMLElement} elem KT  DOM element\r\n */\r\n$class('olleh.maps.event.EventManager').define({\r\n  $static: {\r\n    /**\r\n     *  event stopPropagation .\r\n     * @example\r\n     * var domEvent = event.originEvent; // event olleh.maps.event.Event \r\n     * \r\n     * olleh.maps.event.EventManager.stopPropagation(domEvent);\r\n     * @param {UIEvent} domEvent  \r\n     * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface|w3c Event#stopPropagation\r\n     */\r\n    stopPropagation: function (domEvent) {\r\n      domEvent.stopPropagation ? domEvent.stopPropagation() : \r\n        (domEvent.cancelBubble = true); // ie7,8 cancelBubble\r\n    },\r\n\r\n    /**\r\n     *  event preventDefault .\r\n     * @example\r\n     * var domEvent = event.originEvent; // event olleh.maps.event.Event \r\n     * olleh.maps.event.EventManager.preventDefault(domEvent);\r\n     * @param {UIEvent} domEvent  \r\n     * @see http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface|w3c Event#preventDefault\r\n     */\r\n    preventDefault: function (domEvent) {\r\n      domEvent.preventDefault ? domEvent.preventDefault() : \r\n        (domEvent.returnValue = false); // ie7,8 returnValue\r\n    },\r\n    \r\n    /**\r\n     *   .\r\n     * @param {MouseEvent} domEvent   \r\n     * @returns {Boolean}\r\n     */\r\n    isRightClick: function (domEvent) {\r\n      return (domEvent.which && domEvent.which == 3) || (domEvent.button && domEvent.button == 2);\r\n    },\r\n    \r\n    /**\r\n     *    DOM input, select, textarea  <code>false</code> .\r\n     * @returns {Boolean}\r\n     */\r\n    checkEnabledKeyevent: function (activeElement) {\r\n      olleh.maps.isUndefined(activeElement) && (activeElement = document.activeElement);\r\n      \r\n      if (!activeElement) return true;\r\n      \r\n      var nodeName = activeElement.nodeName;\r\n      return !(nodeName === 'INPUT' || nodeName === 'SELECT' || nodeName === 'TEXTAREA');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * req_zoomin \r\n   * @event olleh.maps.event.EventDelegator#event:req_zoomin\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  /**\r\n   * req_zoomout \r\n   * @event olleh.maps.event.EventDelegator#event:req_zoomout\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  /**\r\n   * ,  EventManager  .\r\n   * @param {olleh.maps.Map} map Map \r\n   * @param {HTMLElement} elem KT  DOM element\r\n   */\r\n  EventManager: function (map, elem) {\r\n    this._map = map;\r\n    this._root = elem;  // olleh.maps.Map     .\r\n    this._hitTargets = {}; // hit test      hashmap\r\n    this._recognizers = {};\r\n    \r\n    this._desktopIE = false;\r\n    this._clicked = false; //    true,    false\r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * <p/>\r\n   *   .   . map start   .\r\n   * @private\r\n   */\r\n  start: function () {\r\n    var browser = olleh.maps.browser;\r\n    var events;\r\n    \r\n    this.registryDom(this._map, this._root);\r\n    this._layerMgr = this._map.layerMgr;\r\n\r\n    // Track history map by track ID\r\n    this._history = {};\r\n    \r\n    if (browser.isMobile) {\r\n      /**\r\n       * touchstart .   .\r\n       * @event olleh.maps.event.EventDelegator#event:touchstart\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * touchmove .     .\r\n       * @event olleh.maps.event.EventDelegator#event:touchmove\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * touchend .   .\r\n       * @event olleh.maps.event.EventDelegator#event:touchend\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * touchcancel .    .\r\n       * @event olleh.maps.event.EventDelegator#event:touchcancel\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      this._addEventsListener(document, ['touchstart', 'touchmove', 'touchend',\r\n        'touchcancel'], this, false);\r\n    } else {\r\n      if (browser.browserName === browser.BROWSER_NAME.ie) { // ie   \r\n        var hackDOM = document.createElement('div');\r\n        olleh.maps.util.dom.setStyles(hackDOM, {\r\n          position: 'absolute',\r\n          width: '100%',\r\n          height: '100%',\r\n          zIndex: 2\r\n        });\r\n        this._desktopIE = true;\r\n        this._hackDOM = hackDOM;\r\n        this._root.appendChild(hackDOM);\r\n      }\r\n      /**\r\n       * mousewheel .       .\r\n       * <p/> \r\n       * firefox DOMMouseScroll mousewheel .\r\n       * @event olleh.maps.event.EventDelegator#event:mousewheel\r\n       * @param {olleh.maps.event.Event} event\r\n       * @see http://www.w3.org/TR/2007/WD-DOM-Level-3-Events-20071221/events.html#event-mousewheel|w3c mousewheel\r\n       * @see https://developer.mozilla.org/en-US/docs/DOM/DOM_event_reference/DOMMouseScroll|DOMMouseScroll\r\n       */\r\n      /**\r\n       * mousedown .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mousedown\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mousemove .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mousemove\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mouseup .        .\r\n       * @event olleh.maps.event.EventDelegator#event:mouseup\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mouseover .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mouseover\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * mouseout .      .\r\n       * @event olleh.maps.event.EventDelegator#event:mouseout\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * click .        .\r\n       * @event olleh.maps.event.EventDelegator#event:click\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * rightclick .        .\r\n       * @event olleh.maps.event.EventDelegator#event:rightclick\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * dblclick .       .\r\n       * @event olleh.maps.event.EventDelegator#event:dblclick\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      this._mousewheel = (browser.browserName === browser.BROWSER_NAME.firefox)\r\n        ? 'DOMMouseScroll' : 'mousewheel';\r\n      this._addEventsListener(document, ['mousedown', 'mousemove', 'mouseup'], this, false);\r\n      \r\n      if (this._desktopIE) {\r\n        events = ['dragstart', 'contextmenu', this._mousewheel];\r\n      } else {\r\n        events = ['dragstart', 'selectstart', 'contextmenu', this._mousewheel, 'mouseout', 'mouseover'];\r\n      }\r\n      this._addEventsListener(this._root, events, this, false);\r\n    }\r\n    this._addEventsListener(window, ['resize'], this, false);\r\n    this._addEventsListener(this._root, ['click'], this, false);\r\n    this._started = true;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * <p/>\r\n   *   .   . map stop   .\r\n   * @private\r\n   */\r\n  stop: function () {\r\n    var browser = olleh.maps.browser;\r\n    var events;\r\n\r\n    this.unregistry(this._map);\r\n    this._history = null;\r\n    \r\n    if (browser.isMobile) {\r\n      this._removeEventsListener(document, ['touchstart', 'touchmove', \r\n        'touchend', 'touchcancel'], this, false);\r\n    } else {\r\n      this._removeEventsListener(document, ['mousedown', 'mouseup', 'mousemove'], this, false);\r\n      if (this._desktopIE) {\r\n        events = ['dragstart', 'contextmenu', this._mousewheel];\r\n      } else {\r\n        events = ['dragstart', 'selectstart', 'contextmenu', this._mousewheel, 'mouseout', 'mouseover'];\r\n      }\r\n      this._removeEventsListener(this._root, events, this, false);\r\n    }\r\n    this._removeEventsListener(window, ['resize'], this, false);\r\n    this._removeEventsListener(this._root, ['click'], this, false);\r\n    this._started = false;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * @returns {Boolean}\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n  \r\n\r\n  /**\r\n   * {@link olleh.maps.event.EventDelegator}  EventManager hashmap .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#registerEvent} .\r\n   * @param {olleh.maps.event.EventDelegator} delegator  EventDelegator \r\n   */\r\n  registry: function (delegator) {\r\n    var id = delegator.getId();\r\n    this._hitTargets[id] = delegator;\r\n  },\r\n  \r\n  /**\r\n   * DOM element data-id, style class ,\r\n   * {@link olleh.maps.event.EventDelegator}  EventManager hashmap .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#registerEventDom} .\r\n   * @param {olleh.maps.event.EventDelegator} delegator  EventDelegator \r\n   * @param {HTMLElement} elem    DOM element\r\n   */\r\n  registryDom: function (delegator, elem) {\r\n    if (!elem) return;\r\n    var id = delegator.getId();\r\n    elem.setAttribute('data-id', id);\r\n    olleh.maps.util.dom.addClass(elem, 'ollehmap-event');\r\n    this._hitTargets[id] = delegator;\r\n  },\r\n\r\n  /**\r\n   * DOM element data-id, style class .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#unregisterEventDom} .\r\n   * @param {HTMLElement} elem    DOM element\r\n   */\r\n  unregistryDom: function (elem) {\r\n    if (elem) {\r\n      elem.removeAttribute('data-id');\r\n      olleh.maps.util.dom.removeClass(elem, 'ollehmap-event');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.event.EventDelegator}  EventManager hashmap .\r\n   * <p/>\r\n   *   .   . {@link olleh.maps.event.EventDelegator#unregisterEvent} .\r\n   * @param {olleh.maps.event.EventDelegator} delegator  EventDelegator \r\n   */\r\n  unregistry: function (delegator) {\r\n    this._hitTargets[delegator.getId()] = null;\r\n    delete this._hitTargets[delegator.getId()];\r\n  },\r\n\r\n  /**\r\n   * recognizer  .\r\n   * @example\r\n   * eventMgr.findRecognizer('olleh.maps.event.DoubleClickZoom');\r\n   * @param {String} classname recognizer \r\n   * @returns {olleh.maps.event.Recognizer} recognizer \r\n   */\r\n  findRecognizer: function (classname) {\r\n    return this._recognizers[classname];\r\n  },\r\n\r\n  /**\r\n   * event recognizer  .\r\n   * @example\r\n   * eventMgr.addRecognizer(new olleh.maps.event.DoubleClickZoom({dblrightclick: true}));\r\n   * @param {olleh.maps.event.Recognizer} recognizer \r\n   * @see olleh.maps.event.Recognizer\r\n   */\r\n  addRecognizer: function (recognizer) {\r\n    if (!recognizer || !recognizer.isMixinOf(olleh.maps.event.Recognizer)) \r\n      return;\r\n    this._recognizers[recognizer.$classname] = recognizer;\r\n  },\r\n\r\n  /**\r\n   *   recognizer  .\r\n   * @example\r\n   * eventMgr.removeRecognizer('olleh.maps.event.DoubleClickZoom');\r\n   * @param {String} classname recognizer \r\n   */\r\n  removeRecognizer: function (classname) {\r\n    this._recognizers[classname] = null;\r\n    delete this._recognizers[classname];\r\n  },\r\n  \r\n  /**\r\n   * UIEvent( )    .\r\n   * @param {Object} from   Object(window or DOM)\r\n   * @param {Array.<string>} names   \r\n   * @param {Function|Object} handler  , \r\n      <code>context</code>   <code>context#handleEvent</code>   .\r\n   * @param {Boolean} [capture=false] if true, handles event listeners \r\n   * on capture phase of DOM event propagation process.\r\n   * @private\r\n   */\r\n  _addEventsListener: function (from, names, handler, capture) {\r\n    var i = names.length;\r\n\r\n    if (from.addEventListener) {\r\n      capture = !!capture;\r\n      handler = handler || this;\r\n      while(i--) {\r\n        from.addEventListener(names[i], handler, capture);\r\n      }\r\n    } else if (from.attachEvent) {\r\n      if (handler === this || !handler) {\r\n        !this._ieHandler && (this._ieHandler = this.handleEvent.bind(this));\r\n        handler = this._ieHandler;\r\n      } \r\n      while(i--) {\r\n        from.attachEvent('on' + names[i], handler);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * UIEvent( )    .\r\n   * @param {Object} from   Object(window or DOM)\r\n   * @param {Array.<string>} names   \r\n   * @param {Function|Object} handler  , \r\n      <code>context</code>   <code>context#handleEvent</code>   .\r\n   * @param {Boolean} capture if true, handles event listeners \r\n   * on capture phase of DOM event propagation process.\r\n   * @private\r\n   */\r\n  _removeEventsListener: function (from, names, handler, capture) {\r\n    var i = names.length;\r\n\r\n    if (from.removeEventListener) {\r\n      capture = !!capture;\r\n      handler = handler || this;\r\n      while(i--) {\r\n        from.removeEventListener(names[i], handler, capture);\r\n      }\r\n    } else if (from.detachEvent) {\r\n      (handler === this || !handler) && (handler = this._ieHandler); \r\n      while(i--) {\r\n        from.detachEvent('on' + names[i], handler);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * <p/>\r\n   *   DOM         .\r\n   * @param {UIEvent} domEvent   \r\n   * @private\r\n   */\r\n  handleEvent: function (domEvent) {\r\n    if (!this.isStarted()) {\r\n      return;\r\n    }\r\n    var clazz = olleh.maps.event.EventManager;\r\n    var domTarget = domEvent.target = (domEvent.target || domEvent.srcElement);  // ie7,8 srcElement\r\n    \r\n    domEvent = domEvent || window.event;\r\n    this._prevDomEvent = this._domEvent;\r\n    this._domEvent = domEvent;\r\n    this._prevActiveElement = this._activeElement;\r\n    this._activeElement = document.activeElement;\r\n    \r\n    if (this._prevDomEvent === domEvent) { // ie  .    .\r\n      return;\r\n    }\r\n    switch (domEvent.type) {\r\n      case 'mousedown':\r\n        return this.domMousedownEvent(domEvent);\r\n      case 'mouseup':\r\n        return this.domMouseupEvent(domEvent);\r\n      case 'mousemove':\r\n        //clazz.preventDefault(domEvent);\r\n        return this.domMousemoveEvent(domEvent);\r\n      case 'click':\r\n        return this.domGenericEvent(domEvent);\r\n      case 'mouseover':\r\n        return this.domMouseoverEvent(domEvent);\r\n      case 'mouseout':\r\n        return this.domMouseoutEvent(domEvent);\r\n      case 'resize':\r\n        return this.domResizeEvent(domEvent, 'resize');\r\n      case 'selectstart':\r\n        if (domTarget.nodeType == 3 && domTarget.parentElement && \r\n            olleh.maps.util.dom.getStyle(domTarget.parentElement, 'userSelect') != 'none') { // webkit  cursor  \r\n          return;\r\n        }\r\n      case 'dragstart':\r\n        clazz.preventDefault(domEvent);\r\n        return;\r\n      case 'contextmenu':\r\n        return clazz.preventDefault(domEvent);\r\n      case 'keydown':\r\n      case 'keyup':\r\n      case 'keypress':\r\n        return this.domKeyboardEvent(domEvent);\r\n      case 'touchstart':\r\n      case 'touchmove':\r\n      case 'touchend':\r\n      case 'touchcancel':\r\n        return this.handleTouchEvent(domEvent);\r\n      case this._mousewheel:\r\n        return this.domGenericEvent(domEvent, 'mousewheel');\r\n      default:\r\n        return this.domGenericEvent(domEvent);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * mouseover DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domMouseoverEvent: function (domEvent, name) {\r\n    var hit = this.hitTarget(domEvent.target);\r\n    \r\n    if (!hit) {\r\n      return;\r\n    }\r\n    var relatedTarget = this.hitTarget(domEvent.relatedTarget);\r\n    \r\n    if (relatedTarget && hit.target === relatedTarget.target) return;\r\n    \r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM, relatedTarget: relatedTarget\r\n    });\r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * mouseout DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domMouseoutEvent: function (domEvent, name) {\r\n    var hit = this.hitTarget(domEvent.target);\r\n    if (!hit) {\r\n      return;\r\n    }\r\n    \r\n    var relatedTarget = this.hitTarget(domEvent.relatedTarget);\r\n    \r\n    if (relatedTarget && hit.target === relatedTarget.target) return;\r\n    \r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM, relatedTarget: relatedTarget\r\n    });\r\n    this.handleMapEvent(event);\r\n  },  \r\n  \r\n  /**\r\n   * DOM  resize orientationchange   map size  \r\n   * resize . \r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domResizeEvent: function (domEvent, name) {\r\n    var root = this._root;\r\n    var map = this._map;\r\n    var width = root.clientWidth || root.offsetWidth;\r\n    var height = root.clientHeight || root.offsetHeight;\r\n    var payload = {}; \r\n    \r\n    if (olleh.maps.browser.hasOrientationChange) {\r\n      payload.orientation = window.orientation;\r\n    } \r\n    payload.width = width;\r\n    payload.height = height;\r\n    \r\n    /**\r\n     *       . (:       .)\r\n     * <p/>\r\n     * <code>resize</code> target {@link olleh.maps.Map} .\r\n     *   payload  .\r\n     * @event olleh.maps.Map#event:resize\r\n     * @param {olleh.maps.event.Event} event\r\n     * @param {Object} payload\r\n     * @param {Number} payload.width map viewport width\r\n     * @param {Number} payload.height map viewport height\r\n     * @param {Number} [payload.orientation]    window.orientation  \r\n     */\r\n    var event = new olleh.maps.event.Event(name, map, {originEvent: domEvent, \r\n      targetDOM: root});\r\n    map.fireEvent(event, payload);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domMousedownEvent: function (domEvent, name) {\r\n    if (this._desktopIE && this._hackDOM) { // desktop ie browser bug fix\r\n      this._root.removeChild(this._hackDOM);\r\n      this._hackDOM = null;\r\n      delete this._hackDOM;\r\n   }\r\n    var doc = document;\r\n    var event;\r\n    var hit = this.hitTarget(domEvent.target);\r\n\r\n    if (!hit) {\r\n      this._clicked = false;\r\n      this._removeEventsListener(doc, ['keyup','keydown','keypress'], this, false);\r\n      return;\r\n    }\r\n    this._clicked = true;\r\n    \r\n    // Text selection \r\n    if (window.getSelection) {\r\n      if (window.getSelection().empty) {  // Chrome\r\n        window.getSelection().empty();\r\n      } else if (window.getSelection().removeAllRanges) {  // Firefox\r\n        window.getSelection().removeAllRanges();\r\n      }\r\n    } else if (document.selection) {  // IE\r\n      document.selection.empty();\r\n    }\r\n\r\n    if (this._desktopIE) { // desktop ie browser address bar focus bug fix\r\n      if (olleh.maps.event.EventManager.checkEnabledKeyevent()) {\r\n        window.focus();\r\n      } else {\r\n        if (this._prevActiveElement && \r\n            this._prevActiveElement !== domEvent.target && \r\n            !olleh.maps.event.EventManager.checkEnabledKeyevent(this._prevActiveElement)) {\r\n          this._prevActiveElement.blur();\r\n        }\r\n      }\r\n    } \r\n    /**\r\n     * keydown .      .\r\n     * @event olleh.maps.event.EventDelegator#event:keydown\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    /**\r\n     * keypress .       .\r\n     * @event olleh.maps.event.EventDelegator#event:keypress\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    /**\r\n     * keyup .      .\r\n     * @event olleh.maps.event.EventDelegator#event:keyup\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this._addEventsListener(doc, ['keyup','keydown','keypress'], this, false);\r\n\r\n    event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    \r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domMouseupEvent: function (domEvent, name) {\r\n    var doc = document;\r\n    var hit = this.hitTarget(domEvent.target);\r\n    if (!hit) {\r\n      this._removeEventsListener(doc, ['keyup','keydown','keypress'], this, false);\r\n      hit = this.hitTarget(this._root);\r\n    }\r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent DOM event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  domMousemoveEvent: function (domEvent, name) {\r\n    if (this._desktopIE && this._hackDOM) { // desktop ie browser bug fix\r\n      this._root.removeChild(this._hackDOM);\r\n      this._hackDOM = null;\r\n      delete this._hackDOM;\r\n   }\r\n    var hit = this.hitTarget(domEvent.target) || this.hitTarget(this._root);\r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    this.handleMapEvent(event);\r\n    \r\n    if (this._desktopIE) { // IE   mouseout, mouseover   .\r\n      var prevEvent = this._prevEvent;\r\n      this._prevEvent = event;\r\n      if (prevEvent && prevEvent.getSource() !== hit.target) {\r\n        event = new olleh.maps.event.Event('mouseout', prevEvent.getSource(), {\r\n          originEvent: prevEvent.originEvent, targetDOM: prevEvent.targetDOM, relatedTarget: prevEvent.getSource()\r\n        });\r\n        this.handleMapEvent(event);\r\n      } \r\n      if (!prevEvent || prevEvent.getSource() !== hit.target) {\r\n        domEvent.relatedTarget = prevEvent ? prevEvent.targetDOM : null;\r\n        event = new olleh.maps.event.Event('mouseover', hit.target, {\r\n          originEvent: domEvent, targetDOM: hit.targetDOM, relatedTarget: prevEvent ? prevEvent.getSource() : null\r\n        });\r\n        this.handleMapEvent(event);\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domKeyboardEvent: function (domEvent) {\r\n    var hit = {target: this._layerMgr, targetDOM: document};\r\n    var event = new olleh.maps.event.Event(domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM});\r\n   \r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   *  DOM  . \r\n   * <p/>\r\n   *  DOM   {@link olleh.maps.event.EventDelegator}   \r\n   * {@link olleh.maps.event.Event}   .\r\n   * @param {UIEvent} domEvent   \r\n   * @returns {Boolean}    true \r\n   * @private\r\n   */\r\n  domGenericEvent: function (domEvent, name) {\r\n    var hit = this.hitTarget(domEvent.target);\r\n    if (!hit) {\r\n      return;\r\n    }\r\n    var event = new olleh.maps.event.Event(name || domEvent.type, hit.target, {\r\n      originEvent: domEvent, targetDOM: hit.targetDOM\r\n    });\r\n    this.handleMapEvent(event);\r\n  },\r\n  \r\n  /**\r\n   * @param {UIEvent} domEvent  event\r\n   * @param {String} name  \r\n   * @private\r\n   */\r\n  handleTouchEvent: function (domEvent, name) {\r\n    var type = domEvent.type;\r\n    var target = domEvent.target;\r\n    var touch = domEvent.changedTouches[0];\r\n    var prevDomEvent = this._prevDomEvent;\r\n    var browser = olleh.maps.browser;\r\n    var hit = this.hitTarget(target);\r\n\r\n    if (type === 'touchstart') {\r\n      this._mousedown = !!hit;\r\n      if (!this._mousedown) {\r\n        return; \r\n      }\r\n      //  input, selectbox, textarea  focus   touchstart  blur  .(#1286) \r\n      if (this._prevActiveElement && \r\n          this._prevActiveElement !== domEvent.target && \r\n          !olleh.maps.event.EventManager.checkEnabledKeyevent(this._prevActiveElement)) {\r\n        this._prevActiveElement.blur();\r\n      }\r\n    } else if (!this._mousedown){\r\n      return;\r\n    }\r\n\r\n    // android      - os bug fix\r\n    if (browser.hotfixAndroid) {\r\n      // android longpress bug fix(touch-callout)\r\n      if (type === 'touchstart' && domEvent.touches.length == 1) {\r\n        olleh.maps.event.EventManager.preventDefault(domEvent);\r\n      } else if (prevDomEvent.type === 'touchstart' && type === 'touchend' && \r\n          prevDomEvent.touches.length == 1 && !domEvent.touches.length && \r\n          domEvent.timeStamp - prevDomEvent.timeStamp < 750) { // touchstart  preventDefault  click     \r\n          olleh.maps.util.defer(this.handleMapEvent, this, new olleh.maps.event.Event('click', hit.target, {\r\n            targetDOM: hit.targetDOM,\r\n            pageXY: new olleh.maps.Point(touch.pageX, touch.pageY),\r\n            originEvent: domEvent \r\n          }));\r\n      }\r\n    } else if (browser.osName === browser.OS_NAME.ios &&\r\n        prevDomEvent && prevDomEvent.type === 'touchend' && type === 'touchstart' && \r\n        !prevDomEvent.touches.length && prevDomEvent.changedTouches[0].identifier === touch.identifier) {\r\n      // ios browser alert & confirm touchstart bug fix\r\n      olleh.maps.event.EventManager.preventDefault(domEvent);\r\n      this.handleMapEvent(new olleh.maps.event.Event('touchcancel', hit.target));\r\n      return;\r\n    }\r\n    \r\n    this.handleMapEvent(new olleh.maps.event.Event(name || type, hit.target, {\r\n      targetDOM: hit.targetDOM,\r\n      pageXY: new olleh.maps.Point(touch.pageX, touch.pageY),\r\n      originEvent: domEvent, \r\n      touch: touch, \r\n      touches: domEvent.touches, \r\n      targetTouches: domEvent.targetTouches,\r\n      changedTouches: domEvent.changedTouches\r\n    }));\r\n  },\r\n  \r\n  /**\r\n   *   enable/disable. <p/>\r\n   *         \r\n   *        .   \r\n   * .\r\n   * @param {Boolean} value <code>false</code> event handling .\r\n   */\r\n  setEnable: function (value) {\r\n    this._opts.enabled = !!value;\r\n  },\r\n  \r\n  /**\r\n   * DOM Tree  {@link olleh.maps.event.EventDelegator}    .\r\n   * <p/>\r\n   *    <code>null</code> .\r\n   * ie  pointer-events      .\r\n   *  <code>document.elementFromPoint</code> .\r\n   * @param {HTMLElement} elem hit   DOM Element \r\n   * @returns {{target: olleh.maps.event.EventDelegator, targetDOM: HTMLElement}}\r\n   */\r\n  hitTarget: function (elem) {\r\n    var body = document.body;\r\n    var domEvent = this._domEvent;\r\n    var noPointerEvents = !olleh.maps.browser.hasPointerEvents;\r\n    var hasClass = olleh.maps.util.dom.hasClass;\r\n    var dom, parent, id, noevent, noevents = [], x, y, target, returnVal;\r\n    var layerMgrElem = this._layerMgr._root_pane;\r\n    \r\n    if (!domEvent.target) return null;\r\n\r\n    while (elem && elem !== window && elem !== body) {\r\n      if (olleh.maps.isElement(elem)) {\r\n        // pointer-events     \r\n        if (noPointerEvents && hasClass(elem, 'ollehmap-noevent')) {\r\n          elem = this._findAncestorNoEventDom(elem);\r\n          parent = elem.parentElement || elem.parentNode;\r\n\r\n          if (parent === layerMgrElem) {\r\n            returnVal = {target: this._layerMgr, targetDOM: layerMgrElem};\r\n            break;\r\n          }\r\n          \r\n          if (noevents.length == 0) {\r\n            x = domEvent.clientX; \r\n            y = domEvent.clientY;\r\n          }\r\n          noevents.push(elem);\r\n          elem.style.visibility = 'hidden';\r\n          elem = document.elementFromPoint(x, y);\r\n          \r\n          if (elem && (elem.nodeType === 3 || elem.tagName === 'svg')) { // Opera\r\n            elem = elem.parentNode;\r\n          }\r\n          if (!elem) {\r\n            returnVal = {target: this._layerMgr, targetDOM: layerMgrElem};\r\n            break;\r\n          }\r\n        }\r\n        \r\n        id = elem.getAttribute('data-id');\r\n        if (id) {\r\n          dom = elem;\r\n          break;\r\n        }\r\n      } \r\n      elem = elem.parentElement || elem.parentNode;\r\n    }\r\n    if (noPointerEvents) {\r\n      while(noevent = noevents.pop()) {\r\n        noevent.style.visibility = '';\r\n      }\r\n    }\r\n    \r\n    if (returnVal) {\r\n      return returnVal;\r\n    } else if (dom && id && (target = this._hitTargets[id])) {\r\n      !('textContent' in dom) && dom.innerText && (dom.textContent = dom.innerText); // ie7,8 innerText\r\n      return {target: target, targetDOM: dom}; \r\n    }\r\n    return null;\r\n  },\r\n  \r\n  /**\r\n   *  <code>elem</code> ollehmap-noevent css class  DOM Element .\r\n   * @private\r\n   */\r\n  _findAncestorNoEventDom: function (elem) {\r\n    var hasClass = olleh.maps.util.dom.hasClass;\r\n    var noevent = elem;\r\n\r\n    while((elem = elem.parentElement || elem.parentNode) && hasClass(elem, 'ollehmap-noevent')) {\r\n      noevent = elem;\r\n    }\r\n    return noevent;\r\n  },\r\n  \r\n  /**\r\n   *     {@link olleh.maps.event.Event}  \r\n   *   {@link olleh.maps.event.Recognizer}     \r\n   *    hit target  . \r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} [payload]\r\n   * @param {Number} [delay]\r\n   * @private\r\n   */\r\n  handleMapEvent: function (event, payload) {\r\n    var resultSrc, recognizeredEvent, resultEvent; \r\n    var hit = event.getSource();\r\n    var targetDOM = event.targetDOM;\r\n    \r\n    if (!hit) return;\r\n    \r\n    var mixin = olleh.maps.mixin;\r\n    for(var key in this._recognizers){\r\n      resultEvent = this._recognizers[key].handle(event);\r\n      if (resultEvent) {\r\n        resultSrc = resultEvent.src || hit;\r\n        recognizeredEvent = new olleh.maps.event.Event(resultEvent.name, resultSrc, \r\n            mixin({targetDOM: targetDOM}, resultEvent.opts, true));\r\n        resultSrc.fireEvent(recognizeredEvent, resultEvent.payload);\r\n      }\r\n    }\r\n    \r\n    if (!event._stopPropagation) {\r\n      hit.fireEvent(event, payload);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * <p/>\r\n   *     <code>false</code> .\r\n   * \r\n   * @returns {Boolean}\r\n   */\r\n  isMapClicked: function () {\r\n    return this._clicked;\r\n  }\r\n});\r\n/**\r\n *          .\r\n * <p/>\r\n *      mixin      .\r\n\r\n * <h3>KT   recognizer</h3>\r\n * <h5>  recognizer</h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.Drag}</li>\r\n * </ul>\r\n * <h5>   recognizer</h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.DoubleClickZoom}</li>\r\n *   <li>{@link olleh.maps.event.ScrollWheelZoom}</li>\r\n *   <li>{@link olleh.maps.event.KeyboardZoom}</li>\r\n * </ul>\r\n * <h5>   recognizer</h5>\r\n * <ul>\r\n *   <li>{@link olleh.maps.event.Pinch}</li>\r\n *   <li>{@link olleh.maps.event.DoubleTapZoom}</li>\r\n * </ul>\r\n * \r\n * <h3>custom recognizer </h3>\r\n *   {@link olleh.maps.event.EventManager} {@link olleh.maps.event.Event}   \r\n *       {@link olleh.maps.event.Event}      {@link olleh.maps.event.EventManager} .\r\n * <p/>\r\n * Recognizer    <code>function</code>      .\r\n *            .\r\n * <p/>\r\n *    .\r\n * <dl>\r\n *   <dt>name</dt><dd> </dd>\r\n *   <dt>src</dt><dd>   </dd>\r\n *   <dt>payload</dt><dd>olleh.maps.Event  </dd>\r\n * </dl>\r\n * @example\r\n * // custom recognizer\r\n * $class('foo').mixin(olleh.maps.event.Recognizer).define({\r\n *   mousedown: function (event) {\r\n *     olleh.maps.log(event.timStamp);\r\n *   }),\r\n *   \r\n *   click: function (event) {\r\n *     if (true) {\r\n *       return {\r\n           name: 'fooClick' // \r\n           payload: { // olleh.maps.event.Event \r\n             originEvent: event.originEvent, \r\n             pageXY: event.pageXY\r\n           }\r\n        }\r\n *     }\r\n *   }\r\n *   ...\r\n * };\r\n * @summary     (drag, pinch )      .\r\n */\r\n$class('olleh.maps.event.Recognizer').define({\r\n  /**\r\n   * event     .\r\n   * @param {olleh.maps.event.Event} event ollehmap event \r\n   * @private\r\n   */\r\n  handle: function (event) {\r\n    if (!!this._disabled || event._stopPropagation) return;\r\n    var func = this[event.getName()];\r\n    return func && func.call(this, event);\r\n  },\r\n\r\n  /**\r\n   * Recognizer  .\r\n   * <p/>\r\n   * <code>false</code>     .\r\n   * @param {Boolean} enabled Recognizer  \r\n   */\r\n  setEnabled: function (enabled) {\r\n    this._disabled = !enabled;\r\n  },\r\n\r\n  /**\r\n   * Recognizer   .\r\n   * @returns {Boolean}\r\n   */\r\n  isEnabled: function () {\r\n    return !this._disabled;\r\n  }\r\n});/**\r\n *        mixin  ,    .\r\n * <p/>\r\n *        mixin  (, )       \r\n *   . \r\n * <h3>event handler </h3>\r\n *   {@link olleh.maps.event.Event}        .\r\n * <p/>\r\n * <dl>\r\n *   <dt>$capture_</dt><dd>{@link olleh.maps.event.Event.CAPTURING_PHASE}    </dd>\r\n *   <dt>$current_</dt><dd>{@link olleh.maps.event.Event.AT_TARGET}, {@link olleh.maps.event.Event.BUBBLING_PHASE}    </dd>\r\n *   <dt>$default_</dt><dd></dd>{@link olleh.maps.event.EventDelegator#onEvent} <code>capture</code> <code>false</code>        </dd>\r\n * </dl>\r\n * @example\r\n * $class('olleh.maps.handler.Desktop').define({\r\n * \r\n *   $capture_mousedown: function (event, payload) {\r\n *     olleh.maps.log.info(event.getName()); // mousedown\r\n *   },\r\n *\r\n *   $current_click: function (event, payload) {\r\n *     olleh.maps.log.info(event.getName()); // click\r\n *   },\r\n *\r\n *   $default_mousewheel: function (event, payload) {\r\n *     olleh.maps.log.info(event.timeStamp);\r\n *   }\r\n * });\r\n */\r\nolleh.maps.namespace('olleh.maps.event.handler', {\r\n  \r\n  // TODO FIXME Handler Class     member  delegator  copy     filter \r\n  _EXCLUDES: {$constructor: true, constructor: true, getClass: true, isMixinOf: true, currentStack : true, $classname: true},  \r\n\r\n  /**\r\n   *   <code>$capture_</code>, <code>$current_</code>, <code>$default_</code> \r\n   * {@link olleh.maps.event.EventDelegator} instance attach, class attach.\r\n   * <p/>\r\n   * <code>instance</code> attach   <code>instance</code> {@link olleh.maps.event.handler.detach}.\r\n   * \r\n   * <code>class</code> attach   <code>class</code> {@link olleh.maps.event.handler.detach}. \r\n   * @example\r\n   * olleh.maps.event.handler.attach(olleh.maps.Map, olleh.maps.event.handler.Drag);\r\n   * @example\r\n   * var map = new olleh.maps.Map(div, opts);\r\n   * olleh.maps.event.handler.attach(map, olleh.maps.event.handler.Drag);\r\n   * @param {olleh.maps.event.EventDelegator | class} delegator   delegator class\r\n   * @param {class} handlerClass\r\n   *   capture phase {@link olleh.maps.event.EventDeleagtor#onEvent}     \r\n   *     <code>$capture_</code> .\r\n   *   target, bubbling phase {@link olleh.maps.event.EventDeleagtor#onEvent}     \r\n   *     <code>$current_</code> .\r\n   *   target, bubbling phase {@link olleh.maps.event.EventDeleagtor#onEvent}     \r\n   *     <code>$default_</code> .\r\n   * @see olleh.maps.event.handler.detach\r\n   */\r\n  attach: function (delegator, handlerClass) {\r\n    if ( !delegator.isMixinOf || !delegator.isMixinOf(olleh.maps.event.EventDelegator)) {\r\n      delegator = delegator.prototype;\r\n    }\r\n    handlerClass = handlerClass.prototype;\r\n    \r\n    var backup = delegator['$eventHandler'] || {};\r\n    var fnName, originHandleFn;\r\n    var Event = olleh.maps.event.Event;\r\n    var events = delegator.$EVENTS;\r\n\r\n    for(fnName in handlerClass) {\r\n      if(this._EXCLUDES[fnName])\r\n        continue;\r\n      if(originHandleFn = delegator[fnName])\r\n        backup[fnName] = originHandleFn;\r\n      delegator[fnName] =  handlerClass[fnName];\r\n      \r\n      if (fnName.indexOf('$') != 0) {\r\n        continue;\r\n      }\r\n      var eventName = null;\r\n      if (fnName.indexOf('capture_') == 1) {\r\n        eventName = fnName.substring(9);\r\n        events[eventName] = events[eventName] | Event.CAPTURING_PHASE;\r\n      } else if (fnName.indexOf('current_') == 1) {\r\n        eventName = fnName.substring(9);\r\n        events[eventName] = events[eventName] | Event.AT_TARGET;\r\n      } else if (fnName.indexOf('default_') == 1) {\r\n        eventName = fnName.substring(9);\r\n        events[eventName] = events[eventName] | Event.DEFAULT_PHASE;\r\n      }\r\n    }\r\n    delegator['$eventHandler'] = backup;\r\n  },\r\n  \r\n  /**\r\n   *   <code>$capture_</code>, <code>$current_</code>, <code>$default_</code> \r\n   * {@link olleh.maps.event.EventDelegator} instance detach, class detach.\r\n   * <p/>\r\n   * <code>instance</code> attach   <code>instance</code> {@link olleh.maps.event.handler.detach}.\r\n   * \r\n   * <code>class</code> attach   <code>class</code> {@link olleh.maps.event.handler.detach}. \r\n   * @example\r\n   * olleh.maps.event.handler.detach(olleh.maps.Map, olleh.maps.event.handler.Drag);\r\n   * @param {olleh.maps.event.EventDelegator | class} delegator   delegator class\r\n   * @param {class} handlerClass\r\n   * @see olleh.maps.event.handler.attach\r\n   */\r\n  detach: function (delegator, handlerClass) {\r\n    if ( !delegator.isMixinOf || !delegator.isMixinOf(olleh.maps.event.EventDelegator)) {\r\n      delegator = delegator.prototype;\r\n    }\r\n    handlerClass = handlerClass.prototype;\r\n    \r\n    var backup = delegator['$eventHandler'];\r\n    \r\n    for(var fnName in handlerClass) {\r\n      if(this._EXCLUDES[fnName])\r\n        continue;\r\n      if(backup && backup[fnName]) {\r\n        delegator[fnName] = backup[fnName];\r\n        delete backup[fnName];\r\n      } else {\r\n        delete delegator[fnName];\r\n      }\r\n    }\r\n  }\r\n});\r\n/**\n * Map  corner DOM  \n */\n$class('olleh.maps.control.Corner').define({\n  \n  /**\n   * ,  Corner  .\n   * @param {String} position <p/>  :\n   *        <ul>\n   *        <li>{@link olleh.maps.control.Control.BOTTOM_LEFT}</li>\n   *        <li>{@link olleh.maps.control.Control.TOP_LEFT}</li>\n   *        <li>{@link olleh.maps.control.Control.BOTTOM_RIGHT}</li>\n   *        <li>{@link olleh.maps.control.Control.TOP_RIGHT}</li>\n   *        </ul>\n   */\n  Corner: function (position) {\n    var elem = olleh.maps.Element.create('div');\n\n    this.elem = elem;\n    this.ctrls = [];\n    this.vAlign = position.indexOf('top') !== -1 ? 'top' : 'bottom';\n\n    if (position.indexOf('left') !== -1) {\n      this.hAlign = 'left';\n      this.horizontalArea = this._createInnerDom();\n      this.verticalArea = this._createInnerDom();\n    } else {\n      this.hAlign = 'right';\n      this.verticalArea = this._createInnerDom();\n      this.horizontalArea = this._createInnerDom();\n      elem.elem.setAttribute('align', this.hAlign);\n    }\n    elem.addClass('ollehmap-corner');\n    elem.addClass('ollehmap-noevent');\n    elem.setStyle(this.vAlign, '0px');\n    elem.setStyle(this.hAlign, '0px');\n  },\n\n  /**\n   *  corner   inner dom .\n   * @private\n   */\n  _createInnerDom: function () {\n    var elem = olleh.maps.Element.create('div');\n\n    elem.addClass('ollehmap-corner-area');\n    elem.setStyle('verticalAlign', this.vAlign);\n    this.elem.pushElement(elem);\n    return elem;\n  }\n});\n/**\r\n * control position direction      .\r\n */\r\n$class('olleh.maps.control.ControlManager').define({\r\n\r\n  /**\r\n   * ,  ControlManager  .\r\n   * @param {olleh.maps.Map} map\r\n   */\r\n  ControlManager: function (map) {\r\n    this._ctrls = [];\r\n    this._corners = [];\r\n    this.map = map;\r\n    this._defaultMargin = 5;\r\n\r\n    var corners = this._corners;\r\n    var cornerClass = olleh.maps.control.Corner;\r\n    var ctrlClass = olleh.maps.control.Control;\r\n    var positions = [ ctrlClass.TOP_LEFT, ctrlClass.TOP_RIGHT, ctrlClass.BOTTOM_LEFT, ctrlClass.BOTTOM_RIGHT ];\r\n    var key, corner;\r\n    var i = positions.length;\r\n    var fragment = document.createDocumentFragment();\r\n\r\n    while (i--) {\r\n      key = positions[i];\r\n      corner = new cornerClass(key);\r\n      corners[key] = corner;\r\n      fragment.appendChild(corner.elem.elem);\r\n    }\r\n    map.elem.appendChild(fragment);\r\n  },\r\n\r\n  /**\r\n   * ControlManager   control draw()  .\r\n   */\r\n  start: function () {\r\n    this._started = true;\r\n    var len = this._ctrls.length;\r\n    this._opts = olleh.maps.util.clone(this.map.getOptions());\r\n    for ( var i = 0; i < len; i++) {\r\n      this.draw(this._ctrls[i]);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.control.Control} ctrl\r\n   * @returns {String} className\r\n   */\r\n  _getCtrlClassName: function (ctrl) {\r\n    var cn = ctrl.$classname;\r\n    cn = cn.substring(cn.lastIndexOf('.') + 1);\r\n    cn = cn.charAt(0).toLowerCase() + cn.substr(1);\r\n\r\n    return cn;\r\n  },\r\n\r\n  /**\r\n   * @returns {Boolean}\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @param {olleh.maps.control.Control} ctrl  \r\n   */\r\n  add: function (ctrl) {\r\n    this._ctrls.push(ctrl);\r\n    ctrl.mgr = this;\r\n    if (this.isStarted()) {\r\n      this.draw(ctrl);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.control.Control} ctrl\r\n   */\r\n  draw: function (ctrl) {\r\n    // map option    false     .\r\n    var opts = this._opts;\r\n    var cn = this._getCtrlClassName(ctrl);\r\n    var option = opts[cn + 'Options'];\r\n    ctrl.start();\r\n    option && olleh.maps.mixin(ctrl, option, true);\r\n\r\n    ctrl.elem = ctrl.draw();\r\n    ctrl.setDrawn(true);\r\n    this._updatePosition(ctrl);\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.control.Control} ctrl\r\n   * @private\r\n   */\r\n  _updatePosition: function (ctrl) {\r\n    var corner = this._corners[ctrl.position];\r\n    var direction = ctrl.direction;\r\n    var cornerDOM = corner[direction + 'Area'].elem;\r\n    var container = olleh.maps.Element.create('div');\r\n    var containerDOM = container.elem;\r\n\r\n    corner.ctrls.push(ctrl);\r\n    container.addClass('ollehmap-corner-container');\r\n    container.pushElement(ctrl.elem.elem);\r\n    if (direction === 'vertical') {\r\n      if (corner.vAlign === 'bottom')\r\n        cornerDOM.insertBefore(containerDOM, cornerDOM.firstChild);\r\n      else\r\n        cornerDOM.appendChild(containerDOM);\r\n    } else {\r\n      container.setStyle('verticalAlign', corner.vAlign);\r\n      container.addClass('olleh-maps-inline');\r\n\r\n      if (corner.hAlign === 'left')\r\n        cornerDOM.appendChild(containerDOM);\r\n      else\r\n        cornerDOM.insertBefore(containerDOM, cornerDOM.firstChild);\r\n    }\r\n    if (corner.hAlign === 'right') {\r\n      container.addClass('ollehmap-control-rightAlign');\r\n      ctrl.elem.elem.setAttribute('align', 'left');\r\n    }\r\n    ctrl.left && container.setStyle('paddingLeft', ctrl.left + 'px');\r\n    ctrl.right && container.setStyle('paddingRight', ctrl.right + 'px');\r\n    ctrl.top && container.setStyle('paddingTop', ctrl.top + 'px');\r\n    ctrl.bottom && container.setStyle('paddingBottom', ctrl.bottom + 'px');\r\n    ctrl._containerDOM = container;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.control.Control} ctrl  \r\n   */\r\n  remove: function (ctrl) {\r\n    var ctrls = this._ctrls;\r\n    olleh.maps.util.removeFromArray(ctrls, ctrl);\r\n    ctrls = this._corners[ctrl.position].ctrls;\r\n    olleh.maps.util.removeFromArray(ctrls, ctrl);\r\n\r\n    if (this.isStarted()) {\r\n      ctrl.destroy();\r\n      ctrl._containerDOM && olleh.maps.util.dom.removeElements(ctrl._containerDOM.elem);\r\n    }\r\n    ctrl = null;\r\n  },\r\n\r\n  /**\r\n   *  class     .\r\n   * @param {String} cls class\r\n   */\r\n  removeByClass: function (cls) {\r\n    var ctrls = this._ctrls;\r\n    var i = ctrls.length;\r\n    while (i--) {\r\n      var ctrl = ctrls[i];\r\n      if (ctrl instanceof cls) {\r\n        ctrl.setMap(null);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  class     . TODO service id     \r\n   * @param {String} cls class\r\n   * @returns {olleh.maps.control.Control}\r\n   */\r\n  findByClass: function (cls) {\r\n    var ctrls = this._ctrls;\r\n    var i = ctrls.length;\r\n    while (i--) {\r\n      var ctrl = ctrls[i];\r\n      if (ctrl instanceof cls) {\r\n        return ctrl;\r\n      }\r\n    }\r\n  },\r\n\r\n  stop: function () {\r\n    var i = this._ctrls.length;\r\n    while (i--) {\r\n      this._ctrls[i].stop();\r\n    }\r\n    this._started = false;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  removeAll: function () {\r\n    var ctrl, ctrls = this._ctrls;\r\n\r\n    while (ctrl = ctrls.pop()) {\r\n      ctrl.setMap(null);\r\n    }\r\n  }\r\n});/**\r\n * ControlOptions Object Specification\r\n * @typedef olleh.maps.control.ControlOptions\r\n * @property {String} [direction]   . <p/> :\r\n *           <ul>\r\n *           <li>{@link olleh.maps.control.Control.HORIZONTAL}</li>\r\n *           <li>{@link olleh.maps.control.Control.VERTICAL}</li>\r\n *           </ul>\r\n * @property {String} [position]  . <p/> :\r\n *           <ul>\r\n *           <li>{@link olleh.maps.control.Control.BOTTOM_LEFT}</li>\r\n *           <li>{@link olleh.maps.control.Control.TOP_LEFT}</li>\r\n *           <li>{@link olleh.maps.control.Control.BOTTOM_RIGHT}</li>\r\n *           <li>{@link olleh.maps.control.Control.TOP_RIGHT}</li>\r\n *           </ul>\r\n * @property {Number} [right] control     px\r\n * @property {Number} [left] control     px\r\n * @property {Number} [top] control     px\r\n * @property {Number} [bottom] control     px\r\n */\r\n\r\n/**\r\n *          .\r\n * TODO: olleh.maps.Initializable \r\n */\r\n$class('olleh.maps.control.Control').mixin(olleh.maps.event.EventDelegator, olleh.maps.Adaptable).define({\r\n\r\n  $static: {\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    BOTTOM_LEFT: 'bottom_left',\r\n\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    BOTTOM_RIGHT: 'bottom_right',\r\n\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    TOP_LEFT: 'top_left',\r\n\r\n    /**\r\n     *     position \r\n     * @type String\r\n     */\r\n    TOP_RIGHT: 'top_right',\r\n\r\n    /**\r\n     *    direction \r\n     * @type String\r\n     */\r\n    HORIZONTAL: 'horizontal',\r\n\r\n    /**\r\n     *    direction \r\n     * @type String\r\n     */\r\n    VERTICAL: 'vertical',\r\n\r\n    /**\r\n     * @constant\r\n     * @type String\r\n     */\r\n    //IMG_URL: '../../resources/img/controls.png'\r\n    IMG_URL: olleh.maps.env.RESOURCE_URL + 'img/controls.png'\r\n  },\r\n\r\n  /**\r\n   * ,  Control  .\r\n   * @param {Object} [opts]  \r\n   */\r\n  Control: function (opts) {\r\n    this.mgr;\r\n    this.elem = null;\r\n    this.padding = 5;\r\n    this._isDrawn = false;\r\n    this._opts = opts;\r\n  },\r\n\r\n  /**\r\n   *  start .\r\n   */\r\n  start: function () {\r\n    this._started = true;\r\n    this.initOptions();\r\n  },\r\n\r\n  /**\r\n   *  option  .\r\n   * @private\r\n   */\r\n  initOptions: function () {\r\n    olleh.maps.mixin(this, this._opts, true);\r\n  },\r\n\r\n  /**\r\n   *  stop .\r\n   */\r\n  stop: function () {\r\n    this._started = false;\r\n  },\r\n\r\n  /**\r\n   *  start    .\r\n   * @returns {Boolean}\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n\r\n  /**\r\n   *   .     .\r\n   * @param {String} position  \r\n   */\r\n  setPosition: function (position) {\r\n    this.position = position;\r\n    if (this.isStarted()) {// isStarted ??\r\n      this.mgr.remove(this);\r\n      this.mgr.add(this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    .     .\r\n   * @param {String} direction  \r\n   */\r\n  setDirection: function (direction) {\r\n    this.direction = direction;\r\n    if (this.isStarted()) {// isStarted ??\r\n      this.mgr.remove(this);\r\n      this.mgr.add(this);\r\n    }\r\n  },\r\n\r\n  attach: function () {\r\n    this.mgr = this.map.controlMgr;\r\n    this.mgr.add(this);\r\n  },\r\n\r\n  detach: function () {\r\n    this.mgr.remove(this);\r\n  },\r\n\r\n  /**\r\n   * Control       .  ,  {@link #draw}    \r\n   * true    ,  {@link #draw}   {@link #destroy}   \r\n   * false .\r\n   * @returns {Boolean} isDrawn\r\n   */\r\n  isDrawn: function () {\r\n    return this._isDrawn;\r\n  },\r\n\r\n  setDrawn: function (isDrawn) {\r\n    this._isDrawn = isDrawn;\r\n  },\r\n\r\n  /**\r\n   *  .   element  . \r\n   * {@link olleh.maps.event.EventDelegator#registerEventDom}    \r\n   * element   .\r\n   * @returns {olleh.maps.Element}  element\r\n   */\r\n  draw: function () {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.control.Control#draw}    .   \r\n   * element  pane     . \r\n   * {@link olleh.maps.event.EventDelegator#unregisterEvent}     .\r\n   *\r\n   * TODO: destroy -> erase:       erase   \r\n   * @private\r\n   */\r\n  destroy: function () {\r\n    this.unregisterEvent();\r\n    this.mgr = null;\r\n    if (this.elem) {\r\n      olleh.maps.util.dom.removeElements(this.elem.elem);\r\n      this.elem = null;\r\n    }\r\n    this._isDrawn = false;\r\n  },\r\n\r\n  /**\r\n   * Control  bubble target  Map.\r\n   * @returns {olleh.maps.Map}\r\n   * @see olleh.maps.event.EventDelegator#getBubble\r\n   */\r\n  getBubble: function () {\r\n    return this.mgr.map;\r\n  }\r\n});\r\n/**\r\n * @typedef olleh.maps.layer.LayerOptions\r\n * @property {String} [name] Layer \r\n * @property {olleh.maps.Map} [map] Layer    \r\n * @property {String} [layerType=base] Layer .\r\n *        <p>:\r\n *        <ul><li>\"base\"  base layer  . </li><li>\"ground\"  ground layer  .</li></ul>\r\n * @property {Number} [zIndex=0] ground layer     index. \r\n *     0   zIndex   layer    .\r\n * @property {String} [label]   \r\n * @property {String} [group] PluginControl   group \r\n * @property {Boolean} [autoActivate] ground layer   true    activate   .\r\n * @property {string} [copyright] CopyrightControl    . Layer  base   .\r\n */\r\n\r\n/**\r\n * Layer      . <p/>\r\n *    option  layer    .\r\n * @example\r\n * new MyLayer({\r\n *  map: map,\r\n *  layerType: 'base' | 'ground',\r\n *  zIndex: 0,\r\n *  name: 'OllehMap',\r\n *  label: '',\r\n *  group: 'PluginGroup1'\r\n * });\r\n * <p/>\r\n *   Layer    layer    .\r\n * @example\r\n *  $class('MyLayer').extend(olleh.maps.layer.Layer).define({\r\n *    MyLayer: function() {\r\n *     this.layerType = 'base';\r\n *     this.zIndex = 0;\r\n *     this.name = 'OllehMap';\r\n *     this.label = '';\r\n *     this.group = 'PluginGroup1';\r\n *    }\r\n *  \r\n */\r\n$class('olleh.maps.layer.Layer').extend(olleh.maps.Initializable).mixin(olleh.maps.event.EventDelegator, olleh.maps.Plugin)\r\n    .define({\r\n      \r\n      /**\r\n       * Layer      \r\n       * @name event:added\r\n       * @event\r\n       * @memberOf olleh.maps.layer.Layer.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       * Layer      \r\n       * @name event:removed\r\n       * @event\r\n       * @memberOf olleh.maps.layer.Layer.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      \r\n      /**\r\n       * Layer . LayerManager#getLayer()   layer    .\r\n       * @type String\r\n       */\r\n      name: 'Layer',\r\n      \r\n      /**\r\n       * Layer . base  ground .\r\n       * @type String\r\n       */\r\n      layerType: 'ground',\r\n      \r\n      /**\r\n       * Ground Layer    layer  zIndex\r\n       * @type Number\r\n       */\r\n      zIndex: 0,\r\n      \r\n      /**\r\n       *   \r\n       * @name olleh.maps.layer.Layer#label\r\n       * @type String\r\n       */\r\n      /**\r\n       * PluginControl   group \r\n       * @name olleh.maps.layer.Layer#group\r\n       * @type String\r\n       */\r\n      /**\r\n       * layer   copyright . Layer  base   .  \r\n       * @name olleh.maps.layer.Layer#copyright\r\n       * @type String\r\n       */\r\n      /**\r\n       * true      activate .\r\n       * true   Layer  setVisible(false)  . \r\n       * @name olleh.maps.layer.Layer#autoActivate\r\n       * @type Boolean\r\n       */\r\n            \r\n      /**\r\n       * Layer \r\n       * @param {olleh.maps.layer.LayerOptions} opts  \r\n       */\r\n      Layer: function (opts) {\r\n        /**\r\n         * Layer   LayerManager\r\n         * @type olleh.maps.layer.LayerManager\r\n         */\r\n        this.layerMgr = null;\r\n        \r\n        this._constructorOpts = opts || {};\r\n      },\r\n      \r\n      /**\r\n       *      .  option  layer  .\r\n       */\r\n      init: function() {\r\n        olleh.maps.mixin(this, this._constructorOpts, true, ['name','layerType','zIndex','label','group','autoActivate','copyright']);\r\n        // layer  pluginInfo  .\r\n        var pluginInfo = {};\r\n        this.label && (pluginInfo.label = this.label);\r\n        if(this.layerType === 'base') {\r\n          pluginInfo.group = '$baseLayer';\r\n        } else if (this.group) {\r\n          pluginInfo.group = this.group;\r\n        }\r\n        pluginInfo.autoActivate = this.autoActivate;\r\n        !this.autoActivate && this.setVisible(false);\r\n        this.setPluginInfo(pluginInfo);\r\n        this._constructorOpts.map && this.setMap(this._constructorOpts.map);\r\n        \r\n        delete this._constructorOpts;\r\n      },\r\n\r\n      /**\r\n       * Layer  bubble target  LayerManager .\r\n       * @returns {olleh.maps.layer.LayerManager} \r\n       */\r\n      getBubble: function () {\r\n        return this.layerMgr;\r\n      },\r\n\r\n      /**\r\n       * Layer   pane  return .  class     .\r\n       * @returns {HTMLElement}\r\n       */\r\n      getPane: function () {\r\n        return null;\r\n      },\r\n            \r\n      /**\r\n       * Animation     .\r\n       * @private \r\n       */\r\n      move: function () {\r\n        this.moveStart();\r\n        this.moveEnd();\r\n      },\r\n\r\n      /**\r\n       * Animation       animation  .\r\n       * Animation    moveEnd()  .\r\n       *  Animation      \r\n       *  animation   moveStart()    animation  \r\n       * moveEnd()   .\r\n       * @private   \r\n       */\r\n      moveStart: function () {\r\n\r\n      },\r\n\r\n      /**\r\n       * Animation       animation  .\r\n       * @private\r\n       */\r\n      moveEnd: function () {\r\n\r\n      },\r\n\r\n      /**\r\n       * Layer  .\r\n       * @param {Boolean} mapStart     draw   true    false .\r\n       * @private  \r\n       */\r\n      draw: function (mapStart) {\r\n\r\n      },\r\n\r\n      /**\r\n       *     LayerManager  . Layer    origin  \r\n       * scale      .\r\n       * @param {Number} scale \r\n       * @param {olleh.maps.Point} origin    layer offset  \r\n       * @param {Number} duration    \r\n       * @param {olleh.maps.fx.Pulse} [pulse] .      .\r\n       * @private\r\n       */\r\n      zoomStart: function (scale, origin, duration, pulse) {\r\n\r\n      },\r\n\r\n      /**\r\n       * zoom    LayerManager   .\r\n       * @private\r\n       */\r\n      zoomEnd: function (oldZoom, newZoom) {\r\n\r\n      },\r\n\r\n      /**\r\n       * layer      . <br>\r\n       *  <br>\r\n       * NOTE: Base Layer  LayerManager#setActiveBaseLayer(layer)    .\r\n       *  Base layer         . \r\n       * @param {Boolean} visible\r\n       * @private\r\n       */\r\n      setVisible: function (visible) {\r\n\r\n      },\r\n      \r\n      /**\r\n       * layer     \r\n       * @returns {Boolean}\r\n       * @private\r\n       */\r\n      isVisible: function () {\r\n\r\n      },\r\n\r\n      isVisibleForZoom: function () {\r\n        return true;\r\n      },\r\n      \r\n      /**\r\n       * Layer  start .\r\n       * @private\r\n       */\r\n      start: function () {\r\n        this._started = true;\r\n      },\r\n\r\n      /**\r\n       * Layer  stop .\r\n       * @private\r\n       */\r\n      stop: function () {\r\n        this._started = false;\r\n      },\r\n\r\n      /**\r\n       * Layer  start    .\r\n       * @returns {Boolean}\r\n       * @private\r\n       */\r\n      isStarted: function () {\r\n        return !!this._started;\r\n      },\r\n      \r\n      /**\r\n       * base layer  LayerManager   active base layer  , ground layer   draw()  setVisible(false)  . \r\n       * @private\r\n       */\r\n      doActivate: function() {\r\n        this.setVisible(true);\r\n        if(this.layerType === 'base') {\r\n          this.layerMgr.setActiveBaseLayer(this);\r\n        } else if(this.layerMgr.isStarted()){\r\n          this.draw();\r\n        }\r\n      },\r\n\r\n      /**\r\n       * active   visible   .\r\n       * @param active\r\n       * @private\r\n       */\r\n      setActive: function(active) {\r\n        this.setVisible(active);\r\n        olleh.maps.Plugin.prototype.setActive.call(this, active);        \r\n      },\r\n      \r\n      /**\r\n       * Layer   .  \r\n       * @returns {Boolean}\r\n       */\r\n      isActive: function() {\r\n        if(!this.layerMgr)\r\n          return false;\r\n        if(this.layerType === 'base') {\r\n          return this.layerMgr.getActiveBaseLayer() === this;\r\n        }\r\n        return this.isVisible();\r\n      },\r\n      \r\n      attach: function() {\r\n        this.map.layerMgr.addLayer(this);\r\n      },\r\n      \r\n      detach: function() {\r\n        this.map.layerMgr.removeLayer(this);\r\n      }\r\n\r\n    });\r\n/**\n * LayerManager  Layer        . \n */\n$class('olleh.maps.layer.LayerManager').mixin(olleh.maps.event.EventDelegator).define({\n\n  $static: {\n    /**\n     *    resoultion  .\n     * @param zoom\n     * @private\n     */\n    getResolutionForZoom: function (zoom) {\n      return 2048 / Math.pow(2, zoom);\n    }\n  },\n\n  defaultOpts: {\n    zoom: 7,\n    minZoom: 0,\n    maxZoom: 13,\n    maxExtent: null,\n    panAnimDuration: 1.0, // panTo()  . /    \n    zoomAnimDuration: 0.2, // zoomIn()/zoomOut()/zoomTo()  \n    useCSSTransform: true\n  },\n\n  /**\n   *       .\n   *        draw   zoom_change   . \n   * @name event:zoom_change\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   * @param {Object} payload\n   * @param {Number} payload.oldZoom   \n   * @param {Number} payload.newZoom   \n   * @param {olleh.maps.Point} payload.origin   \n   * @param {Number} payload.duration    \n   * @param {Number} payload.scale   \n   * @see olleh.maps.layer.Layer#event:zoom_changed\n   */\n  /**\n   * /   \n   * @name event:zoomrange_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   *      \n   * @name event:center_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   * @param {Object} payload\n   * @param {olleh.maps.UTMK} payload.oldCenter  \n   * @param {olleh.maps.UTMK} payload.newCenter  \n   */\n  /**\n   *      \n   * @name event:zoom_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   * @param {Object} payload\n   * @param {olleh.maps.UTMK} payload.oldZoom  \n   * @param {olleh.maps.UTMK} payload.newZoom  \n   * @see olleh.maps.layer.Layer#event:zoom_change\n   */\n  /**\n   *       \n   * center_changed  zoom_changed     .\n   * @name event:bounds_changed\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   * {@link olleh.maps.layer.Layer#start}   LayerManager    \n   * @name event:started\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   *    ,   , /          \n   *         .\n   * @name event:idle\n   * @event\n   * @memberOf olleh.maps.layer.LayerManager.prototype\n   * @param {olleh.maps.event.Event} event\n   */\n  /**\n   *  \n   * @param {olleh.maps.Map} map Map \n   * @param {Element} elem Map  HTML element\n   */\n  LayerManager: function (map, elem) {\n    if (map === null)\n      throw new Error('map is null');\n\n    this._center = null;\n    this._zoom = null;\n    this._minZoom = null;\n    this._maxZoom = null;\n\n    this._map = map;\n    this._mapElem = elem;\n    this._viewportSize = null;\n    this._viewportOffset = null; //  viewport  ( )\n\n    this._layerOffset = new olleh.maps.Point(0, 0); // root_pane offset. move   layerOffset  .\n    this._pendingZoom = null; //       zoom \n    this._pendingCenter = null; //       center\n    this._isZooming = false; //   \n\n    this._baseLayers = [];\n    this._groundLayers = [];\n    this._activeBaseLayer = null;\n    this._overlayLayer = null;\n\n    this._root_pane = null;\n    this._transparent_pane = null;\n    this._layer_container = null;\n\n    this._panAnimTiming = null;\n  },\n\n  /**\n   * LayerManager  bubble  Map .\n   * @returns {olleh.maps.Map}\n   * @private\n   */\n  getBubble: function () {\n    return this._map;\n  },\n\n  /**\n   * Map  .\n   * @returns {olleh.maps.Map}\n   */\n  getMap: function () {\n    return this._map;\n  },\n\n  // ////////////////////\n  // Pane Managements //\n  // ////////////////////\n  _initPanes: function () {\n    var layer_container = this._createPane('layer_container', 0);\n\n    this._layer_container = layer_container;\n    olleh.maps.util.dom.setStyles(layer_container, {\n      width: '100%',\n      height: '100%'\n    });\n    this._mapElem.appendChild(layer_container);\n    this._root_pane = this._createPane('root_pane', 0);\n    layer_container.appendChild(this._root_pane);\n\n    var transparent_pane = this._createPane('transparent_pane', 99999);\n    this._transparent_pane = transparent_pane;\n    layer_container.appendChild(transparent_pane);\n    olleh.maps.util.dom.setStyles(transparent_pane, {\n      width: '100%',\n      height: '100%',\n      display: 'none'\n    });\n    olleh.maps.util.dom.addClass(this._transparent_pane, 'ollehmap-transparent');\n  },\n\n  _createPane: function (id, zIndex) {\n    var pane = document.createElement('div');\n    pane.id = id;\n    pane.style.position = 'absolute';\n    if (olleh.maps.isNumber(zIndex)) {\n      pane.style.zIndex = zIndex;\n    }\n    return pane;\n  },\n\n  // /////////////////////\n  // Layer Managements //\n  // /////////////////////\n\n  /**\n   * Layer  . <p/>\n   * NOTE: Layer   {@link olleh.maps.layer.Layer#setMap(map)}   .\n   * @private  \n   */\n  addLayer: function (layer) {\n    if (layer.layerType === 'base') {\n      this.addBaseLayer(layer);\n    } else {\n      this.addGroundLayer(layer, layer.zIndex);\n    }\n  },\n\n  /**\n   * base layer  .\n   * @param {olleh.maps.layer.Layer} layer  Layer\n   * @private\n   */\n  addBaseLayer: function (layer) {\n    layer.layerMgr = this;\n    layer.setVisible(false);\n    layer.getPane().style.zIndex = '-2';\n    this._baseLayers.push(layer);\n\n    var addBaseLayer = function () {\n      !layer.isStarted() && layer.start();\n      var pane = layer.getPane();\n      this._root_pane.insertBefore(pane, this._root_pane.firstChild);\n      this.unsubscribeEvent('started', addBaseLayer);\n      layer.fireEvent('added');\n    };\n    if (this.isStarted()) {\n      addBaseLayer.call(this);\n      if (!this._activeBaseLayer) {\n        this.setActiveBaseLayer(layer);\n      }\n    } else {\n      this.onEvent('started', addBaseLayer, this);\n    }\n  },\n\n  /**\n   * ground layer  zIndex  . zIndex   z-index  .\n   * , zIndex       .\n   * @param {olleh.maps.layer.Layer} layer\n   * @param {Number} zIndex\n   * @private\n   */\n  addGroundLayer: function (layer, zIndex) {\n    layer.layerMgr = this;\n    layer.getPane().style.zIndex = zIndex;\n    this._groundLayers.push(layer);\n\n    var addGroundLayer = function () {\n      !layer.isStarted() && layer.start();\n      var pane = layer.getPane();\n      pane.style.position = 'absolute';\n      this._root_pane.appendChild(pane);\n      if (layer.isVisible()) {\n        layer.draw();\n      }\n      this.unsubscribeEvent('started', addGroundLayer);\n      layer.fireEvent('added');\n    };\n    if (this.isStarted()) {\n      addGroundLayer.call(this);\n    } else {\n      this.onEvent('started', addGroundLayer, this);\n    }\n  },\n\n  /**\n   * layer  .\n   * @param {olleh.maps.layer.Layer | String} layer  layer   name\n   * @private\n   */\n  removeLayer: function (layer) {\n    if (olleh.maps.isString(layer)) {\n      layer = this.getLayer(layer);\n    }\n    layer.layerMgr = null;\n    if (this.isStarted()) {\n      var pane = layer.getPane();\n      if (pane && pane.parentNode)\n        pane.parentNode.removeChild(pane);\n      layer.fireEvent('removed');\n    }\n    var idx = olleh.maps.util.removeFromArray(this._groundLayers, layer);\n    idx === -1 && olleh.maps.util.removeFromArray(this._baseLayers, layer);\n  },\n\n  /**\n   *  name  layer  .\n   * @param {String} layerName Layer name\n   * @private\n   */\n  getLayer: function (layerName) {\n    var i, len, layer;\n\n    for (i = 0, len = this._baseLayers.length; i < len; i++) {\n      layer = this._baseLayers[i];\n      if (layer.name === layerName)\n        return layer;\n    }\n    for (i = 0, len = this._groundLayers.length; i < len; i++) {\n      layer = this._groundLayers[i];\n      if (layer.name === layerName)\n        return layer;\n    }\n    if (layerName === 'olleh.maps.overlay.OverlayLayer') {\n      return this._overlayLayer;\n    }\n  },\n\n  /**\n   * LayerManager   base layer  .\n   * @returns {Array.<olleh.maps.layer.Layer>} Base Layer \n   * @private\n   */\n  getBaseLayers: function () {\n    return this._baseLayers;\n  },\n\n  /**\n   * LayerManager   ground layer  .\n   * @returns {Array.<olleh.maps.layer.Layer>} Ground Layer \n   * @private\n   */\n  getGroundLayers: function () {\n    return this._groundLayers;\n  },\n\n  /**\n   * OverlayLayer  .\n   * @returns {olleh.maps.overlay.OverlayLayer}\n   * @private\n   */\n  getOverlayLayer: function () {\n    return this._overlayLayer;\n  },\n\n  /**\n   * active base layer  .\n   * @param {olleh.maps.layer.Layer | String} layer\n   * @private\n   */\n  setActiveBaseLayer: function (layer) {\n    if (olleh.maps.isString(layer)) {\n      layer = this.getLayer(layer);\n    }\n\n    if (this._activeBaseLayer !== layer) {\n      var oldLayer = this._activeBaseLayer;\n      this._activeBaseLayer = layer;\n      layer.getPane().style.zIndex = '-1';\n      layer.setActive(true);\n      if (this.isStarted()) {\n        if (oldLayer) {\n          if (layer instanceof olleh.maps.layer.TileLayer) {\n            oldLayer.getPane().style.zIndex = '-2';\n            this._hideLayerFn = function () {\n\n              //      'loaded'      .\n              //         oldLayer    .\n              //           ,\n              //  oldlLayer  Layer .\n              //      Layer    \n              //     oldLayer.setActive(false)   \n              if(oldLayer.getPane().style.zIndex == '-2') oldLayer.setActive(false);\n              \n              layer.unsubscribeEvent('loaded', this._hideLayerFn, this);\n              this._hideLayerFn = null;\n            };\n            layer.onEvent('loaded', this._hideLayerFn, this);\n          } else {\n            oldLayer.setActive(false);\n          }\n        }\n        var minMaxZoomChanged = this._updateMinMaxZoom();\n        var zoom = Math.min(Math.max(this._zoom, this._minZoom),\n          this._maxZoom);\n        if (zoom !== this._zoom) {\n          this.moveTo(null, zoom, 'redraw');\n        } else {\n          this._activeBaseLayer.draw();\n        }\n        if (minMaxZoomChanged)\n          this.fireEvent('zoomrange_changed');\n      } else /* if(!this.isStarted()) */ {\n        if (oldLayer) {\n          oldLayer.setActive(false);\n        }\n      }\n    }\n    this.fireEvent('set_base_layer');\n  },\n\n  /**\n   *  minZoom .\n   * @param {number} minZoom \n   */\n  setMinZoom: function (minZoom) {\n    if (this.isStarted()) {\n      this._opts.minZoom = minZoom;\n      this._updateZoomRange();\n    }\n  },\n\n  /**\n   *  maxZoom .\n   * @param {number} maxZoom \n   */\n  setMaxZoom: function (maxZoom) {\n    if (this.isStarted()) {\n      this._opts.maxZoom = maxZoom;\n      this._updateZoomRange();\n    }\n  },\n\n  /**\n   * Active base layer  minZoom/maxZoom .  \n   * @private\n   */\n  _updateZoomRange: function () {\n    var minMaxZoomChanged = this._updateMinMaxZoom();\n    var zoom = Math.min(Math.max(this._zoom, this._minZoom),\n      this._maxZoom);\n    if (zoom !== this._zoom) {\n      this.moveTo(null, zoom, 'redraw');\n    }\n    if (minMaxZoomChanged)\n      this.fireEvent('zoomrange_changed');\n\n  },\n\n  /** \n   * active base layer   minZoom/maxZoom   .\n   * @returns {Boolean} minZoom/maxZoom  \n   * @private \n   */\n  _updateMinMaxZoom: function () {\n    var layer = this._activeBaseLayer;\n    // Map  maxZoom   (add code r2fresh)\n    var mapMaxZoom = this._map.getOptions().maxZoom;\n    var newMinZoom = this._opts.minZoom;\n    // mapMaxZoom   newMaxZoom   (modify code r2fresh)\n    var newMaxZoom = (mapMaxZoom && mapMaxZoom <= 15) ? mapMaxZoom : this._opts.maxZoom;\n\n    if (olleh.maps.isNumber(layer.minZoom)) {\n      newMinZoom = Math.max(layer.minZoom, newMinZoom);\n    }\n\n    // mapMaxZoom   newMaxZoom min     (modify code r2fresh)\n    if (olleh.maps.isNumber(layer.maxZoom) && !(mapMaxZoom && mapMaxZoom <= 15)) {\n      newMaxZoom = Math.min(layer.maxZoom, newMaxZoom);\n    }\n\n    var minMaxZoomChanged = false;\n    if (newMinZoom !== this._minZoom || newMaxZoom !== this._maxZoom) {\n      this._minZoom = newMinZoom;\n      this._maxZoom = newMaxZoom;\n      minMaxZoomChanged = true;\n    }\n    return minMaxZoomChanged;\n  },\n\n\n  /**\n   * active base layer  .\n   * @returns {olleh.maps.layer.Layer}\n   * @private\n   */\n  getActiveBaseLayer: function () {\n    return this._activeBaseLayer;\n  },\n\n  // //////////////////\n  // Map Operations //\n  // //////////////////\n\n  /**\n   *       .\n   * @param {olleh.maps.Bounds} bounds   \n   * @returns {Number}\n   * @private\n   */\n  getZoomForBounds: function (bounds) {\n    bounds = bounds.transform(olleh.maps.UTMK);\n    var zoom = this._minZoom;\n    var width = bounds.getWidth();\n    var height = bounds.getHeight();\n    for (; zoom <= this._maxZoom; zoom++) {\n      var coordSize = this._getCoordSizeForZoom(zoom);\n      if (coordSize.width < width || coordSize.height < height)\n        return zoom === this._minZoom ? this._minZoom : zoom - 1;\n    }\n    return zoom;\n  },\n\n  /**\n   * coord    (bounds)   .\n   * @param {olleh.maps.Coord} coord\n   * @returns {Boolean}\n   * @private\n   */\n  isValidCoord: function (coord) {\n    var bounds = this.getBounds();\n    return bounds.contains(coord);\n  },\n\n  /**\n   *   layer  start   center  zoom  draw  .\n   * 'started'  .\n   * @private\n   */\n  start: function () {\n    var opts = olleh.maps.util.clone(this.defaultOpts);\n    var i, len;\n\n    opts = olleh.maps.mixin(opts, this._map.getOptions(), true);\n    this._opts = opts;\n\n    this._minZoom = opts.minZoom;\n    this._maxZoom = opts.maxZoom;\n    this._viewportSize = new olleh.maps.Size(this._mapElem.clientWidth, this._mapElem.clientHeight);\n    this._viewportOffset = olleh.maps.util.dom.getXY(this._mapElem);\n    this._disableLoadingWhilePanning = this._map.getOption('disableLoadingWhilePanning', false);\n\n    if (!this._center && this._initialBounds) {\n      var bounds = this._initialBounds;\n      this._center = bounds.getCenter();\n      this._zoom = this.getZoomForBounds(bounds);\n      delete this._initialBounds;\n    }\n\n    // start   setCenter()  setZoom()     .\n    !this._center && (this._center = opts.center.asDefault());\n    !olleh.maps.isNumber(this._zoom) && (this._zoom = +opts.zoom);\n\n    this._panAnimTiming = new olleh.maps.fx.timing.CubicBezier(0, opts.panAnimEaseLinearity1, opts.panAnimEaseLinearity2, 1);\n    this._zoomPulse = olleh.maps.browser.usePulseForZoom ? new olleh.maps.fx.Pulse(opts.zoomAnimDuration) : false;\n\n    this._initPanes();\n\n    this._updateMinMaxZoom();\n    if (opts.overlayLayer) {\n      this._overlayLayer = opts.overlayLayer;\n      this._overlayLayer.map = this._map; // OverlayLayer  Adaptable type  map   \n      this._overlayLayer.layerMgr = this;\n      var panes = this._overlayLayer.panes;\n      for (var k in panes) {\n        this._root_pane.appendChild(panes[k]);\n      }\n    }\n    this.registerEventDom(this._layer_container);\n\n    for (i = 0, len = this._baseLayers.length; i < len; i++) {\n      this._baseLayers[i].start();\n    }\n    for (i = 0, len = this._groundLayers.length; i < len; i++) {\n      this._groundLayers[i].start();\n    }\n    this._overlayLayer && this._overlayLayer.start();\n\n    if (this._disableLoadingWhilePanning) {\n      var backgroundLayer = new olleh.maps.layer.BackgroundLayer();\n      backgroundLayer.layerMgr = this;\n      backgroundLayer.start();\n      var pane = backgroundLayer.getPane();\n      this._root_pane.appendChild(pane);\n      this._backgroundLayer = backgroundLayer;\n    }\n\n    this._started = true;\n    if (this._center)\n      this.moveTo(this._center, this._zoom, 'redraw');\n    this.fireEvent('started');\n  },\n\n  /**\n   *  layer  stop .\n   * @private\n   */\n  stop: function () {\n    var i, len;\n    for (i = 0, len = this._baseLayers.length; i < len; i++) {\n      this._baseLayers[i].stop();\n    }\n    for (i = 0, len = this._groundLayers.length; i < len; i++) {\n      this._groundLayers[i].stop();\n    }\n    this._overlayLayer && this._overlayLayer.stop();\n    this.unregisterEvent();\n    this._started = false;\n  },\n\n  /**\n   *   .\n   * @returns {Boolean}\n   * @private\n   */\n  isStarted: function () {\n    return !!this._started;\n  },\n\n  /**\n   *     resolution  .\n   * TODO resolution   tile spec       . \n   * TODO coord <-> point        \n   * @returns {Number}\n   * @private\n   */\n  getResolution: function () {\n    return 2048 / Math.pow(2, this._zoom);\n  },\n\n  /**\n   * Viewport size  .\n   * @returns {olleh.maps.Size}\n   * @private\n   */\n  getViewportSize: function () {\n    return this._viewportSize;\n  },\n\n  /**\n   * viewport   .\n   * @returns {olleh.maps.Point}\n   * @private\n   */\n  getViewportCenter: function () {\n    return new olleh.maps.Point(Math.floor(this._viewportSize.width / 2), Math.floor(this._viewportSize.height / 2));\n  },\n\n  /**\n   * Viewport pixel  .\n   * @returns {olleh.maps.Point} x  left, y  top  \n   * @private\n   */\n  getViewportOffset: function () {\n    return this._viewportOffset;\n  },\n\n  /**\n   *    viewport size  UTMK   .\n   * @param {Number} zoom\n   * @private \n   */\n  _getCoordSizeForZoom: function (zoom) {\n    var resolution = olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\n    return this._viewportSize.multiplyBy(resolution);\n  },\n\n  /**\n   * Layer offset  .\n   * @returns {olleh.maps.Point}\n   * @private\n   */\n  getLayerOffset: function () {\n    return this._layerOffset;\n  },\n\n  /**\n   * Viewport top-left  UTMK  .\n   * @param {boolean} [afterZoom] true          \n   * @returns {olleh.maps.UTMK}\n   * @private\n   */\n  _getCoordOrigin: function (afterZoom) {\n    if (!this._center)\n      throw new Error('Center must be specified.');\n    var zoom = afterZoom ? this.getPendingZoom() : this._zoom;\n    var center = afterZoom ? this.getPendingCenter() : this._center;\n    var coordSize = this._getCoordSizeForZoom(zoom);\n    var x = center.x - coordSize.width / 2;\n    var y = center.y + coordSize.height / 2;\n    return new olleh.maps.UTMK(x, y);\n  },\n\n  /**\n   *   viewport pixel  .\n   * @param {olleh.maps.Coord} coord   \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.Point}  viewport pixel \n   */\n  getViewportPxFromCoord: function (coord, afterZoom) {\n    afterZoom = afterZoom !== false;\n    coord = coord.asDefault();\n    var coordOrigin = this._getCoordOrigin(!!afterZoom);\n    var dx = coord.x - coordOrigin.x;\n    var dy = coordOrigin.y - coord.y;\n    var zoom = afterZoom ? this.getPendingZoom() : this._zoom;\n    var resolution = olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\n    return new olleh.maps.Point(dx / resolution, dy / resolution)._round();\n  },\n\n  /**\n   *   layer pixel  .\n   * @param {olleh.maps.Coord} coord   \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.Point}  layer pixel \n   */\n  getLayerPxFromCoord: function (coord, afterZoom) {\n    afterZoom = afterZoom !== false;\n    var viewportPx = this.getViewportPxFromCoord(coord, !!afterZoom);\n    return new olleh.maps.Point(viewportPx.x - this._layerOffset.x,\n      viewportPx.y - this._layerOffset.y)._round();\n  },\n\n  /**\n   * Viewport pixel  UTMK   .\n   * @param {olleh.maps.Point} viewportPx viewport pixel \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.UTMK}   \n   */\n  getCoordFromViewportPx: function (viewportPx, afterZoom) {\n    afterZoom = afterZoom !== false;\n    var zoom = afterZoom ? this.getPendingZoom() : this._zoom;\n    var resolution = olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\n    var coordOrigin = this._getCoordOrigin(!!afterZoom);\n    var dx = viewportPx.x * resolution;\n    var dy = viewportPx.y * resolution;\n    return new olleh.maps.UTMK(coordOrigin.x + dx, coordOrigin.y - dy);\n  },\n\n  /**\n   * Layer pixel  UTMK   .\n   * @param {olleh.maps.Point} layerPx layer pixel \n   * @param {boolean} [afterZoom=true] true          \n   * @returns {olleh.maps.UTMK}   \n   */\n  getCoordFromLayerPx: function (layerPx, afterZoom) {\n    afterZoom = afterZoom !== false;\n    var viewportPx = new olleh.maps.Point(layerPx.x\n      + this._layerOffset.x, layerPx.y + this._layerOffset.y);\n    return this.getCoordFromViewportPx(viewportPx, afterZoom);\n  },\n\n  /**\n   * Viewport pixel  layer pixel  .\n   * @param {olleh.maps.Point} viewportPx viewport pixel \n   * @returns {olleh.maps.Point}  layer pxiel \n   */\n  getLayerPxFromViewportPx: function (viewportPx) {\n    return new olleh.maps.Point(viewportPx.x - this._layerOffset.x,\n      viewportPx.y - this._layerOffset.y);\n  },\n\n  /**\n   * Layer pixel  viewport pixel  .\n   * @param {olleh.maps.Point} layerPx layer pixel \n   * @returns {olleh.maps.Point}  viewport pixel \n   */\n  getViewportPxFromLayerPx: function (layerPx) {\n    return new olleh.maps.Point(layerPx.x + this._layerOffset.x,\n      layerPx.y + this._layerOffset.y);\n  },\n\n  /**\n   *    .\n   * @returns {olleh.maps.UTMK}  \n   * @private\n   */\n  getCenter: function () {\n    return this._center;\n  },\n\n  /**\n   * viewport     UTMK  .\n   * @returns {olleh.maps.Bounds}  \n   * @private\n   */\n  getBounds: function () {\n    var coordSize = this._getCoordSizeForZoom(this._zoom);\n    // left bottom\n    var x1 = this._center.x - coordSize.width / 2;\n    var y1 = this._center.y - coordSize.height / 2;\n    // right top\n    var x2 = this._center.x + coordSize.width / 2;\n    var y2 = this._center.y + coordSize.height / 2;\n\n    return new olleh.maps.Bounds(new olleh.maps.UTMK(x1, y1),\n      new olleh.maps.UTMK(x2, y2));\n  },\n\n  /**\n   *   .\n   * @returns {Number}  \n   * @private\n   */\n  getZoom: function () {\n    return this._zoom;\n  },\n\n  /**\n   *    .\n   * @returns {Number}   \n   * @private\n   */\n  getMinZoom: function () {\n    return this._minZoom;\n  },\n\n  /**\n   *    .\n   * @returns {Number}   \n   * @private\n   */\n  getMaxZoom: function () {\n    return this._maxZoom;\n  },\n\n  /**\n   *         .\n   * @param {Number} newZoom   \n   * @private \n   */\n  _getScaleForZoom: function (newZoom) {\n    return Math.pow(2, newZoom - this._zoom);\n  },\n\n  /**\n   *      .\n   * @param changeAmount  \n   * @private\n   */\n  _getScaleForChanges: function (changeAmount) {\n    return Math.pow(2, changeAmount);\n  },\n\n  /**\n   *     .\n   * @param scale \n   * @private\n   */\n  _getZoomForScale: function (scale) {\n    return this._zoom + (Math.log(scale) / Math.LN2);\n  },\n\n  /**\n   *  .\n   * @param {Number} zoom  \n   * @private\n   */\n  setZoom: function (zoom) {\n    this.moveTo(null, zoom, 'on');\n  },\n\n  /**\n   *  1 .\n   * @private\n   */\n  zoomIn: function () {\n    this.setZoom(this.getPendingZoom() + 1);\n  },\n\n  /**\n   *  1 .\n   * @private\n   */\n  zoomOut: function () {\n    this.setZoom(this.getPendingZoom() - 1);\n  },\n\n  /**\n   * fitBounds()         animation  \n   * @param {olleh.maps.Bounds} bounds  \n   * @private\n   */\n  panToBounds: function (bounds) {\n    var center = bounds.getCenter();\n    var zoom = this.getZoomForBounds(bounds);\n    this.panTo(center, zoom);\n  },\n\n  /**\n   *  bounds     .\n   * @param {olleh.maps.Bounds} bounds\n   * @private\n   */\n  fitBounds: function (bounds) {\n    if (!this.isStarted()) {\n      this._initialBounds = bounds;\n    } else {\n      var center = bounds.getCenter();\n      var zoom = this.getZoomForBounds(bounds);\n      this.moveTo(center, zoom, 'redraw');\n    }\n  },\n\n  /**\n   *  x  dx  , y  dy     . \n   *       animation   .\n   * @param {Number} dx x   .   .\n   * @param {Number} dy y   .   .\n   * @private\n   */\n  panBy: function (dx, dy) {\n    var newCenter = this.calcNewCenter(dx, dy);\n    this.panTo(newCenter, this._zoom);\n  },\n\n  /**\n   *  center   dx, dy    . \n   * @param dx x     \n   * @param dy y     \n   * @returns {olleh.maps.UTMK}  \n   * @private\n   */\n  calcNewCenter: function (dx, dy) {\n    var resolution = this.getResolution();\n    var _dx = dx * resolution;\n    var _dy = dy * resolution;\n    return new olleh.maps.UTMK(this._center.x + _dx, this._center.y - _dy);\n  },\n\n  /**\n   *   center  .      \n   * animation   .\n   * @param {olleh.maps.Coord} center    \n   * @param {number} [zoom]  zoom\n   * @param {string} [animation=auto] 'off'     .\n   *                             'auto'            . \n   * @private\n   */\n  panTo: function (center, zoom, animation) {\n    center = center.asDefault();\n    this.moveTo(center, zoom, animation || 'auto');\n  },\n\n  /**\n   * dx, dy  layer offset  . argument   layer offset  \n   * 0,0  reset .\n   * @param {Number} dx  \n   * @param {Number} dy \n   * @private\n   */\n  _moveRootPane: function (dx, dy) {\n    if (arguments.length >= 2) {\n      this._layerOffset._add(dx, dy);\n    } else {\n      this._layerOffset.x = 0;\n      this._layerOffset.y = 0;\n    }\n    var styles = this._getPositionStyles();\n\n    olleh.maps.util.dom.setStyles(this._root_pane, styles);\n  },\n\n  _getPositionStyles: function () {\n    return olleh.maps.util.dom.getPositionStyles(this._layerOffset.x,\n      this._layerOffset.y, this._opts.useCSSTransform, olleh.maps.browser.use3DRootPane);\n  },\n\n  /**\n   * dx, dy  layer offset     . \n   * @param {Number} dx  \n   * @param {Number} dy \n   * @param {Number} animationDuration animation   \n   * @param {Function} animationCallback animation    callback function \n   * @private\n   */\n  _panRootPane: function (dx, dy, animationDuration, animationCallback) {\n    var currentStyles = this._getPositionStyles();\n    this._layerOffset._add(dx, dy);\n    var styles = this._getPositionStyles();\n    this._rootPaneAnimator = new olleh.maps.fx.Animation({\n      from: currentStyles,\n      to: styles,\n      duration: animationDuration,\n      timing: this._panAnimTiming,\n      callback: animationCallback ? animationCallback.bind(this) : null,\n      pulse: true\n    }).animate(this._root_pane);\n  },\n\n  /**\n   *  pan animation    center  update . \n   * @private\n   */\n  _abortPanAnimationAndUpdateCenter: function () {\n    if (!this._isZooming && this._rootPaneAnimator && this._rootPaneAnimator.status === 'started') {\n      var currentStyles = this._rootPaneAnimator.abort();\n      var currentPosition = olleh.maps.util.dom.getPointFromStyle(currentStyles);\n      var diff = this._layerOffset.subtract(currentPosition);\n      this._layerOffset = currentPosition;\n      var newCenter = this.calcNewCenter(diff.x, diff.y);\n      this._center = newCenter;\n      if (!this._disableLoadingWhilePanning)\n        this._moveLayers();\n      this._resetIdleTimer();\n    }\n  },\n\n  /**\n   *   coord  .\n   * @param {olleh.maps.Coord} center\n   * @private\n   */\n  setCenter: function (center) {\n    center = center.asDefault();\n    this.moveTo(center, null, 'redraw');\n  },\n\n  /**\n   * viewport size       .\n   * window resize    map element  \n   *    .  \n   * @param {String} [horizontalRef=left] left,right,center      . left     right      center  .\n   *  center   center   . center    verticalRef   .\n   * @param {String} [verticalRef=top] top  bottom    . top     bottom      center  . \n   * @private\n   */\n  resize: function (horizontalRef, verticalRef) {\n    if (!this.isStarted())\n      return;\n    var newCenter;\n    var viewportSize = new olleh.maps.Size(this._mapElem.clientWidth,\n      this._mapElem.clientHeight);\n    if (horizontalRef === 'center') {\n      newCenter = this._center;\n    } else {\n      var point = viewportSize.divideBy(2).asPoint();\n      newCenter = this.getCoordFromViewportPx(point);\n      if (horizontalRef === 'right' || verticalRef === 'bottom') {\n        var point2 = this._viewportSize.divideBy(2).asPoint();\n        this._viewportSize = viewportSize;\n        var coord2 = this.getCoordFromViewportPx(point2);\n        var x = horizontalRef === 'right' ? coord2.x : newCenter.x;\n        var y = verticalRef === 'bottom' ? coord2.y : newCenter.y;\n        newCenter = new olleh.maps.UTMK(x, y);\n      }\n    }\n    this._viewportSize = viewportSize;\n    this._viewportOffset = olleh.maps.util.dom.getXY(this._mapElem);\n    this._viewportSizeChanged = true;\n    this.moveTo(newCenter, null, 'redraw');\n  },\n\n  /**\n   * maxExtent    moveTo()    . \n   * @param center   \n   * @param zoom  \n   * @returns {olleh.maps.UTMK}   \n   * @private\n   */\n  _adjustCenter: function (center, zoom) {\n    var restrictedExtent = this._opts.restrictedExtent;\n    if (!restrictedExtent)\n      return center;\n    var coordSize = this._getCoordSizeForZoom(zoom);\n    var left, right, bottom, top;\n    if (coordSize.width > restrictedExtent.getWidth()) {\n      left = restrictedExtent.getRight() - coordSize.width / 2;\n      right = restrictedExtent.getLeft() + coordSize.width / 2;\n    } else {\n      left = restrictedExtent.getLeft() + coordSize.width / 2;\n      right = restrictedExtent.getRight() - coordSize.width / 2;\n    }\n    if (coordSize.height > restrictedExtent.getHeight()) {\n      bottom = restrictedExtent.getTop() - coordSize.height / 2;\n      top = restrictedExtent.getBottom() + coordSize.height / 2;\n    } else {\n      bottom = restrictedExtent.getBottom() + coordSize.height / 2;\n      top = restrictedExtent.getTop() - coordSize.height / 2;\n    }\n    var centerBounds = new olleh.maps.Bounds(\n      new olleh.maps.UTMK(left, bottom),\n      new olleh.maps.UTMK(right, top)\n    );\n    if (centerBounds.contains(center)) {\n      return center;\n    }\n    var x = Math.max(centerBounds.getLeft(), Math.min(centerBounds.getRight(), center.x));\n    var y = Math.max(centerBounds.getBottom(), Math.min(centerBounds.getTop(), center.y));\n    return new olleh.maps.UTMK(x, y);\n  },\n\n  /**\n   *   center   zoom  .\n   * @param {olleh.maps.UTMK} center  .  UTMK. null    center   zoom  .\n   * @param {number} zoom . null    zoom   center  .\n   * @param {string} [animation=redraw] redraw:  redraw, .    viewport    \n   *                             on:  animation.      handler   .\n   *                             auto:    animation,  draw, Map#panTo()    \n   *                             off:    animation     . \n   *                                   pan control   .    draw   \n   * @param {number} [animationDuration] animation   \n   * @private\n   */\n  moveTo: function (center, zoom, animation, animationDuration) {\n    // zoom    \n    if (zoom)\n      zoom = +zoom;\n    if (!this.isStarted()) {\n      center && (this._center = center);\n      olleh.maps.isNumber(zoom) && (this._zoom = zoom);\n      return;\n    }\n    if (this._pinch_started) { // PinchZoom.js  . pinch   zoom    .\n      return;\n    }\n    // center      center   \n    //    pendingCenter( center)  \n    if (!center) {\n      center = this._isZooming ? this._pendingCenter : this._center;\n    }\n    // zoom      zoom   \n    //     pendingZoom( zoom) \n    if (!olleh.maps.isNumber(zoom)) {\n      zoom = this._isZooming ? this._pendingZoom : this._zoom;\n    }\n    // minZoom, maxZoom  .\n    zoom = Math.max(this._minZoom, zoom);\n    zoom = Math.min(this._maxZoom, zoom);\n    // maxExtent  .\n    center = this._adjustCenter(center, zoom);\n    var oldZoom = this._zoom;\n    var oldCenter = this._center;\n    var zoomChanged = this._isZooming ? zoom !== this._pendingZoom : zoom !== oldZoom;\n    var centerChanged = this._isZooming ? !center.equals(this._pendingCenter) : !center.equals(oldCenter);\n    // forceDraw  true   redraw \n    var forceDraw = false;\n    //   \n    var useAnimation = false;\n    //    center  .\n    this._abortPanAnimationAndUpdateCenter();\n    var panDuration = olleh.maps.isNumber(animationDuration) ? animationDuration\n      : this._opts.panAnimDuration;\n    var zoomDuration = olleh.maps.isNumber(animationDuration) ?\n      animationDuration : this._opts.zoomAnimDuration;\n    //  draw\n    if (animation === 'redraw' || olleh.maps.isUndefined(animation) || (zoomChanged && zoomDuration === 0) || (centerChanged && panDuration === 0)) {\n      forceDraw = true;\n    } else if (animation === 'on') { //  animation\n      useAnimation = true;\n    } else /* if (animation === 'auto' || animation === 'off') */ { //    move,  draw\n      //      redraw .\n      var coordSize = this._getCoordSizeForZoom(Math.min(zoom, this._zoom));\n      // left bottom\n      var x1 = this._center.x - coordSize.width * 3 / 2;\n      var y1 = this._center.y - coordSize.height * 3 / 2;\n      // right top\n      var x2 = this._center.x + coordSize.width * 3 / 2;\n      var y2 = this._center.y + coordSize.height * 3 / 2;\n      if (center.x < x1 || center.y < y1 || center.x > x2 || center.y > y2) {\n        forceDraw = true;\n      } else {\n        useAnimation = animation === 'auto'; // move  animation   \n      }\n    }\n    //  zoom  forceDraw  . \n    if (!useAnimation && zoomChanged)\n      forceDraw = true;\n    if (!forceDraw && !centerChanged && !zoomChanged) {\n      return;\n    }\n    // draw: layer offset   layer.draw() \n    if (!this._center || forceDraw) {\n      if (this._isZooming) {\n        if (this._zoomEndReq) {\n          window.cancelAnimationFrame(this._zoomEndReq);\n          this._zoomEndReq = null;\n        }\n        this._isZooming = false;\n        this._pendingZoom = null;\n        this._pendingCenter = null;\n      }\n      this._setBounds(center, zoom);\n      this._moveRootPane(); // reset layer offset\n      this._drawLayers();\n      this._fireBoundsChangedEvent();\n    } else if (zoomChanged) {\n      var layerPx;\n      //      \n      if (this._isZooming) {\n        // zoom     origin   .\n        layerPx = this._initialOriginLayerPx;\n        //  zoom   center    .\n        if (this._initialCenterLayerPx) { //   center layer px\n          var initialCenterLayerPx = this._initialCenterLayerPx;\n          var scale = this._getScaleForZoom(zoom);\n          var offsetPx = layerPx.subtract(initialCenterLayerPx);\n          offsetPx._multiplyBy(1 - 1 / scale);\n          var tempCoord = initialCenterLayerPx.add(offsetPx);\n          tempCoord = this.getCoordFromLayerPx(tempCoord, false);\n          center = tempCoord;\n        }\n      } else {\n        layerPx = this.getLayerPxFromCoord(center, false);\n        if (centerChanged) {\n          // zoom animation  .\n          // leaflet    .   ;;\n          // animation  =   + (  -  )/(1 - 1 /  ) \n          var centerLayerPx = this.getLayerPxFromCoord(this._center, false);\n          var offsetPx = layerPx.subtract(centerLayerPx);\n          var scale = this._getScaleForZoom(zoom);\n          offsetPx._divideBy(1 - 1 / scale);\n          layerPx = centerLayerPx.add(offsetPx);\n          //   center layer px\n          this._initialCenterLayerPx = centerLayerPx;\n        }\n        //   zoom origin layer px \n        this._initialOriginLayerPx = layerPx;\n      }\n      this._pendingZoom = zoom;\n      this._pendingCenter = center;\n      var scale = this._getScaleForChanges(zoom - oldZoom);\n      this.fireEvent('zoom_change', {\n        origin: layerPx, scale: scale,\n        duration: zoomDuration, newZoom: zoom, oldZoom: oldZoom\n      });\n      if (this._hideLayerFn) { // base layer     \n        this._hideLayerFn.call(this);\n      }\n      this._zoomStartLayers(scale, layerPx, zoomDuration);\n      this._triggerZoomEnd(center, zoom, oldZoom, zoomDuration);\n    }\n    // move \n    //     move  .\n    else if (!this._isZooming) {\n      var resolution = this.getResolution();\n      var dx = Math.floor((center.x - this._center.x) / resolution);\n      var dy = Math.floor((center.y - this._center.y) / resolution);\n      //   \n      if (useAnimation) {\n        this._panRootPane(-dx, dy, panDuration, this._moveEndLayers);\n        this._setBounds(center, this._zoom);\n        this._moveStartLayers();\n      } else { //   move\n        this._moveRootPane(-dx, dy);\n        this._setBounds(center, this._zoom);\n        if (!this._disableLoadingWhilePanning)\n          this._moveLayers();\n        this._resetIdleTimer();\n        this._fireBoundsChangedEvent();\n      }\n    }\n  },\n\n  /**\n   *  layer  zoom animation   zoomEnd()    \n   * requestAnimationFrame   _triggerZoomEnd2  .\n   * @private\n   */\n  _triggerZoomEnd: function (center, zoom, oldZoom, zoomDuration) {\n    this._isZooming = true;\n    if (this._zoomEndReq) {\n      window.cancelAnimationFrame(this._zoomEndReq);\n    }\n    this._zoomEndReq = olleh.maps.util.deferAF(this._triggerZoomEnd2, this, center, zoom, oldZoom, zoomDuration);\n  },\n\n  /**\n   * zoomDuration  _triggerZoomEnd3  .\n   * @param {Number} t requsetAnimationFrame   \n   * @param {olleh.maps.coord} center\n   * @param {Number} zoom\n   * @param {Number} oldZoom\n   * @param {Nuber} zoomDuration\n   * @private\n   */\n  _triggerZoomEnd2: function (t, center, zoom, oldZoom, zoomDuration) {\n    if (this._zoomTimer !== null) {\n      window.clearTimeout(this._zoomTimer);\n    }\n    this._zoomEndReq = null;\n    this._zoomTimer = olleh.maps.util.delay(this._triggerZoomEnd3, 1000 * zoomDuration + 100, this, center, oldZoom, zoom);\n  },\n\n  /**\n   * center,zoom   zoomEnd layer  .\n   * @private\n   */\n  _triggerZoomEnd3: function (center, oldZoom, zoom) {\n    this._isZooming = false;\n    this._setBounds(center, zoom);\n    this._pendingZoom = null;\n    this._pendingCenter = null;\n    this._zoomEndLayers(oldZoom, zoom);\n    this._initialCenterLayerPx = null;\n    this._zoomTimer = null;\n    this._fireBoundsChangedEvent();\n  },\n\n  _setBounds: function (center, zoom) {\n    var centerChanged = this._center !== center;\n    var zoomChanged = this._zoom !== zoom;\n    if (!centerChanged && !zoomChanged)\n      return;\n    if (centerChanged) {\n      var oldCenter = this._center;\n      this._center = center;\n      this._centerChanged = { newCenter: center, oldCenter: oldCenter };\n    }\n    if (zoomChanged) {\n      var oldZoom = this._zoom;\n      this._zoom = zoom;\n      this._zoomChanged = { newZoom: zoom, oldZoom: oldZoom };\n    }\n  },\n\n  _fireBoundsChangedEvent: function () {\n    if (this._centerChanged) {\n      this.fireEvent('center_changed', this._centerChanged);\n    }\n    if (this._zoomChanged) {\n      this.fireEvent('zoom_changed', this._zoomChanged);\n    }\n    if (this._zoomChanged || this._centerChanged || this._viewportSizeChanged) {\n      this.fireEvent('bounds_changed');\n    }\n    this._centerChanged = null;\n    this._zoomChanged = null;\n    this._viewportSizeChanged = null;\n  },\n\n  /**\n   *      true  .\n   * @returns {Boolean}\n   * @private\n   */\n  isZooming: function () {\n    return this._isZooming;\n  },\n\n  /**\n   * zoom animation    getZoom()    zoom  \n   *   zoom  .\n   * zoom animation   zoom   \n   * getPendingZoom()   .\n   * @returns {Number}    \n   * @private\n   */\n  getPendingZoom: function () {\n    return olleh.maps.isNumber(this._pendingZoom) ? this._pendingZoom : this._zoom;\n  },\n\n  /**\n   * {@link #getPendingZoom()}       \n   * center  .\n   * @returns {olleh.maps.Coord}  \n   * @private\n   */\n  getPendingCenter: function () {\n    return this._pendingCenter ? this._pendingCenter : this._center;\n  },\n\n  /**\n   *  layer  draw  .\n   * @private\n   */\n  _drawLayers: function () {\n    this._forEachLayers('draw', [!this.isStarted()]);\n    if (!this.isStarted()) {\n      this._idle();\n    } else {\n      this._resetIdleTimer();\n    }\n  },\n\n  /**\n   *  layer  moveEnd  .\n   * @private\n   */\n  _moveEndLayers: function () {\n    this._forEachLayers('moveEnd');\n    this._fireBoundsChangedEvent();\n    this._idle();\n  },\n\n  /**\n   *  layer  moveStart  .\n   * @private\n   */\n  _moveStartLayers: function () {\n    this._forEachLayers('moveStart');\n  },\n\n  /**\n   *  layer  move  .\n   * @private\n   */\n  _moveLayers: function () {\n    this._forEachLayers('move');\n  },\n\n  /**\n   *  layer  zoomStart  .\n   * @param {Number} scale   \n   * @param {olleh.maps.Point} origin  \n   * @param {Number} duration    \n   * @private\n   */\n  _zoomStartLayers: function (scale, origin, duration) {\n    this._forEachLayers('zoomStart', [scale, origin,\n      duration, this._zoomPulse]);\n  },\n\n  /**\n   *  layer  zoomEnd  .\n   * @param {Number} oldZoom    \n   * @param {Number} newZoom    \n   * @private\n   */\n  _zoomEndLayers: function (oldZoom, newZoom) {\n    this._forEachLayers('zoomEnd', [oldZoom, newZoom]);\n    if (this._zoomPulse) {\n      this._zoomPulse.stop();\n    }\n    this._idle();\n  },\n\n  /**\n   *  layer    .\n   * @param {String} fnString    \n   * @param {Array} args function arguments array\n   * @private \n   */\n  _forEachLayers: function (fnString, args) {\n    args || (args = []);\n\n    if (this._backgroundLayer) {\n      this._backgroundLayer[fnString].apply(this._backgroundLayer, args);\n    }\n\n    if (this._activeBaseLayer) {\n      this._activeBaseLayer[fnString].apply(this._activeBaseLayer, args);\n    }\n\n    for (var i = 0, len = this._groundLayers.length; i < len; i++) {\n      var l = this._groundLayers[i];\n      if ((l.isVisible() && l.isVisibleForZoom()) || fnString.indexOf('End') != -1) { // TODO  \n        l[fnString].apply(l, args);\n      }\n    }\n\n    if (this._overlayLayer) {\n      this._overlayLayer[fnString].apply(this._overlayLayer, args);\n    }\n  },\n\n  /**\n   * edit mode  viewport  transparent_pane     overlay  cursor style   . \n   * @param {Boolean} editable true  edit mode   .\n   * @private\n   */\n  setEditMode: function (editable) {\n    var display = editable ? 'block' : 'none';\n    this._transparent_pane.style.display = display;\n  },\n\n  /**\n   *   max extent (  )  .\n   * @returns {olleh.maps.Bounds} max extetnt\n   * @private\n   */\n  getMaxExtent: function () {\n    return this._opts.maxExtent;\n  },\n\n  /**\n   *   restricted extent ( panning  )  .\n   * @returns {olleh.maps.Bounds} restricted extent\n   * @private\n   */\n  getRestrictedExtent: function () {\n    return this._opts.restrictedExtent;\n  },\n\n  _resetIdleTimer: function () {\n    if (this._idleTimer) {\n      window.clearTimeout(this._idleTimer);\n    }\n    this._idleTimer = olleh.maps.util.delay(this.__resetIdleTimer, 200, this);\n  },\n\n  /**\n   * @private\n   */\n  __resetIdleTimer: function () {\n    //      /   . \n    if (!this._isZooming && (!this._rootPaneAnimator || this._rootPaneAnimator.status != 'started')) {\n      if (this._disableLoadingWhilePanning)\n        this._moveLayers();\n      this.fireEvent('idle');\n    }\n    this._idleTimer = null;\n  },\n\n  _idle: function () {\n    //       .\n    if (!this._idleTimer) {\n      this.fireEvent('idle');\n    }\n  }\n\n});\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.layer.BackgroundLayer').extend(olleh.maps.layer.Layer).define({\r\n            \r\n  start: function() {\r\n    var browser = olleh.maps.browser;\r\n    var viewportSize = this.layerMgr.getViewportSize();\r\n    this._pane = document.createElement('div');\r\n    this._buffer = 3000; // buffer  10000   iOS   .\r\n    var styles = {\r\n        position: 'absolute',\r\n        zIndex: '-1000',\r\n        width: viewportSize.width + this._buffer * 2 + 'px',\r\n        height: viewportSize.height + this._buffer * 2 + 'px',\r\n        backgroundImage: 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAALUlEQVR4Xu3SMQEAMAgDwVD/2mDDDnXAb0w5Ab8k2nTlCDyBg4ADwVMx/8CBDz7/CnKqkouSAAAAAElFTkSuQmCC)',\r\n        backgroundRepeat: 'repeat'  \r\n    };\r\n    if (browser.has3D) {\r\n      styles.transform  = 'translate3d(0,0,0)';\r\n    }\r\n    olleh.maps.util.dom.setStyles(this._pane, styles);\r\n    this._updatePosition();\r\n    this.layerMgr.onEvent('idle', this._onIdle, this);\r\n  },\r\n  \r\n  getPane: function() {\r\n    return this._pane;\r\n  },\r\n  \r\n  _onIdle: function() {\r\n    if (this._idleTimer) {\r\n      window.clearTimeout(this._idleTimer);\r\n    }\r\n    this._idleTimer = olleh.maps.util.delay(this._resetIdleTimer, 500, this);\r\n  },\r\n  \r\n  _resetIdleTimer: function() {\r\n    this._updatePosition();\r\n    this._idleTimer = null;\r\n  },\r\n    \r\n  _updatePosition: function() {\r\n    var layerOffset = this.layerMgr.getLayerOffset();\r\n    olleh.maps.util.dom.setStyles(this._pane, {\r\n      left: -layerOffset.x - this._buffer + 'px',\r\n      top:  -layerOffset.y - this._buffer + 'px'\r\n    });\r\n  }\r\n      \r\n});/**\r\n * Overlay   Layer\r\n */\r\n$class('olleh.maps.overlay.OverlayLayer').extend(olleh.maps.layer.Layer).define({\r\n  \r\n  /**\r\n   * OverlayLayer name: olleh.maps.overlay.OverlayLayer \r\n   * @type String\r\n   * @private\r\n   */\r\n  name: 'olleh.maps.overlay.OverlayLayer',\r\n  \r\n  label: '',\r\n  \r\n  autoActivate: true,\r\n\r\n  /**\r\n   * overlay draw   buffer   viewport    . \r\n   * 1   viewport    buffer   0   buffer   .\r\n   *  zoom in animation  move  draw          . \r\n   *  (moveStart() ) buffer  overlay  draw/erase   . \r\n   * @type Number\r\n   * @private\r\n   */\r\n  buffeSize: 0.2,\r\n  \r\n  /**\r\n   * lower overlay pane   z-index.  pane  1  .\r\n   * @type Number\r\n   * @private\r\n   */\r\n  baseIndex: 1000,\r\n  \r\n  /**\r\n   * true   Overlay   . default: false \r\n   * @type Boolean\r\n   * @private\r\n   */\r\n  disableShadow: false,\r\n  \r\n  /**\r\n   * Overlay Pane id:\r\n   * <ul>\r\n   *  <li>lower_overlay_pane</li>\r\n   *  <li>overlay_shadow_pane</li>\r\n   *  <li>upper_overlay_pane</li>\r\n   *  <li>infowindow_shadow_pane</li>\r\n   *  <li>infowindow_pane</li>\r\n   * </ul>\r\n   * @private\r\n   */\r\n  paneIds: ['lower_overlay_pane', 'overlay_shadow_pane', 'upper_overlay_pane',\r\n             'infowindow_shadow_pane', 'infowindow_pane'],\r\n  /**\r\n   * ,   .\r\n   */\r\n  OverlayLayer: function () {\r\n    this._visible = true;\r\n    this._overlays = [];\r\n    this._displayedOverlays = {};\r\n    /**\r\n     *  Overlay Panes\r\n     *  @type Object\r\n     *  @private \r\n     */\r\n    this.panes = {};\r\n    var pane, paneId;\r\n    for (var i = 0; i < this.paneIds.length; i++) {\r\n      paneId = this.paneIds[i];\r\n      pane = this.panes[paneId] = document.createElement('div');\r\n      pane.style.position = 'absolute';\r\n      pane.style.zIndex = 1000 + i;\r\n    }\r\n    this._gridIndex = new olleh.maps.overlay.GridIndex(10000);\r\n  },\r\n  \r\n  start: function() {\r\n    olleh.maps.overlay.OverlayLayer.$super.start.call(this);\r\n    this.disableShadow = this.map.getOption('disableShadow', false);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event}\r\n   * @param {Object} payload\r\n   * @private\r\n   */\r\n  $current_bounds_changed: function (event, payload) {\r\n    var o = event.getSource();\r\n\r\n    this._gridIndex.remove(o, payload.from);\r\n    this._gridIndex.add(o);\r\n    this._updateSingleOverlayDisplayHint(o);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event}\r\n   * @param {Object} payload\r\n   * @private\r\n   */\r\n  $current_position_changed: function (event, payload) {\r\n    var o = event.getSource();\r\n    if(!o.getBounds()) {\r\n      this._gridIndex.remove(o, payload.from);\r\n      this._gridIndex.add(o);\r\n      this._updateSingleOverlayDisplayHint(o);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * <code>paneId</code>   pane   .\r\n   * @returns {Element}\r\n   */\r\n  getPane: function (paneId) {\r\n    return this.panes[paneId];\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer    Overlay  .\r\n   * @returns {Array.<olleh.maps.overlay.Overlay>} Overay \r\n   */\r\n  getOverlays: function () {\r\n    return this._overlays;\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer   .\r\n   * @param {boolean} visible false   OverlayLayer   .\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible != visible) {\r\n      this._visible = visible;\r\n      visible && this.draw();\r\n      var overlayPanes = this.panes;\r\n      var visibility = visible ? 'block' : 'none';\r\n      for (var i in overlayPanes) {\r\n        overlayPanes[i].style.display = visibility;\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer  visible   .\r\n   * @returns {boolean} visilbe \r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer  Overlay   .\r\n   * @param {olleh.maps.overlay.Overlay} overlay Overlay \r\n   * @private\r\n   */\r\n  add: function (overlay) {\r\n   // layer   attach   remove   .\r\n    overlay.layer = this; \r\n   // zoom animation  animation    .\r\n    if (this.layerMgr.isZooming()) {\r\n      if(!this._toAddOverlaysAtZoomEnd)\r\n        this._toAddOverlaysAtZoomEnd = [];\r\n      this._toAddOverlaysAtZoomEnd.push(overlay);\r\n      return;\r\n    }\r\n    this._overlays.push(overlay);\r\n    if(overlay.getPosition() || overlay.getBounds())\r\n      this._gridIndex.add(overlay);\r\n    if (this.isStarted()) {\r\n      overlay.fireEvent('attached');\r\n      this._updateSingleOverlayDisplayHint(overlay);\r\n      overlay.draw(true);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * OverlayLayer  Overlay   .\r\n   * @param {olleh.maps.overlay.Overlay} overlay\r\n   * @private\r\n   */\r\n  remove: function (overlay) {\r\n    this._gridIndex.remove(overlay);\r\n    if(!this._toAddOverlaysAtZoomEnd\r\n        || olleh.maps.util.removeFromArray(this._toAddOverlaysAtZoomEnd, overlay) === -1) {\r\n      if (this.isStarted()) {\r\n        overlay.erase(true);\r\n      }\r\n      overlay.fireEvent('detached');\r\n      olleh.maps.util.removeFromArray(this._overlays, overlay);\r\n    }\r\n    var id = overlay.getId();\r\n    if(this._displayedOverlays[id]) {\r\n      delete this._displayedOverlays[id];\r\n    }\r\n    overlay.layer = null;\r\n  },\r\n\r\n  /**\r\n   * Pan Animation  .\r\n   * @private\r\n   */\r\n  moveStart: function () {\r\n  },\r\n\r\n  /**\r\n   * Pan Animation   .\r\n   * @private\r\n   */\r\n  moveEnd: function () {\r\n    var layerBoundsChanged;\r\n    var center = this._center;\r\n    var currentCenter = this.layerMgr.getCenter();\r\n    if (center) {\r\n      var bufferBounds = this._getBufferBounds(new olleh.maps.Bounds(center, center));\r\n      layerBoundsChanged = !bufferBounds.contains(currentCenter);\r\n    } else {\r\n      layerBoundsChanged = true;\r\n    }\r\n    if (layerBoundsChanged) {\r\n      this._center = currentCenter;\r\n      this._onBoundsChanged();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Zoom Animation  .\r\n   * @param {Number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {Number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   * @private\r\n   */\r\n  zoomStart: function (scale, origin, duration, pulse) {\r\n    var i, overlay, overlays = this._overlays;\r\n    for ( i = overlays.length - 1; i >= 0; i--) {\r\n      overlay = this._overlays[i];\r\n      overlay.zoomStart(scale, origin, duration, pulse);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Zoom Animation   .\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n    var i, overlay, overlays = this._overlays;\r\n    for ( i = overlays.length - 1; i >= 0; i--) {\r\n      overlay = this._overlays[i];\r\n      overlay.zoomEnd();\r\n    }\r\n    this._onBoundsChanged();\r\n    // zoom animation   overlay   .\r\n    if(this._toAddOverlaysAtZoomEnd) {\r\n      var toAddOverlaysAtZoomEnd = this._toAddOverlaysAtZoomEnd;\r\n      delete this._toAddOverlaysAtZoomEnd;\r\n      for(i = 0, len = toAddOverlaysAtZoomEnd.length; i < len; i++) {\r\n        this.add(toAddOverlaysAtZoomEnd[i]);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Overlay Layer  .\r\n   * @param {Boolean} isMapStart     draw   true .\r\n   * @private\r\n   */\r\n  draw: function (isMapStart) {\r\n    var i, o, overlays = this._overlays;\r\n    for ( i = overlays.length - 1; i >= 0; i--) {\r\n      o = overlays[i];\r\n      o.draw(isMapStart);\r\n    }\r\n    this._onBoundsChanged();\r\n  },\r\n  \r\n  /**\r\n   * Overlay  bounds   .\r\n   */\r\n  _onBoundsChanged: function() {\r\n    var from = this._bounds;\r\n    this._bounds = null;\r\n    var to = this.getBounds();\r\n    this._updateAllOverlayDisplayHint();\r\n    /**\r\n     * OverlayLayer  buffer bounds    .\r\n     * @name event:overlay_layer_bounds_changed\r\n     * @event\r\n     * @memberOf olleh.maps.overlay.OverlayLayer.prototype\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('overlay_layer_bounds_changed', {from: from, to: to});\r\n  },\r\n  \r\n\r\n  /**\r\n   * Buffer  .\r\n   * @returns {olleh.maps.Size} Buffer \r\n   * @private\r\n   */\r\n  _getBufferSize: function () {\r\n    var viewportSize = this.layerMgr.getViewportSize();\r\n    return viewportSize.multiplyBy(this.buffeSize);\r\n  },\r\n  \r\n  /**\r\n   * OverlayLayer bounds  . OverlayLayer bounds  buffer    viewport bounds    .\r\n   * @returns {olleh.maps.Bounds}\r\n   */\r\n  getBounds: function() {\r\n    // _getBufferBounds          .\r\n    // bounds    (onBoundsChanged()  this._bounds  null   .\r\n    if(!this._bounds) {\r\n      this._bounds = this._getBufferBounds();\r\n    }\r\n    return this._bounds; \r\n  },\r\n\r\n  /**\r\n   * Overlay draw   Buffer Bounds  .\r\n   * @param {olleh.maps.Bounds} [bounds]\r\n   * @returns {olleh.maps.Bounds}\r\n   * @private\r\n   */\r\n  _getBufferBounds: function (bounds) {\r\n    var lm = this.layerMgr;\r\n    var resolution = lm.getResolution();\r\n    var buffer = this._getBufferSize();\r\n    return (bounds || lm.getBounds()).expand(buffer.width * resolution, buffer.height * resolution);\r\n  },\r\n  \r\n  /**\r\n   *  overlay  display hint   .\r\n   * @private\r\n   */\r\n  _updateAllOverlayDisplayHint: function() {\r\n    var i, id, overlay, overlays = {};\r\n    var overlaysAsArray = this._gridIndex.getOverlays(this.getBounds());\r\n    for (i = 0; i < overlaysAsArray.length; i++) {\r\n      overlay = overlaysAsArray[i];\r\n      overlays[overlay.getId()] = overlay;\r\n    }\r\n    for(id in this._displayedOverlays) {\r\n      if (!overlays[id]) {\r\n        this._displayedOverlays[id].setDisplayHint(false);\r\n        delete this._displayedOverlays[id]; \r\n      }\r\n    }\r\n    for(id in overlays) {\r\n      if(!this._displayedOverlays[id]) {\r\n        overlays[id].setDisplayHint(true);\r\n        this._displayedOverlays[id] = overlays[id];\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  overlay  display hint   .\r\n   * @param {olleh.maps.Overlay} overlay Overlay\r\n   * @private\r\n   */\r\n  _updateSingleOverlayDisplayHint: function(overlay) {\r\n    var displayHint = this.getBounds().intersects(overlay.getBounds() || overlay.getPosition());\r\n    overlay.setDisplayHint(displayHint);\r\n    if(displayHint) {\r\n      this._displayedOverlays[overlay.getId()] = overlay;\r\n    } else if(this._displayedOverlays[overlay.getId()]) {\r\n      delete this._displayedOverlays[overlay.getId()];\r\n    }\r\n  }\r\n  \r\n});\r\n/**\n *     .\n */\n$class('olleh.maps.overlay.GridIndex').define({\n  \n  /**\n   * \n   * @param {number} cellSize\n   */\n  GridIndex: function (cellSize) {\n    this._cellSize = cellSize;\n    this._grid = [];\n  },\n\n  /**\n   * \n   * @param {olleh.maps.overlay.Overlay} overlay\n   * @param {olleh.maps.Coord|olleh.maps.Bounds} [arg]\n   */\n  add: function (overlay, arg) {\n    var x, y, col, cell;\n    var range = this._getCellRange(arg || overlay.getIndexObject());\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        col = this._grid[x] = [];\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (!cell) {\n          col[y] = [overlay];\n        } else {\n          cell.push(overlay);\n        }\n      }\n    }\n  },\n\n  /**\n   * \n   * @param {olleh.maps.overlay.Overlay} overlay\n   * @param {olleh.maps.Coord|olleh.maps.Bounds} [arg]\n   */\n  remove: function (overlay, arg) {\n    var i, x, y, col, cell;\n    var range = this._getCellRange(arg || overlay.getIndexObject());\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        continue;\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (cell) {\n          i = olleh.maps.util.indexOf(cell, overlay);\n          if (i != -1) {\n            cell.splice(i, 1);\n          }\n        }\n      }\n    }\n  },\n\n  clear: function () {\n    var x, y, o, xMax, yMax, oMax, overlays;\n    var gridX, gridY;\n\n    for(x = 0, gridX = this._grid, xMax = gridX ? gridX.length : 0; x < xMax; x++) {\n      for(y = 0, gridY = this._grid[x], yMax = gridY ? gridY.length : 0; y < yMax; y++) {\n        for(o = 0, overlays = this._grid[x][y], oMax = overlays ? overlays.length : 0; o < oMax; o++) {\n          overlays[o].setMap(null);\n        }\n      }\n    }\n  },\n  \n  /**\n   * \n   * @param {olleh.maps.overlay.Overlay} overlay\n   * @returns {boolean}\n   */\n  contains: function (overlay) {\n    var x, y, col, cell;\n    var range = this._getCellRange(overlay.getIndexObject());\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        continue;\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (cell && olleh.maps.util.indexOf(cell, overlay) != -1) {\n          return true;\n        }\n      }\n    }\n    \n    return false;\n  },\n  \n  /**\n   * \n   * @param {olleh.maps.Bounds} bounds\n   * @returns {object}\n   */\n  getOverlays: function (bounds) {\n    var x, y, col, cell, overlay, result = [];\n    var range = this._getCellRange(bounds);\n\n    for (x = range.minX; x <= range.maxX; x++) {\n      col = this._grid[x];\n      if (!col) {\n        continue;\n      }\n      for (y = range.minY; y <= range.maxY; y++) {\n        cell = col[y];\n        if (!cell) {\n          continue;\n        }\n        for (var i = 0; i < cell.length; i++) {\n          overlay = cell[i];\n          if (bounds.intersects(overlay.getIndexObject())) {\n            result.push(overlay);\n          }\n        }\n      }\n    }\n    \n    return result;\n  },\n  \n  /**\n   * \n   * @private\n   * @param {olleh.maps.Coord|olleh.maps.Bounds} arg\n   * @returns {Object}\n   */\n  _getCellRange: function (arg) {\n    var minX, minY, maxX, maxY;\n    var cellSize = this._cellSize;\n\n    arg = arg.asDefault();\n    if (arg.x !== undefined && arg.y !== undefined) {\n      minX = maxX = Math.floor(arg.x / cellSize);\n      minY = maxY = Math.floor(arg.y / cellSize);\n    } else {\n      minX = Math.floor(arg.leftBottom.x / cellSize);\n      minY = Math.floor(arg.leftBottom.y / cellSize);\n      maxX = Math.floor(arg.rightTop.x / cellSize);\n      maxY = Math.floor(arg.rightTop.y / cellSize);\n    }\n\n    return {\n      minX: minX,\n      minY: minY,\n      maxX: maxX,\n      maxY: maxY\n    };\n  }\n  \n});/**\r\n *   Plugin     \r\n */\r\n$class('olleh.maps.PluginRegistry').mixin(olleh.maps.event.EventDelegator)\r\n    .define({\r\n      \r\n      /**\r\n       *      \r\n       * @name plugin_added\r\n       * @event\r\n       * @memberOf olleh.maps.PluginRegistry.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      /**\r\n       *      \r\n       * @name plugin_removed\r\n       * @event\r\n       * @memberOf olleh.maps.PluginRegistry.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n\r\n      /**\r\n       * ,   .\r\n       */\r\n      PluginRegistry: function () {\r\n        this._plugins = [];\r\n        this._drawingTools = [];\r\n      },\r\n\r\n      /**\r\n       * Plugin  .\r\n       * @param {olleh.maps.Plugin} plugin\r\n       */\r\n      add: function (plugin) {\r\n        plugin.pluginRegistry = this;\r\n        this._plugins.push(plugin);\r\n        this.fireEvent('plugin_added', {\r\n          plugin: plugin\r\n        });\r\n        if(plugin.pluginInfo && plugin.pluginInfo.drawingTool) {\r\n          this._drawingTools.push(plugin);\r\n        }\r\n      },\r\n\r\n      /**\r\n       * Plugin  .\r\n       * @param {olleh.maps.Plugin} plugin\r\n       */\r\n      remove: function (plugin) {\r\n        if (plugin.active)\r\n          plugin.deactivate();\r\n        olleh.maps.util.removeFromArray(this._plugins, plugin);\r\n        olleh.maps.util.removeFromArray(this._drawingTools, plugin);\r\n        this.fireEvent('plugin_removed', {\r\n          plugin: plugin\r\n        });\r\n        plugin.pluginRegistry = null;\r\n      },\r\n      \r\n      /**\r\n       *  plugin  .\r\n       * @returns {Array.<olleh.maps.Plugin>} \r\n       */\r\n      getPlugins: function() {\r\n        return this._plugins;\r\n      },\r\n\r\n      /**\r\n       * label   plugin  group  .\r\n       * group    plugin  $nogroup  .\r\n       * @returns {Object} property: {String} group , value: {olleh.maps.Plugin[]} plugin \r\n       */\r\n      getLabeledPluginsByGroup: function () {\r\n        var plugins = this._plugins;\r\n        var pluginsByGroup = {};\r\n        for ( var i = 0 , len = plugins.length ; i < len ; i++) {\r\n          var p = plugins[i];\r\n          var pluginInfo = p.pluginInfo;\r\n          if(!pluginInfo || !pluginInfo.label)\r\n            continue;\r\n          var groupId = pluginInfo.group ? pluginInfo.group : '$nogroup';\r\n          var arrs = pluginsByGroup[groupId];\r\n          if (!arrs) {\r\n            arrs = [];\r\n            pluginsByGroup[groupId] = arrs;\r\n          }\r\n          arrs.push(p);\r\n        }\r\n        return pluginsByGroup;\r\n      },\r\n\r\n      /**\r\n       * drawingTool  active    plugin  .\r\n       * @param {olleh.maps.Plugin} plugin active  plugin \r\n       * @private\r\n       */\r\n      drawingToolActivate: function(plugin) {\r\n        for(var i = this._drawingTools.length - 1 ; i >= 0 ; i-- ) {\r\n          if(this._drawingTools[i] !== plugin) {\r\n            this._drawingTools[i].deactivate();\r\n          }\r\n        }\r\n      }\r\n      \r\n    });////////////////\r\n//  Map  //\r\n////////////////\r\n/**\r\n * Map \r\n * @typedef olleh.maps.MapOptions\r\n * @property {olleh.maps.Bounds} [maxExtent]    .      maxExtent    .\r\n *                                     restrictedExtent   . <br/>\r\n *                                 . <pre> Left: 171162, Bottom: 1214781, Right: 1744026, Top: 2787645 </pre>\r\n * @property {olleh.maps.Bounds} [restrictedExtent]       . restrictedExtent   panning   \r\n *                               maxExtent     maxExtent      . <br/>  \r\n *                                 . <pre> Left: 171162, Bottom: 1214781, Right: 1744026, Top: 2787645 </pre>\r\n * @property {Boolean} [trackWindowSize=true] true   window resize     . \r\n * @property {Number} [panAnimEaseLinearity1=0.5] pan animation   cubic bezier timing function  y1 .    .\r\n * @property {Number} [panAnimEaseLinearity2=0.25] pan animation   cubic bezier timing function  x2 .    . \r\n * @property {olleh.maps.Coord} center     \r\n * @property {Number} [zoom=7]    . \r\n * @property {Number} [minZoom=0]   . \r\n * @property {Number} [maxZoom=13]   =>15. \r\n * @property {Number} [panAnimDuration=1.0] panTo()/panBy()  animation  .  .\r\n * @property {Number} [zoomAnimDuration=0.3] zoomIn()/zoomOut()/zoomTo()  animation  .  .\r\n * @property {Boolean} [useCSSTransform=true] panning  CSS3 transform   . \r\n * @property {Boolean} [disableDefaultUI=false]    .\r\n * @property {Boolean} [copyrightControl=true] CopyrightControl  . \r\n * @property {olleh.maps.control.CopyrightControlOptions} [copyrightControlOptions] CopyrightControl \r\n * @property {Boolean} [logoControl=true] LogoControl  .\r\n * @property {olleh.maps.control.LogoControlOptions} [logoControlOptions] LogoControl \r\n * @property {Boolean} [mapTypeControl=true] MapTypeControl  . \r\n * @property {olleh.maps.control.ControlOptions} [mapTypeControlOptions] MapTypeControl  \r\n * @property {Boolean} [panControl=true] PanControl  . \r\n * @property {olleh.maps.control.ControlOptions} [panControlOptions] PanControl   \r\n * @property {Boolean} [scaleControl=true] ScaleControl  .\r\n * @property {olleh.maps.control.ControlOptions} [scaleControlOptions] ScaleControl \r\n * @property {Boolean} [zoomControl=true] ZoomControl  .\r\n * @property {olleh.maps.control.ZoomControlOptions} [zoomControlOptions] ZoomControl \r\n * @property {Number} [tileLayerBufferNum=0]     .\r\n * @property {Number} [tileLayerUpdateInterval=.1]      .  .\r\n * @property {Boolean} [tileFadeInDuration=.3]     .  . 0    .\r\n * @property {Boolean} [measureControl=true] MeasureControl  .\r\n * @property {olleh.maps.control.MeasureControlOptions} [measureControlOptions] MeasureControl \r\n * @property {Boolean} [dragInertia=true]    .\r\n * @property {Number} [dragInertiaThreshold]         delay .       .\r\n * @property {Number} [dragInertiaDeceleration]       \r\n * @property {Boolean} [disableDoubleClickZoom=false] true      .\r\n * @property {Boolean} [disableMultiTapZoom=false] true       .\r\n * @property {Boolean} [disablePinchZoom=false] true     . \r\n * @property {Boolean} [disableScrollWheelZoom=false] true      .\r\n * @property {Boolean} [disableShadow=false] true       .\r\n * @property {String} [mapTypeId]  MapType id\r\n * @property {Boolean} [useEngMap=false]   , true     , false   \r\n * @property {boolean} [disableDraggingCursor=true] true         .\r\n * @property {Number} [longpressThreshold=750]    (ms)   <code>longpress</code>  .\r\n * @property {string} [disableLoadingWhilePanning=false] true            . \r\n                                             true     false .\r\n * @group Map\r\n */\r\n\r\n//  HD      \r\n// * @property {Boolean} [hd=false] HD   . \r\n\r\n// JsDoc    map option.     \r\n// * @property {String} [draggingCursor]      CSS   URL. <p/> see: {@link olleh.maps.Map#setCursor}\r\n// * @property {String} [draggableCursor]   CSS   URL\r\n// * @property {olleh.maps.overlay.OverlayLayer} overlayLayer OverlayLayer instance. internal use only\r\n\r\n\r\n/**\r\n * Map \r\n */\r\n$class('olleh.maps.Map').mixin(olleh.maps.event.EventDelegator).define({\r\n  \r\n  $static: {\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_LEFT:171162,\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_BOTTOM:1214781,\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_RIGHT: 1744026,\r\n    /**\r\n     * KT     \r\n     * @type Number\r\n     */\r\n    DEFAULT_MAX_EXTENT_TOP: 2787645,\r\n    /**\r\n     *  MapType id. ROADMAP\r\n     * @type String\r\n     */\r\n    ROADMAP: 'ROADMAP',\r\n    /**\r\n     *  MapType id. SATELLITE\r\n     * @type String\r\n     */\r\n    SATELLITE: 'SATELLITE',\r\n    /**\r\n     *  MapType id. HYBRID\r\n     * @type String\r\n     */\r\n    HYBRID: 'HYBRID',\r\n    /**\r\n     *  MapType id. ENGMAP\r\n     * @type String\r\n     */\r\n    ENGMAP: 'ENGMAP',\r\n    /**\r\n     *      \r\n     * @type Number\r\n     */\r\n    DEFAULT_NORMAL_MAX_ZOOM: 13\r\n  },\r\n  \r\n  defaultOpts: {\r\n    mapTypeId: 'ROADMAP',\r\n    maxExtent: new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(171162, 1214781), // leftBottom\r\n        new olleh.maps.UTMK(1744026, 2787645) // rightTop\r\n    ),\r\n    restrictedExtent: new olleh.maps.Bounds(\r\n        new olleh.maps.UTMK(171162, 1214781), // leftBottom\r\n        new olleh.maps.UTMK(1744026, 2787645) // rightTop  \r\n    ),\r\n    trackWindowSize: true,\r\n    panAnimEaseLinearity1: 0.5,\r\n    panAnimEaseLinearity2: olleh.maps.browser.isMobile ? 0.7 : 0.25,\r\n    disableDraggingCursor: true,\r\n    draggingCursor: 'url(' + olleh.maps.env.RESOURCE_URL + 'cursor/closedhand_8_8.cur), move',\r\n    draggableCursor: 'url(' + olleh.maps.env.RESOURCE_URL + 'cursor/openhand_8_8.cur), default',\r\n    disableLoadingWhilePanning: olleh.maps.browser.osName === 'Android',\r\n    useEngMap: false,\r\n  },\r\n  \r\n  /**\r\n   * ,  HTML elem, opts    .\r\n   * @param {HTMLElement|String} elem Map   HTML element   element  id\r\n   * @param {olleh.maps.MapOptions} opts Map \r\n   */\r\n  Map: function (elem, opts) {\r\n    if(!elem) {\r\n      throw Error('Map element must be specified.');\r\n    }\r\n    if(olleh.maps.isString(elem)) {\r\n      elem = document.getElementById(elem);\r\n    }\r\n    var skeleton = olleh.maps.$skeleton;\r\n    this._defaultOpts = olleh.maps.util.clone(this.defaultOpts);\r\n    this._opts = opts;\r\n    this._cursor = 'ollehmap-default';\r\n    olleh.maps.util.dom.addClass(elem, 'ollehmap');\r\n    this.elem = elem;\r\n    this._cursors = [];\r\n\r\n    // setting whether English Map \r\n    this._setUseEngMap(this._opts.useEngMap);\r\n    \r\n    /**\r\n     * hasMobileStylesheet   CSS   .\r\n     * @type Boolean\r\n     */\r\n    this.hasMobileStylesheet =  false;\r\n    /**\r\n     * Service registry.   service    .\r\n     * {@link olleh.maps.Adaptable}  mixin     {@link olleh.maps.Adaptable#serviceId} field  \r\n     *      serviceId    services  .   \r\n     * @type Object\r\n     */\r\n    this.services = {};\r\n    /**\r\n     * MapType   Registry.\r\n     *  , ,   Layer   MapType  .\r\n     * @type Object\r\n     */\r\n    this._mapTypeRegistry = {};\r\n    \r\n    /**\r\n     * Plugin Registry.   Plugin    .\r\n     * @type olleh.maps.PluginRegistry\r\n     */\r\n    this.pluginRegistry = new olleh.maps.PluginRegistry();\r\n    /**\r\n     * EventManager   .\r\n     * @type olleh.maps.event.EventManager\r\n     */\r\n    this.eventMgr = new olleh.maps.event.EventManager(this, elem);\r\n    /**\r\n     * LayerManager       .\r\n     * @type olleh.maps.layer.LayerManager\r\n     */\r\n    this.layerMgr = new olleh.maps.layer.LayerManager(this, elem);\r\n    /**\r\n     * ControlManager   .\r\n     * @type olleh.maps.control.ControlManager\r\n     */\r\n    this.controlMgr = new olleh.maps.control.ControlManager(this);\r\n    \r\n    for (var i = 0, len = skeleton.length; i < len; i++) {\r\n      new skeleton[i]().setMap(this);\r\n    }\r\n    \r\n    if(this._opts.center)\r\n      this.start();\r\n  },\r\n  \r\n  /**\r\n   * user option  default option  merge   manager  start .  \r\n   * @private\r\n   */\r\n  start: function () {\r\n    // merge default opts\r\n    this._opts = olleh.maps.mixin(this._opts, this._defaultOpts);\r\n\r\n    if(this._opts.mapTypeId) {\r\n      this.setMapTypeId(this._opts.mapTypeId);\r\n    }\r\n    this._started = true;\r\n    this.eventMgr.start();\r\n    this.layerMgr.start();\r\n    this.controlMgr.start();\r\n    this.fireEvent('started');\r\n    this.setCursor(null);\r\n    if(olleh.maps.browser.hasOrientationChange) {\r\n      this._orientation = window.orientation;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {Boolean}   \r\n   */\r\n  _setUseEngMap:function(useEngMap){\r\n    this._useEngMap = useEngMap;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Boolean}   \r\n   */\r\n  getUseEngMap:function(){\r\n    return this._useEngMap;\r\n  },\r\n\r\n  /**\r\n   * Map  stop .\r\n   * @private\r\n   */\r\n  stop: function () {\r\n    this._started = false;\r\n    this.fireEvent('stopped');\r\n  },\r\n\r\n  /**\r\n   * Map  start    .\r\n   * @returns {Boolean}\r\n   * @private\r\n   */\r\n  isStarted: function () {\r\n    return !!this._started;\r\n  },\r\n\r\n  /**\r\n   * MapType   Plugin  .\r\n   * \r\n   * @param {String} id map type id\r\n   * @param {olleh.maps.Plugin|String} mapTypePlugin map type   Plugin,Layer  layer name .\r\n   */\r\n  registerMapType: function(id, mapTypePlugin) {\r\n    if(id === olleh.maps.Map.ENGMAP && !this.getUseEngMap()) return;\r\n\r\n    if(olleh.maps.isString(mapTypePlugin)) {\r\n      mapTypePlugin = this.layerMgr.getLayer(mapTypePlugin);\r\n    }\r\n    this._mapTypeRegistry[id] = mapTypePlugin;\r\n    mapTypePlugin.setMap(this);\r\n    if(this._mapTypeId === id) {\r\n      this._mapTypeId = null;\r\n      this.setMapTypeId(id);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * MapType id   plugin   . \r\n   * @param id MapType Id\r\n   */\r\n  unregisterMapType: function(id) {\r\n    delete this._mapTypeRegistry[id];\r\n  },\r\n  \r\n  /**\r\n   * MapType registry  .\r\n   * @returns {Object} key: MapType id, value: MapType plugin\r\n   */\r\n  getMapTypeRegistry: function() {\r\n    return this._mapTypeRegistry;\r\n  },\r\n  \r\n  /**\r\n   * {@link olleh.maps.Map#setMapTypeId(id)}   MapType     \r\n   * @name event:maptypeid_changed\r\n   * @event\r\n   * @memberOf olleh.maps.Map.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} payload\r\n   * @param {String} payload.mapTypeId\r\n   */\r\n  /**\r\n   *  MapType id  .\r\n   * @param id MapType Id\r\n   */\r\n  setMapTypeId: function(id) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#setMapTypeId: ' + id);\r\n    \r\n    //   ,     id olleh.maps.Map.ROADMAP  \r\n    if(id === olleh.maps.Map.ENGMAP && !this.getUseEngMap()) id = olleh.maps.Map.ROADMAP;\r\n\r\n    if(this._mapTypeId !== id) {\r\n      var oldMapTypePlugin = this._mapTypeRegistry[this._mapTypeId];\r\n      oldMapTypePlugin && oldMapTypePlugin.deactivate();\r\n      this._mapTypeId = id;\r\n      var mapTypePlugin = this._mapTypeRegistry[id];\r\n      mapTypePlugin.activate();\r\n      this.fireEvent('maptypeid_changed', {\r\n        mapTypeId: id\r\n      });\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  MapType id  .\r\n   * @returns {String}\r\n   */\r\n  getMapTypeId: function() {\r\n    return this._mapTypeId;\r\n  },\r\n  \r\n  /**\r\n   *  layer name   Layer   .\r\n   * @param {String} layerName\r\n   */\r\n  getLayer: function(layerName) {\r\n    return this.layerMgr.getLayer(layerName);\r\n  },\r\n  \r\n  /**\r\n   *   base layer  .\r\n   * @returns {Array.<olleh.maps.layer.Layer>} Base Layer \r\n   */\r\n  getBaseLayers: function() {\r\n    return this.layerMgr.getBaseLayers();\r\n  },\r\n  \r\n  /**\r\n   *   ground layer  .\r\n   * @returns {Array.<olleh.maps.layer.Layer>} Ground Layer \r\n   */\r\n  getGroundLayers: function() {\r\n    return this.layerMgr.getGroundLayers();\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @param {olleh.maps.Bounds} bounds   \r\n   * @returns {Number}  \r\n   */\r\n  getZoomForBounds: function(bounds) {\r\n    return this.layerMgr.getZoomForBounds(bounds);\r\n  },\r\n  \r\n  /**\r\n   *  coord    (bounds)   .\r\n   * @param {olleh.maps.Coord} coord \r\n   * @returns {Boolean}   \r\n   * @see olleh.maps.Map#getBounds\r\n   */\r\n  isValidCoord: function(coord) {\r\n    return this.layerMgr.isValidCoord(coord);\r\n  },\r\n  \r\n  /**\r\n   * OverlayLayer  .\r\n   * @returns {olleh.maps.overlay.OverlayLayer} OverlayLayer\r\n   */\r\n  getOverlayLayer: function () {\r\n    return this.layerMgr.getOverlayLayer();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Coord} coord  \r\n   */\r\n  setCenter: function (coord) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#setCenter: ' + coord);\r\n    this.layerMgr.isZooming() && this._warnZooming('setCenter');\r\n    this.layerMgr.setCenter(coord);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @returns {olleh.maps.UTMK}  \r\n   */\r\n  getCenter: function () {\r\n    this.layerMgr.isZooming() && this._warnZooming('getCenter');\r\n    return this.layerMgr.getCenter();\r\n  },\r\n\r\n  /**\r\n   *     .<br/>\r\n   *          \r\n   *            .  \r\n   * @returns {Number}  \r\n   */\r\n  getZoom: function () {\r\n    this.layerMgr.isZooming() && this._warnZooming('getZoom');\r\n    return this.layerMgr.getZoom();\r\n  },\r\n\r\n  /**\r\n   *      UTMK  .\r\n   * @returns {olleh.maps.Bounds}  \r\n   */\r\n  getBounds: function() {\r\n    this.layerMgr.isZooming() && this._warnZooming('getBounds');\r\n    return this.layerMgr.getBounds();\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {Number}   \r\n   */\r\n  getMinZoom: function() {\r\n    return this.layerMgr.getMinZoom();\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {Number}   \r\n   */\r\n  getMaxZoom: function() {\r\n    return this.layerMgr.getMaxZoom();\r\n  },\r\n\r\n  /**\r\n   *      . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            . <br/>\r\n   * :    zoom    {@link #getCenter()}  {@link #getZoom()}    center,zoom \r\n   *     .\r\n   * @param {Number} zoom  \r\n   */\r\n  setZoom: function (zoom) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#setZoom: ' + zoom);\r\n    this.layerMgr.isZooming() && this._warnZooming('setZoom');\r\n    this.layerMgr.setZoom(zoom);\r\n  },\r\n\r\n  /**\r\n   *       . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            .\r\n   */\r\n  zoomIn: function () {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#zoomIn');\r\n    this.layerMgr.isZooming() && this._warnZooming('zoomIn');\r\n    this.layerMgr.zoomIn();\r\n  },\r\n\r\n  /**\r\n   *       . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            .\r\n   */\r\n  zoomOut: function () {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#zoomOut');\r\n    this.layerMgr.isZooming() && this._warnZooming('zoomOut');\r\n    this.layerMgr.zoomOut();\r\n  },\r\n\r\n  /**\r\n   *              / .\r\n   * panToBounds()       .\r\n   * @param {olleh.maps.Bounds} bounds   \r\n   */\r\n  fitBounds: function (bounds) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#fitBounds: ' + bounds);\r\n    this.layerMgr.isZooming() && this._warnZooming('fitBounds');\r\n    this.layerMgr.fitBounds(bounds);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *              / .\r\n   * fitBounds()       . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            . \r\n   * @param {olleh.maps.Bounds} bounds   \r\n   */\r\n  panToBounds: function (bounds) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#panToBounds: ' + bounds.leftBottom.x + ', '+ bounds.leftBottom.y + ', '+ bounds.rightTop.x + ', '+ bounds.rightTop.x + ', ');\r\n    this.layerMgr.isZooming() && this._warnZooming('panToBounds');\r\n    this.layerMgr.panToBounds(bounds);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *            / . <br/>\r\n   * :    (panTo,panToBounds,setZoom )    \r\n   *   center  zoom         .\r\n   *            . <br/>\r\n   * :    zoom    {@link #getCenter()}  {@link #getZoom()}    center,zoom \r\n   *     . \r\n   * @param {olleh.maps.Coord} coord  \r\n   * @param {Number} [zoom]  \r\n   * @param {String} [animation=auto] 'off'     .\r\n   *                             'auto'            . \r\n   */\r\n  panTo: function (coord, zoom, animation) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#panTo: coord: ' + coord + ', zoom: ' + zoom);\r\n    this.layerMgr.isZooming() && this._warnZooming('panTo');\r\n    this.layerMgr.panTo(coord, zoom, animation);\r\n    this._checkStart();\r\n  },\r\n\r\n  /**\r\n   *         .\r\n   * @param {Number} dx   \r\n   * @param {Number} dy   \r\n   */\r\n  panBy: function (dx, dy) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info('Map#panBy: dx: ' + dx + ' ,dy:' + dy);\r\n    this.layerMgr.isZooming() && this._warnZooming('panBy');\r\n    this.layerMgr.panBy(dx, dy);\r\n  },\r\n  \r\n  _warnZooming: function(fnName) {\r\n    var log = olleh.maps.log;\r\n    if(log.isLevel(log.INFO))\r\n      log.info(':    ' +  fnName +  '      .    .');\r\n  },\r\n  \r\n  \r\n  /**\r\n   * Viewport size  .\r\n   * @returns {olleh.maps.Size} Viewport size\r\n   */\r\n  getViewportSize: function () {\r\n    return this.layerMgr.getViewportSize();\r\n  },\r\n  \r\n  /**\r\n   *   max extent (  )  .\r\n   * @returns {olleh.maps.Bounds} max extetnt\r\n   */\r\n  getMaxExtent: function () {\r\n    return this._opts.maxExtent;\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @example \r\n   * map.setCursor('url(...)');\r\n   * map.setCursor('default');\r\n   * map.setCursor('draggable');\r\n   * map.setCursor('dragging');\r\n   * @param {String} cursor   'default', 'draggable', 'dragging', CSS  . null    ('default'  'draggable')  .\r\n   * @see http://www.w3.org/TR/CSS21/ui.html#propdef-cursor|CSS  \r\n   */\r\n  setCursor: function (cursor) {\r\n    if(olleh.maps.browser.isMobile)\r\n      return;\r\n    var elem = this.elem;\r\n    if (!elem) return;\r\n    \r\n    if(this._cursors[this._cursors.length - 1] === cursor) return;\r\n    \r\n    var opts = this._opts;\r\n    if(!cursor) {\r\n      cursor = opts.disableDraggingCursor ? 'default' : 'draggable';\r\n    }\r\n    switch (cursor) {\r\n    case 'draggable':\r\n      cursor = opts.draggableCursor;\r\n      break;\r\n    case 'dragging':\r\n      cursor = opts.draggingCursor;\r\n      break;\r\n    }\r\n    this._cursors.push(cursor);\r\n    elem.style.cursor = cursor;\r\n  },\r\n  \r\n  /**\r\n   * {@link #setCursor(cursor)}   cursor   cursor  . \r\n   */\r\n  resetCursor: function() {\r\n    if (this._cursors.length <= 1) return;\r\n    this._cursors.pop();\r\n    this.elem.style.cursor = this._cursors[this._cursors.length - 1];\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @private\r\n   */\r\n  _checkStart: function() {\r\n    if(!this.isStarted()) {\r\n      this.start();\r\n    }\r\n  }, \r\n  \r\n  /**\r\n   * Map   .\r\n   * @returns {olleh.maps.MapOptions}\r\n   * @private\r\n   */\r\n  getOptions: function() {\r\n    return this._opts;\r\n  },\r\n  \r\n  /**\r\n   * Control   .\r\n   * @param {String} ctrlName\r\n   * @returns {Boolean} control  \r\n   * @private\r\n   */\r\n  checkDefaultControl: function(ctrlName){\r\n    var ctrlOpt = this.getOption(ctrlName);\r\n    var disableDefaultUI = this.getOption('disableDefaultUI', false);\r\n    return (ctrlOpt === true || !disableDefaultUI && ctrlOpt !== false);\r\n  },\r\n\r\n  /**\r\n   * Map   . \r\n   * @param {String} name Map  \r\n   * @param {object} defaultValue     \r\n   * @private\r\n   */\r\n  getOption: function(name, defaultValue) {\r\n    var value = this._opts[name];\r\n    return value !== undefined ? value : defaultValue;\r\n  },\r\n\r\n  /**\r\n   * Map   default    . \r\n   * default       . \r\n   * @param {Object} opts\r\n   * @private\r\n   */\r\n  mergeDefaultOptions: function(opts) {\r\n    olleh.maps.mixin(this._defaultOpts, opts, true);\r\n  },\r\n\r\n  /**\r\n   * [event:resize]\r\n   * trackWindowSize  true  resize     .\r\n   * @private\r\n   */\r\n  $default_resize: function (event, payload) {\r\n    if(this._opts.trackWindowSize) {\r\n      var ref = 'left';\r\n      //  orientation    center  .\r\n      if(payload.orientation !== undefined && payload.orientation !== this._orientation) {\r\n        ref = 'center';\r\n        this._orientation = payload.orientation;\r\n      }\r\n      this.layerMgr.resize(ref);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * viewport size       . \r\n   * Map element     element      .\r\n   * @param {String} [horizontalRef=left] left,right,center      . left     right      center  .\r\n   *  center   center   . center    verticalRef   .\r\n   * @param {String} [verticalRef=top] top  bottom    . top     bottom      center  . \r\n   */\r\n  resize: function(horizontalRef, verticalRef) {\r\n    this.layerMgr.resize(horizontalRef, verticalRef);\r\n  },\r\n  \r\n  /**\r\n   * Map   tooltip  .\r\n   * @returns {olleh.maps.overlay.Tooltip} Tooltip  \r\n   * @private\r\n   */\r\n  getTooltip: function() {\r\n    if(!this._tooltip && olleh.maps.overlay.Tooltip) {\r\n      this._tooltip = new olleh.maps.overlay.Tooltip();\r\n    }\r\n    return this._tooltip;\r\n  }\r\n\r\n});\r\n/**\r\n *   \r\n */\r\n$class('olleh.maps.layer.Tile').mixin(olleh.maps.event.EventDelegator).define({\r\n\r\n  /**\r\n   * ,  layer    .\r\n   * @param {olleh.maps.layer.TileLayer} layer\r\n   */\r\n  Tile: function (layer) {\r\n    this.setLayer(layer);\r\n    this._animationPolicy = 'none';\r\n    this._loading = false;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @return {olleh.maps.layer.TileLayer} \r\n   */\r\n  getLayer: function () {\r\n    return this._layer;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.layer.TileLayer} layer \r\n   */\r\n  setLayer: function (layer) {\r\n    this._layer = layer;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @return {olleh.maps.layer.TileLayer} \r\n   */\r\n  getBubble: function () {\r\n    return this._layer;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  setEffectPolicy: function (animationPolicy) {\r\n    this._animationPolicy = animationPolicy;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @return {boolean}\r\n   */\r\n  isLoading: function () {\r\n    return this._loading;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  getPosition: function () {\r\n    return this._position;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  setPosition: function (position) {\r\n    this._position = position;\r\n    this._root && this._updatePosition();\r\n  },\r\n\r\n  /**\r\n   * modify r2fresh\r\n   * @private\r\n   */\r\n  _getTileSize: function(){\r\n    var normalMaxZoom = olleh.maps.Map.DEFAULT_NORMAL_MAX_ZOOM;\r\n    var tileSize = this._layer.tileSize;\r\n    var zoom = this._layer.layerMgr.getZoom();\r\n    var tileSizeW = (zoom > normalMaxZoom) ? tileSize.width * ( (zoom - normalMaxZoom) * 2 ) : tileSize.width;\r\n    var tileSizeH = (zoom > normalMaxZoom) ? tileSize.height * ( (zoom - normalMaxZoom) * 2 ) : tileSize.height;\r\n    return {'width':tileSizeW,'height':tileSizeH}\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _updatePosition: function () {\r\n    // add r2fresh\r\n    var tileSize = this._getTileSize();\r\n\r\n    this._root.setStyles({\r\n      left: this._position.x + 'px',\r\n      top: this._position.y + 'px',\r\n      // add r2fresh\r\n      'width': tileSize.width + 'px',\r\n      'height': tileSize.height + 'px'\r\n    });\r\n  },\r\n\r\n  \r\n\r\n  /**\r\n   * @private\r\n   */\r\n  getURL: function () {\r\n    return this._url;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  setPositionAndUrl: function (position, url, animationPolicy) {\r\n    this._position = position;\r\n    this._url = url;\r\n    animationPolicy && (this._animationPolicy = animationPolicy);\r\n    this._root && this._update();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _update: function () {\r\n    // tileSize add r2fresh\r\n    var tileSize = this._getTileSize(), root = this._root, img = this._img, animation = this._layer.tileAnimation;\r\n    \r\n    this.stopAnimator();\r\n    this._updatePosition();\r\n    \r\n    if (img.getProperty('src') != this._url) {\r\n      img.setStyle({\r\n        'visibility': 'hidden',\r\n        //add r2fresh\r\n        'width': tileSize.width + 'px',\r\n        'height': tileSize.height + 'px'\r\n      });\r\n      this._loading = true;\r\n\r\n      if (animation && (this._animationPolicy == 'always' ||\r\n          (this._animationPolicy == 'once' && !this._layer.cachedTileURLs[this._url]))) {\r\n        root.setStyles(animation.from);\r\n        this._animator = animation.newAnimator(root, {\r\n          callback: this._fadedin.bind(this)\r\n        });\r\n      }\r\n\r\n      img.setStyle('visibility', '').setProperty('src', this._url);\r\n    } else if (!this._loading) {\r\n      this.fireEvent('loaded');\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {HTMLElement}\r\n   */\r\n  getElement: function () {\r\n    var browser = olleh.maps.browser;\r\n    // modify tileSize r2fresh\r\n    var tileSize = this._getTileSize(), root = this._root, img = this._img;\r\n    \r\n    if (!root) {\r\n      if (browser.has3D && !browser.use3DRootPane) {\r\n        root = this._root = olleh.maps.Element.create('div').setStyles({\r\n          position: 'absolute',\r\n          width: tileSize.width + 'px',\r\n          height: tileSize.height + 'px',\r\n          transform: 'translateZ(0)'\r\n        });\r\n        \r\n        img = this._img = olleh.maps.Element.create('img').setStyles({\r\n          width: tileSize.width + 'px',\r\n          height: tileSize.height + 'px'\r\n        });\r\n\r\n        root.appendChild(img);\r\n      } else {\r\n        root = img = this._root = this._img = olleh.maps.Element.create('img').setStyles({\r\n          position: 'absolute',\r\n          width: tileSize.width + 'px',\r\n          height: tileSize.height + 'px'\r\n        });\r\n        \r\n        if (browser.has3D && browser.osName == 'iOS') {\r\n          img.setStyle('transform', 'translate3d(0,0,0)');\r\n        }\r\n      }\r\n\r\n      this._bound_onload = this._onload.bind(this);\r\n      this._bound_onerror = this._onerror.bind(this);\r\n      \r\n      img.addEventListener('load', this._bound_onload);\r\n      img.addEventListener('error', this._bound_onerror);\r\n      \r\n      this._update();\r\n    }\r\n    \r\n    return root.elem;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  stopAnimator: function () {\r\n    if (this._animator) {\r\n      this._animator.stop();\r\n      this._animator = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  destroy: function () {\r\n    this.stopAnimator();\r\n    if (this._root) {\r\n      this._img.removeEventListener('load', this._bound_onload);\r\n      this._img.removeEventListener('error', this._bound_onerror);\r\n      this._root = this._img = null;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _onerror: function () {\r\n    if (this._loading) {\r\n      this.stopAnimator();\r\n      this._loading = false;\r\n      this._img.setProperty('src', this._layer.errorTileURL);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _onload: function () {\r\n    if (this._loading) {\r\n      this._layer.cachedTileURLs[this._url] = true;\r\n\r\n      if (this._animator) {\r\n        this._animator.start();\r\n      } else {\r\n        this._loading = false;\r\n        this.fireEvent('loaded');\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _fadedin: function (isFinished) {\r\n    if (isFinished) {\r\n      this._loading = false;\r\n      this.fireEvent('loaded');\r\n    }\r\n  }\r\n\r\n});\r\n/**\r\n * @typedef olleh.maps.layer.TileLayerOptions \r\n * @extends olleh.maps.layer.LayerOptions\r\n * @property {number} [tileSize=new olleh.maps.Size(256, 256)]  .  .\r\n * @property {number} [minZoom=0]      .\r\n * @property {number} [maxZoom=13]      =>15.\r\n * @property {string} [errorTileURL]        URL.\r\n * @property {number} [maxWaitTime=3] /   . -1  .  .\r\n */\r\n//<-             L             ->\r\n//<- -D -><-      V      ->\r\n//<-B->                     <-B->\r\n//+---+---------------------+---+\r\n//|   |                     |   |\r\n//+---+                     +---+\r\n//|                             |\r\n//|       +---------------+     |\r\n//|       |               |     |\r\n//|       |               |     |\r\n//|       |   viewport    |     |\r\n//|       |               |     |\r\n//|       |               |     |\r\n//|       +---------------+     |\r\n//|                             |\r\n//|         tile layer          |\r\n//+-----------------------------+\r\n//L = TileLayer#_getLayerSize()\r\n//D = -TileLayer#_getDisplayOffset()\r\n//B = TileLayer#bufferNum * TileLayer#tileSize\r\n//V = LayerManager#getVierportSize()\r\n//L / B = TileLayer#getGridNum()\r\n\r\n/**\r\n *    ()     .\r\n */\r\n$class('olleh.maps.layer.TileLayer').extend(olleh.maps.layer.Layer).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @constant\r\n     * @type string\r\n     */\r\n    ERROR_TILE_URL: olleh.maps.env.RESOURCE_URL + 'img/tile_transparent.png',\r\n\r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type olleh.maps.Size\r\n     */\r\n    DEFAULT_TILE_SIZE: new olleh.maps.Size(256, 256),\r\n\r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_MAX_WAIT_TIME: 3,\r\n    \r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_UPDATE_INTERVAL: .1,\r\n\r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_BUFFER_NUM: 0,\r\n    \r\n    /**\r\n     * @private\r\n     * @constant\r\n     * @type number\r\n     */\r\n    DEFAULT_TILE_FADE_IN_DURATION: .2\r\n  },\r\n  \r\n  /**\r\n   * ,   .\r\n   * @param {olleh.maps.layer.TileLayerOptions} opts .\r\n   */\r\n  TileLayer: function (opts) {\r\n    var TileLayer = olleh.maps.layer.TileLayer;\r\n\r\n    this.Tile = olleh.maps.layer.Tile;\r\n    this.tileSize = TileLayer.DEFAULT_TILE_SIZE;\r\n    this.minZoom = 0;\r\n    // modify r2fresh\r\n    //      maxZoom \r\n    // 13() => 15()\r\n    this.maxZoom = 15;\r\n    this.errorTileURL = TileLayer.ERROR_TILE_URL;\r\n    this.maxWaitTime = TileLayer.DEFAULT_MAX_WAIT_TIME;\r\n    \r\n    this._tileQueue = new olleh.maps.fx.AnimationFrameQueue();\r\n    this._tileQueue.setEnabled(false);\r\n    this._tiles = [];\r\n    this._movingBuffer = [];\r\n    this._visible = true;\r\n\r\n    this._pane = olleh.maps.Element.create('div').addClass('ollehmap-noevent').setStyle('position', 'absolute');\r\n    \r\n    this._createGridDiv();\r\n  },\r\n  \r\n  init: function () {\r\n    olleh.maps.mixin(this, this._constructorOpts, true, [ 'tileSize', 'getTileSize', 'minZoom', 'maxZoom', 'errorTileURL', 'maxWaitTime' ]);\r\n    olleh.maps.layer.TileLayer.$super.init.apply(this, arguments);\r\n  },\r\n  \r\n  start: function () {\r\n    var TileLayer = olleh.maps.layer.TileLayer;\r\n    var tileFadeInDuration = this.map.getOption('tileFadeInDuration', TileLayer.DEFAULT_TILE_FADE_IN_DURATION);\r\n    if (olleh.maps.browser.style.opacity && tileFadeInDuration !== 0) {\r\n      this.tileAnimation = new olleh.maps.fx.Animation({\r\n        from: {\r\n          opacity: '0'\r\n        },\r\n        to: {\r\n          opacity: '1'\r\n        },\r\n        duration: tileFadeInDuration,\r\n        timing: olleh.maps.fx.timing.easeOut\r\n      });\r\n    }\r\n    this.bufferNum = this.map.getOption('tileLayerBufferNum', TileLayer.DEFAULT_BUFFER_NUM);\r\n    this._updateInterval = this.map.getOption('tileLayerUpdateInterval', TileLayer.DEFAULT_UPDATE_INTERVAL);\r\n    this._disableLoadingWhilePanning = this.map.getOption('disableLoadingWhilePanning', false);\r\n    \r\n    //        (add code r2fresh)\r\n    var mapMaxZoom = this.map.getOptions().maxZoom;\r\n    this.maxZoom = (mapMaxZoom && mapMaxZoom <= 15) ? mapMaxZoom : this.maxZoom;\r\n  },\r\n\r\n  /**\r\n   * pane .\r\n   * @returns {HTMLElement} pane .\r\n   */\r\n  getPane: function () {\r\n    return this._pane.elem;\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {number}  .\r\n   */\r\n  getTileSize: function () {\r\n    // modify r2fresh\r\n    //    \r\n    var normalMaxZoom = olleh.maps.Map.DEFAULT_NORMAL_MAX_ZOOM;\r\n    var zoom = this.layerMgr.getZoom();\r\n    var tileSize = ( zoom > normalMaxZoom ) ? this.tileSize.multiplyBy((zoom - normalMaxZoom) * 2) : this.tileSize;\r\n    return tileSize;\r\n   // return this.tileSize;\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>.\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible != visible) {\r\n      this._visible = visible;\r\n      this._updateVisibility();\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @return {boolean} <code>true</code>  ,    .\r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _updateVisibility: function () {\r\n    this._pane.setStyle('display', this._visible && this.isVisibleForZoom() ? 'block' : 'none');\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @return {boolean}\r\n   */\r\n  isVisibleForZoom: function () {\r\n    var zoom;\r\n    if (!this.map) {\r\n      return false;\r\n    }\r\n    zoom = this.map.getZoom();\r\n    return this.minZoom <= zoom && zoom <= this.maxZoom;\r\n  },\r\n\r\n  \r\n  ////////////////////////////////////////\r\n  // Internal\r\n  ////////////////////////////////////////\r\n  \r\n  /**\r\n   *      .    .\r\n   * @private\r\n   * @returns {olleh.maps.Size}     .\r\n   */\r\n  _getLayerSize: function () {\r\n    var gridNum = this._gridNum;\r\n\r\n    // FIXME- android chrome  (#30257)\r\n    if (!gridNum) {\r\n      return;\r\n    }\r\n    var tileSize = this.getTileSize();\r\n\r\n    return new olleh.maps.Size(tileSize.width * gridNum.x,\r\n        tileSize.height * gridNum.y);\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @private\r\n   * @returns {olleh.maps.Point}      .\r\n   */\r\n  _getDisplayOffset: function () {\r\n    var offset = this._offset;\r\n    var layerOffset = this.layerMgr.getLayerOffset();\r\n    return new olleh.maps.Point(offset.x + layerOffset.x,\r\n        offset.y + layerOffset.y);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {olleh.maps.Point}\r\n   */\r\n  _getTilePosition: function (x, y) {\r\n    var offset = this._offset;\r\n    var tileSize = this.getTileSize();\r\n    return new olleh.maps.Point(offset.x + x * tileSize.width,\r\n        offset.y + (this._gridNum.y - 1 - y) * tileSize.height);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _createGridDiv: function () {\r\n    this._div = olleh.maps.Element.create('div')\r\n        .setStyle('position', 'absolute')\r\n        .addClass('ollehmap-noevent');\r\n    this._pane.appendChild(this._div);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {string} url\r\n   * @returns {olleh.maps.layer.Tile}\r\n   */\r\n  _removeTileFromArray: function (url, arr) {\r\n    var i, l;\r\n    for (i = 0, l = arr.length; i < l; i++) {\r\n      if (arr[i].getURL() == url) {\r\n        return arr.splice(i, 1)[0];\r\n      }\r\n    }\r\n    return null;\r\n  },\r\n\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _getGridNum: function () {\r\n    var viewportSize = this.layerMgr.getViewportSize()\r\n    var tileSize = this.getTileSize();\r\n    var bufferNum = this.bufferNum;\r\n    return {\r\n      x: Math.ceil(viewportSize.width / tileSize.height) + 1 + bufferNum * 2,\r\n      y: Math.ceil(viewportSize.height / tileSize.width) + 1 + bufferNum * 2\r\n    };\r\n  },\r\n  \r\n  ////////////////////////////////////////\r\n  // Drawing\r\n  ////////////////////////////////////////\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cleanup: function (dontCleanZoomingBuffer) {\r\n    this.cachedTileURLs = {};\r\n    this._loadedTileNum = 0;\r\n    this._unloadedTileNum = 0;\r\n    \r\n    this._updateVisibility();\r\n    \r\n    this._stopUpdateTimer();\r\n    this._stopZoomAnimation();\r\n    \r\n    if (!dontCleanZoomingBuffer) {\r\n      this._cleanZoomingBufferDiv();\r\n    }\r\n\r\n    //         .\r\n    this._tileQueue.clear();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _calculate: function () {\r\n    var tileSize = this.getTileSize();\r\n    var tileOrigin = this.tileOrigin;\r\n    var resolution = this.layerMgr.getResolution();\r\n    var origin = this.layerMgr.getBounds().leftBottom;\r\n\r\n    var tileCoordSize = {\r\n      width: tileSize.width * resolution,\r\n      height: tileSize.height * resolution\r\n    };\r\n\r\n    //   \r\n    var coordOffset = {\r\n      x: origin.x - tileOrigin.x,\r\n      y: origin.y - tileOrigin.y\r\n    };\r\n    \r\n    //    \r\n    var index = {\r\n      x: Math.floor(coordOffset.x / tileCoordSize.width),\r\n      y: Math.floor(coordOffset.y / tileCoordSize.height)\r\n    };\r\n    \r\n    //    lb\r\n    var tileLeftBottom = new olleh.maps.UTMK(\r\n        index.x * tileCoordSize.width + tileOrigin.x,\r\n        index.y * tileCoordSize.height + tileOrigin.y);\r\n    \r\n    this._gridNum = this._getGridNum();\r\n    \r\n    this.index = index;\r\n    \r\n    //    point\r\n    this._offset = this.layerMgr.getLayerPxFromCoord(tileLeftBottom)\r\n        ._subtract(0, tileSize.height * this._gridNum.y);\r\n  },\r\n  \r\n  \r\n  /**\r\n   * @param {boolean} dontCleanZoomingBuffer\r\n   * @private\r\n   */\r\n  draw: function (dontCleanZoomingBuffer) {\r\n    var Tile = this.Tile;\r\n    var x, y, tile, tileInfo, tilePosition, tileUrl, gridNum;\r\n    var oldTiles = this._tiles;\r\n    var tiles = [];\r\n    var later = [];\r\n    var unloadedTileNum = 0;\r\n    \r\n    this._cleanup(dontCleanZoomingBuffer);\r\n\r\n    //      .\r\n    if (!this.isVisible() || !this.isVisibleForZoom()) {\r\n      return;\r\n    }\r\n    \r\n    this._calculate();\r\n    \r\n    //    .\r\n    this._grid = [];\r\n    gridNum = this._gridNum;\r\n    for (x = 0; x < gridNum.x; x++) {\r\n      this._grid[x] = [];\r\n\r\n      for (y = 0; y < gridNum.y; y++) {\r\n        tileUrl = this.getTileURL(x, y);\r\n        if (!tileUrl) {\r\n          continue;\r\n        }\r\n        \r\n        tilePosition = this._getTilePosition(x, y);\r\n        \r\n        //   URL        .\r\n        //     unloadedTileNum  .\r\n        //     later   .\r\n        tile = this._removeTileFromArray(tileUrl, oldTiles);\r\n        if (tile) {\r\n          tile.setPosition(tilePosition);\r\n          tiles.push(tile);\r\n          this._grid[x][y] = tile;\r\n        } else {\r\n          later.push({\r\n            x: x,\r\n            y: y,\r\n            position: tilePosition,\r\n            url: tileUrl\r\n          });\r\n        }\r\n      }\r\n    }\r\n    \r\n    // later      .\r\n    //     URL   ,\r\n    //        .\r\n    while (tileInfo = later.pop()) {\r\n      tile = oldTiles.length ? oldTiles.pop() : new Tile(this);\r\n\r\n      tile.setPositionAndUrl(tileInfo.position, tileInfo.url, 'always');\r\n      unloadedTileNum++;\r\n      this._grid[tileInfo.x][tileInfo.y] = tile;\r\n      tiles.push(tile);\r\n      \r\n      //       .\r\n      if (!tile.getElement().parentNode) {\r\n        this._div.appendChild(tile.getElement());\r\n      }\r\n    }\r\n    \r\n    this._tiles = tiles;\r\n    \r\n    //       .\r\n    while (tile = oldTiles.pop()) {\r\n      if (tile.getElement().parentNode) {\r\n        this._div.removeChild(tile.getElement());\r\n      }\r\n      tile.destroy();\r\n    }\r\n    \r\n    // IE        src   \r\n    //    load  .   this._loadedTileNum\r\n    //      load  .\r\n    if (this._loadedTileNum == unloadedTileNum) {\r\n      olleh.maps.util.defer(this._onload, this);\r\n    } else {\r\n      this._unloadedTileNum = unloadedTileNum;\r\n    }\r\n  },\r\n  \r\n  \r\n  ////////////////////////////////////////\r\n  // Moving\r\n  ////////////////////////////////////////\r\n\r\n  /**\r\n   *    .\r\n   * @returns {boolean}    <code>true</code>,    <code>false</code>\r\n   */\r\n  isMoving: function () {\r\n    return this._tileQueue.isEnabled();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  move: function () {\r\n    if (!this._updateTimer) {\r\n      this._updateTimer = olleh.maps.util.delay(this._update, this._updateInterval * 1000, this);\r\n    }\r\n  },\r\n  \r\n  _stopUpdateTimer: function () {\r\n    if (this._updateTimer) {\r\n      window.clearTimeout(this._updateTimer);\r\n      this._updateTimer = null;\r\n    }\r\n  },\r\n  \r\n  _update: function () {\r\n    this._updateTimer = null;\r\n    this._tileQueue.setEnabled(false);\r\n    this._shiftGrid(false);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  moveStart: function () {\r\n    this._stopUpdateTimer();\r\n    if(!this._disableLoadingWhilePanning) {\r\n      this._tileQueue.setEnabled(true);\r\n      this._shiftGrid(true);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  moveEnd: function () {\r\n    if(this._disableLoadingWhilePanning) {\r\n      this._shiftGrid(false);\r\n    } else {\r\n      this._tileQueue.setEnabled(false);\r\n    }\r\n    this._cleanMovingBuffer();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {boolean} useBuffer\r\n   */\r\n  _shiftGrid: function (useBuffer) {\r\n    var isUpdated, viewportSize, layerSize, bufferSize, displayOffset;\r\n\r\n    //        \r\n    if (this.layerMgr.isZooming()) {\r\n      return;\r\n    }\r\n\r\n    //     \r\n    viewportSize = this.layerMgr.getViewportSize(); // V\r\n    layerSize = this._getLayerSize(); // L\r\n    bufferSize = this.getTileSize().multiplyBy(this.bufferNum); // B\r\n\r\n    // FIXME- android chrome  (#30257)\r\n    if (!layerSize) {\r\n      return;\r\n    }\r\n\r\n    // this._offset:     \r\n    do {\r\n      isUpdated = false;\r\n\r\n      //   \r\n      displayOffset = this._getDisplayOffset(); // D\r\n\r\n      // (case 1) -D < B :  (-) \r\n      //\r\n      // <-> -D\r\n      // <-B->                     shift\r\n      // +---*---------------------+---+\r\n      // |  +---------------+      |###|\r\n      // |  |               |      |###|\r\n      //\r\n      // (case 2) L + D - V < B :  (+) \r\n      // <-             L             ->\r\n      // <-   -D   -><-      V      ->\r\n      //                           <-B->\r\n      // +---+---------------------*---+\r\n      // |###|       +---------------+ |\r\n      // |###|       |               | |\r\n      // shift\r\n      \r\n      if (-displayOffset.x < bufferSize.width) {\r\n        this._shiftCol(-1, useBuffer);\r\n        isUpdated = true;\r\n      } else if (layerSize.width - (-displayOffset.x) - viewportSize.width < bufferSize.width) {\r\n        this._shiftCol(1, useBuffer);\r\n        isUpdated = true;\r\n      }\r\n\r\n      //    \r\n      if (-displayOffset.y < bufferSize.height) {\r\n        this._shiftRow(1, useBuffer);\r\n        isUpdated = true;\r\n      } else if (layerSize.height - (-displayOffset.y) - viewportSize.height < bufferSize.height) {\r\n        this._shiftRow(-1, useBuffer);\r\n        isUpdated = true;\r\n      }\r\n    } while (isUpdated);\r\n    \r\n    if (this._loadedTileNum == this._unloadedTileNum) {\r\n      olleh.maps.util.defer(this._onload, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    offset .\r\n   *            \r\n   *           .\r\n   *     _cleanMovingBuffer()    ,\r\n   *      moveEnd() .\r\n   * @private\r\n   * @param {number} offset   \r\n   */\r\n  _shiftCol: function (offset, useBuffer) {\r\n    var x, y, remove, add, tileCol;\r\n    var gridNum = this._gridNum;\r\n\r\n    if (offset < 0) {\r\n      x = 0;\r\n      remove = Array.prototype.pop;\r\n      add = Array.prototype.unshift;\r\n    } else {\r\n      x = gridNum.x - 1;\r\n      remove = Array.prototype.shift;\r\n      add = Array.prototype.push;\r\n    }\r\n\r\n    this.index.x = this.index.x + offset;\r\n    this._offset.x += offset * this.getTileSize().width;\r\n\r\n    tileCol = remove.call(this._grid);\r\n\r\n    for (y = 0; y < gridNum.y; y++) {\r\n      tileCol[y] = this._shiftTile(tileCol[y], x, y, useBuffer);\r\n    }\r\n\r\n    add.call(this._grid, tileCol);\r\n  },\r\n\r\n  /**\r\n   *    offset .   _shiftCol() .\r\n   * @private\r\n   * @param {number} offset   \r\n   */\r\n  _shiftRow: function (offset, useBuffer) {\r\n    var x, y, remove, add, oldTile, newTile;\r\n    var gridNum = this._gridNum;\r\n\r\n    if (offset < 0) {\r\n      y = 0;\r\n      remove = Array.prototype.pop;\r\n      add = Array.prototype.unshift;\r\n    } else {\r\n      y = gridNum.y - 1;\r\n      remove = Array.prototype.shift;\r\n      add = Array.prototype.push;\r\n    }\r\n\r\n    this.index.y = this.index.y + offset;\r\n    this._offset.y -= offset * this.getTileSize().height;\r\n\r\n    for (x = 0; x < gridNum.x; x++) {\r\n      oldTile = remove.call(this._grid[x]);\r\n      newTile = this._shiftTile(oldTile, x, y, useBuffer);\r\n      add.call(this._grid[x], newTile);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.layer.Tile} oldTile\r\n   * @param {number} x\r\n   * @param {number} y\r\n   * @param {boolean} useBuffer\r\n   * @return {olleh.maps.layer.Tile}\r\n   */\r\n  _shiftTile: function (oldTile, x, y, useBuffer) {\r\n    var tilePosition = this._getTilePosition(x, y);\r\n    var tileUrl = this.getTileURL(x, y);\r\n    var tile;\r\n    \r\n    if (useBuffer) {\r\n      this._movingBuffer.push(oldTile);\r\n      tile = this._removeTileFromArray(tileUrl, this._movingBuffer);\r\n      if (!tile) {\r\n        tile = new this.Tile(this);\r\n        this._appendTileLater(tile);\r\n      }\r\n    } else {\r\n      tile = oldTile;\r\n    }\r\n    \r\n    tile.setPositionAndUrl(tilePosition, tileUrl, 'once');\r\n    this._unloadedTileNum++;\r\n    \r\n    return tile;\r\n  },\r\n  \r\n  /**\r\n   *   pane . {@link olleh.maps.fx.AnimationFrameQueue} \r\n   *       .\r\n   * @private\r\n   * @param {olleh.maps.layer.Tile} tile pane  \r\n   */\r\n  _appendTileLater: function (tile) {\r\n    this._tileQueue.push(function () {\r\n      if (tile && !tile.getElement().parentNode) {\r\n        this._div.appendChild(tile.getElement());\r\n        this._tiles.push(tile);\r\n      }\r\n    }, this);\r\n  },\r\n\r\n  /**\r\n   *   pane  .\r\n   * @private\r\n   */\r\n  _cleanMovingBuffer: function () {\r\n    var tile;\r\n    while (tile = this._movingBuffer.pop()) {\r\n      if (tile.getElement().parentNode) {\r\n        if (tile.isLoading() && this._unloadedTileNum > 0) {\r\n          this._unloadedTileNum--;\r\n        }\r\n        this._div.removeChild(tile.getElement());\r\n        olleh.maps.util.removeFromArray(this._tiles, tile);\r\n      }\r\n      tile.destroy();\r\n    }\r\n  },\r\n  \r\n  \r\n  ////////////////////////////////////////\r\n  // Zooming\r\n  ////////////////////////////////////////\r\n\r\n  /**\r\n   *     .\r\n   * @returns {boolean}     <code>true</code>,    <code>false</code>\r\n   */\r\n  isZooming: function () {\r\n    return !!this._zoomingScale;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   */\r\n  zoomStart: function (scale, origin, duration, pulse) {\r\n    var i, l, tile, zoomingTiles;\r\n\r\n    if (this._zoomingScale == scale) {\r\n      return;\r\n    }\r\n\r\n    this._stopCleanTimer();\r\n    this._stopUpdateTimer();\r\n    this._tileQueue.clear();\r\n    \r\n    if (!this.isZooming()) {\r\n      //         div   .\r\n      this._cleanZoomingBufferDiv();\r\n\r\n      zoomingTiles = this._zoomingTiles = this._tiles;\r\n      for (i = 0, l = zoomingTiles.length; i < l; i++) {\r\n        tile = zoomingTiles[i];\r\n        tile.setEffectPolicy('none');\r\n        if (tile.status == 'animating') {\r\n          tile.stopAnimator();\r\n        }\r\n      }\r\n      \r\n      this._tiles = [];\r\n      this._unloadedTileNum = 0;\r\n\r\n      this._zoomingBufferDiv = this._div.setStyle('zIndex', '-1');\r\n      this._createGridDiv();\r\n\r\n      //         zoomingBufferDiv  \r\n      // movingBuffer      \r\n      this._movingBuffer = [];\r\n    }\r\n\r\n    if (olleh.maps.browser.style.transform) {\r\n      this._zoomWithTransform(scale, origin, duration, pulse);\r\n    } else {\r\n      this._zoomWithoutTransform(scale, origin, duration, pulse);\r\n    }\r\n    \r\n    this._zoomingScale = scale;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   */\r\n  _zoomWithTransform: function (scale, origin, duration, pulse) {\r\n    var zoomingBufferDiv, from;\r\n    \r\n    if (this.isZooming()) {\r\n      zoomingBufferDiv = this._zoomingBufferDiv;\r\n      from = this._zoomAnimator.ignore();\r\n    } else {\r\n      zoomingBufferDiv = this._zoomingBufferDiv.setStyle('transformOrigin',\r\n          origin.x + 'px ' + origin.y + 'px');\r\n      from = {\r\n        transform: olleh.maps.util.dom.getScaleString(1)\r\n      };\r\n    }\r\n    \r\n    this._zoomAnimator = new olleh.maps.fx.Animation({\r\n      from: from,\r\n      to: {\r\n        transform: olleh.maps.util.dom.getScaleString(scale)\r\n      },\r\n      duration: duration,\r\n      pulse: pulse,\r\n      timing: olleh.maps.fx.timing.easeOut\r\n    }).animate(zoomingBufferDiv);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {number} scale\r\n   * @param {olleh.maps.Point} origin\r\n   * @param {number} duration\r\n   * @param {olleh.maps.fx.Pulse} [pulse]\r\n   */\r\n  _zoomWithoutTransform: function (scale, origin, duration, pulse) {\r\n    var x, y;\r\n    var tileSize = this.getTileSize();\r\n    var gridNum = this._gridNum;\r\n    var layerPx = origin.add(this._offset.subtract(origin).multiplyBy(scale));\r\n    \r\n    if (!this._zoomAnimators) {\r\n      this._zoomAnimators = [];\r\n    }\r\n    for (x = 0; x < gridNum.x; x++) {\r\n      if (!this._zoomAnimators[x]) {\r\n        this._zoomAnimators[x] = [];\r\n      }\r\n      for (y = 0; y < gridNum.y; y++) {\r\n        this._zoomAnimators[x][y] = new olleh.maps.fx.Animation({\r\n          from: this._zoomAnimators[x][y] ? this._zoomAnimators[x][y].ignore() : {\r\n            width: tileSize.width + 'px',\r\n            height: tileSize.height + 'px',\r\n            left: this._grid[x][y].getPosition().x + 'px',\r\n            top: this._grid[x][y].getPosition().y + 'px'\r\n          },\r\n          to: {\r\n            width: (tileSize.width * scale) + 'px',\r\n            height: (tileSize.height * scale) + 'px',\r\n            left: (layerPx.x + x * tileSize.width * scale) + 'px',\r\n            top: (layerPx.y + (gridNum.y - y - 1) * tileSize.height * scale) + 'px'\r\n          },\r\n          duration: duration,\r\n          timing: olleh.maps.fx.timing.easeOut,\r\n          pulse: pulse\r\n        }).animate(this._grid[x][y].getElement());\r\n      }\r\n    }\r\n  },\r\n  \r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n      if (this.maxWaitTime >= 0 && this.isVisibleForZoom()) {\r\n        this._cleanTimer = olleh.maps.util.delay(this._cleanZoomingBufferDiv, this.maxWaitTime * 1000, this);\r\n      } else {\r\n        this._cleanZoomingBufferDiv();\r\n      }\r\n      this.draw(true);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _stopCleanTimer: function() {\r\n    if (this._cleanTimer) {\r\n      window.clearTimeout(this._cleanTimer);\r\n      this._cleanTimer = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _stopZoomAnimation: function () {\r\n    var x, y;\r\n    \r\n    this._zoomingScale = null;\r\n    \r\n    if (this._zoomAnimator) {\r\n      this._zoomAnimator.stop();\r\n      this._zoomAnimator = null;\r\n    } else if (this._zoomAnimators) {\r\n      for (x = 0; x < this._zoomAnimators.length; x++) {\r\n        for (y = 0; y < this._zoomAnimators[x].length; y++) {\r\n          this._zoomAnimators[x][y].stop();\r\n        }\r\n      }\r\n      this._zoomAnimators = null;\r\n    }\r\n    \r\n    this._stopCleanTimer();\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _cleanZoomingBufferDiv: function () {\r\n    var i, l;\r\n    if (this._zoomingBufferDiv) {\r\n      this._pane.removeChild(this._zoomingBufferDiv);\r\n      this._zoomingBufferDiv = null;\r\n      \r\n      for (i = 0, l = this._zoomingTiles.length; i < l; i++) {\r\n        this._zoomingTiles[i].destroy();\r\n      }\r\n      this._zoomingTiles = null;\r\n    }\r\n\r\n    this._stopCleanTimer();\r\n  },\r\n  \r\n  ////////////////////////////////////////\r\n  // Event\r\n  ////////////////////////////////////////\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.event.Event} event\r\n   */\r\n  $capture_loaded: function (event) {\r\n    if (event.getSource() !== this) { // assume src === tile\r\n      event.stopPropagation();\r\n      this._loadedTileNum++;\r\n      if (this._loadedTileNum == this._unloadedTileNum) {\r\n        this._onload();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _onload: function () {\r\n    if (!this._zoomAnimator && !this._zoomAnimators) {\r\n      this._cleanZoomingBufferDiv();\r\n    }\r\n\r\n    this._loadedTileNum = 0;\r\n    this._unloadedTileNum = 0;\r\n    this.fireEvent('loaded');\r\n  }\r\n\r\n});\r\n/**\r\n * @typedef olleh.maps.layer.OllehTileLayerOptions \r\n * @extends olleh.maps.layer.TileLayerOptions\r\n * @property {string} tileURLTmpl  URL .\r\n */\r\n\r\n/**\r\n *  KT  .\r\n */\r\n$class('olleh.maps.layer.OllehTileLayer').extend(olleh.maps.layer.TileLayer).define({\r\n\r\n  /**\r\n   * Logo  . black  white .\r\n   * @type String\r\n   */\r\n  logoType: 'black',\r\n\r\n  /**\r\n   * @private\r\n   * @constant\r\n   * @type string\r\n   */\r\n  _OUT_OF_BOUND_TILE_URL: olleh.maps.env.RESOURCE_URL + 'img/tile_transparent.png',\r\n\r\n  /**\r\n   * @private\r\n   * @constant\r\n   * @type olleh.maps.UTMK\r\n   */\r\n  tileOrigin: new olleh.maps.UTMK(171162, 1214781),\r\n\r\n  /**\r\n   * @private\r\n   * @constant\r\n   * @type olleh.maps.Bounds\r\n   */\r\n  tileMaxBounds: new olleh.maps.Bounds(new olleh.maps.UTMK(171162, 1214781), new olleh.maps.UTMK(1744026, 2787645)),\r\n  \r\n  /**\r\n   * \r\n   * @param {olleh.maps.layer.OllehTileLayerOptions} opts .\r\n   */\r\n  OllehTileLayer: function (opts) {\r\n    this.errorTileURL = olleh.maps.layer.OllehTileLayer.OUT_OF_BOUND_TILE_URL;\r\n    this._maxTileIndex = [];\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  init: function () {\r\n    olleh.maps.mixin(this, this._constructorOpts, true, [ 'tileURLTmpl', 'logoType']);\r\n    olleh.maps.layer.OllehTileLayer.$super.init.apply(this, arguments);\r\n\r\n    // logoType     black \r\n    if(this.logoType !== 'black') {\r\n      this.logoType = 'white'\r\n    }\r\n\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  getMaxTileIndex: function () {\r\n    var zoom = this.layerMgr.getZoom();\r\n    var tileSize = this.getTileSize();\r\n    var maxTileIndex = this._maxTileIndex[zoom];\r\n    if (!maxTileIndex) {\r\n      var tileMaxBounds = this.tileMaxBounds;\r\n      var resolution = this.layerMgr.getResolution();\r\n      var tileCoordSize = {\r\n        width: tileSize.width * resolution,\r\n        height: tileSize.height * resolution\r\n      };\r\n      maxTileIndex = this._maxTileIndex[zoom] = {\r\n        x: Math.floor((tileMaxBounds.getRight() - tileMaxBounds.getLeft()) / tileCoordSize.width) - 1,\r\n        y: Math.floor((tileMaxBounds.getTop() - tileMaxBounds.getBottom()) / tileCoordSize.height) - 1\r\n      };\r\n    }\r\n    return maxTileIndex;\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {Number} x\r\n   * @param {Number} y\r\n   * @returns {String}      (x, y)     URL\r\n   */\r\n  getTileURL: function (x, y) {\r\n    // modify r2fresh\r\n    //       \r\n    // () var zoom = this.layerMgr.getZoom();\r\n    var nomalMaxZoom = olleh.maps.Map.DEFAULT_NORMAL_MAX_ZOOM;\r\n    var zoom = ( this.layerMgr.getZoom() > nomalMaxZoom ) ? nomalMaxZoom : this.layerMgr.getZoom();\r\n    var maxIndex = this.getMaxTileIndex();\r\n    var tileX = this.index.x + x;\r\n    var tileY = maxIndex.y - (this.index.y + y);\r\n    if (tileX < 0 || tileX > maxIndex.x || tileY < 0 || tileY > maxIndex.y) {\r\n      return this._OUT_OF_BOUND_TILE_URL;\r\n    }\r\n\r\n    // modify r2fresh\r\n    // ktgis.com  => 16\r\n    // gis.kt.com  => 10\r\n    var tileOpt = (this.tileURLTmpl.indexOf('gis.kt.com') >= 0)?{\r\n      x: tileX,\r\n      y: tileY,\r\n      z: zoom\r\n    } : {\r\n      x: this._fillZero(tileX.toString(16), 8),\r\n      y: this._fillZero(tileY.toString(16), 8),\r\n      z: this._fillZero(zoom, 2)\r\n    }\r\n    \r\n    return olleh.maps.util.applyTemplate(this.tileURLTmpl, tileOpt);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {String} str\r\n   * @param {Number} len\r\n   * @returns {String}\r\n   */\r\n  _fillZero: function (str, len) {\r\n    return '00000000'.substr(0, len - (str + '').length) + str;\r\n  }\r\n\r\n});\r\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.DefaultComponents').extend(olleh.maps.Adaptable).define({\r\n  \r\n  attach: function () {\r\n    var useHD = this.map.getOption('hd', olleh.maps.browser.isHDTile) && olleh.maps.browser.isHDTile;\r\n    var env = olleh.maps.env;\r\n    var oBase = new olleh.maps.layer.OllehTileLayer({\r\n      name: 'OllehBase',\r\n      label: olleh.maps.msg(''),\r\n      layerType: 'base',\r\n      logoType: 'black',\r\n      tileSize: useHD ? new olleh.maps.Size(128, 128) : new olleh.maps.Size(256, 256),\r\n      tileURLTmpl: useHD ? env.TILE_URL.HD_BASE : env.TILE_URL.BASE,\r\n      errorTileURL: olleh.maps.env.RESOURCE_URL + 'img/tile_nodata.jpg',\r\n      copyright: useHD ? env.TILE_COPYRIGHT.HD_BASE : env.TILE_COPYRIGHT.BASE,\r\n\r\n      // 1  maxZoom   (modify r2fresh)\r\n      maxZoom:13\r\n    });\r\n    this.map.registerMapType('ROADMAP',oBase);\r\n  },\r\n  \r\n  detach: function () {\r\n    // ???\r\n  }\r\n  \r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.DefaultComponents);/**\n * @private\n */\n$class('olleh.maps.layer.OllehAirMapType').extend(olleh.maps.Plugin).define({\n\n  doActivate: function() {\n    this.map.getLayer('OllehAir').activate();\n\n    // 1  maxZoom   (modify r2fresh)\n    this.map.layerMgr.setMaxZoom(14);\n  }\n\n});\n\n/**\n * @private\n */\n$class('olleh.maps.layer.OllehEngMapType').extend(olleh.maps.Plugin).define({\n\n    doActivate: function() {\n      this.map.getLayer('OllehEng').activate();\n  \n      // 1  maxZoom   (modify r2fresh)\n      this.map.layerMgr.setMaxZoom(13);\n    }\n  \n  });\n\n/**\n * @private\n */\n$class('olleh.maps.layer.OllehHybridMapType').extend(olleh.maps.Plugin).define({\n  \n  doActivate: function() {\n    \n    // 1  maxZoom   (modify r2fresh)\n    this.map.layerMgr.setMaxZoom(13);\n    this.map.getLayer('OllehAir').activate();\n    this.map.getLayer('OllehAirLabel').activate();\n  },\n  \n  doDeactivate: function() {\n    this.map.getLayer('OllehAirLabel').deactivate();\n  }\n  \n});\n\n/**\n * @private\n */\n$class('olleh.maps.layer.OllehTilesPlugin').extend(olleh.maps.Adaptable).define({\n  \n  attach: function () {\n    this.env = olleh.maps.env;\n    this.useHD = this.map.getOption('hd', olleh.maps.browser.isHDTile) && olleh.maps.browser.isHDTile;\n\n    this.setAirMap();\n    this.setEngMap();\n    this.setHybridMap();\n  },\n\n  /**\n   *    \n   */\n  setHybridMap: function(){\n    var oHybrid = new olleh.maps.layer.OllehTileLayer({\n      name: 'OllehAirLabel',\n      label: olleh.maps.msg(' '),\n      layerType: 'ground',\n      zIndex: 0,\n      tileSize: this.useHD ? new olleh.maps.Size(128, 128) : new olleh.maps.Size(256, 256),\n      tileURLTmpl: this.useHD ? this.env.TILE_URL.HD_HYBRID : this.env.TILE_URL.HYBRID,\n      maxWaitTime: 0.7,\n\n      // 1  maxZoom   (modify r2fresh)\n      maxZoom : 13\n    });\n    oHybrid.setMap(this.map);\n    this.ollehHybridMapType = new olleh.maps.layer.OllehHybridMapType();\n    this.map.registerMapType('HYBRID', this.ollehHybridMapType);\n  },\n\n  /**\n   *    \n   */\n  setAirMap: function(){\n    var oAir = new olleh.maps.layer.OllehTileLayer({\n      name: 'OllehAir',\n      label: olleh.maps.msg(''),\n      layerType: 'base',\n      logoType: 'white',\n      tileURLTmpl: this.env.TILE_URL.AIR,\n      errorTileURL: this.env.RESOURCE_URL + 'img/tile_nodata.jpg',\n      copyright: this.env.TILE_COPYRIGHT.AIR,\n\n      // 1  maxZoom   (modify r2fresh)\n      maxZoom : 14\n    });\n    oAir.setMap(this.map);\n    this.ollehAirMapType = new olleh.maps.layer.OllehAirMapType();\n    this.map.registerMapType('SATELLITE', this.ollehAirMapType);\n  }, \n\n  /**\n   *     \n   */\n  setEngMap: function() {\n    var oEng = new olleh.maps.layer.OllehTileLayer({\n      name: 'OllehEng',\n      label: olleh.maps.msg(''),\n      layerType: 'base',\n      logoType: 'black',\n      tileURLTmpl: this.env.TILE_URL.ENG,\n      errorTileURL: this.env.RESOURCE_URL + 'img/tile_nodata.jpg',\n      copyright: this.env.TILE_COPYRIGHT.ENG,\n\n      // 1  maxZoom   (modify r2fresh)\n      maxZoom : 13\n    });\n    oEng.setMap(this.map);\n    this.ollehEngMapType = new olleh.maps.layer.OllehEngMapType();\n    this.map.registerMapType('ENGMAP', this.ollehEngMapType);\n  },\n  \n  detach: function () {\n    // ????\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.layer.OllehTilesPlugin);\n/**\r\n * 4 Ease-in    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseInQuad').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return t * t;\r\n    };\r\n  }\r\n\r\n});\r\n/**\r\n * 4 Ease-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseOutQuad').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return t * (2 - t);\r\n    };\r\n  }\r\n\r\n});\r\n/**\r\n * 4 Ease-in-out    .\r\n */\r\n$class('olleh.maps.fx.timing.EaseInOutQuad').extend(olleh.maps.fx.timing.Timing).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return (t < .5) ? (2 * t * t) : (-1 + (4 - 2 * t) * t);\r\n    };\r\n  }\r\n\r\n});\r\n/**\n * TrafficInfoControl   Layer             . \n *    .\n */\n$class('olleh.maps.control.TrafficInfoControl').extend(olleh.maps.control.Control).define({\n  $static: {\n    /**\n     * @constant\n     * @type Object\n     */\n    SPEED_INFO: {\n      '': {\n        color: 'green',\n        loadSpeed: {\n          ',': '30/h',\n          '': '60/h',\n          '': '70/h'\n        }\n      },\n      '': {\n        color: 'yellow',\n        loadSpeed: {\n          ',': '20~30/h',\n          '': '40~60/h',\n          '': '50~70/h'\n        }\n      },\n      '': {\n        color: 'orange',\n        loadSpeed: {\n          ',': '10~20/h',\n          '': '20~40/h',\n          '': '30~50/h'\n        }\n      },\n      '': {\n        color: 'red',\n        loadSpeed: {\n          ',': '10/h',\n          '': '20/h',\n          '': '30/h'\n        }\n      }\n    }\n  },\n\n  /**\n   * ,  TrafficInfoControl  .\n   * @param {olleh.maps.control.ControlOptions} [opts] TrafficInfoControl   <br>\n   * opts.position  : {@link olleh.maps.control.Control.BOTTOM_LEFT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\n   */\n  TrafficInfoControl: function (opts) {\n    var _opts = olleh.maps.mixin({\n      position: olleh.maps.control.Control.BOTTOM_LEFT,\n      direction: olleh.maps.control.Control.VERTICAL\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    this.tooltips = {};\n    this.rdoms = [];\n    var left = 0;\n    var speedInfos = olleh.maps.control.TrafficInfoControl.SPEED_INFO;\n    var elem = olleh.maps.Element.create('div');\n    var title = document.createElement('h1');\n    var imgDiv = document.createElement('div');\n    var _closeTrafficInfo = function (domEvent, elem) {\n      olleh.maps.util.dom.addClass(elem, 'ollehmap-hidden');\n    };\n    var _openTrafficInfo = function (domEvent, elem) {\n      olleh.maps.util.dom.removeClass(elem, 'ollehmap-hidden');\n    };\n\n    title.innerHTML = olleh.maps.msg(' ');\n    this.registerEventDom(elem.elem);\n    elem.addClass('ollehmap-traffic-control');\n    elem.setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n    elem.appendChild(title);\n    elem.appendChild(imgDiv);\n    imgDiv.appendChild(document.createTextNode(' ' + olleh.maps.msg(\"\") + ' '));\n    olleh.maps.util.dom.addClass(imgDiv, 'imgDiv');\n    for ( var i in speedInfos) {\n      var speedInfo = speedInfos[i];\n      var trafficBar = olleh.maps.Element.create('div');\n      var loadInfos = speedInfo.loadSpeed;\n      trafficBar.addClass('trafficbar');\n      trafficBar.setStyles({\n        backgroundColor : speedInfo.color,\n        pointerEvents: 'auto'\n      });\n      imgDiv.appendChild(trafficBar.elem);\n\n      if (loadInfos) {\n        var tooltip = document.createElement('div');\n\n        var ul = document.createElement('ul');\n        for ( var j in loadInfos) {\n          var loadInfo = loadInfos[j];\n          var li = document.createElement('li');\n          li.innerHTML = '<span class=\"a1\">' + olleh.maps.msg(j) + '</span><span class=\"a2\">: ' + loadInfo\n              + '</span>';\n          ul.appendChild(li);\n        }\n        tooltip.appendChild(ul);\n        olleh.maps.util.dom.setStyle(tooltip, 'backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n        olleh.maps.util.dom.setStyle(tooltip, 'left', left + 'px');\n        left += 55;\n        olleh.maps.util.dom.addClass(tooltip, 'control-traffic-info');\n        olleh.maps.util.dom.addClass(tooltip, 'tooltip');\n        olleh.maps.util.dom.addClass(tooltip, 'ollehmap-hidden');\n        elem.appendChild(tooltip);\n        this.tooltips[i] = tooltip;\n\n        trafficBar.addEventListener('mouseout', olleh.maps.curry(_closeTrafficInfo, null, tooltip));\n        trafficBar.addEventListener('mouseover', olleh.maps.curry(_openTrafficInfo, null, tooltip));\n      }\n      this.rdoms.push(trafficBar);\n    }\n    imgDiv.appendChild(document.createTextNode(' ' + olleh.maps.msg('') + ' '));\n    var infoElem = document.createElement('ul');\n    infoElem.innerHTML = '<li>' + olleh.maps.msg('    ,    ') + '</li><li>' + \n      olleh.maps.msg('         ') + '</li>';\n    elem.appendChild(infoElem);\n    return elem;\n  }\n});\n/**\n * MobileTrafficInfoControl   Layer           \n *  .    .\n */\n$class('olleh.maps.control.MobileTrafficInfoControl').extend(olleh.maps.control.Control).define({\n\n  /**\n   * MobileTrafficInfoControl \n   * @param {olleh.maps.control.ControlOptions} [opts] MobileMapTypeControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n  MobileTrafficInfoControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    this.position = Control.TOP_RIGHT;\n    this.direction = Control.HORIZONTAL;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div').setStyles({\n      padding: this.padding + 'px'\n    });\n    var trafficImg = this._trafficImg = olleh.maps.Element.create('div').addClass('mobile-traffic-info');\n\n    if(olleh.maps.browser.isHD)\n      trafficImg.addClass('retina').setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/retinas.png)');\n    else\n      trafficImg.setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/mobiles.png)');\n    elem.appendChild(trafficImg);\n    return elem;\n  }\n\n});\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.TrafficInfoPlugin').mixin(olleh.maps.Plugin).define({\r\n\r\n  serviceId: 'trafficInfo',\r\n\r\n  pluginInfo: {\r\n    label: olleh.maps.msg(' '),\r\n    autoActivate: false,\r\n    group: 'ground'\r\n  },\r\n  /**\r\n   * TODO:\r\n   *   MobileTrafficInfoControl    TrafficInfoControl     \r\n   */\r\n  attach: function () {\r\n    this.trafficLayer = new olleh.maps.layer.OllehTileLayer({\r\n      name: 'OllehTraffic',\r\n      layerType: 'ground',\r\n      zIndex: 1,\r\n      tileURLTmpl: olleh.maps.env.TILE_URL.TRAFFIC,\r\n      maxWaitTime: 0.7,\r\n      map: this.map\r\n    });\r\n\r\n    if(!this.trafficInfoControl){\r\n      if (olleh.maps.browser.isMobile)\r\n        this.trafficInfoControl = new olleh.maps.control.MobileTrafficInfoControl();\r\n      else {\r\n        this.trafficInfoControl = new olleh.maps.control.TrafficInfoControl();\r\n      }\r\n    }\r\n  },\r\n\r\n  detach: function () {\r\n    this.trafficLayer.setMap(null);\r\n    this.trafficLayer = null;\r\n    this.trafficInfoControl.setMap(null);\r\n    this.trafficInfoControl = null;\r\n  },\r\n\r\n  doActivate: function () {\r\n    this.trafficLayer.activate();\r\n    this.trafficInfoControl.setMap(this.map);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    this.trafficLayer.deactivate();\r\n    this.trafficInfoControl.setMap(null);\r\n  }\r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.TrafficInfoPlugin);\r\n/**\r\n * OverlayOptions Object Specification\r\n * @typedef olleh.maps.overlay.OverlayOptions\r\n * @property {olleh.maps.Map} [map]    . null      .\r\n */\r\n\r\n/**\r\n *   interface\r\n */\r\n$class('olleh.maps.overlay.Overlay').extend(olleh.maps.Initializable).mixin(olleh.maps.event.EventDelegator, olleh.maps.Adaptable).define({\r\n  \r\n  /**\r\n   * position_changed . \r\n   *   Overlay       .\r\n   * @event olleh.maps.overlay.Overlay#event:position_changed\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {Object} payload\r\n   * @param {olleh.maps.Coord} payload.from  \r\n   * @param {olleh.maps.Coord} payload.to  \r\n   */\r\n  /**\r\n   * bounds_changed .\r\n   *   Overlay         .\r\n   * @event olleh.maps.overlay.Overlay#event:bounds_changed\r\n   * @param {olleh.maps.event.Event} event\r\n   * @param {olleh.maps.Bounds} payload.from  Bounds\r\n   * @param {olleh.maps.Bounds} payload.to  Bounds\r\n   */\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.overlay.OverlayOptions} opts\r\n   */\r\n  Overlay: function (opts) {\r\n    this._constructorOpts = opts || {};\r\n    this._bubble = null;\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @private\r\n   */\r\n  init: function () {\r\n    this.setOptions(this._constructorOpts);\r\n    this._constructorOpts = null;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.OverlayOptions} opts .\r\n   */\r\n  setOptions: function (opts) {\r\n    opts.visible !== undefined && this.setVisible(opts.visible);\r\n    opts.map !== undefined && this.setMap(opts.map);\r\n  },\r\n  \r\n  /**\r\n   *      true  .\r\n   * @returns {Boolean}\r\n   * @private\r\n   */\r\n  isAdded: function () {\r\n    return !!this.layer;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   *   element  pane     .\r\n   *  {@link olleh.maps.event.EventDelegator#registerEventDom}  \r\n   *   element   .\r\n   *    element      .\r\n   * @param {Boolean} onAdd      draw()    true\r\n   * @private  \r\n   */\r\n  draw: function (onAdd) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * draw()    .\r\n   *    element  pane     .\r\n   *  {@link olleh.maps.event.EventDelegator#unregisterEvent} \r\n   * Overlay     .\r\n   *      erase()      draw()   \r\n   * element   reference     . \r\n   * @param {Boolean} onRemove     draw()    true\r\n   * @private \r\n   */\r\n  erase: function (onRemove) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {Boolean} visible true    false   . \r\n   */\r\n  setVisible: function (visible) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @returns {Boolean}\r\n   */\r\n  isVisible: function () {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * zoom animation    .    zoomEnd()  .\r\n   * @param {Number} scale / . zoomEnd()    zoomStart()   \r\n   *   zoomStart()    .\r\n   * @param {olleh.maps.Point} origin zoom animation  \r\n   * @param {Number} duration zoom animation   \r\n   * @param {olleh.maps.fx.Pulse} [pulse] .      .\r\n   * @private\r\n   */\r\n  zoomStart: function (scale, origin, duration, pulse) {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   * zoom animation    .\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n    // Subclass should override this\r\n  },\r\n\r\n  /**\r\n   *        bounds  .\r\n   *    Marker         .\r\n   * @returns {olleh.maps.Bounds}\r\n   * @private\r\n   */\r\n  getBounds: function () {\r\n    // Sublcass may override this\r\n    return null;\r\n  },\r\n\r\n  /**\r\n   *        coord  .\r\n   *   GroundOverlay        .\r\n   * @returns {olleh.maps.Coord}\r\n   * @private\r\n   */\r\n  getPosition: function () {\r\n    // Sublcass may override this\r\n    return null;\r\n  },\r\n\r\n  /**\r\n   *  bubble target   .\r\n   *    {@link olleh.maps.layer.Layer}  bubble target  .\r\n   * @param bubble\r\n   * @private\r\n   */\r\n  setBubble: function (bubble) {\r\n    this._bubble = bubble;\r\n  },\r\n\r\n  /**\r\n   *  bubble target  .\r\n   * @private\r\n   */\r\n  getBubble: function () {\r\n    return this._bubble || this.layer;\r\n  },\r\n\r\n  /**\r\n   *   layer  .\r\n   * @returns {olleh.maps.layer.Layer} layer \r\n   */\r\n  getLayer: function () {\r\n    return this.layer;\r\n  },\n  \r\n  attach: function() {\r\n    this.map.getOverlayLayer().add(this);\n  },\r\n\r\n  detach: function() {\r\n    this.layer && this.layer.remove(this);\r\n  },\r\n  \r\n  /**\r\n   * OverlayLayer  Overlay       . \r\n   * @param {boolean} displayHint true    \r\n   * @private\r\n   */\r\n  setDisplayHint: function(displayHint) {\r\n    // Subclass should override this\r\n  }\r\n  \r\n});\r\n/**\n * @typedef olleh.maps.overlay.BaseOverlayOptions\n * BaseOverlayOptions Object Specification\n * @property {Boolean} [visible=true] . <code>true</code>  .\n * @property {Number|String} [zIndex=auto] z-index.     . <code>'auto'</code>   .\n * @extends olleh.maps.overlay.OverlayOptions\n */\n\n/**\n * HTML   .\n */\n$class('olleh.maps.overlay.BaseOverlay').extend(olleh.maps.overlay.Overlay).define({\n  \n  $static: {\n    /** \n     *   z-index\n     * @constant\n     * @type Number \n     */\n    MAX_ZINDEX: 357913940\n  },\n\n  /**\n   * ,   .\n   */\n  BaseOverlay: function () {\n    this._drawn = false;\n    this._visible = true;\n    this._zIndex = 'auto';\n    this._displayHint = true;\n    \n    this.elements = {};\n    this._moveAnimators = [];\n  },\n\n  /**\n   *  .\n   * @param {olleh.maps.overlay.BaseOverlayOptions} opts .\n   */\n  setOptions: function (opts) {\n    opts.zIndex !== undefined && this.setZIndex(opts.zIndex);\n    olleh.maps.overlay.BaseOverlay.$super.setOptions.apply(this, arguments);\n  },\n\n  /**\n   * HTML element     HTML element  .\n   * {@link olleh.maps.overlay.BaseOverlay#draw}    . \n   * @private\n   */\n  update: function () {\n    this._updateVisibility();\n    this._updateZIndex();\n  },\n  \n  /**\n   * @name getIndexObject\n   * @memberOf olleh.maps.overlay.BaseOverlay.prototype\n   * @returns {olleh.maps.Coord|olleh.maps.Bounds}\n   *             {@link olleh.maps.Coord} \n   *         {@link olleh.maps.Bounds}  .\n   */\n\n  /**\n   *  .\n   * @returns {Boolean}   <code>true</code>,    <code>false</code>.\n   */\n  isVisible: function () {\n    return this._visible;\n  },\n\n  /**\n   *  .\n   * @fires olleh.maps.overlay.BaseOverlay#event:visible_changed\n   * @param {Boolean} visible <code>true</code>  ,    .\n   */\n  setVisible: function (visible) {\n    if (this._visible === visible) {\n      return;\n    }\n    this._visible = visible;\n    this._drawn && this._updateVisibility();\n    \n    /**\n     *    .\n     * @event olleh.maps.overlay.BaseOverlay#event:visible_changed\n     * @param {olleh.maps.event.Event} event\n     */\n    \n    this.fireEvent('visible_changed');\n  },\n\n  /**\n   * @private\n   */\n  setDisplayHint: function(displayHint) {\n    if(this._displayHint !== displayHint) {\n      this._displayHint = displayHint;\n      this.isDrawn() && this._updateVisibility();\n    }\n  },\n\n  /**\n   * @private\n   */\n  _updateVisibility: function () {\n    var visible = this._visible && this._displayHint;\n    var display = visible ? 'block' : 'none';\n    if(this._display !== display) {\n      this._display = display;\n      this.forEachElement(function (paneId, elem) {\n        olleh.maps.util.dom.setStyle(elem, 'display', this._display);\n      });\n    }\n  },\n  \n  /**\n   *   z-index . {@link #bringToFront} \n   * z-index <code>'auto'</code>       z-index .\n   * @returns {Number}   z-index.\n   */\n  getCurrentZIndex: function () {\n    return this._currentZIndex;\n  },\n  \n  /**\n   *  z-index .\n   * @returns {Number|String} z-index.\n   */\n  getZIndex: function () {\n    return this._zIndex;\n  },\n\n  /**\n   * z-index . z-index         .\n   * @param {Number|String} zIndex z-index. <code>'auto'</code>   . \n   */\n  setZIndex: function (zIndex) {\n    this._zIndex = zIndex == 'auto' ? 'auto' : Math.min(olleh.maps.overlay.BaseOverlay.MAX_ZINDEX, zIndex);\n    this._drawn && this._updateZIndex();\n  },\n\n  /**\n   * @private\n   */\n  _updateZIndex: function () {\n    var zIndex;\n    \n    if (this._isFront) {\n      zIndex = olleh.maps.overlay.BaseOverlay.MAX_ZINDEX;\n    } else if (this._zIndex == 'auto') {\n      zIndex = this.getAutoZIndex();\n    } else {\n      zIndex = this._zIndex;\n    }\n    //TODO : ContentOverlay setContnet root pane     \n    //if(this._currentZIndex !== zIndex) {\n    this._currentZIndex = zIndex;\n    this.forEachElement(function (paneId, elem) {\n      olleh.maps.util.dom.setStyle(elem, 'zIndex', zIndex);\n    });\n    //}\n  },\n\n  /**\n   *     .\n   */\n  bringToFront: function () {\n    if (!this._isFront) {\n      this._isFront = true;\n      this._drawn && this._updateZIndex();\n    }\n  },\n\n  /**\n   * {@link olleh.maps.overlay.BaseOverlay#bringToFront()}   z-index   .\n   */\n  resetZIndex: function () {\n    if (this._isFront) {\n      this._isFront = false;\n      this._drawn && this._updateZIndex();\n    }\n  },\n\n  /**\n   *  pane   .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @returns {Boolean}  pane    <code>true</code>,    <code>false</code>.\n   * @private\n   */\n  isRegistered: function (paneId, elem) {\n    return this.elements[paneId] && olleh.maps.util.indexOf(this.elements[paneId], elem) > -1;\n  },\n\n  /**\n   *  pane .       ,\n   *       /    .\n   *    {@link olleh.maps.overlay.Overlay#setMap()}     .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  registerElement: function (paneId, elem) {\n    if (!this.isRegistered(paneId, elem)) {\n      if (!this.elements[paneId]) {\n        this.elements[paneId] = [elem];\n      } else {\n        this.elements[paneId].push(elem);\n      }\n      this.appendElement(paneId, elem);\n    }\n  },\n\n  /**\n   *  pane  .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  unregisterElement: function (paneId, elem) {\n    if (this.isRegistered(paneId, elem)) {\n      olleh.maps.util.removeFromArray(this.elements[paneId], elem);\n      this.removeElement(paneId, elem);\n    }\n  },\n  \n  /**\n   *    pane .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  appendElement: function (paneId, elem) {\n    if (this._drawn) {\n      var pane = this.getLayer().getPane(paneId);\n      if (!elem.parentNode || elem.parentNode != pane) {\n        olleh.maps.util.dom.setStyles(elem, this._currentStyles);\n        pane.appendChild(elem);\n      }\n    }\n  },\n\n  /**\n   *    pane .\n   * @param {String} paneId pane ID.\n   * @param {HTMLElement} elem HTML .\n   * @private\n   */\n  removeElement: function (paneId, elem) {\n    elem.parentNode && elem.parentNode.removeChild(elem);\n  },\n  \n  /**\n   * {@link #registerElement()}      pane .\n   * @private\n   */\n  appendElements: function () {\n    this.forEachElement(this.appendElement);\n  },\n\n  /**\n   * {@link #registerElement()}      pane .\n   * @private\n   */\n  removeElements: function () {\n    this.forEachElement(this.removeElement);\n  },\n\n  /**\n   *       .\n   * @returns {Boolean}    <code>true</code>,    <code>false</code>\n   * @private\n   */\n  isDrawn: function () {\n    return this._drawn;\n  },\n  \n  /**\n   *   .\n   * {@link olleh.maps.overlay.OverlayLayer}    .\n   * @param {Boolean} onAdd   .\n   * @private\n   */\n  draw: function (onAdd) {\n    if (this.layer) {\n      this.update();\n      this._drawn = true;\n      this.appendElements();\n      if (onAdd) {\n        this.onAdd();\n      } else {\n        this.ready();\n      }\n      this.registerEvent();\n    }\n  },\n\n  /**\n   *   .\n   * {@link olleh.maps.overlay.OverlayLayer}    .\n   * @param {Boolean} onRemove   .\n   * @private\n   */\n  erase: function (onRemove) {\n    if (this._drawn) {\n      this._drawn = false;\n      if (onRemove) {\n        this.onRemove();\n      } else {\n        this.cleanup();\n      }\n      this.unregisterEvent();\n    }\n  },\n  \n  /**\n   * @private\n   * @fires olleh.maps.overlay.BaseOverlay#event:ready\n   */\n  ready: function () {\n    /**\n     * Overlay        .\n     * DOM       .\n     * @name event:ready\n     * @event\n     * @memberof olleh.maps.overlay.BaseOverlay.prototype\n     * @param {olleh.maps.event.Event} event\n     */\n    this.fireEvent('ready');\n  },\n\n  /**\n   * @private\n   * @fires olleh.maps.overlay.BaseOverlay#event:erased\n   */\n  erased: function () {\n    /**\n     * Overlay    .\n     *    DOM   .\n     * @name event:erased\n     * @event\n     * @memberof olleh.maps.overlay.BaseOverlay.prototype\n     * @param {olleh.maps.event.Event} event\n     */\n    this.fireEvent('erased');\n  },\n  \n  /**\n   * @private\n   */\n  cleanup: function () {\n    this.removeElements();\n    this.erased();\n  },\n  \n  /**\n   * @private\n   */\n  onAdd: function () {\n    this._fadeInAnimation = this.getFadeInAnimation();\n    if (this._fadeInAnimation) {\n      this._fadeInRequested = 0;\n      this._fadeInFinished = 0;\n      this.forEachElement(this._fadeInElement);\n    } else {\n      this.ready();\n    }\n  },\n\n  /**\n   * @private\n   */\n  onRemove: function () {\n    this._fadeOutAnimation = this.getFadeOutAnimation();\n    if (this._fadeOutAnimation) {\n      this._removeRequested = 0;\n      this._removeFinished = 0;\n      this.forEachElement(this._fadeOutElement);\n    } else {\n      this.cleanup();\n    }\n  },\n\n  /**\n   * @private\n   */\n  getFadeInAnimation: function () {\n    return null;\n  },\n\n  /**\n   * @private\n   */\n  getFadeOutAnimation: function () {\n    return null;\n  },\n\n  /**\n   * @private\n   */\n  _fadeInElement: function (paneId, elem) {\n    olleh.maps.util.dom.setStyles(elem, this._fadeInAnimation.from);\n    this._fadeInRequested++;\n    this._fadeInAnimation.animate(elem, {\n      callback: this._onFadeInFinished,\n      ctx: this\n    });\n  },\n\n  /**\n   * @private\n   */\n  _fadeOutElement: function (paneId, elem) {\n    var overlay = this;\n    this._removeRequested++;\n    this._fadeOutAnimation.animate(elem, {\n      callback: function () {\n        this.parentNode && this.parentNode.removeChild(this);\n        overlay._onElementRemoved();\n      }\n    });\n  },\n\n  /**\n   * @private\n   */\n  _onFadeInFinished: function () {\n    this._fadeInFinished++;\n    if (this._fadeInFinished == this._fadeInRequested) {\n      this.ready();\n    }\n  },\n\n  /**\n   * @private\n   */\n  _onElementRemoved: function () {\n    this._removeFinished++;\n    if (this._removeFinished == this._removeRequested) {\n      this.erased();\n    }\n  },\n  \n  /**\n   *     .\n   * @return {Boolean}    <code>true</code>,    <code>false</code>\n   * @private\n   */\n  isMoving: function () {\n    return !!this._moveAnimators.length && this._moveAnimators[0].status != 'finished';\n  },\n  \n  /**\n   *    .\n   * @see olleh.maps.fx.Animator#stop()\n   * @private\n   */\n  stopAnimators: function () {\n    var i, l, moveAnimators = this._moveAnimators;\n    for (i = 0, l = moveAnimators.length; i < l; i++) {\n      if (moveAnimators[i].status != 'finished') {\n        moveAnimators[i].stop();\n      }\n    }\n    this._moveAnimators = [];\n  },\n\n  /**\n   *     .\n   *       .\n   * @param {Object} styles key-value    .\n   * @private\n   */\n  updatePositioningStyles: function (styles) {\n    this._currentStyles = styles;\n    this.forEachElement(function (paneId, elem) {\n      olleh.maps.util.dom.setStyles(elem, this._currentStyles);\n    });\n  },\n\n  /**\n   *     .\n   *       .\n   * @param {Object} to key-value    .\n   * @param {Number} [duration=0]  .   . \n   * @param {olleh.maps.fx.Pulse} [pulse]  .    .\n   * @param {Function} [callback]     .\n   * @param {Object} [ctx=this]   .    .\n   * @private\n   */\n  animateTo: function (to, duration, pulse, callback, ctx) {\n    var from = this._currentStyles;\n    \n    this.stopAnimators();\n    \n    if (duration > 0) {\n\n      this._finishedAnimation = 0;\n      this._animationCallback = callback;\n      this._animationCallbackCtx = ctx;\n\n      this.forEachElement(function (paneId, elem) {\n        this._moveAnimators.push(new olleh.maps.fx.Animation({\n          from: from,\n          to: to,\n          duration: duration,\n          pulse: pulse,\n          timing: olleh.maps.fx.timing.easeOut,\n          callback: this._animationFinished,\n          ctx: this\n        }).animate(elem));\n      });\n\n      this._currentStyles = to;\n      \n    } else {\n    \n      this.updatePositioningStyles(to);\n      if (callback) {\n        callback.call(ctx || this);\n      }\n      \n    }\n    \n  },\n  \n  /**\n   * @private\n   */\n  _animationFinished: function () {\n    this._finishedAnimation++;\n    if (this._finishedAnimation == this._moveAnimators.length) {\n      this._moveAnimators = [];\n      if (this._animationCallback) {\n        this._animationCallback.call(this._animationCallbackCtx || this);\n      }\n    }\n  },\n\n  /**\n   *     <code>fn</code>  .\n   * fn     pane ID,      .  \n   * @param {Function} fn     .\n   * @private\n   */\n  forEachElement: function (fn) {\n    var paneId, i, l, elems;\n    for (paneId in this.elements) {\n      elems = this.elements[paneId];\n      if (elems) {\n        for (i = 0, l = elems.length; i < l; i++) {\n          fn.apply(this, [paneId, elems[i]]);\n        }  \n      }\n    }\n  },\n  \n  detach: function() {\n    this.stopAnimators();\n    olleh.maps.overlay.BaseOverlay.$super.detach.apply(this, arguments);\n  }\n  \n});\n/**\r\n *  overlay     \r\n */\r\n$class('olleh.maps.overlay.OverlayGroup').mixin(olleh.maps.event.EventDelegator, olleh.maps.Adaptable).define({\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {Object} opts  \r\n   * @param {olleh.maps.Map} opts.map OverlayGroup   map \r\n   * @param {boolean} opts.visible  visibility \r\n   */\r\n  OverlayGroup: function (opts) {\r\n    this._overlays = [];\r\n    this.layer = null;\r\n    this._visible = true;\r\n    opts && opts.visible === false && (this._visible = false); \r\n    if(opts && opts.map) {\r\n      this.setMap(opts.map);\r\n    }\r\n  },\r\n  \r\n  attach: function() {\r\n    var i, len, o;\r\n    for(i = 0 , len = this._overlays.length ; i < len ; i++ ) {\r\n      o = this._overlays[i];\r\n      o.setMap(this.map);\r\n    }\r\n  },\r\n  \r\n  detach: function() {\r\n    var i, len, o;\r\n    for(i = 0 , len = this._overlays.length ; i < len ; i++ ) {\r\n      o = this._overlays[i];\r\n      o.setMap(null);\r\n    }\r\n  },\r\n    \r\n  /**\r\n   * @see olleh.maps.event.EventDelegator#getBubble()\r\n   */\r\n  getBubble: function() {\r\n    return this.map.getOverlayLayer();\r\n  },\r\n\r\n  /**\r\n   * Overlay  OverlayGroup  . \r\n   * <code>setMap(map)</code>   OverlayGroup    \r\n   *  overlay   . \r\n   * @param overlay\r\n   */\r\n  add: function (overlay) {\r\n    this._overlays.push(overlay);\r\n    overlay.setVisible(this._visible);\r\n    this.map && overlay.setMap(this.map);\r\n    overlay.setBubble(this);\r\n  },\r\n\r\n  /**\r\n   * Overlay  OverlayGroup  . \r\n   * <code>setMap(map)</code>   OverlayGroup    \r\n   *  overlay   . \r\n   * @param overlay\r\n   */\r\n  remove: function (overlay) {\r\n    olleh.maps.util.removeFromArray(this._overlays, overlay);\r\n    this.map && overlay.setMap(null);\r\n    overlay.setBubble(null);\r\n  },\r\n\r\n  /**\r\n   *  overlay  visiblity  .\r\n   * @param {Boolean} visible\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible !== visible) {\r\n      var o, i = this._overlays.length;\r\n      this._visible = visible;\r\n      while(i--) {\r\n        o = this._overlays[i];\r\n        o.setVisible(visible);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * <code>setVisible(visible)</code>   visible  .\r\n   * @returns {Boolean}\r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  }\r\n});\r\n/**\n * @private\n */\n$class('olleh.maps.plugin.Overlay').extend(olleh.maps.Adaptable).define({\n  \n  attach: function () {\n    this.map._opts = olleh.maps.mixin(this.map._opts, {\n      overlayLayer: new olleh.maps.overlay.OverlayLayer()}, true);\n  },\n\n  detach: function () {\n  }\n\n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.Overlay);/**\n * PointedOverlayOptions Object Specification\n * @typedef olleh.maps.overlay.PointedOverlayOptions\n * @extends olleh.maps.overlay.BaseOverlayOptions \n * @property {olleh.maps.Coord} position  .\n */\n\n/**\n *       .\n */\n$class('olleh.maps.overlay.PointedOverlay').extend(olleh.maps.overlay.BaseOverlay).define({\n\n  /**\n   * ,  opts    .\n   * @param {olleh.maps.overlay.PointedOverlayOptions} opts .\n   */\n  PointedOverlay: function () {\n  },\n\n  /**\n   *  .\n   * @param {olleh.maps.overlay.PointedOverlayOptions} opts .\n   */\n  setOptions: function (opts) {\n    opts.position && this.setPosition(opts.position);\n    olleh.maps.overlay.PointedOverlay.$super.setOptions.apply(this, arguments);\n  },\n\n  /**\n   * @private\n   * @see olleh.maps.overlay.BaseOverlay#update\n   */\n  update: function () {\n    this._updatePosition();\n    olleh.maps.overlay.PointedOverlay.$super.update.apply(this, arguments);\n  },\n  \n  /**\n   * @private\n   * @returns {olleh.maps.Coord}\n   */\n  getIndexObject: function () {\n    return this.getPosition();\n  },\n  \n  /**\n   * @private\n   * @returns {number}\n   */\n  getAutoZIndex: function () {\n    var coord = this._position.asDefault();\n      // Chrome Bug : zIndex      \n    var maxTopCoord = this.layer.layerMgr.getMaxExtent().getTop();\n    return Math.round(maxTopCoord - coord.y);\n  },\n\n  /**\n   *   .\n   * @returns {olleh.maps.Coord}  .\n   */\n  getPosition: function () {\n    return this._position;\n  },\n  \n  /**\n   *   .\n   * @fires olleh.maps.overlay.PointedOverlay#event:position_changed\n   * @param {olleh.maps.Coord} position  .\n   */\n  setPosition: function (position) {\n    var before = this._position;\n    position = olleh.maps.UTMK.valueOf(position);\n    this._position = position;\n    if(this.isDrawn()) {\n      this._updatePosition();\n    }\n    this.fireEvent('position_changed',{from: before, to: position});\n  },\n\n  /**\n   * @private\n   */\n  _updatePosition: function () {\n    if (!this._position) {\n      throw new Error(\"Position is not set.\");\n    }\n    this._currentLayerPx = this.getOriginalLayerPx();\n    this.updatePositioningStyles(olleh.maps.util.dom.getPositionStyles(this._currentLayerPx.x, this._currentLayerPx.y));\n  },\n\n  /**\n   * @param {Number} scale\n   * @param {olleh.maps.Point} origin\n   * @param {Number} duration\n   * @param {olleh.maps.fx.Pulse} [pulse]\n   * @private\n   */\n  zoomStart: function (scale, origin, duration, pulse) {\n    //var originalLayerPx = this.getOriginalLayerPx();\n    //var newPx = origin.add(originalLayerPx.subtract(origin).multiplyBy(scale)).round();\n    var layerMgr = this.layer.layerMgr;\n    var newPx = layerMgr.getLayerPxFromCoord(this._position, true);\n    this.moveTo(newPx, duration, pulse);\n  },\n\n  /**\n   * @private\n   */\n  zoomEnd: function () {\n    this.stopAnimators();\n  },\n\n  /**\n   *    .\n   *  (position)      draw()      . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   * @private\n   */\n  moveTo: function (px, duration, pulse, callback) {\n    this.animateTo(olleh.maps.util.dom.getPositionStyles(px.x, px.y), duration, pulse, callback);\n    this._currentLayerPx = px;\n  },\n\n  /**\n   *      .\n   *        draw()       . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   * @private\n   */\n  move: function (px, duration, pulse, callback) {\n    this.moveTo(this._currentLayerPx.add(px), duration, pulse, callback);\n  },\n\n  /**\n   *       .\n   * @returns {olleh.maps.Point}   \n   * @private\n   */\n  getOriginalLayerPx: function () {\n    return this.layer.layerMgr.getLayerPxFromCoord(this._position);\n  },\n\n  /**\n   *    .\n   *   {@link olleh.maps.overlay.PointedOverlay#getOriginalLayerPx()}  \n   * {@link olleh.maps.overlay.PointedOverlay#moveTo()} \n   * {@link olleh.maps.overlay.PointedOverlay#move()}     .\n   * @returns {olleh.maps.Point}   .\n   * @private\n   */\n  getCurrentLayerPx: function () {\n    return this._currentLayerPx;\n  },\n\n  /**\n   * @param {olleh.maps.event.Event}\n   * @param {Object} payload\n   * @private\n   */\n  $default_mouseover: function (event, payload) {\n    event.preventDefault();\n    this.bringToFront();\n  },\n\n  /**\n   * @param {olleh.maps.event.Event}\n   * @param {Object} payload\n   * @private\n   */\n  $default_mouseout: function (event, payload) {\n    event.preventDefault();\n    this.resetZIndex();\n  },\n\n  /**\n   * @param {olleh.maps.event.Event}\n   * @param {Object} payload\n   * @private\n   */\n  $current_position_changed: function (event, payload) {\n    this.isAdded() && this._updateZIndex();\n  }\n});\n/**\r\n *      .\r\n */\r\n$class('olleh.maps.overlay.DropTiming').extend(olleh.maps.fx.timing.Timing).define({\r\n\r\n  /**\r\n   * @private\r\n   * @returns {Function}\r\n   */\r\n  genFn: function () {\r\n    return function (t) {\r\n      return (t < .5) ? 2 * t * t : t * (t - 1.5) + 1.5;\r\n    };\r\n  }\r\n});\r\n///////////////////////////\n//  Marker     //\n///////////////////////////\n/**\n * MarkerOptions Object Specification\n * @typedef olleh.maps.overlay.MarkerOptions\n * @property {String|Object} [icon=olleh.maps.overlay.Marker.DEFAULT_ICON]   . <code>String</code>   \n *           url   \n * @property {String|Object} [shadow=olleh.maps.overlay.Marker.DEFAULT_SHADOW]  . <code>String</code>   \n *           url   \n * @property {String|Object} [caption]  . <code>String</code>   \n *              \n * @property {Number} [angle]   \n * @property {String} [cursor]     \n * @property {String} [title]  \n * @property {Boolean} [draggable=false]    . <code>true</code>  drag    \n * @property {Boolean} [flat=false]  . <code>true</code>    \n * @extends olleh.maps.overlay.PointedOverlayOptions\n */\n\n///////////////////////////\n//  MarkerIconOptions    //\n///////////////////////////\n/**\n * MarkerIconOptions Object Specification\n * @typedef olleh.maps.overlay.MarkerIconOptions\n * @property {String} url icon   URL\n * @property {olleh.maps.Size} [size] icon \n * @property {olleh.maps.Point} [anchor] icon anchor    <code>olleh.maps.Point(icon.size.width / 2, icon.size.height)</code> \n * @property {olleh.maps.Point} [origin]     \n * @property {olleh.maps.Size} [scaledSize]      \n */\n\n///////////////////////////\n//  MarkerCaptionOptions //\n///////////////////////////\n/**\n * MarkerCaptionOptions Object Specification\n * @typedef olleh.maps.overlay.MarkerCaptionOptions\n * @property {String} title  \n * @property {String} [color='#000000']  \n * @property {String} [backgroundColor='transparent'] caption \n * @property {Number} [size=9]  (pt )\n */\n\n/**\n * Marker     ,      . \n * <p/>\n * <h5> </h5>\n * <ul>\n * <li>{@link olleh.maps.overlay.BaseOverlay#event:visible_changed|visible_changed}</li>\n * <li>{@link olleh.maps.overlay.PointedOverlay#event:position_changed|position_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:animation_changed|animation_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:cursor_changed|cursor_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:draggable_changed|draggable_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:flat_changed|flat_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:icon_changed|icon_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:shadow_changed|shadow_changed}</li>\n * <li>{@link olleh.maps.overlay.Marker#event:title_changed|title_changed}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\n * </ul>\n * <p/>  \n * \n * @example\n * marker = new olleh.maps.overlay.Marker({\n *   position: new olleh.maps.UTMK(958094, 1942790),\n *   title: \"IC\",\n *   caption: \"Center(bounce)\",\n *   animation: olleh.maps.overlay.Marker.BOUNCE,\n *   draggable: true\n * });\n * marker.setMap(map);\n * marker.onEvent('position_changed', function () {alert(\"\")});\n */\n$class('olleh.maps.overlay.Marker').extend(olleh.maps.overlay.PointedOverlay).define({\n\n  $static: {\n\n    /**\n     *           Object\n     * @type Object\n     */\n    DEFAULT_ICON: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/markers.png',\n      size: new olleh.maps.Size(28, 40),\n      origin: new olleh.maps.Point(0, 1107)\n    },\n\n    /**\n     *            Object\n     * @type Object\n     */\n    DEFAULT_MOBILE_ICON: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/mobiles.png',\n      size: new olleh.maps.Size(25, 37),\n      origin: new olleh.maps.Point(78, 80)\n    },\n\n    // /**\n    //  *         HD   Object\n    //  * @type Object\n    //  */\n    DEFAULT_HD_ICON: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/retinas.png',\n      size: new olleh.maps.Size(26, 35),\n      origin: new olleh.maps.Point(78, 81),\n      scaledSize: new olleh.maps.Size(170, 155)\n    },\n\n    /**\n     *           Object\n     * @type Object\n     */\n    DEFAULT_SHADOW: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/markers.png',\n      size: new olleh.maps.Size(34, 27),\n      anchor: new olleh.maps.Point(6, 27),\n      origin: new olleh.maps.Point(0, 1147)\n    },\n\n    /**\n    *            Object\n    * @type Object\n    */\n    DEFAULT_MOBILE_SHADOW: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/mobiles.png',\n      size: new olleh.maps.Size(27, 20),\n      origin: new olleh.maps.Point(128, 80),\n      anchor: new olleh.maps.Point(4, 20)\n    },\n\n    ///**\n    // *         HD   Object\n    // * @type Object\n    // */\n    DEFAULT_HD_SHADOW: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/retinas.png',\n      size: new olleh.maps.Size(27, 20),\n      origin: new olleh.maps.Point(126, 80),\n      anchor: new olleh.maps.Point(5, 20),\n      scaledSize: new olleh.maps.Size(170, 155)\n    },\n\n    DRAG_POINT: {\n      url: olleh.maps.env.RESOURCE_URL + 'img/markers.png',\n      size: new olleh.maps.Size(20, 13),\n      anchor: new olleh.maps.Point(10, 5),\n      origin: new olleh.maps.Point(0, 1092)\n    },\n\n    DRAG_FLOATING_PX: 10,\n\n    /**\n     *     animation type\n     * @type String\n     */\n    BOUNCE: 'bounce',\n\n    /**\n     *    animation type\n     * @type String\n     */\n    DROP: 'drop',\n\n    bouncePulse: new olleh.maps.fx.Pulse(1),\n\n    dropTiming: new olleh.maps.overlay.DropTiming(),\n\n    getBounceAnimator: function (anchor, isShadow) {\n      var dx, dy, distance = 10;\n\n      if (isShadow) {\n        dy = distance * Math.SQRT1_2;\n        dx = -dy;\n      } else {\n        dy = distance;\n        dx = 0;\n      }\n      return new olleh.maps.fx.Animation({\n        from: {\n          marginLeft: -anchor.x + 'px',\n          marginTop: -anchor.y + 'px'\n        },\n        to: {\n          marginLeft: -(anchor.x + dx)+ 'px',\n          marginTop: -(anchor.y + dy) + 'px'\n        },\n        timing: olleh.maps.fx.timing.easeOut,\n        comeback: true,\n        repeat: -1,\n        duration: 1,\n        pulse: olleh.maps.overlay.Marker.bouncePulse\n      });\n    },\n    \n    getDropAnimator: function (anchor, isShadow) {\n      var dx, dy, distance = 200;\n\n      if (isShadow) {\n        dy = distance * Math.SQRT1_2;\n        dx = -dy;\n      } else {\n        dy = distance;\n        dx = 0;\n      }\n      return new olleh.maps.fx.Animation({\n        from: {\n          marginLeft: -(anchor.x + dx)+ 'px',\n          marginTop: -(anchor.y + dy) + 'px'\n        },\n        to: {\n          marginLeft: -anchor.x + 'px',\n          marginTop: -anchor.y + 'px'\n        },\n        timing: olleh.maps.overlay.Marker.dropTiming,\n        duration: 0.5\n      });\n    }\n  },\n\n  /**\n   * ,  opts    .\n   * @param {olleh.maps.overlay.MarkerOptions} opts MarkerOptions\n   */\n  Marker: function (opts) {\n    this._cursor = 'pointer';\n    this._title = '';\n    this._flat = false;\n    this._draggable = false;\n    this._angle = 0;\n  },\n\n  /**\n   *  .\n   * \n   * @example \n   * marker.setOptions({\n   *   icon: {\n   *     url: 'marker.png',\n   *     size: new olleh.maps.Size(20, 20)\n   *   },\n   *   position: new olleh.maps.UTMK(958094, 1942790),\n   *   title: 'IC',\n   *   draggable: true\n   * });\n   * @param {olleh.maps.overlay.MarkerOptions} opts  \n   * @see olleh.maps.overlay.PointedOverlay#setOptions\n   */\n  setOptions: function (opts) {\n    opts.icon && this.setIcon(opts.icon);\n    opts.angle && this.setAngle(opts.angle);\n    opts.shadow && this.setShadow(opts.shadow);\n    opts.caption && this.setCaption(opts.caption);\n    opts.cursor && this.setCursor(opts.cursor);\n    opts.title && this.setTitle(opts.title);\n    opts.draggable && this.setDraggable(opts.draggable);\n    opts.flat && this.setFlat(opts.flat);\n    opts.animation && this.setAnimation(opts.animation);\n    olleh.maps.overlay.Marker.$super.setOptions.apply(this, arguments);\n  },\n\n  /**\n   * @see olleh.maps.overlay.PointedOverlay#update\n   */\n  update: function () {\n    this._updateIcon();\n    this._updateAngle();\n    this._updateCursor();\n    this._updateShadow();\n    this._updateCaption();\n    this._updateAnimation();\n    olleh.maps.overlay.Marker.$super.update.apply(this, arguments);\n  },\n\n  /**\n   * draw    .\n   * @see olleh.maps.overlay.BaseOverlay#erase\n   */\n  erase: function () {\n    olleh.maps.overlay.Marker.$super.erase.apply(this, arguments);\n    this._infoWin && this._infoWin.erase();\n    if (this._tooltip) {\n      this._tooltip.close();\n      delete this._tooltip;\n    }\n  },\n  \n  /**\n   *   .\n   * @returns {Object} icon   Object\n   */\n  getIcon: function () {\n    return this._icon;\n  },\n  \n  /**\n   *   .\n   * @example \n   * var icon = {\n   *   url:'mark.png', \n   *   size: new olleh.maps.Size(21, 30), \n   *   anchor: new olleh.maps.Point(10, 30)};\n   * marker.setIcon(icon);\n   * marker2.setIcon('marker.png');\n   * @fires olleh.maps.overlay.Marker#event:icon_changed\n   * @param {String|olleh.maps.overlay.MarkerIconOptions} icon   URL  MarkerImage   Obect\n   */\n  setIcon: function (icon) {\n    if (olleh.maps.isString(icon)) {\n      icon = {\n        url: icon\n      };\n    } else if (!olleh.maps.isObject(icon)) {\n      throw new TypeError('Icon must be String or Object');\n    }\n\n    if (!icon.url) {\n      throw new TypeError('Icon url is undefined');\n    }\n\n    icon.size || (icon.size = olleh.maps.overlay.Marker.DEFAULT_ICON.size);\n    icon.anchor || (icon.anchor = new olleh.maps.Point(icon.size.width / 2, icon.size.height));\n\n    if (this._icon != icon) {\n      this._icon = icon;\n      if (this.isDrawn()) {\n        this._updateIcon();\n        /**\n         * icon_changed .    .\n         * <p/>\n         * @name event:icon_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('icon_changed');\n      }\n    }\n  },\n\n  _updateIcon: function () {\n    var icon = this._icon; // iconOption\n    var img = this._iconImg; // iconImgDom\n\n    if (!icon) { //     .\n      var Marker = olleh.maps.overlay.Marker;\n \n      icon = olleh.maps.browser.isHD ? Marker.DEFAULT_HD_ICON : \n        olleh.maps.browser.isMobile ? Marker.DEFAULT_MOBILE_ICON : Marker.DEFAULT_ICON;\n\n      this._icon = icon; // _icon   setIcon event  .\n      this.setIcon(icon);\n    }\n\n    if (!img) {\n      var iconDiv = olleh.maps.Element.create('div').setStyle('position', 'absolute');\n      img = this._iconImg = new olleh.maps.SpritedImage();\n      iconDiv.appendChild(img);\n      this._updateCursor();\n      this.registerElement('upper_overlay_pane', iconDiv.elem);\n      this.registerEventDom(this._iconImg.elem);\n    }\n\n    if (this._currentIcon != icon) {\n      img.setStyles({\n        width: icon.size.width + 'px',\n        height: icon.size.height + 'px',\n        marginLeft: -icon.anchor.x + 'px',\n        marginTop: -icon.anchor.y + 'px'\n      }).setImage(icon.url, icon.origin, icon.scaledSize);\n      this._currentIcon = icon;\n    }\n    //    \n    var origin = (100 - 100 * (icon.size.width - icon.anchor.x)\n        / icon.size.width) + \"% \"\n        + (100 - 100 * (icon.size.height - icon.anchor.y)/ icon.size.height) + \"%\";\n    img.setStyle('transformOrigin', origin);\n  },\n\n  /**\n   *    .\n   * @example marker.setAngle(45);\n   * @fires olleh.maps.overlay.Marker#event:angle_changed\n   * @param {Number} angle   \n   */\n  setAngle: function(angle){\n    this._angle = angle;\n      if (this.isDrawn()) {\n        this._updateAngle();\n        /**\n         * angle_changed .     .\n         * <p/>\n         * @name event:angle_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('angle_changed');\n      }\n  },\n\n  _updateAngle: function () {\n    var img = this._iconImg;\n    img.setStyles({\n      transform: \"rotate(\" + this._angle + \"deg)\"\n    });\n  },\n\n  /**\n   *    .\n   * @returns {Number} angle\n   */\n  getAngle: function(){\n    return this._angle;\n  },\n  \n  /**\n   *    .\n   * @returns {String} title\n   */\n  getTitle: function () {\n    return this._title;\n  },\n  \n  /**\n   *    .\n   * @example marker.setTitle('');\n   * @fires olleh.maps.overlay.Marker#event:title_changed\n   * @param {String} title   \n   */\n  setTitle: function (title) {\n    this._title = title;\n    /**\n     * title_changed . marker    .\n     * <p/>\n     * @name event:title_changed\n     * @event\n     * @memberOf olleh.maps.overlay.Marker.prototype\n     * @param {olleh.maps.event.Event} event\n     */\n      this.isAdded() && this.fireEvent('title_changed');\n  },\n\n  /**\n   *   .\n   * @returns {String} cursor  \n   */\n  getCursor: function () {\n    return this._cursor;\n  },\n\n  /**\n   *      .\n   * @example marker.setCursor('point');\n   * @fires olleh.maps.overlay.Marker#event:cursor_changed\n   * @param {String} cursor\n   */\n  setCursor: function (cursor) {\n    this._cursor = cursor;\n    if (this.isDrawn()) {\n      this._updateCursor();\n      /**\n       * cursor_changed . marker    .\n       * @name event:cursor_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('cursor_changed');\n    }\n  },\n\n  _updateCursor: function () {\n    this._iconImg.setStyle('cursor', this._cursor);\n  },\n  \n  /**\n   *   Object .\n   * @returns {Object}   Object\n   */\n  getShadow: function () {\n    // TODO \n    return this._shadowImg ? this._shadow : null;\n  },\n\n  /**\n   *    .\n   * @example \n   * var shadow = {\n   *   url:'shadow.png', \n   *   size: new olleh.maps.Size(21, 30), \n   *   anchor: new olleh.maps.Point(10, 30)};\n   * marker.setShadow(shadow);\n   * marker2.setShadow('shadow.png');\n   * @fires olleh.maps.overlay.Marker#event:shadow_changed\n   * @param {String|olleh.maps.overlay.MarkerIconOptions} shadow   URL     Obect\n   */\n  setShadow: function (shadow) {\n    if (olleh.maps.isString(shadow)) {\n      shadow = {\n        url: shadow\n      };\n    } else if (!olleh.maps.isObject(shadow)) {\n      throw new TypeError('Shadow must be String or Object');\n    }\n\n    if (!shadow.url) {\n      throw new TypeError('Shadow url is undefined');\n    }\n\n    shadow.size || (shadow.size = olleh.maps.overlay.Marker.DEFAULT_SHADOW.size);\n    shadow.anchor || (shadow.anchor = new olleh.maps.Point(0, shadow.size.height));\n\n    if (this._shadow != shadow) {\n      this._shadow = shadow;\n      if (this.isDrawn()) {\n        this._updateShadow();\n        /**\n         * shadow_changed . marker    .\n         * <p/>\n         * @name event:shadow_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('shadow_changed');\n      }\n    }\n  },\n\n  _updateShadow: function () {\n    var shadow = this._shadow, img = this._shadowImg;\n    var disableShadow = this.getLayer().disableShadow;\n    \n    if (!shadow) {\n      if(olleh.maps.browser.isHD) this._shadow = olleh.maps.overlay.Marker.DEFAULT_HD_SHADOW;\n      else if(olleh.maps.browser.isMobile) this._shadow = olleh.maps.overlay.Marker.DEFAULT_MOBILE_SHADOW ;\n      else this._shadow = olleh.maps.overlay.Marker.DEFAULT_SHADOW;\n      this.setShadow(this._shadow);\n      shadow = this._shadow;\n    }\n\n    if (!disableShadow && !this._flat) {\n      if (!img) {\n        img = this._shadowImg = new olleh.maps.SpritedImage();\n        this.registerElement('overlay_shadow_pane', img.elem);\n      }\n      if (this._currentShadow != shadow) {\n        img.setStyles({\n          width: shadow.size.width + 'px',\n          height: shadow.size.height + 'px',\n          marginLeft: -shadow.anchor.x + 'px',\n          marginTop: -shadow.anchor.y + 'px'\n        }).setImage(shadow.url, shadow.origin, shadow.scaledSize);\n        this._currentShadow = shadow;\n      }\n    } else {\n      if (img) {\n        this.unregisterElement('overlay_shadow_pane', img.elem);\n        this._shadowAnimator && this._shadowAnimator.stop();\n        this._shadowAnimator = null;\n        this._currentShadow = null;\n        this._shadowImg = null;\n      }\n    }\n  },\n\n  /**\n   * Marker caption .\n   * @returns {olleh.maps.overlay.MarkerCaptionOptions} captionOptions\n   */\n  getCaption: function () {\n    return this._caption;\n  },\n\n  /**\n   * marker Caption  .\n   * @example\n   * marker.setCaption('');\n   * marker.setCaption({\n   *   title: '',\n   *   backgroundColor: '#ffffff'\n   * });\n   * @fires olleh.maps.overlay.Marker#event:caption_changed\n   * @param {String|olleh.maps.overlay.MarkerCaptionOptions} captionOptions  caption \n   */\n  setCaption: function (caption) {\n    if (olleh.maps.isString(caption)) {\n      caption = {\n        title: caption\n      };\n    } else if (!olleh.maps.isObject(caption)) {\n      throw new TypeError('Caption must be String or Object');\n    }\n\n    // caption.title 0  empty string   \n    // icon.url shadow.url !caption.title   .\n    if (caption.title === null || caption.title === undefined) {\n      throw new TypeError('Caption title is undefined');\n    }\n\n    this._caption = caption;\n\n    if (this.isDrawn()) {\n      this._updateCaption();\n      /**\n       * caption_changed . marker    .\n       * <p/>\n       * @name event:caption_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('caption_changed');\n    }\n  },\n  \n  _updateCaption: function() {\n    var span, div = this._captionDiv;\n    var caption = this._caption;\n\n    if (caption) {\n      caption.size = caption.size || 9;\n      caption.backgroundColor = caption.backgroundColor || \"\";\n      caption.color = caption.color || '#000000';\n      \n      if (!div) {\n        div = this._captionDiv = olleh.maps.Element.create('div').setStyles({\n          position: 'absolute',\n          marginLeft: '-100px',\n          width: '200px',\n          textAlign: 'center'\n        });\n        span = olleh.maps.Element.create('span');\n        div.appendChild(span);\n        this.registerElement('lower_overlay_pane', div.elem);\n      } else{\n        span = new olleh.maps.Element(div.elem.firstChild);\n      }\n      span.setStyles({\n        backgroundColor: caption.backgroundColor,\n        color: caption.color,\n        fontSize: caption.size + 'pt',\n        fontWeight: 'bold',\n        padding: '2px'\n      });\n      span.elem.innerHTML = '' + caption.title;\n    } else {\n      if (div) {\n        this.unregisterElement('lower_overlay_pane', div.elem);\n        this._captionDiv = null;\n      }\n    }\n  },\n\n  /**\n   *  flat \n   * @returns {Boolean} flat\n   */\n  isFlat: function () {\n    return this._flat;\n  },\n\n  /**\n   *  flat  .\n   * @example marker.setFlat(true);\n   * @fires olleh.maps.overlay.Marker#event:flat_changed\n   * @param {boolean} flat <code>true</code>  shadow  .\n   */\n  setFlat: function (flat) {\n    this._flat = flat;\n    if (this.isDrawn()) {\n      this._updateShadow();\n      /**\n       * flat_changed . marker flat    .\n       * <p/>\n       * @name event:flat_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('flat_changed');\n    }\n  },\n\n  /**\n   *  drag   .\n   * @returns {boolean} draggable\n   */\n  isDraggable: function () {\n    return this._draggable;\n  },\n\n  isDragging: function () {\n    return this._isDragging && this._draggable;\n  },\n\n  /**\n   *  drag   .\n   * @fires olleh.maps.overlay.Marker#event:draggable_changed\n   * @param {boolean} draggable <code>true</code>  marker drag .\n   */\n  setDraggable: function (draggable) {\n\n    if (this._draggable != draggable) {\n      this._draggable = draggable;\n      /**\n       * draggable_changed . marker drag     .\n       * <p/>\n       * @name event:draggable_changed\n       * @event\n       * @memberOf olleh.maps.overlay.Marker.prototype\n       * @param {olleh.maps.event.Event} event\n       */\n      this.fireEvent('draggable_changed');\n    }\n  },\n\n  /**\n   * @private\n   * @param event\n   * @param payload\n   */\n  $capture_dragstart: function (event, payload) {\n    if(!this._draggable) return;\n\n    var dragImg = this._dragImg;\n    var DRAG_FLOATING_PX = olleh.maps.overlay.Marker.DRAG_FLOATING_PX;\n\n    event.preventDefault();\n    this._isDragging = true;\n\n    if (!dragImg) {\n      // drag Pointer Image \n      var DRAG_POINT = olleh.maps.overlay.Marker.DRAG_POINT;\n      var size = DRAG_POINT.size;\n      var anchor = DRAG_POINT.anchor || new olleh.maps.Point(size.width / 2, size.height);\n      dragImg = this._dragImg = new olleh.maps.SpritedImage().setStyles({\n        width: size.width + 'px',\n        height: size.height + 'px',\n        marginLeft: -anchor.x + 'px',\n        marginTop: -anchor.y + 'px',\n        zIndex: olleh.maps.overlay.BaseOverlay.MAX_ZINDEX\n      }).setImage(DRAG_POINT.url, DRAG_POINT.origin);\n    }\n    if (this._tooltip) {\n      this._tooltip.close();\n      delete this._tooltip;\n    }\n    this._iconImg.addClass('ollehmap-dragging');\n    this.registerElement('upper_overlay_pane', dragImg.elem);\n    this._float(DRAG_FLOATING_PX);\n    this._infoWin && this._infoWin._dragStart(new olleh.maps.Point(0, -DRAG_FLOATING_PX), new olleh.maps.Point(DRAG_FLOATING_PX, -DRAG_FLOATING_PX));\n  },\n\n  /**\n   * @private\n   * @param event\n   * @param payload\n   */\n  $capture_drag: function (event, payload) {\n    if (this.isDragging()) {\n      event.preventDefault();\n      this.move(payload.movementXY);\n      this._infoWin && this._infoWin._drag(payload.movementXY);\n    }\n  },\n\n  /**\n   * @private\n   * @param event\n   * @param payload\n   */\n  $capture_dragend : function (event, payload) {\n    if (this.isDragging()) {\n      var coord;\n      event.preventDefault();\n\n      this.unregisterElement('upper_overlay_pane', this._dragImg.elem);\n      this._sink(olleh.maps.overlay.Marker.DRAG_FLOATING_PX);\n\n      coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\n      this.setPosition(coord);\n      this._infoWin && this._infoWin._dragEnd(coord);\n      this._iconImg.removeClass('ollehmap-dragging');\n      this._isDragging = false;\n    }\n  },\n\n  /**\n   *  px marker  .\n   * @param {Number} distance \n   * @private\n   */\n  _float: function (distance) {\n    var o, anchor, shadowD;\n\n    if (this._animation != olleh.maps.overlay.Marker.BOUNCE) {\n      o = this._icon;\n      anchor = o.anchor || new olleh.maps.Point(o.size.width / 2, o.size.height);\n      this._iconImg.setStyles({\n        marginTop: -(anchor.y + distance) + 'px'\n      });\n      if (this._shadowImg) {\n        o = this._shadow;\n        anchor = o.anchor || new olleh.maps.Point(0, o.size.height);\n        shadowD = distance * Math.SQRT1_2;\n        this._shadowImg.setStyles({\n          marginTop: -(anchor.y + shadowD) + 'px',\n          marginLeft: -(anchor.x - shadowD) + 'px'\n        });\n      } \n    }\n  },\n\n  /**\n   *  px marker .\n   * @param distance \n   * @private\n   */\n  _sink: function (distance) {\n    var o, anchor;\n\n    if (this._animation != olleh.maps.overlay.Marker.BOUNCE) {\n      o = this._icon;\n      anchor = o.anchor || new olleh.maps.Point(o.size.width / 2, o.size.height);\n      this._iconImg.setStyles({\n        marginTop: -anchor.y + 'px'\n      });\n      if (this._shadowImg) {\n        o = this._shadow;\n        anchor = o.anchor || new olleh.maps.Point(0, o.size.height);\n        this._shadowImg.setStyles({\n          marginTop: -anchor.y + 'px',\n          marginLeft: -anchor.x + 'px'\n        });\n      }\n    }\n  },\n\n  /**\n   *    animation .\n   * @returns {String}  .\n   *  : {@link olleh.maps.overlay.Marker.BOUNCE} | {@link olleh.maps.overlay.Marker.DROP}\n   */\n  getAnimation: function () {\n    return this._animation;\n  },\n\n  /**\n   *  animation .\n   * @example marker.setAnimation(olleh.maps.overlay.Marker.BOUNCE);\n   * @fires olleh.maps.overlay.Marker#event:animation_changed\n   * @param {String} animation . <p/>\n   *  :\n   * <ul>\n   * <li>{@link olleh.maps.overlay.Marker.BOUNCE}</li>\n   * <li>{@link olleh.maps.overlay.Marker.DROP}</li>\n   * </ul>\n   */\n  setAnimation: function (animation) {\n    if (this._animation != animation) {\n      this._animation = animation;\n      if (this.isDrawn()) {\n        this._updateAnimation();\n        /**\n         * animation_changed . marker    .\n         * <p/>\n         * @name event:animation_changed\n         * @event\n         * @memberOf olleh.maps.overlay.Marker.prototype\n         * @param {olleh.maps.event.Event} event\n         */\n        this.fireEvent('animation_changed');\n      }\n    }\n  },\n  \n  _updateAnimation: function () {\n    var anchor;\n\n    if (!this._animation) {\n      this.stopAnimation();\n    } else if (this._animation === olleh.maps.overlay.Marker.BOUNCE) {\n      this.stopAnimationImmediately();\n      \n      anchor = this._icon.anchor || new olleh.maps.Point(this._icon.size.width / 2, this._icon.size.height);\n      this._iconAnimator = olleh.maps.overlay.Marker.getBounceAnimator(anchor).animate(this._iconImg.elem);\n      \n      if (this._shadowImg) {\n        anchor = this._shadow.anchor || new olleh.maps.Point(0, this._shadow.size.height);\n        this._shadowAnimator = olleh.maps.overlay.Marker.getBounceAnimator(anchor, true).animate(this._shadowImg.elem);\n      }\n    }\n  },\n\n  /**\n   *     .\n   * @private\n   */\n  stopAnimation: function () {\n    this._iconAnimator && this._iconAnimator.stopRepeat();\n    this._shadowAnimator && this._shadowAnimator.stopRepeat();\n  },\n\n  stopAnimationImmediately: function () {\n    this._iconAnimator && this._iconAnimator.stop();\n    this._shadowAnimator && this._shadowAnimator.stop();\n  },\n  \n  onAdd: function () {\n    var anchor, animator;\n\n    if (this._animation === olleh.maps.overlay.Marker.DROP) {\n      anchor = this._icon.anchor || new olleh.maps.Point(this._icon.size.width / 2, this._icon.size.height);\n      animator = olleh.maps.overlay.Marker.getDropAnimator(anchor);\n      this._iconImg.setStyles(animator.from);\n      animator.animate(this._iconImg.elem, {\n        callback: this.ready,\n        ctx: this\n      });\n      if (this._shadowImg) {\n        anchor = this._shadow.anchor || new olleh.maps.Point(0, this._shadow.size.height);\n        animator = olleh.maps.overlay.Marker.getDropAnimator(anchor, true);\n        this._shadowImg.setStyles(animator.from);\n        animator.animate(this._shadowImg.elem);\n      }\n    } else {\n      this.ready();\n    }\n  },\n\n  getBounds: function () {\n    return this._infoWin ? this._infoWin.getBounds().union(this._position): null;\n  },\n\n  /**\n   *  infowindow .\n   * @param {olleh.maps.overlay.BaseInfoWindow} infowindow\n   * @private\n   */\n  setInfoWindow: function (infoWin) {\n    if(infoWin == null)\n      this.resetZIndex();\n    this._infoWin = infoWin;\n  },\n\n  /**\n   *   .\n   * @example \n   * var position = new olleh.maps.UTMK(958094.06, 1942790.82);\n   * marker.setPosition(position);\n   * @param {olleh.maps.Coord} pos Coord\n   */\n  setPosition: function (pos) {\n    olleh.maps.overlay.Marker.$super.setPosition.apply(this, arguments);\n    this._infoWin && this._infoWin.setPosition(pos);\n  },\n\n  detach: function() {\n    this.stopAnimationImmediately();\n    if (this._infoWin) {\n      this._infoWin.close();\n      this._infoWin = null;\n    }\n    olleh.maps.overlay.Marker.$super.detach.apply(this, arguments);\n  },\n\n  $default_mouseover: function (event, payload) {\n    if(!this.isDragging() && this._title) {\n      var tooltip = this.map.getTooltip();\n      if (tooltip) {\n        tooltip.setContent(this._title);\n        tooltip.setPixelOffset(new olleh.maps.Point(0, 0));\n        tooltip.open(this.map, this);\n        this._tooltip = tooltip;\n      }\n    }\n    olleh.maps.overlay.Marker.$super.$default_mouseover.apply(this, arguments);\n  },\n\n  $default_mouseout: function (event, payload) {\n    if(this._tooltip) {\n      this._tooltip.close();\n      delete this._tooltip;\n    }\n    if(!this._infoWin)\n      olleh.maps.overlay.Marker.$super.$default_mouseout.apply(this, arguments);\n  },\n\n  zoomStart: function (scale, origin, duration) {\n    if (!this.isDragging()) {\n      olleh.maps.overlay.Marker.$super.zoomStart.apply(this, arguments);\n    }\n  },\n\n  zoomEnd: function () {\n    if (this.isDragging()) {\n      this.moveTo(this.getCurrentLayerPx());\n    } else {\n      olleh.maps.overlay.Marker.$super.zoomEnd.apply(this, arguments);\n    }\n  }\n\n});\n/**\r\n * ContentOverlayOptions Object Specification\r\n * @typedef olleh.maps.overlay.ContentOverlayOptions\r\n * @extends olleh.maps.overlay.PointedOverlayOptions\r\n * @property {String|Node} content ContentOverlay  content .\r\n * HTML element , plain-text string, HTML  string   . ContentOverlay content  size .\r\n * @property {olleh.maps.Point} [pixelOffset] position offset \r\n * @property {Number} [padding] content padding .\r\n */\r\n\r\n/**\r\n *        \r\n */\r\n$class('olleh.maps.overlay.ContentOverlay').extend(olleh.maps.overlay.PointedOverlay).define({\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.overlay.ContentOverlayOptions} opts \r\n   */\r\n  ContentOverlay: function (opts) {\r\n    this.name = 'olleh.maps.overlay.ContentOverlay';\r\n    this._defaultCss = null;\r\n    this._defaultPadding = 0;\r\n    this._body = null;\r\n    this._shadow = null;\r\n    this._marginPx = null;\r\n    this._topleftPx = null;\r\n    this._bounds = null;\r\n    this._opts = {};\r\n    this._opts.pixelOffset = new olleh.maps.Point(0,0);\r\n    this._contentAttacted = false;\r\n    this.contentSize = {\r\n        minWidth : 10,\r\n        minHeight : 10,\r\n        maxWidth : 800,\r\n        maxHeight : 800\r\n    };\r\n  },\r\n  \r\n  /**\r\n   *    \r\n   * @param event\r\n   * @param payload\r\n   * @private\r\n   */\r\n  $default_detached: function (event, payload) {\r\n    this._eliminateElements();\r\n    event.preventDefault();\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.ContentOverlayOptions} opts \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: false,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *    info.setOptions({content: WlongCnt,maxWidth: 300});\r\n   * });  \r\n   */\r\n  setOptions: function (opts) {\r\n    if (opts.maxWidth) {\r\n      var maxWidth = parseInt(opts.maxWidth);\r\n      opts.maxWidth = Math.min(maxWidth, this.contentSize.maxWidth);\r\n    } else if (this._opts.maxWidth) {\r\n      opts.maxWidth = this._opts.maxWidth;\r\n    } else {\r\n      opts.maxWidth = this.contentSize.maxWidth;\r\n    }\r\n    this._setMaxWidth(opts.maxWidth);\r\n    \r\n    if (opts.padding) {\r\n      opts.padding = parseInt(opts.padding);\r\n      this._setPadding(opts.padding);\r\n    }\r\n    \r\n    opts.pixelOffset && this.setPixelOffset(opts.pixelOffset);\r\n    olleh.maps.mixin(this._opts, opts, true);\r\n    if (opts.content){\r\n      this.setContent(opts.content);\r\n    } else if (opts.padding != undefined || opts.maxWidth != undefined) {\r\n      //padding  , maxWidth   content update.\r\n      // content  .\r\n      if (this._body) {\r\n        this._updateContent(this._body.contentElem.children[0]);\r\n      }\r\n      \r\n    }\r\n    olleh.maps.overlay.ContentOverlay.$super.setOptions.call(this, this._opts);\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @see olleh.maps.overlay.PointedOverlay#update\r\n   */\r\n  update: function () {\r\n    if (!this._body) this._updateElements();\r\n    olleh.maps.overlay.ContentOverlay.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   * @see olleh.maps.overlay.BaseOverlay#draw\r\n   * @override\r\n   * @param onAdd\r\n   * @private\r\n   */\r\n  draw: function (onAdd) {\r\n    olleh.maps.overlay.ContentOverlay.$super.draw.apply(this, arguments);\r\n    if (!this._contentAttacted) {\r\n      this._contentAttacted = true;\r\n      this.fireEvent('domready');\r\n    } \r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay Content .\r\n   * @fires olleh.maps.overlay.ContentOverlay#event:content_changed\r\n   * @param {String|Node} content ContentOverlay  content . \r\n   * HTML element , plain-text string, HTML  string   . ContentOverlay content  size .\r\n   *  size   HTML style size . \r\n   *  ContentOverlay ,  width, height  . \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   *  \r\n   * marker.onEvent('click', function () { info.setContent('Hello World'); });  \r\n   */\r\n  setContent: function (content) {\r\n    this._opts.content = content;\r\n    this._contentAttacted = false;\r\n    if (this.isAdded()) {\r\n      this._updateContent();\r\n      if (this.isDrawn()) {\r\n        this._contentAttacted = true;\r\n        this.fireEvent('domready');\r\n      }\r\n      this.fireEvent('content_changed');\r\n    }\r\n  },\r\n  /**\r\n   * 'domread' content_changed    content .\r\n   * setMaxWidth, setPadding .\r\n   * @private \r\n   */\r\n  _updateContent: function (beforeContent) {\r\n    if (this.isAdded()) {\r\n      this._eliminateElements();\r\n      this._updateElements(beforeContent);\r\n      olleh.maps.overlay.ContentOverlay.$super.update.apply(this, arguments);\r\n    }\r\n  },\r\n  /**\r\n   * ContentOverlay content .\r\n   * @returns {String|Node} content ContentOverlay  Content \r\n   */\r\n  getContent: function (content) {\r\n    return this._opts.content;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay position .\r\n   * @fires olleh.maps.overlay.ContentOverlay#event:position_changed\r\n   * @param {olleh.maps.Coord} coord ContentOverlay   \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *   info.setPosition(new olleh.maps.UTMK(953795.70, 1969715.52));\r\n   * }); \r\n   */\r\n  setPosition: function (coord) {\r\n    var from = this._position;\r\n    this._opts.position = coord;\r\n    this._position = coord;\r\n    if (this.isAdded()) {\r\n      this._updateMargin();\r\n      this._updateBounds();\r\n      //position  margin   .\r\n      if (this.isDrawn()) {\r\n        this._updatePosition();\r\n      }\r\n      this.fireEvent('position_changed',{from: from, to: coord});\r\n    }\r\n    \r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay Position .\r\n   * @returns {olleh.maps.Coord} coord ContentOverlay  \r\n   */\r\n  getPosition: function () {\r\n    return this._opts.position;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay pixelOffset .\r\n   * @param {olleh.maps.Point} offset ContentOverlay pixelOffset \r\n   */\r\n  setPixelOffset: function (offset) {\r\n    this._opts.pixelOffset = offset;\r\n    if (this.isAdded()) {\r\n      this._updateMargin();\r\n      this._updateBounds();\r\n      if (this.isDrawn()) {\r\n        this._updatePosition();\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay pixelOffset .\r\n   * @returns {olleh.maps.Point} pixelOffset\r\n   */\r\n  getPixelOffset: function () {\r\n    return this._opts.pixelOffset;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay body .\r\n   *\r\n   * @param {olleh.maps.Size} contentSize   \r\n   * @param {olleh.maps.Point} point ContentOverlay  , layerPixel \r\n   * @return {Element}          [rootElem] ContentOverlay body root element\r\n   *         {Element}          [contentElem] ContentOverlay body content element\r\n   *         {Element}          [closeElem] ContentOverlay body close element\r\n   *         {olleh.maps.Size}  [size] ContentOverlay size\r\n   *         {olleh.maps.Point} [topLeftPoint] ContentOverlay top left Point. \r\n   *                                  point   top, left   .\r\n   *@private\r\n   */\r\n  createBodyElem: function (contentSize, point) {},\r\n  \r\n  /**\r\n   * ContentOverlay shadow . \r\n   * \r\n   * @param {olleh.maps.Size} contentSize   \r\n   * @param  {olleh.maps.Point} point ContentOverlay   , layerPixel \r\n   * @return {Element}          [rootElem] ContentOverlay  root element\r\n   *         {olleh.maps.Size}  [size] ContentOverlay size\r\n   *         {olleh.maps.Point} [topLeftPoint] ContentOverlay top left Point. \r\n   *                                  point   top, left   .\r\n   *@private\r\n   */\r\n  createShadowElem: function (contentSize, point) {},\r\n  \r\n  _setMaxWidth: function (width) {\r\n    this._opts.maxWidth = width;\r\n  },\r\n  \r\n  _setPadding: function (padding) {\r\n    if (padding*2 >= this.contentSize.maxWidth) {\r\n      throw new RangeError('padding   .' \r\n          +this.contentSize.maxWidth/2+'  .');\r\n    }\r\n    this._opts.padding = padding;\r\n  },\r\n  /**\r\n   * ContentOverlay elements(body, shadow) ,  .\r\n   * @private\r\n   */\r\n  _updateElements: function (beforeContent) {\r\n    var domutil = olleh.maps.util.dom;\r\n    var opts = this._opts;\r\n    var size = this._checkContentSize(beforeContent);\r\n    var pos = opts.position;\r\n    var layerMgr = this.layer.layerMgr;\r\n    \r\n    var layerPx = layerMgr.getLayerPxFromCoord(pos);\r\n    layerPx = new olleh.maps.Point(Math.round(layerPx.x), Math.round(layerPx.y));    \r\n    \r\n    this._body = this.createBodyElem(size, layerPx);\r\n    this._topLeftPx = { body: this._body.topLeftPoint.subtract(layerPx)};\r\n    \r\n    if (beforeContent == undefined) {\r\n      var optsContent = opts.content;\r\n      var div = document.createElement('div');\r\n     \r\n      if (olleh.maps.isString(optsContent)) {\r\n        div.innerHTML = optsContent;\r\n      } else {\r\n        domutil.pushElement(div, optsContent);\r\n      }\r\n      domutil.addClass(div,this._defaultCss);\r\n      domutil.pushElement(this._body.contentElem, div);\r\n    } else {\r\n      //  content  .\r\n      domutil.pushElement(this._body.contentElem, beforeContent);\r\n    }\r\n    this.registerElement('infowindow_pane', this._body.rootElem);\r\n    \r\n    if (!this.layer.disableShadow) {\r\n      this._shadow = this.createShadowElem(size, layerPx);\r\n      if (this._shadow) {\r\n        this.registerElement('infowindow_shadow_pane', this._shadow.rootElem);\r\n        this._topLeftPx.shadow = this._shadow.topLeftPoint.subtract(layerPx);\r\n      }\r\n    }\r\n    //Event .\r\n    this._appendEvent();\r\n    //margin .\r\n    this._updateMargin();\r\n    //bound .\r\n    this._updateBounds();\r\n  },\r\n  \r\n  /**\r\n   * margin offset  . ContentOverlay top, left Margin .\r\n   *  margin option  pixelOffset .\r\n   * @private\r\n   */\r\n  _updateMargin: function () {\r\n    var offset = this._opts.pixelOffset;\r\n    this._marginPx = { body : this._topLeftPx.body.add(offset)};\r\n    if (this._shadow) {\r\n        this._marginPx.shadow = this._topLeftPx.shadow.add(offset);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay bounds  .\r\n   * @private\r\n   */\r\n  _updateBounds: function () {\r\n    var oldBounds = this._bounds;\r\n    var layerMgr = this.layer.layerMgr;\r\n    var pos = this._opts.position;\r\n    var layerPx = layerMgr.getLayerPxFromCoord(pos);\r\n    var topleft = this._marginPx.body.add(layerPx);\r\n    var leftBottom = \r\n      layerMgr.getCoordFromLayerPx(new olleh.maps.Point(topleft.x, topleft.y + this._body.size.height));\r\n    var rightTop = \r\n      layerMgr.getCoordFromLayerPx(new olleh.maps.Point(topleft.x + this._body.size.width, topleft.y));\r\n    this._bounds = new olleh.maps.Bounds(leftBottom, rightTop);\r\n    if (this._shadow) {\r\n      var s_topleft = this._marginPx.shadow.add(layerPx);\r\n      var s_leftBottom = \r\n        layerMgr.getCoordFromLayerPx(new olleh.maps.Point(s_topleft.x, s_topleft.y + this._shadow.size.height));\r\n      var s_rightTop = \r\n        layerMgr.getCoordFromLayerPx(new olleh.maps.Point(s_topleft.x + this._shadow.size.width, s_topleft.y));\r\n      var shadowBounds = new olleh.maps.Bounds(s_leftBottom, s_rightTop);\r\n      this._bounds = this._bounds.union(shadowBounds);\r\n    }\r\n    this.fireEvent('bounds_changed', {from: oldBounds, to: this._bounds});\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay   .\r\n   * @override\r\n   * @see olleh.maps.overlay.PointedOverlay#_updatePosition}\r\n   * @private\r\n   */\r\n  _updatePosition: function () {\r\n    var body = this._body;\r\n    var bm = this._marginPx.body;\r\n    body.rootElem.style.marginTop = bm.y + 'px';\r\n    body.rootElem.style.marginLeft = bm.x + 'px';\r\n    \r\n    if (this._shadow) {\r\n      var shadow = this._shadow;\r\n      var sm = this._marginPx.shadow;\r\n      shadow.rootElem.style.marginTop = sm.y + 'px';\r\n      shadow.rootElem.style.marginLeft = sm.x + 'px';\r\n    } \r\n    olleh.maps.overlay.ContentOverlay.$super._updatePosition.apply(this);\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay  .\r\n   *  @returns {olleh.maps.Bounds} bounds ContentOverlay \r\n   */\r\n  getBounds: function () {\r\n    if (!this._body) { //element    .\r\n      this._updateElements();\r\n    }\r\n    return this._bounds;\r\n  },\r\n  \r\n  /**\r\n   * @override\r\n   * @private\r\n   */\r\n  zoomEnd: function () {\r\n    this._updateBounds();\r\n    olleh.maps.overlay.ContentOverlay.$super.zoomEnd.apply(this);\r\n  },\r\n  \r\n  /**\r\n   * content size  .\r\n   * @returns {olleh.maps.Size} size\r\n   * @private \r\n   */\r\n  _checkContentSize: function (beforeContent) {\r\n    var pDiv = document.createElement('div');\r\n    var iDiv = document.createElement('div');\r\n    var domutil = olleh.maps.util.dom;\r\n    var maxWidth = (this._opts.maxWidth? this._opts.maxWidth : this.contentSize.maxWidth);\r\n    var contentPadding = this._opts.padding == undefined ? this._defaultPadding : this._opts.padding;\r\n    var dbContentPadding = contentPadding*2;\r\n    domutil.setStyles(pDiv, {\r\n      position: 'absolute',\r\n      left: '10000px',\r\n      top: '0px',\r\n      width : maxWidth - dbContentPadding +'px',\r\n      height :this.contentSize.maxHeight - dbContentPadding + 'px',\r\n      margin: '0px',\r\n      padding: '0px',\r\n      opacity: 0\r\n    });\r\n    domutil.setStyles(iDiv, {\r\n      position: 'absolute',\r\n      overflow: 'auto',\r\n      minWidth: Math.max(0,this.contentSize.minWidth - dbContentPadding)+ 'px',\r\n      minHeight: Math.max(0,this.contentSize.minHeight - dbContentPadding)+ 'px',\r\n      maxWidth: maxWidth - dbContentPadding+'px',\r\n      maxHeight: this.contentSize.maxHeight - dbContentPadding+ 'px'\r\n    });\r\n    domutil.addClass(iDiv,this._defaultCss);\r\n    pDiv.appendChild(iDiv);\r\n    if (beforeContent == undefined) {\r\n      var content = this._opts.content;\r\n      if (olleh.maps.isString(content)) {\r\n        iDiv.innerHTML = content;\r\n      } else {\r\n        domutil.pushElement(iDiv,content);\r\n      }\r\n    } else {\r\n      domutil.pushElement(iDiv,beforeContent);\r\n    }\r\n    \r\n    \r\n    var infopane = this.layer.getPane('infowindow_pane');\r\n    \r\n    domutil.pushElement(infopane, pDiv);\r\n    var size = new olleh.maps.Size(\r\n        iDiv.offsetWidth, \r\n        iDiv.offsetHeight\r\n    );\r\n    domutil.popElement(infopane, pDiv);\r\n    return size;\r\n  },\r\n  \r\n  /**\r\n   * ContentOverlay  .\r\n   * @private\r\n   */\r\n  _appendEvent: function () {\r\n    var body = this._body;\r\n    this.registerEventDom(body.contentElem);\r\n    if (!this._opts.disableCloseButton && body.closeElem) {\r\n      this.registerEventDom(body.closeElem);\r\n    } \r\n  },\r\n  \r\n\r\n  /**\r\n   *  pane  element .\r\n   * @private\r\n   */\r\n  _eliminateElements: function () {\r\n    this.unregisterElement('infowindow_pane',this._body.rootElem);\r\n    this._shadow && this.unregisterElement('infowindow_shadow_pane',this._shadow.rootElem);\r\n    this._topleftPx = null;\r\n    this._body = null;\r\n    this._shadow = null;\r\n    this._marginPx = null;\r\n    this._contentAttacted = false;\r\n  }\r\n});\n/////////////////////////\r\n//  InfoWindowOptions  //\r\n/////////////////////////\r\n/**\r\n * InfoWindowOptions Object Specification\r\n * @typedef olleh.maps.overlay.InfoWindowOptions\r\n * @extends olleh.maps.overlay.ContentOverlayOptions\r\n * @property {olleh.maps.Point} [pixelOffset=(0,0)] InfoWindow position offset \r\n * @property {Number} [zIndex] InfoWindow zIndex\r\n * @property {Number} [maxWidth=600] infowindow  width\r\n * @property {Boolean} [disableAutoPan=false] map  InfoWindow   \r\n * @property {Boolean} [disableCloseButton=false] InfoWindow closeButton   .\r\n * @property {Number} [padding=18] content padding .\r\n * @property {String|Node} content InfoWindow  content . \r\n * HTML element , plain-text string, HTML  string   . InfoWindow content  size .\r\n *  size   HTML style size .  InfoWindow size ,  width, height  .\r\n */\r\n\r\n/**\r\n *  BaseInfoWindow InfoWindow    .  InfoWindow  \r\n *  {@link olleh.maps.overlay.InfoWindow} .\r\n *  BaseInfoWindow  InfoWindow      createBodyElem,\r\n *  createShadowElem  InfoWindow   .\r\n *  createBodyElem Tip Body  DOM   createShadowElem\r\n *   shadow  DOM  .<p/>\r\n *  BaseInfoWindow  InfoWindow  ()      Overlay.\r\n *  InfoWindow UI    , UI  body, shadow, tip . \r\n *  tip (tip  )  tip      . \r\n *  body tip         .\r\n *  shadow InfoWindow tip body     .\r\n *  InfoWindow Marker  Overlay    . \r\n *    InfoWindow option   {@link olleh.maps.overlay.BaseInfoWindow#open}  InfoWindow  .\r\n *   close    , {@link olleh.maps.overlay.BaseInfoWindow#close}     .\r\n *     InfoWindow     DOM       .  \r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:close_click|close_click}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:content_changed|content_changed}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:domready|domready}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:position_changed|position_changed}</li>\r\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:zIndex_changed|zIndex_changed}</li>\r\n * </ul>\r\n * \r\n * @summary InfoWindow  ()      Overlay.\r\n */\r\n$class('olleh.maps.overlay.BaseInfoWindow').extend(olleh.maps.overlay.ContentOverlay).define({\r\n  \r\n  $static: { \r\n    AUTO_PAN_MARGIN : 10\r\n  },\r\n  /**\r\n   * close_click <p/>\r\n   *        .\r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.onEvent('close_click', \r\n   *   function (event) { console.log('close_click');}\r\n   * );\r\n   * info.open(map, marker);\r\n   * @name event:close_click\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   * \r\n   **/\r\n  /**\r\n  * content_changed <p/>\r\n  * InfoWindow Content     .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('content_changed', \r\n  *   function (event) { console.log('content_changed');}\r\n  * );\r\n  * info.open(map, marker); \r\n  * @name event:content_changed\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n /**\r\n  * domready <p/>\r\n  * InfoWindow DOM Tree  append     . \r\n  * InfoWindow DOM Tree append       . \r\n  *   InfoWindow DOM Tree append  append     .\r\n  *  InfoWindow DOM Tree append  InfoWindow       \r\n  * InfoWindow DOM Tree  .  InfoWindow      InfoWindow DOM Tree . \r\n  *  domready  .  DOM Tree  append   domready  .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('domready', \r\n  *   function (event) { console.log('domready');}\r\n  * );\r\n  * info.open(map, marker); \r\n  * @name event:domready\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n  /**\r\n  * position_changed <p/>\r\n  * InfoWindow position     .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('position_changed', \r\n  *   function (event) { console.log('position_changed');}\r\n  * );\r\n  * info.open(map, marker);\r\n  * @name event:position_changed\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n  /**\r\n  * zIndex_changed <p/>\r\n  * InfoWindow zIndex     .\r\n  * @example\r\n  * info = new olleh.maps.overlay.InfoWindow({\r\n  *   pixelOffset: new olleh.maps.Point(10, 20),\r\n  *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n  *   content: content\r\n  * });\r\n  * info.onEvent('zIndex_changed', \r\n  *   function (event) { console.log('zIndex_changed');}\r\n  * );\r\n  * info.open(map, marker);\r\n  * @name event:zIndex_changed\r\n  * @event\r\n  * @memberOf olleh.maps.overlay.BaseInfoWindow.prototype\r\n  * @param {olleh.maps.event.Event} event\r\n  **/\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.overlay.InfoWindowOptions} opts InfoWindowOptions\r\n   */\r\n  BaseInfoWindow: function (opts) {\r\n    this.name = 'olleh.maps.overlay.BaseInfoWindow';\r\n    //content   css\r\n    this._defaultCss = 'ollehmap-info-defaultStyle';\r\n    //content   padding\r\n    this._defaultPadding = 18;\r\n    this._anchor = null;\r\n    this._body =  null;\r\n    this._shadow =  null;\r\n    this._anchorOffset =  null;\r\n    \r\n    this.contentSize = {\r\n    //minWidth = maxHeight/2 - topShadowImageHeight + bottomShadowImageHeight + SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP\r\n    //   css ollehmap-info-content   .\r\n    //minHeight = 60(   :SHADOW_IMG_TOP_HEIGHT : 10 + SHADOW_IMG_BOTTOM_HEIGHT : 30) / cos45\r\n        minWidth : 300,\r\n        minHeight : 60,\r\n        maxWidth : 600,\r\n        maxHeight : 500 \r\n    };\r\n  },\r\n \r\n  /**\r\n   * auto-pan    InfoWindow elements  auto-pan .\r\n   * @private\r\n   */\r\n  $default_attached: function (event, payload) {\r\n    event.preventDefault();\r\n    if (!this._opts.disableAutoPan) {\r\n      if (!this._body) this._updateElements();\r\n      this._autoPan();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow content  \r\n   * close       \r\n   *   .\r\n   * @override\r\n   * @param event\r\n   * @param payload\r\n   * @private\r\n   */\r\n  propagateEvent: function (event, payload) {\r\n    try {\r\n      switch (event.getName()) {\r\n      case 'attached':\r\n      case 'detached':\r\n      case 'position_changed':\r\n      case 'bounds_changed':\r\n      case 'click':\r\n        break;\r\n      default:\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      }\r\n    } finally {\r\n      olleh.maps.overlay.BaseInfoWindow.$super.propagateEvent.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  $capture_click: function (event, payload) {\r\n    event.stopPropagation();\r\n    if (this._opts.disableCloseButton || this._body.closeElem !== event.targetDOM) {\r\n      event.preventDefault();\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  : close      .\r\n   * @private\r\n   */\r\n  $default_click: function (event, payload) {\r\n    event.preventDefault();\r\n    if (!this._opts.disableCloseButton && this._body.closeElem === event.targetDOM) {\r\n      this.fireEvent('close_click');\r\n      this.close();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow open . anchor  anchor position  \r\n   * InfoWindow . anchor  {@link olleh.maps.overlay.Marker}  marker anchor marker  \r\n   *  marker   . anchor marker   getPosition  \r\n   *  InfoWindow  . marker     \r\n   * {@link olleh.maps.overlay.InfoWindowOptions.pixelOffset}   . \r\n   * \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map, marker);\r\n   * @see olleh.maps.overlay.BaseInfoWindow#close\r\n   * @param {olleh.maps.Map} map Overlay  Map  \r\n   * @param anchor {olleh.maps.Coord | olleh.maps.Point | olleh.maps.overlay.Overlay} anchor {@link olleh.maps.Coord}  {@link olleh.maps.Point}  \r\n   * {@link olleh.maps.overlay.Overlay} (Marker ). Point  viewport  .\r\n   */\r\n  open: function (map, anchor) {\r\n    if (this._anchor instanceof olleh.maps.overlay.Marker) {\r\n      // anchor marker   .\r\n      this._anchor.setInfoWindow(null);\r\n    }\r\n    \r\n    if (anchor) {\r\n      //anchor open    opts Position  .\r\n      if (!this._anchor) {\r\n        this._optsPosition = this._opts.position;\r\n      }\r\n      \r\n      var coord = null;\r\n      if(anchor instanceof olleh.maps.Coord) {\r\n        coord = anchor;\r\n      } else if (anchor instanceof olleh.maps.Point) {\r\n        coord = map.layerMgr.getCoordFromViewportPx(anchor);\r\n      } else if (anchor instanceof olleh.maps.overlay.Marker) {\r\n        anchor.setInfoWindow(this);\r\n        var markerIcon = anchor.getIcon();\r\n        var markerShadow = anchor.getShadow();\r\n        this._anchorOffset = {};\r\n        this._anchorOffset.body =\r\n            new olleh.maps.Point(\r\n                Math.round(markerIcon.size.width/2 - markerIcon.anchor.x),\r\n                -markerIcon.size.height\r\n            );\r\n        if (markerShadow) {\r\n          this._anchorOffset.shadow = \r\n            new olleh.maps.Point(\r\n                Math.round(markerShadow.size.width - markerShadow.anchor.x),\r\n                -markerShadow.size.height\r\n            );\r\n        } else {\r\n          this._anchorOffset.shadow = \r\n            new olleh.maps.Point(\r\n                Math.round(markerIcon.size.width/2 - markerIcon.anchor.x),\r\n                -markerIcon.size.height\r\n            );\r\n        }\r\n        coord = anchor.getPosition();\r\n      } else if (anchor instanceof olleh.maps.overlay.Overlay) {\r\n        if (anchor.getPosition()) {\r\n          coord = anchor.getPosition();\r\n        } else if (anchor.getBounds()) {\r\n          coord = anchor.getBounds().getCenter();\r\n        } else {\r\n          throw new TypeError(\"anchor parameter must have a position\");\r\n        }\r\n      } else {\r\n        throw new TypeError(\"anchor parameter is incorrect\");\r\n      }\r\n      this._anchor = anchor;\r\n      this._setPosition(coord);\r\n    } else if (this._anchor  && this.isAdded()) {\r\n      // anchor   anchor   open .\r\n      this._anchor = null;\r\n      this._anchorOffset = null;\r\n      if (this._optsPosition) {//option   .\r\n        this._setPosition(this._optsPosition);\r\n        this._optsPosition = null;\r\n      } else {\r\n        throw new Error(\"Option's Position value is not exist\");\r\n      }\n    }\r\n    if (!this.isAdded()) {\r\n      \r\n      this.setMap(map);\r\n      \r\n    } else if (!this._opts.disableAutoPan) {\r\n      //infowindow   open  autopan\r\n      this._autoPan();\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * DOM Tree InfoWindow elements  InfoWindow .\r\n   * @fires olleh.maps.overlay.BaseInfoWindow#event:close_click\r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: true,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   *\r\n   * marker.onEvent('click', function () { info.close(); });\r\n   */\r\n  close: function () {\r\n    if (this.isAdded()) {\r\n      if (this._anchor instanceof olleh.maps.overlay.Marker) {\r\n        this._anchor.setInfoWindow(null);\r\n      }\r\n      this.setMap(null);\r\n    } \r\n  },\r\n  \n  /**\r\n   * InfoWindow . \r\n   * @private\r\n   */\r\n  $default_detached: function(event, payload) {\r\n    olleh.maps.overlay.BaseInfoWindow.$super.$default_detached.apply(this, arguments);\n    this._anchor = null;\r\n    this._anchorOffset = null;\r\n    this._optsPosition = null;\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow zIndex .\r\n   * @param {Number} zIndex InfoWindow zIndex  , default . \r\n   * zIndex       .\r\n   * @fires olleh.maps.overlay.BaseInfoWindow#event:zIndex_changed\r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: true,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   *          \r\n   * marker.onEvent('click', function () { \r\n   *   info.setZIndex(olleh.maps.overlay.BaseOverlay.MAX_ZINDEX); \r\n   * }); \r\n   */\r\n  setZIndex: function (zIndex) {\r\n    this._opts.zIndex = zIndex;\r\n    olleh.maps.overlay.BaseInfoWindow.$super.setZIndex.call(this, zIndex);\r\n    this.fireEvent('zIndex_changed');\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow option .\r\n   * @param {olleh.maps.overlay.InfoWindowOptions} opts  InfoWindowOptions \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   disableAutoPan: false,\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *    info.setOptions({content: WlongCnt,maxWidth: 300});\r\n   * });  \r\n   */\r\n  \r\n  /**\r\n   * @private\r\n   */\r\n  _setPosition: function (position) {\r\n    olleh.maps.overlay.BaseInfoWindow.$super.setPosition.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   * InfoWindow position .\r\n   * @fires olleh.maps.overlay.ContentOverlay#event:position_changed\r\n   * @param {olleh.maps.Coord} coord InfoWindow   \r\n   * @example \r\n   * info = new olleh.maps.overlay.InfoWindow({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * info.open(map);\r\n   * \r\n   * marker.onEvent('click', function () { \r\n   *   info.setPosition(new olleh.maps.UTMK(953795.70, 1969715.52));\r\n   * }); \r\n   */\r\n  setPosition: function (position) {\r\n    if (this._optsPosition) {\r\n      this._optsPosition = position;\r\n    }\r\n    olleh.maps.overlay.BaseInfoWindow.$super.setPosition.apply(this, arguments);\r\n  },\r\n  \r\n  \r\n  /**\r\n   * drag     . Marker . \r\n   * @param {olleh.maps.Point} bodyUpPoint   body   point\r\n   * @param {olleh.maps.Point} shadoWUpPoint   shadow   point\r\n   * @private\r\n   */\r\n  _dragStart: function (bodyUpPoint, shadowUpPoint) {\r\n    this.bringToFront();\r\n    this._dragUpPoint =  {\r\n        body : bodyUpPoint,\r\n        shadow : shadowUpPoint\r\n    };\r\n    this._marginPx.body = this._marginPx.body.add(this._dragUpPoint.body);\r\n    this._shadow && (this._marginPx.shadow = this._marginPx.shadow.add(this._dragUpPoint.shadow));\r\n    this._updatePosition();\r\n  },\r\n  \r\n  /**\r\n   * drag     . \r\n   * @param dragDelta\r\n   * @private\r\n   */\r\n  _drag: function (deltaPoint) {\r\n    this.move(deltaPoint);\r\n  },\r\n  \r\n  /**\r\n   * drag     . \r\n   * @param {olleh.maps.Coord} coord   Coord\r\n   * @private\r\n   */\r\n  _dragEnd: function (coord) {\r\n    this.resetZIndex();\r\n    this._marginPx.body = this._marginPx.body.subtract(this._dragUpPoint.body);\r\n    this._shadow && (this._marginPx.shadow = this._marginPx.shadow.subtract(this._dragUpPoint.shadow));\r\n    this._updatePosition();\r\n    this.setPosition(coord);\r\n  },\r\n \r\n  /**\r\n   * margin offset  . InfoWindow top, left Margin .\r\n   *  margin option  offset open  marker offset .\r\n   * @private\r\n   * @override\r\n   */\n  _updateMargin: function () {\r\n    var offset = this._opts.pixelOffset;\r\n    if (this._anchor instanceof olleh.maps.overlay.Marker) {\r\n      this._marginPx = { body: this._topLeftPx.body.add(offset.add(this._anchorOffset.body)) };\r\n      if (this._shadow) {\r\n        this._marginPx.shadow = this._topLeftPx.shadow.add(offset.add(this._anchorOffset.shadow));\r\n      }\r\n    } else {\r\n      olleh.maps.overlay.BaseInfoWindow.$super._updateMargin.apply(this, arguments);\n    }\r\n  },\r\n  \r\n  /**\r\n   *    InfoWindow  .\r\n   * @private\r\n   */\r\n  _autoPan: function () {\r\n    var layerMgr = this.getMap().getOverlayLayer().layerMgr;\r\n    var BaseInfo = olleh.maps.overlay.BaseInfoWindow;\r\n    var tPoint = layerMgr.getLayerPxFromCoord(layerMgr.getCenter());\r\n    var centerPoint = new olleh.maps.Point(Math.round(tPoint.x), Math.round(tPoint.y));\r\n    var viewSize = layerMgr.getViewportSize();\r\n    var viewHalfOfWidth = Math.round(viewSize.width/2);\r\n    var viewHalfOfHeight = Math.round(viewSize.height/2);\r\n    var viewTopLeft = layerMgr.getLayerPxFromViewportPx(new olleh.maps.Point(0,0));\r\n    var viewBottomRight = layerMgr.getLayerPxFromViewportPx(layerMgr.getViewportSize().asPoint());\r\n    \r\n    var infoData = this._calInfoData();\r\n    var infoPos = this.getOriginalLayerPx();\r\n    var infoSize = infoData.size;\r\n    var infoTopLeft = infoData.topLeft;\r\n    var infoBottomRight = infoData.bottomRight;\r\n    \r\n    var moveX = infoPos.x , moveY =  infoPos.y;\r\n    \r\n    //  INFOWINDOW  \r\n    var infoTopTypePoint = infoTopLeft.subtract(viewTopLeft);\r\n    var infoBottomTypePoint = viewBottomRight.subtract(infoBottomRight);\r\n    var isMoveX = true, isMoveY = true;\r\n    if (infoTopTypePoint.x > 0 && infoBottomTypePoint.x > 0) {\r\n      //infowindow X  .\r\n      isMoveX = false;\r\n      moveX = centerPoint.x;\r\n    }\r\n    \r\n    if (infoTopTypePoint.y > 0 && infoBottomTypePoint.y > 0) {\r\n      //infowindow Y  .\r\n      isMoveY = false;\r\n      moveY = centerPoint.y;\r\n    }\r\n    \r\n    if (!isMoveX && !isMoveY) { //infowindow  .\r\n      return; \r\n    }\r\n     \r\n    \r\n    var checkInfoSize = viewSize.subtract(infoSize);\r\n    var isLongerThanView = checkInfoSize.width < 0;\r\n    var isHigherThanView = checkInfoSize.height < 0;\r\n    var checkInfoPos = centerPoint.subtract(infoPos);\r\n    var isLeftOfCenter = checkInfoPos.x > 0;\r\n    var isTopOfCenter = checkInfoPos.y > 0;\r\n    \r\n    //move X     \r\n    if (isMoveX) {\r\n      if (isLongerThanView) {\r\n        //    \r\n        moveX = infoTopLeft.x - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfWidth;        \r\n      } else if (isLeftOfCenter) {\r\n        //  \r\n        moveX = infoTopLeft.x - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfWidth;\r\n      } else {\r\n        //  \r\n        moveX = infoTopLeft.x + infoSize.width + BaseInfo.AUTO_PAN_MARGIN - viewHalfOfWidth;\r\n      }\r\n    }\r\n    \r\n    //move Y \r\n    // view    \r\n    if (isMoveY) {\r\n      if(isHigherThanView) {\r\n        //    \r\n        moveY = infoTopLeft.y - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfHeight;\r\n      } else if (isTopOfCenter) {\r\n        //  \r\n        moveY = infoTopLeft.y - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfHeight;\r\n      } else {\r\n        //  \r\n        if (viewHalfOfHeight < infoSize.height && infoBottomTypePoint.y > 0) {\r\n          //point    ,  View   \r\n          moveY = infoTopLeft.y - BaseInfo.AUTO_PAN_MARGIN + viewHalfOfHeight;\r\n        } else {\r\n          moveY = infoBottomRight.y + BaseInfo.AUTO_PAN_MARGIN - viewHalfOfHeight;\r\n        }\r\n      }\r\n    }   \r\n      \r\n    var coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(moveX, moveY));\r\n    layerMgr.panTo(coord);\r\n  },\r\n\r\n  /**\r\n   * offset  autopan  InfoWindow size .\r\n   * @private\r\n   */\r\n  _calInfoData: function () {\r\n    var layerPx = this.getOriginalLayerPx();\r\n    var infoSize = this._body.size;\r\n    var infoTopLeft = layerPx.add(this._marginPx.body);\r\n    var infoBottomRight = infoTopLeft.add(new olleh.maps.Point(infoSize.width, infoSize.height));\r\n    var topleft = infoTopLeft.clone();\r\n    var bottomRight = infoBottomRight.clone();\r\n\r\n    if (layerPx.x < infoTopLeft.x) {\r\n      //pos.x  topleft.x    pos.x topleft.x  .\r\n      topleft.x = layerPx.x;\r\n    } else if (layerPx.x > infoBottomRight.x) {\r\n      //pos.x  bottomRight.x  \r\n      bottomRight.x = layerPx.x;\r\n    }\r\n    \r\n    if (layerPx.y < infoTopLeft.y) {\r\n      //pos.y  topleft.y  \r\n      topleft.y = layerPx.y;\r\n    } else if (layerPx.y > infoBottomRight.y) {\r\n      //pos.y  bottomRight.y  \r\n      bottomRight.y = layerPx.y;\r\n    }\r\n    var size = bottomRight.subtract(topleft);\r\n    \r\n    return {\r\n      topLeft: topleft,\r\n      bottomRight: bottomRight,\r\n      size: new olleh.maps.Size(size.x, size.y) \r\n    };\r\n  }\r\n});\r\n/**\n *  InfoWindow UI    , UI  body, shadow, tip . \n *  tip (tip  )  tip      . \n *  body tip         .\n *  shadow InfoWindow tip body     .\n *  InfoWindow Marker  Overlay    . \n *    InfoWindow option   {@link olleh.maps.overlay.BaseInfoWindow#open}  InfoWindow  .\n *   close    , {@link olleh.maps.overlay.BaseInfoWindow#close}     .\n *  InfoWindow    .     . minWidth : 300, minHeight : 60, maxWidth : 600, maxHeight : 500\n * <h5> </h5>  \n * <ul>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:close_click|close_click}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:content_changed|content_changed}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:domready|domready}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:position_changed|position_changed}</li>\n * <li>{@link olleh.maps.overlay.BaseInfoWindow#event:zIndex_changed|zIndex_changed}</li>\n * </ul>\n * \n * @summary InfoWindow  ()      Overlay.\n */\n$class('olleh.maps.overlay.InfoWindow').extend(olleh.maps.overlay.BaseInfoWindow).define({\n  \n  $static: {\n    URL: olleh.maps.env.RESOURCE_URL,\n    SHADOW_URL : 'img/infowins.png',\n    INFO_URL : 'img/infowins.png',\n    CLOSE_URL : 'img/infowins.png',\n    //body border\n    BORDER : 2,\n    //content  Tip(infowindow  )   \n    TIP_POS_RATE : 0,\n    //TIP  left     \n    TIP_POS_MAXLEFT : 45,\n    TIP_HEIGHT : 26,\n    TIP_NOVIEW_HEIGHT : 2,\n    /*    */\n    //    \n    SHADOW_LEFT_HYPOTENUSE : -366, \n    //    \n    SHADOW_RIGHT_HYPOTENUSE : -1106, \n    //shadowCenterImage width height  (px),  centerLeft width  .\n    //shadow_img_top_width  , \n    SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP : 70, \n    //Shadow Tip  tip  px  \n    SHADOW_IMG_TIP_GAP : 18, //tip  * tan45, body   shadow     \n    /*  (  ) */\n    SHADOW_IMG_TIP_WIDTH : 40,\n    SHADOW_IMG_TOP_HEIGHT : 10,\n    SHADOW_IMG_TOP_WIDTH : 70,\n    SHADOW_IMG_BOTTOM_HEIGHT : 30,\n    SHADOW_IMG_BOTTOM_WIDTH : 70,\n    /*      ( px) */\n    SHADOW_IMG_LEFTTOP_WIDTH : 40,\n    SHADOW_IMG_RIGHTTOP_WIDTH : 30,\n    SHADOW_IMG_LEFTBOTTOM_WIDTH : 52,//tip  * cos45 \n    SHADOW_IMG_RIGHTBOTTOM_WIDTH : 30,\n    //top, center shadow bottom shadow   \n    SHADOW_IMG_LEFTBOTTOM_W_PADDING : 3,\n\n    /*\n     * infoWindow template\n     * <pre>\n     * template property : \n     *  infoBodyWidth: Number,\n     *  infoBodyHeight: Number,\n     *  closeUrl: String,\n     *  contentMaxWidth: Number,\n     *  contentWidth: Number,\n     *  contentHeight: Number,\n     *  content: String,\n     *  infoTipTop: Number,\n     *  infoleftofTip: Number,\n     *  infoUrl: String,\n     *  infoBottomWidth: Number,\n     *  infoBottomHeight: Number\n     * </pre>\n     * @type String\n     */\n    INFO_TMPL: [\n      '<div class=\"ollehmap-info-area\" style=\"width:#{infoBodyWidth}px;height:#{infoBodyHeight}px;\">',\n        '<div class=\"ollehmap-info-content\" style=\"max-width:#{contentMaxWidth}px;\">',\n          '<div class=\"ollehmap-info-content-overflow\" style=\"padding:#{contentPadding}px;width:#{contentWidth}px;height:#{contentHeight}px;\"></div>',\n        '</div>',\n        '<div class=\"ollehmap-info-close\">',\n          '<img class=\"ollehmap-info-close-img\" src=\"#{closeUrl}\" draggable=\"false\"></img>',\n        '</div>',\n      '</div>',\n      '<div class=\"ollehmap-info-tip\" style=\"top:#{infoTopofTip}px;left:#{infoleftofTip}px;\">',\n        '<img class=\"ollehmap-info-tip-img\" src=\"#{infoUrl}\"></img>',\n      '</div>'].join(''),\n      /*'<div class=\"ollehmap-info-bottom\" style=\"width:#{infoBottomWidth}px;height:#{infoBottomHeight}px;\"></div>'].join(''),*/\n    \n    /*\n     * infoWindow shadow template\n     * TODO :    background-position, background-size img tag   .\n     * <pre>\n     * template property :\n     *  topLeftPoint: Number,\n     *  topRightPoint: Number,\n     *  bottomLeftPointX: String,\n     *  bottomLeftPointY: Number,\n     *  bottomRightPointX: Number,\n     *  bottomRightPointY: Number,\n     *  bottomTipPointX: String,\n     *  bottomTipPointY: Number,\n     *  topCenterPointX: Number,\n     *  topCenterPointY: String,\n     *  topCenterWidth: Number,\n     *  middleLeftPointX: Number,\n     *  middleLeftWidth: Number,\n     *  middleLeftHeight: Number,\n     *  middleLeftImgLeftPx: Number,\n     *  middleRightPointX: Number,\n     *  middleRightPointY: Number,\n     *  middleRightWidth: Number,\n     *  middleRightHeight: Number,\n     *  middleRightImgLeftPx: Number,\n     *  bottomLeftOfTipPointX: Number,\n     *  bottomLeftOfTipPointY: Number,\n     *  bottomLeftOfTipWidth: Number,\n     *  bottomRightOfTipPointX: Number,\n     *  bottomRightOfTipPointY: Number,\n     *  bottomRightOfTipRightWidth: Number,\n     *  middlePointX: Number,\n     *  middlePointY: Number,\n     *  middleWidth: Number,\n     *  middleHeight: Number,\n     *  url: String\n     * </pre>\n     * @type String\n     */\n    INFO_SHADOW_TMPL: [\n      '<div class=\"ollehmap-info-shadow-topleft\" style=\"left:#{topLeftPoint}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-topright\" style=\"left:#{topRightPoint}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-bottomleft\" style=\"left:#{bottomLeftPointX}px; top:#{bottomLeftPointY}px; \">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-bottomright\" style=\"left:#{bottomRightPointX}px; top:#{bottomRightPointY}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>',\n      '<div class=\"ollehmap-info-shadow-bottomtip\" style=\"left:#{bottomTipPointX}px; top:#{bottomTipPointY}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">', \n      '</div>', //centerTop TopCenter\n      '<div class=\"ollehmap-info-shadow-topcenter\" style=\"left:#{topCenterPointX}px; top:#{topCenterPointY}px; width:#{topCenterWidth}px; \">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>', //centerLeft img\n      '<div class=\"ollehmap-info-shadow-centerleft\" style=\"left:#{middleLeftPointX}px; top:#{middleLeftPointY}px; width:#{middleLeftWidth}px; height:#{middleLeftHeight}px;\">',\n        '<img style=\"left:#{middleLeftImgLeftPx}px;\" src=\"#{url}\" draggable=\"false\">',\n      '</div>', //centerRight img\n      '<div class=\"ollehmap-info-shadow-centerright\" style=\"left:#{middleRightPointX}px; top:#{middleRightPointY}px; width:#{middleRightWidth}px; height:#{middleRightHeight}px;\">',\n        '<img style=\"left:#{middleRightImgLeftPx}px;\" src=\"#{url}\" draggable=\"false\">',\n      '</div>', //leftTip\n      '<div class=\"ollehmap-info-shadow-bottomleftoftip\" style=\"left:#{bottomLeftOfTipPointX}px; top:#{bottomLeftOfTipPointY}px; width:#{bottomLeftOfTipWidth}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>', //rightTip\n      '<div class=\"ollehmap-info-shadow-bottomrightoftip\" style=\"left:#{bottomRightOfTipPointX}px; top:#{bottomRightOfTipPointY}px; width:#{bottomRightOfTipRightWidth}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>', //center\n      '<div class=\"ollehmap-info-shadow-center\" style=\"left:#{middlePointX}px; top:#{middlePointY}px; width:#{middleWidth}px; height:#{middleHeight}px;\">',\n        '<img src=\"#{url}\" draggable=\"false\">',\n      '</div>'].join('')\n  },\n  \n  /**\n   * @name olleh.maps.overlay.InfoWindow#InfoWindow\n   * @param {olleh.maps.overlay.InfoWindowOptions} opts InfoWindowOptions\n   * @see olleh.maps.overlay.PointedOverlay#PointedOverlay\n   * @see olleh.maps.overlay.BaseInfoWindow\n   * @see olleh.maps.overlay.BaseInfoWindow#open\n   * @constructs\n   */\n  \n  /**\n   * InfoWindow body .\n   * @override {@link olleh.maps.overlay.BaseInfoWindow#createBodyElem}\n   * @param {olleh.maps.Size} contentSize   \n   * @param {olleh.maps.Point} point InfoWindow  , layerPixel \n   * @return {Element}          [rootElem] InfoWindow body root element\n   *         {Element}          [contentElem] InfoWindow body content element\n   *         {Element}          [closeElem] InfoWindow body close element\n   *         {olleh.maps.Size}  [size] InfoWindow size\n   *         {olleh.maps.Point} [topLeftPoint] InfoWindow top left Point. \n   *                                  point   top, left   .\n   *@private\n   */\n  createBodyElem: function (contentSize, point) {\n    var InfoWindow = olleh.maps.overlay.InfoWindow;\n    var domutil = olleh.maps.util.dom;\n    var contentPadding = this._opts.padding == undefined ? this._defaultPadding : this._opts.padding;\n    var infoBodyWidth = contentSize.width  + 2*contentPadding; //  padding  body  \n    var infoBodyHeight = contentSize.height  + 2*contentPadding;\n    //infowindow area width   border   \n    var infoWidth = infoBodyWidth + 2*InfoWindow.BORDER;\n    //infowindow area top   border   \n    var infoHeight = infoBodyHeight + InfoWindow.TIP_HEIGHT + 2*InfoWindow.BORDER;\n    var infoPosY = point.y - infoHeight;\n    \n    var tipleftPos = InfoWindow.TIP_POS_RATE * contentSize.width;\n    if (tipleftPos > InfoWindow.TIP_POS_MAXLEFT) {\n      tipleftPos = 0;\n    }     \n    var infoleftofTip = contentPadding + InfoWindow.BORDER\n            + Math.ceil(contentSize.width/2 - tipleftPos);\n    var infoPosX = point.x - infoleftofTip - InfoWindow.BORDER; //infowindow area left  border   left\n    \n    //tip  border  infoBodyHeight(infowindow area ) tip  content    .  \n    var infoTopofTip = infoBodyHeight + 2*InfoWindow.BORDER - InfoWindow.TIP_NOVIEW_HEIGHT;\n    \n    var infoDiv = document.createElement('div');\n    var data = {\n        infoBodyWidth: infoBodyWidth, //border \n        infoBodyHeight: infoBodyHeight,//border \n        contentPadding: contentPadding,\n        closeUrl: InfoWindow.URL + InfoWindow.CLOSE_URL,\n        infoUrl: InfoWindow.URL+ InfoWindow.INFO_URL,\n        contentMaxWidth: this._opts.maxWidth,\n        contentWidth: contentSize.width,\n        contentHeight: contentSize.height,\n        infoTopofTip: infoTopofTip,\n        infoleftofTip: infoleftofTip\n      };\n    \n    domutil.addClass(infoDiv, 'ollehmap-info');\n    infoDiv.innerHTML = olleh.maps.util.applyTemplate(InfoWindow.INFO_TMPL, data);\n    var closeElem = infoDiv.childNodes[0].childNodes[1];\n    if (this._opts.disableCloseButton) {\n      domutil.removeElements(closeElem);\n      closeElem = null;\n    }\n    return {\n      rootElem : infoDiv,\n      contentElem : infoDiv.childNodes[0].childNodes[0].children[0],\n      closeElem : closeElem,\n      size : new olleh.maps.Size(infoWidth, infoHeight),\n      topLeftPoint : new olleh.maps.Point(infoPosX, infoPosY)\n    };\n    \n  },\n  \n  /**\n   * InfoWindow shadow . \n   * @override {@link olleh.maps.overlay.BaseInfoWindow#createBodyElem}\n   * @param {olleh.maps.Size} contentSize   \n   * @param  {olleh.maps.Point} point InfoWindow   , layerPixel \n   * @return {Element}          [rootElem] InfoWindow  root element\n   *         {olleh.maps.Size}  [size] InfoWindow size\n   *         {olleh.maps.Point} [topLeftPoint] InfoWindow top left Point. \n   *                                  point   top, left   .\n   *@private\n   */\n  createShadowElem: function (contentSize, point) {\n    var domutil = olleh.maps.util.dom;\n    var InfoWindow = olleh.maps.overlay.InfoWindow;\n    var contentPadding = this._opts.padding == undefined ?  this._defaultPadding : this._opts.padding;\n    var bodyWidth = contentSize.width + 2*InfoWindow.BORDER + 2*contentPadding;\n    var bodyHeight = contentSize.height + 2*InfoWindow.BORDER + 2*contentPadding;\n    var infoHeight = bodyHeight + InfoWindow.TIP_HEIGHT;\n    \n    var tipleftPos = InfoWindow.TIP_POS_RATE * contentSize.width;\n    if (tipleftPos > InfoWindow.TIP_POS_MAXLEFT) {//??\n      tipleftPos = 0;\n    }\n    var infoleftofTip = contentPadding \n            + Math.ceil(contentSize.width/2 - tipleftPos);\n    \n    var shadowHeight =  Math.round(\n        (infoHeight)/2);\n    var shadowWidth = bodyWidth;\n    \n    \n    var shadowInfoLeftofTip = infoleftofTip\n    - InfoWindow.SHADOW_IMG_TIP_GAP;\n    \n    var shadowPosY = point.y - shadowHeight;\n    var shadowPosX = point.x - infoleftofTip;\n    \n    \n    var infoShadowDiv = document.createElement('div');\n    domutil.addClass(infoShadowDiv, 'ollehmap-info-shadow');\n    domutil.addClass(infoShadowDiv, 'ollehmap-noevent');\n    \n    var middleLeftHSize = shadowHeight \n    - InfoWindow.SHADOW_IMG_TOP_HEIGHT - InfoWindow.SHADOW_IMG_BOTTOM_HEIGHT;\n    var topCenterWSize = shadowWidth\n    - InfoWindow.SHADOW_IMG_LEFTTOP_WIDTH - InfoWindow.SHADOW_IMG_RIGHTTOP_WIDTH;\n    var bottomLeftTipWSize = shadowInfoLeftofTip - InfoWindow.SHADOW_IMG_LEFTBOTTOM_WIDTH;\n    var bottomRightTipWSize = shadowWidth - shadowInfoLeftofTip \n    - InfoWindow.SHADOW_IMG_TIP_WIDTH - InfoWindow.SHADOW_IMG_RIGHTBOTTOM_WIDTH;\n    \n    var left =  InfoWindow.SHADOW_IMG_BOTTOM_WIDTH;\n    var top = InfoWindow.SHADOW_IMG_TOP_HEIGHT + middleLeftHSize;\n    var bottomLeftPoint = new olleh.maps.Point(0, top);\n    //cal position and size of Tip'left  shadow\n    var bottomLeftOfTipPoint = new olleh.maps.Point(left, top);\n    var bottomLeftOfTipWidth = bottomLeftTipWSize;\n    //cal position of Tip shadow\n    left += bottomLeftTipWSize;\n    var bottomTipPoint = new olleh.maps.Point(left, top);\n    //cal position of Tip'right  shadow\n    left += InfoWindow.SHADOW_IMG_TIP_WIDTH;\n    var bottomRightOfTipPoint = new olleh.maps.Point(left, top); \n    var bottomRightOfTipRightWidth = bottomRightTipWSize;\n    //cal position of rightBottom shadow\n    left += bottomRightTipWSize;    \n    var bottomRightPoint = new olleh.maps.Point(left, top);\n    \n    //cal position and size of middle left shadow\n    var middleLeftWidth = middleLeftHSize + InfoWindow.SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP;\n    left = InfoWindow.SHADOW_IMG_LEFTBOTTOM_W_PADDING;\n    top = InfoWindow.SHADOW_IMG_TOP_HEIGHT;\n    var middleLeftPoint = new olleh.maps.Point(left, top);\n    var middleLeftSize = new olleh.maps.Size(middleLeftWidth, middleLeftHSize);\n    var middleLeftImgLeftPx = InfoWindow.SHADOW_LEFT_HYPOTENUSE + middleLeftWidth;\n    //cal position and size of middle shadow\n    left += middleLeftWidth;\n    var middlePoint = new olleh.maps.Point(left, top);\n    var middleSize = new olleh.maps.Size(Math.max(shadowWidth - middleLeftWidth,0), middleLeftHSize);\n    //cal position of middleRight shadow\n    left += parseFloat(middleSize.width);\n    var middleRightPoint = new olleh.maps.Point(left, top);\n    var middleRightSize = new olleh.maps.Size(middleLeftWidth, middleLeftHSize);\n    var middleRightImgLeftPx = InfoWindow.SHADOW_RIGHT_HYPOTENUSE + middleLeftWidth;\n    \n    //cal position of Top's left shadow\n    left = InfoWindow.SHADOW_IMG_LEFTBOTTOM_W_PADDING + middleLeftWidth - InfoWindow.SHADOW_IMG_TOP_WIDTH;\n    var topLeftPoint = new olleh.maps.Point(left, 0);\n    //cal position of Top's center shadow\n    left += InfoWindow.SHADOW_IMG_TOP_WIDTH;\n    var topCenterPoint = new olleh.maps.Point(left, 0);\n    var topCenterWidth = topCenterWSize;\n    //cal position of Top's right shadow\n    left += topCenterWSize;\n    var topRightPoint = new olleh.maps.Point(left, 0);\n    var data = {\n        topLeftPoint: topLeftPoint.x,\n        topRightPoint: topRightPoint.x,\n        bottomLeftPointX: bottomLeftPoint.x,\n        bottomLeftPointY: bottomLeftPoint.y,\n        bottomRightPointX: bottomRightPoint.x,\n        bottomRightPointY: bottomRightPoint.y,\n        bottomTipPointX: bottomTipPoint.x,\n        bottomTipPointY: bottomTipPoint.y,\n        topCenterPointX: topCenterPoint.x,\n        topCenterPointY: topCenterPoint.y,\n        topCenterWidth: topCenterWidth,\n        middleLeftPointX: middleLeftPoint.x,\n        middleLeftPointY: middleLeftPoint.y,\n        middleLeftWidth: middleLeftSize.width,\n        middleLeftHeight: middleLeftSize.height,\n        middleRightPointX: middleRightPoint.x,\n        middleRightPointY: middleRightPoint.y,\n        middleRightWidth: middleRightSize.width,\n        middleRightHeight: middleRightSize.height,\n        bottomLeftOfTipPointX: bottomLeftOfTipPoint.x,\n        bottomLeftOfTipPointY: bottomLeftOfTipPoint.y,\n        bottomLeftOfTipWidth: bottomLeftOfTipWidth,\n        bottomRightOfTipPointX: bottomRightOfTipPoint.x,\n        bottomRightOfTipPointY: bottomRightOfTipPoint.y,\n        bottomRightOfTipRightWidth: bottomRightOfTipRightWidth,\n        middlePointX: middlePoint.x,\n        middlePointY: middlePoint.y,\n        middleWidth: middleSize.width,\n        middleHeight: middleSize.height,\n        middleLeftImgLeftPx: middleLeftImgLeftPx,\n        middleRightImgLeftPx: middleRightImgLeftPx,\n        url: InfoWindow.URL + InfoWindow.SHADOW_URL\n      };\n\n    infoShadowDiv.innerHTML = olleh.maps.util.applyTemplate(InfoWindow.INFO_SHADOW_TMPL, data);\n        \n    return {\n      rootElem : infoShadowDiv,\n      size : new olleh.maps.Size(shadowWidth + shadowHeight*Math.tan(Math.PI/4), shadowHeight),\n      topLeftPoint : new olleh.maps.Point(shadowPosX, shadowPosY)\n    };\n  }\n  \n});\n/////////////////////////\r\n//   TooltipOptions    //\r\n/////////////////////////\r\n/**\r\n * TooltipOptions Object Specification\r\n * @typedef olleh.maps.overlay.TooltipOptions\r\n * @extends olleh.maps.overlay.ContentOverlayOptions\r\n * @property {olleh.maps.Point} [pixelOffset=(0,0)] Tooltip position offset, tooltip    .\r\n * @property {Number} [zIndex] Tooltip zIndex\r\n * @property {Number} [maxWidth=800] Tooltip  width\r\n * @property {Number} [padding=4] content padding .\r\n * @property {String|Node} content Tooltip  content .\r\n * HTML element , plain-text string, HTML  string   . Tooltip content  size .\r\n */\r\n\r\n/**\r\n * Tooltip  overlay      Overlay. UI    .\r\n * Tooltip    ,  ,  ,   4 \r\n * Tooltip   4          .\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:close|close}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:content_changed|content_changed}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:domready|domready}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:position_changed|position_changed}</li>\r\n * <li>{@link olleh.maps.overlay.Tooltip#event:zIndex_changed|zIndex_changed}</li>\r\n * <ul>\r\n * \r\n * @summary Tooltip  ()      Overlay\r\n */\r\n$class('olleh.maps.overlay.Tooltip').extend(olleh.maps.overlay.ContentOverlay).define({\r\n  \r\n  $static: {\r\n    BORDER : 1,\r\n    TOOLTIP_TMPL: [\r\n      '<div class=\"ollehmap-info-tooltip-area\" style=\"width:#{bodyWidth}px;height: #{bodyHeight}px;\">',\r\n        '<div class=\"ollehmap-info-tooltip-content\" style=\"max-width:#{contentMaxWidth}px;max-height:#{contentMaxHeight}px\">',\r\n          '<div class=\"ollehmap-info-content-overflow\" style=\"padding:#{contentPadding}px;width:#{contentWidth}px;height:#{contentHeight}px;\"></div>',\r\n        '</div>',\r\n      '</div>'].join('')\r\n  },\r\n  /**\r\n   * close <p/>\r\n   * Tooltip     .\r\n   * @example \r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('close', \r\n   *   function (event) { console.log('close');}\r\n   * );\r\n   * tooltip.open(map, marker);\r\n   * @name event:close\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   * \r\n   **/\r\n   /**\r\n   * content_changed <p/>\r\n   * Tooltip Content     .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('content_changed', \r\n   *   function (event) { console.log('content_changed');}\r\n   * );\r\n   * tooltip.open(map, marker); \r\n   * @name event:content_changed\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n  /**\r\n   * domready <p/>\r\n   * Tooltip DOM Tree  append     . \r\n   * Tooltip DOM Tree append       . \r\n   *   Tooltip DOM Tree append  append     .\r\n   *  Tooltip DOM Tree append  Tooltip       \r\n   * Tooltip DOM Tree  .  Tooltip      Tooltip DOM Tree . \r\n   *  domready  .  DOM Tree  append   domready  .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('domready', \r\n   *   function (event) { console.log('domready');}\r\n   * );\r\n   * tooltip.open(map, marker); \r\n   * @name event:domready\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n   /**\r\n   * position_changed <p/>\r\n   * Tooltip position     .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('position_changed', \r\n   *   function (event) { console.log('position_changed');}\r\n   * );\r\n   * tooltip.open(map, marker);\r\n   * @name event:position_changed\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n   /**\r\n   * zIndex_changed <p/>\r\n   * Tooltip zIndex     .\r\n   * @example\r\n   * tooltip = new olleh.maps.overlay.Tooltip({\r\n   *   pixelOffset: new olleh.maps.Point(10, 20),\r\n   *   position: new olleh.maps.UTMK(953855.70, 1959715.52),\r\n   *   content: content\r\n   * });\r\n   * tooltip.onEvent('zIndex_changed', \r\n   *   function (event) { console.log('zIndex_changed');}\r\n   * );\r\n   * tooltip.open(map, marker);\r\n   * @name event:zIndex_changed\r\n   * @event\r\n   * @memberOf olleh.maps.overlay.Tooltip.prototype\r\n   * @param {olleh.maps.event.Event} event\r\n   **/\r\n   \r\n   /**\r\n    * ,  opts    .\r\n    * @param {olleh.maps.overlay.TooltipOptions} opts TooltipOptions\r\n    */\r\n  Tooltip: function (opts) {\r\n    //content   css\r\n    this._defaultCss = 'ollehmap-info-tooltip-data';\r\n    //content   padding\r\n    this._defaultPadding = 4;\r\n  },\r\n  \r\n  /**\r\n   *  \r\n   * @param {olleh.maps.overlay.TooltipOptions} opts \r\n   */\r\n  setOptions: function (opts) {\r\n    if (opts.zIndex == undefined) {\r\n      opts.zIndex = olleh.maps.overlay.BaseOverlay.MAX_ZINDEX;\r\n    }\r\n    olleh.maps.overlay.Tooltip.$super.setOptions.call(this, opts);\r\n  },\r\n  \r\n  /**\r\n   * Tooltip Infowindow body .\r\n   * @override\r\n   * @param contentSize\r\n   * @param point\r\n   * @private\r\n   */\r\n  createBodyElem: function (contentSize, point) {\r\n    var tooltip = olleh.maps.overlay.Tooltip;\r\n    //TODO: chrome bug fix   \r\n    contentSize.width +=1;\r\n    var contentPadding = this._opts.padding == undefined ? this._defaultPadding : this._opts.padding;\r\n    var bodyWidth = contentSize.width + 2*contentPadding;\r\n    var bodyHeight = contentSize.height + 2*contentPadding;\r\n    var infoHeight = bodyHeight + 2*tooltip.BORDER;\r\n    var infoWidth = bodyWidth + 2*tooltip.BORDER;\r\n    var domutil = olleh.maps.util.dom;\r\n    var infoDiv = document.createElement('div');\r\n    domutil.addClass(infoDiv, 'ollehmap-info');\r\n    var data = {\r\n        bodyWidth : bodyWidth,\r\n        bodyHeight : bodyHeight,\r\n        contentPadding : contentPadding,\r\n        contentMaxWidth: this._opts.maxWidth,\r\n        contentMaxHeight: this.contentSize.maxHeight,\r\n        contentWidth : contentSize.width,\r\n        contentHeight : contentSize.height\r\n    };\r\n     \r\n    infoDiv.innerHTML = olleh.maps.util.applyTemplate(tooltip.TOOLTIP_TMPL, data);\r\n    \r\n    return {\r\n      rootElem : infoDiv,\r\n      contentElem : infoDiv.childNodes[0].childNodes[0].childNodes[0],\r\n      closeElem : null,\r\n      size : new olleh.maps.Size(infoWidth, infoHeight),\r\n      topLeftPoint : point\r\n    };\r\n    \r\n  },\r\n  \r\n  /**\r\n   * tooltip  point  4     \r\n   *  margin  . 4   bottomRight\r\n   * , bottomLeft, topRight, topLeft .\r\n   * @return {olleh.maps.Point} point margin\r\n   * @private\r\n   */\r\n  _calTooltipPosition: function () {\r\n    var layerMgr = this.getMap().getOverlayLayer().layerMgr;\r\n    var size = this._body.size;\r\n    var offset = this._opts.pixelOffset;\r\n    var viewBounds = layerMgr.getBounds();\r\n    var layerPx = this.getOriginalLayerPx();\r\n    var radius = this._calRadiusOfAnchor();\r\n    \r\n    //bottomRight\r\n    var point = new olleh.maps.Point(\r\n        layerPx.x + offset.x + radius.right, \r\n        layerPx.y + offset.y + radius.bottom);\r\n    \r\n    var coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x + size.width, point.y + size.height));\r\n    if (viewBounds.contains(coord)) {\r\n      return  point.subtract(layerPx);\r\n    }\r\n    \r\n    //bottomLeft\r\n    point = new olleh.maps.Point(\r\n        layerPx.x - size.width - offset.x - radius.left, \r\n        layerPx.y + offset.y + radius.bottom);\r\n    coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x, point.y + size.height));\r\n    if (viewBounds.contains(coord)) {\r\n      return  point.subtract(layerPx);\r\n    }\r\n    \r\n    //topRight\r\n    point = new olleh.maps.Point(\r\n        layerPx.x + offset.x + radius.right,\r\n        layerPx.y - size.height - offset.y - radius.top);\r\n    coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x + size.width, point.y));\r\n    if (viewBounds.contains(coord)) {\r\n      return  point.subtract(layerPx);\r\n    }\r\n    \r\n    //topLeft\r\n    point = new olleh.maps.Point(\r\n        layerPx.x - size.width - offset.x - radius.left, \r\n        layerPx.y - size.height - offset.y - radius.top);\r\n    coord = layerMgr.getCoordFromLayerPx(new olleh.maps.Point(\r\n        point.x, point.y));\r\n    return  point.subtract(layerPx);\r\n  },\r\n  \r\n  /**\r\n   * @override\r\n   * @private\r\n   */\r\n  _updateMargin: function () {\r\n    //  margin .\r\n    this._marginPx = {body : this._calTooltipPosition()};\r\n  },\r\n  /**\r\n   * Marker   Marker anchor        .\r\n   * @private\r\n   */\r\n  _calRadiusOfAnchor: function () {\r\n    var radius = {\r\n        top : 0,\r\n        bottom : 0,\r\n        left : 0,\r\n        right : 0\r\n    };\r\n    if (olleh.maps.overlay.Marker && this._anchor instanceof olleh.maps.overlay.Marker) {\r\n      var mIcon = this._anchor.getIcon();\r\n      var size = mIcon.size;\r\n      var point = mIcon.anchor;\r\n      radius.left = point.x;\r\n      radius.right = size.width - point.x;\r\n      radius.top = point.y;\r\n      radius.bottom = size.height - point.y;\r\n    }    \r\n    return radius;\r\n  },\r\n  \r\n  _setPosition: function (position) {\r\n    olleh.maps.overlay.Tooltip.$super.setPosition.apply(this, arguments);\r\n  },\r\n  \r\n  setPosition: function (position) {\r\n    if (this._optsPosition) {\r\n      this._optsPosition = position;\r\n    }\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.position = position;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setPosition.apply(this, arguments);\r\n    }\r\n    \r\n  },\r\n  \r\n  setPixelOffset: function (offset) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.pixelOffset = offset;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setPixelOffset.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  setContent: function (content) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.content = content;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setContent.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  setZIndex: function (zIndex) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.zIndex = zIndex;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super.setZIndex.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  _setMaxWidth: function (width) {\r\n    if (this._isOpenOptions) {\r\n      this._openOptions.maxWidth = width;\r\n    } else {\r\n      olleh.maps.overlay.Tooltip.$super._setMaxWidth.apply(this, arguments);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * Tooltip open.\r\n   * anchor {@link olleh.maps.overlay.Marker}  marker position marker  \r\n   *  Tooltip .       \r\n   * {@link olleh.maps.overlay.TooltipOptions.pixelOffset}   . \r\n   * @param map {olleh.maps.Map} map Overlay  Map  \r\n   * @param anchor {olleh.maps.Coord | olleh.maps.overlay.Overlay} anchor {@link olleh.maps.Coord}  \r\n   * {@link olleh.maps.overlay.Overlay}  (Marker ), getPosition   .\r\n   * @param options {olleh.maps.overlay.TooltipOptions} options open  options,open options    options . \r\n   *  open  options     options  open .\r\n   * <p>\r\n   * ()\r\n   * 1. open options   position, pixelOffset, zIndex, content, maxWidth 5 .\r\n   * 2. options   open setPosition, setPixelOffset, setPixelOffset, setZIndex, setOptions       .\r\n   *  options   open tooltip option  . options   open tooltip     options \r\n   *  open  . \r\n   * </p> \r\n   */\r\n  open: function (map, anchor, options) {\r\n    if (options) {\r\n      //option    .\r\n      if (!this._isOpenOptions) {\r\n        var opts = this._opts;\r\n        var o = {};\r\n        if (opts.position) {\r\n          o.position = this._optsPosition? this._optsPosition:opts.position;\r\n        }\r\n        if (opts.pixelOffset) {\r\n          o.pixelOffset = opts.pixelOffset;\r\n        } else {\r\n          o.pixelOffset = new olleh.maps.Point(0,0);\r\n        }\r\n        if (opts.content) {\r\n          o.content = opts.content;\r\n        }\r\n        if (opts.zIndex) {\r\n          o.zIndex = opts.zIndex;\r\n        } else {\r\n          o.zIndex = 'auto';\r\n        }\r\n        if (opts.maxWidth) {\r\n          o.maxWidth = opts.maxWidth;\r\n        } else {\r\n          o.maxWidth = this.contentSize.maxWidth;\r\n        }\r\n        \r\n        this._openOptions = o;\r\n      }\r\n      this.setOptions(options);\r\n      this._isOpenOptions = true;\r\n    } else if (this._isOpenOptions){\r\n      //option    option  .\r\n      this._isOpenOptions = false;\r\n      this.setOptions(this._openOptions);\r\n    }\r\n    \r\n    if (anchor) {\r\n      //anchor open    opts Position  .\r\n      if (!this._anchor) {\r\n        // anchor   position  .\r\n        this._optsPosition = this._opts.position;\r\n      }\r\n      \r\n      var coord = null;\r\n      if(anchor instanceof olleh.maps.Coord) {\r\n        coord = anchor;\r\n      } else if (anchor instanceof olleh.maps.Point) {\r\n        coord = map.layerMgr.getCoordFromViewportPx(anchor);\r\n      } else if (olleh.maps.overlay.Marker && anchor instanceof olleh.maps.overlay.Marker) {\r\n        coord = anchor.getPosition();\r\n      } else if (anchor instanceof olleh.maps.overlay.Overlay) {\r\n        \r\n        if (anchor.getPosition()) {\r\n          coord = anchor.getPosition();\r\n        } else if (anchor.getBounds()) {\r\n          coord = anchor.getBounds().getCenter();\r\n        } else {\r\n          throw new TypeError(\"anchor parameter must have a position\");\r\n        }\r\n      } else {\r\n        throw new TypeError(\"anchor parameter must have a position\");\r\n      }\r\n      this._anchor = anchor;\r\n      this._setPosition(coord);\r\n    } else if (this._anchor && this.isAdded()){\r\n      // anchor   anchor   open .\r\n      this._anchor = null;\r\n      if (this._optsPosition) {//option   .\r\n        this._setPosition(this._optsPosition);\r\n        this._optsPosition = null;\r\n      } else {\r\n        throw new Error(\"Option's Position value is not exist\");\r\n      }\r\n    } else if (this.isAdded()){\r\n      //option .\r\n      this.setPosition(this._opts.position);\r\n    }\r\n    if (!this.isAdded()) {\r\n      this.setMap(map);\r\n    } \r\n  },\r\n  \r\n  /**\r\n   * DOM Tree Tooltip elements  Tooltip .\r\n   * @fires olleh.maps.overlay.Tooltip#event:close\r\n   */\r\n  close: function () {\r\n    if (this._isOpenOptions) {\r\n      this.setOptions(this._openOptions);\r\n    }\r\n    this._anchor = null;\r\n    this._isOpenOptions = null;\r\n    this._optsPosition = null;\r\n    this._openOptions = null;\r\n    this.setMap(null);\r\n    if (this.isAdded()) {\r\n      this.fireEvent('close');\r\n    }\r\n  }\r\n});/**\n * ProjectedOverlayOptions Object Specification\n * @typedef olleh.maps.overlay.ProjectedOverlayOptions\n * @extends olleh.maps.overlay.BaseOverlayOptions\n * @property {olleh.maps.Bounds} bounds  .\n * @property {Number} [opacity=1] . <code>0</code>  0%, <code>1</code>  100%.\n * @property {Boolean} [fadeIn=false]   . <code>true</code>    .\n * @property {Boolean} [fadeOut=false]   . <code>true</code>    .\n */\n\n\n/**\n *       .\n */\n$class('olleh.maps.overlay.ProjectedOverlay').extend(olleh.maps.overlay.BaseOverlay).define({\n\n  /**\n   * ,  opts    .\n   * @param {olleh.maps.overlay.ProjectedOverlayOptions} opts .\n   */\n  ProjectedOverlay: function (opts) {\n    this._opacity = 1;\n    this._fadeIn = true;\n    this._fadeOut = true;\n  },\n\n  /**\n   *  .\n   * @param {olleh.maps.overlay.ProjectedOverlayOptions} opts .\n   */\n  setOptions: function (opts) {\n    opts.bounds && this.setBounds(opts.bounds);\n    opts.opacity && this.setOpacity(opts.opacity);\n    opts.fadeIn !== undefined && this.setFadeIn(opts.fadeIn);\n    opts.fadeOut !== undefined && this.setFadeOut(opts.fadeOut);\n    olleh.maps.overlay.ProjectedOverlay.$super.setOptions.apply(this, arguments);\n  },\n\n  update: function () {\n    this._updateBounds();\n    this._updateOpacity();\n    olleh.maps.overlay.ProjectedOverlay.$super.update.apply(this, arguments);\n  },\n  \n  /**\n   * @private\n   * @returns {olleh.maps.Bounds}\n   */\n  getIndexObject: function () {\n    return this.getBounds();\n  },\n  \n  /**\n   * @private\n   * @returns {number}\n   */\n  getAutoZIndex: function () {\n    return 0;\n  },\n\n  /**\n   *   .\n   * @returns {olleh.maps.Bounds}  .\n   */\n  getBounds: function () {\n    return this._bounds;\n  },\n\n  /**\n   *   .\n   * @param {olleh.maps.Bounds} bounds  .\n   */\n  setBounds: function (bounds) {\n    var from = this._bounds;\n    this._bounds = bounds;\n    if(this.isDrawn()) {\n      this._updateBounds();\n    }\n    this.fireEvent('bounds_changed', {from: from, to: bounds});\n  },\n\n  /**\n   * @private\n   */\n  _updateBounds: function () {\n    var size, styles;\n    if (!this._bounds) {\n      throw new Error('Bounds is not set.');\n    }\n    this._currentLayerPx = this.getOriginalLayerPx();\n    this._currentScale = 1;\n    size = this.getOriginalSize();\n    styles = olleh.maps.util.dom.getPositionStyles(this._currentLayerPx.x, this._currentLayerPx.y);\n    if (styles.transform) {\n      styles.transform += ' ' + olleh.maps.util.dom.getScaleString(1);\n    }\n    styles.width = size.width + 'px';\n    styles.height = size.height + 'px';\n    this.updatePositioningStyles(styles);\n  },\n\n  /**\n   *  .\n   * @returns {Number} . 0  0%, 1  100%.\n   */\n  getOpacity: function () {\n    return this._opacity;\n  },\n\n  /**\n   *  .\n   * @param {Number} opacity . <code>0</code>  0%, <code>1</code>  100%.\n   */\n  setOpacity: function (opacity) {\n    this._opacity = opacity;\n    this._drawn && this._updateOpacity();\n  },\n\n  /**\n   *    .\n   * @returns {Boolean}     <code>true</code>,    <code>false</code>.\n   */\n  isFadeIn: function () {\n    return this._fadeIn;\n  },\n\n  /**\n   *    .\n   * @param {Boolean} fadeIn   . <code>true</code>    .\n   */\n  setFadeIn: function (fadeIn) {\n    this._fadeIn = fadeIn;\n  },\n\n  /**\n   *    .\n   * @returns {Boolean}     <code>true</code>,    <code>false</code>.\n   */\n  isFadeOut: function () {\n    return this._fadeOut;\n  },\n\n  /**\n   *    .\n   * @param {Boolean} fadeOut   . <code>true</code>    .\n   */\n  setFadeOut: function (fadeOut) {\n    this._fadeOut = fadeOut;\n  },\n\n  /**\n   * @private\n   */\n  _updateOpacity: function () {\n    this.forEachElement(function (paneId, elem) {\n      olleh.maps.util.dom.setStyle(elem, 'opacity', this._opacity);\n    });\n  },\n\n  /**\n   * @param {Number} scale\n   * @param {olleh.maps.Point} origin\n   * @param {Number} duration\n   * @param {olleh.maps.fx.Pulse} [pulse]\n   * @private\n   */\n  zoomStart: function (scale, origin, duration, pulse) {\n    var originalSize, center, newCenter, newPx;\n    var originalLayerPx = this.getOriginalLayerPx();\n\n    if (olleh.maps.browser.style.transform) {\n      originalSize = this.getOriginalSize();\n      center = originalLayerPx.clone()._add(originalSize.width / 2, originalSize.height / 2);\n      newCenter = origin.add(center.subtract(origin).multiplyBy(scale));\n      newPx = newCenter.clone()._subtract(originalSize.width / 2, originalSize.height / 2).round();\n    } else {\n      newPx = origin.add(originalLayerPx.subtract(origin).multiplyBy(scale)).round();\n    }\n    \n    this.moveTo(newPx, scale, duration, pulse);\n  },\n\n  /**\n   * @private\n   */\n  zoomEnd: function () {\n    this.stopAnimators();\n    this._updateBounds();\n  },\n\n  /**\n   *           . \n   *  (bounds)    draw()       . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [scale]  .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   */\n  moveTo: function (px, scale, duration, pulse, callback) {\n    var styles, originalSize;\n    \n    scale || (scale = this._currentScale);\n\n    styles = olleh.maps.util.dom.getPositionStyles(px.x, px.y);\n    if (styles.transform) {\n      styles.transform += ' ' + olleh.maps.util.dom.getScaleString(scale);\n    } else {\n      originalSize = this.getOriginalSize();\n      styles.width = Math.round(originalSize.width * scale) + 'px';\n      styles.height = Math.round(originalSize.height * scale) + 'px';\n    }\n    \n    this.animateTo(styles, duration, pulse, callback);\n\n    this._currentLayerPx = px;\n    this._currentScale = scale;\n  },\n\n  /**\n   *           . \n   *  (bounds)    draw()       . \n   * @param {olleh.maps.Point} px   .\n   * @param {Number} [scale]  .\n   * @param {Number} [duration=0]  ,  . 0      .\n   * @param {olleh.maps.fx.Pulse} [pulse] .     .\n   * @param {Function} [callback]      .\n   */\n  move: function (px, scale, duration, pulse, callback) {\n    this.moveTo(this._currentLayerPx.add(px), this._currentScale, duration, pulse, callback);\n  },\n\n  /**\n   *           .\n   * @returns {olleh.maps.Point}   \n   */\n  getOriginalLayerPx: function () {\n    var layerMgr = this.layer.layerMgr;\n    var leftBottomPx = layerMgr.getLayerPxFromCoord(this._bounds.leftBottom, false);\n    var rightTopPx = layerMgr.getLayerPxFromCoord(this._bounds.rightTop, false);\n    return new olleh.maps.Point(leftBottomPx.x, rightTopPx.y);\n  },\n\n  /**\n   *       .\n   * @returns {olleh.maps.Size}   \n   */\n  getOriginalSize: function () {\n    var layerMgr = this.layer.layerMgr;\n    var leftBottomPx = layerMgr.getLayerPxFromCoord(this._bounds.leftBottom, false);\n    var rightTopPx = layerMgr.getLayerPxFromCoord(this._bounds.rightTop, false);\n    return new olleh.maps.Size(rightTopPx.x - leftBottomPx.x, leftBottomPx.y - rightTopPx.y);\n  },\n\n  /**\n   *    .\n   *   {@link olleh.maps.overlay.ProjectedOverlay#getOriginalLayerPx()}  \n   * {@link olleh.maps.overlay.ProjectedOverlay#moveTo()} \n   * {@link olleh.maps.overlay.ProjectedOverlay#move()}     .\n   * @returns {olleh.maps.Point}   .\n   */\n  getCurrentLayerPx: function () {\n    return this._currentLayerPx;\n  },\n\n  /**\n   *    .   1\n   * {@link olleh.maps.overlay.ProjectedOverlay#moveTo()} \n   * {@link olleh.maps.overlay.ProjectedOverlay#move()}     .\n   * @returns {olleh.maps.Point}   .\n   */\n  getCurrentScale: function () {\n    return this._currentScale;\n  },\n  \n  getFadeInAnimation: function () {\n    return this._fadeIn ? new olleh.maps.fx.Animation({\n      from: {\n        opacity: '0'\n      },\n      to: {\n        opacity: this._opacity\n      },\n      duration: .5,\n      timing: olleh.maps.fx.timing.easeOut\n    }) : null;\n  },\n\n  getFadeOutAnimation: function () {\n    return this._fadeOut ? new olleh.maps.fx.Animation({\n      from: {\n        opacity: this._opacity\n      },\n      to: {\n        opacity: '0'\n      },\n      duration: .5,\n      timing: olleh.maps.fx.timing.easeOut\n    }) : null;\n  }\n\n});\n/**\r\n * GroundOverlayOptions Object Specification\r\n * @typedef olleh.maps.overlay.GroundOverlayOptions \r\n * @property {String} url  URL.\r\n * @extends olleh.maps.overlay.ProjectedOverlayOptions\r\n */\r\n\r\n/**\r\n *      .\r\n */\r\n$class('olleh.maps.overlay.GroundOverlay').extend(olleh.maps.overlay.ProjectedOverlay).define({\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @name GroundOverlay\r\n   * @param {olleh.maps.overlay.GroundOverlayOptions} opts .\r\n   * @constructor\r\n   * @memberof olleh.maps.overlay.GroundOverlay.prototype\r\n   */\r\n\r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.GroundOverlayOptions} opts .\r\n   */\r\n  setOptions: function (opts) {\r\n    opts.url && this.setURL(opts.url);\r\n    opts.title && this.setTitle(opts.title);\r\n    olleh.maps.overlay.GroundOverlay.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  update: function () {\r\n    this._updateURL();\r\n    olleh.maps.overlay.GroundOverlay.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   *  URL .\r\n   * @returns {String}  URL.\r\n   */\r\n  getURL: function () {\r\n    return this._url;\r\n  },\r\n  \r\n  /**\r\n   *  URL .\r\n   * @param {String} url  URL.\r\n   */\r\n  setURL: function (url) {\r\n    this._url = url;\r\n    this._drawn && this._updateURL();\r\n  },\r\n  \r\n  /**\r\n   * GroundOverlay   .\r\n   * @returns {String} title\r\n   */\r\n  getTitle: function () {\r\n    return this._title;\r\n  },\r\n  \r\n  /**\r\n   * GroundOverlay   .\r\n   * @example groundOverlay.setTitle('');\r\n   * @fires olleh.maps.overlay.GroundOverlay#event:title_changed\r\n   * @param {String} title GroundOverlay  \r\n   */\r\n  setTitle: function (title) {\r\n    if(this._title !== title) {\r\n      this._title = title;\r\n      /**\r\n       * title_changed . GroundOverlay    .\r\n       * <p/>\r\n       * @name event:title_changed\r\n       * @event\r\n       * @memberOf olleh.maps.overlay.GroundOverlay.prototype\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n       this.isAdded() && this.fireEvent('title_changed');\r\n    }\r\n  },\r\n  \r\n  $default_mouseover: function (event, payload) {\r\n    if(this._title) {\r\n      var tooltip = this.map.getTooltip();\r\n      if (tooltip) {\r\n        tooltip.setContent(this._title);\r\n        tooltip.setPixelOffset(new olleh.maps.Point(20, 0));\r\n        tooltip.open(this.map, event.getCoord());\r\n        this._tooltip = tooltip;\r\n      }\r\n    }\r\n    var $default_mouseover= olleh.maps.overlay.GroundOverlay.$super.$default_mouseover;\r\n    $default_mouseover && $default_mouseover.apply(this, arguments);\r\n  },\r\n  \r\n  $default_mousemove: function (event, payload) {\r\n    if(this._tooltip) {\r\n      this._tooltip.setPosition(event.getCoord());\r\n    }\r\n    var  $default_mousemove= olleh.maps.overlay.GroundOverlay.$super.$default_mousemove;\r\n    $default_mousemove && $default_mousemove.apply(this, arguments);\r\n  },\r\n\r\n  $default_mouseout: function (event, payload) {\r\n    if(this._tooltip) {\r\n      this._tooltip.setPixelOffset(new olleh.maps.Point(0, 0));\r\n      this._tooltip.close();\r\n      this._tooltip = null;\r\n    }\r\n    var $default_mouseout = olleh.maps.overlay.GroundOverlay.$super.$default_mouseout;\r\n    $default_mouseout && $default_mouseout.apply(this, arguments);\r\n  },\r\n  \r\n  _updateURL: function () {\r\n    var img = this._img;\r\n    if (!this._url) {\r\n      throw new Error('URL is not set.');\r\n    }\r\n\r\n    if (!img) {\r\n      img = this._img = new olleh.maps.SpritedImage();\r\n      this.registerElement('lower_overlay_pane', img.elem);\r\n      this.registerEventDom(img.elem);\r\n    }\r\n    \r\n    img.setImage(this._url, olleh.maps.Point.zero(), olleh.maps.Size.full());\r\n  }\r\n\r\n});/**\r\n * @private\r\n * @typedef olleh.maps.vector.VectorOptions\r\n * @property {Boolean} [editable=false]    .\r\n * @property {Boolean} [visible=true]   .\r\n * @extends olleh.maps.overlay.OverlayOptions\r\n */\r\n\r\n/**\r\n * Vector   base class.  class   class       .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.Vector').extend(olleh.maps.overlay.Overlay).define({\r\n  /**\r\n   * Vector   Renderer \r\n   * @private\r\n   */\r\n  rendererName: null,\r\n  \r\n  /**\r\n   * Vector   {@link olleh.maps.vector.EditHandler}   registry .  plugin  <br>\r\n   * <code>\r\n   *  olleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Polyline'] = example.PolylineEditHandler \r\n   * </code> \r\n   *   EditHandler class   .\r\n   * @private\r\n   */\r\n  editHandlerRegistry: {},\r\n\r\n  /**\r\n   * ,  opts    .\r\n   */\r\n  Vector: function (opts) {\r\n    if (this.$classname === 'olleh.maps.vector.Vector') {\r\n      throw new TypeError('Cannot instantiate olleh.maps.vector.Vector directly.');\r\n    }\r\n    this._drawn = false;\r\n    this._visible = true;\r\n    this._editable = false;\r\n    this._element = null; // olleh.maps.Element\r\n    this._eventDom = null; // DOM Element\r\n    this.layer = null;\r\n    this._renderer = null; // olleh.maps.vector.BaseRenderer\r\n    this._opts = this._getDefaultOptions();\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @returns {Boolean}   <code>true</code>,   \r\n   *          <code>false</code>.\r\n   */\r\n  isVisible: function () {\r\n    return this._visible;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @fires olleh.maps.vector.Vector#event:visible_changed\r\n   * @param {Boolean} visible <code>true</code>  ,    .\r\n   */\r\n  setVisible: function (visible) {\r\n    if (this._visible === visible) {\r\n      return;\r\n    }\r\n    this._visible = visible;\r\n    if(this._drawn) {\r\n      this._updateVisiblity();\r\n    }\r\n    if(this.isAdded() && visible){\r\n      this.draw();\r\n    }\r\n    /**\r\n     *    .\r\n     * @event olleh.maps.vector.Vector#event:visible_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('visible_changed');\r\n  },\r\n\r\n  /**\r\n   * z-index         .\r\n   */\r\n  bringToFront: function () {\r\n    if (!this._isFront) {\r\n      this._isFront = true;\r\n      if (this._drawn) {\r\n        var vector = olleh.maps.browser.vector;\r\n        if (vector === 'VML') {\r\n          this._updateZIndex();\r\n        } else if (vector === 'SVG') {\r\n          var elem = this._element.elem;\r\n          elem.parentNode && elem.parentNode.appendChild(elem);\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  _updateVisiblity: function () {\r\n    olleh.maps.util.dom.setStyle(this._element.elem, 'display', this._visible ? 'block' : 'none');\r\n  },\r\n\r\n  _updateZIndex: function () {\r\n    var zIndex = this._isFront ? olleh.maps.overlay.BaseOverlay.MAX_ZINDEX : this._zIndex;\r\n    if (olleh.maps.isNumber(zIndex)) {\r\n      olleh.maps.util.dom.setStyle(this._element.elem, 'zIndex', zIndex);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link #bringToFront}  z-index   .\r\n   */\r\n  resetZIndex: function () {\r\n    if (this._isFront) {\r\n      this._isFront = false;\r\n      if (this._drawn && olleh.maps.browser.vector === 'VML') {\r\n        this._updateZIndex();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Vector  layer    .\r\n   * @private\r\n   */\r\n  onAdd: function (layer) {\r\n    this.isVisible() && this.draw();\r\n  },\r\n\r\n  /**\r\n   * Vector   Renderer  . rendererName   renderer  {@link olleh.maps.vector.RendererFactory}\r\n   *   .\r\n   * @private\r\n   * @returns {olleh.maps.vector.BaseRenderer}\r\n   */\r\n  createRenderer: function () {\r\n    return this.layer.getRendererFactory()['create' + this.rendererName](this._opts);\r\n  },\r\n\r\n  /**\r\n   * Vector  . Vector      .\r\n   */\r\n  draw: function () {\r\n    if(!this.isAdded())\r\n      return;\r\n    if(!this._renderer)\r\n      this._renderer = this.createRenderer();\r\n    if(!this._renderer)\r\n      return;\r\n    this._drawn = true;\r\n    this._doDraw();\r\n    if (!this._element) {\r\n      this._element = this._renderer.getRootElement();\r\n      var elem = this._element.elem;\r\n      this.layer.getContainer().appendChild(elem);\r\n      var eventDom = this._eventDom = this._renderer.getEventDom();\r\n      this.registerEventDom(eventDom);\r\n    }\r\n    this.registerEvent();\r\n    if(this._editable) {\r\n      this._attachEditHandler(); \r\n    }\r\n  },\r\n  \r\n  /**\r\n   * Vector  VectorLayer    VectorLayer  .\r\n   * @private\r\n   */\r\n  onRemove: function() {\r\n    this.erase();\r\n  },\r\n\r\n  /**\r\n   * draw()    . Vector       .\r\n   */\r\n  erase: function () {\r\n    olleh.maps.vector.Vector.$super.erase.apply(this, arguments);\r\n    if (this._element) {\r\n      this.unregisterEvent();\r\n      this.layer.getContainer().removeChild(this._element.elem);\r\n      this._element = null;\r\n      this._eventDom = null;\r\n      this._drawn = false;\r\n      if(this._editable) {\r\n        this._detachEditHandler();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @returns {Boolean}    <code>true</code>,   \r\n   *          <code>false</code>\r\n   * @private\r\n   */\r\n  isDrawn: function () {\r\n    return this._drawn;\r\n  },\r\n\r\n  /**\r\n   * Vector      renderer       . subclass\r\n   * should override this\r\n   * @private\r\n   * @returns {Element}\r\n   */\r\n  _doDraw: function () {\r\n  },\r\n\r\n  attach: function () {\r\n    var layer = this.map.getLayer('Vector');\r\n    if (layer)\r\n      layer.add(this);\r\n    else\r\n      throw new Error('VectorLayer does not exists.');\r\n  },\r\n\r\n  detach: function () {\r\n    this.layer && this.layer.remove(this);\r\n  },\r\n\r\n  /**\r\n   *  option   . subclass should override this\r\n   * @private\r\n   * @returns {Object}\r\n   */\r\n  _getDefaultOptions: function () {\r\n    return {};\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {Object} options\r\n   */\r\n  setOptions: function (options) {\r\n    olleh.maps.mixin(this._opts, options, true);\r\n    if (this.isAdded() && this._renderer) {\r\n      this._renderer.setOptions(this._opts);\r\n      this.isVisible() && this._doDraw();\r\n    }\r\n    options.editable !== undefined && this.setEditable(options.editable);\r\n    olleh.maps.vector.Vector.$super.setOptions.apply(this, arguments);\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @returns {olleh.maps.Coord} \r\n   */\r\n  getCenter: function() {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *  bounds  .\r\n   * @returns {olleh.maps.Bounds} bounds\r\n   */\r\n  getBounds: function() {\r\n    \r\n  },\r\n\r\n  /**\r\n   *   / .\r\n   * @param {Boolean} editable true      .\r\n   */\r\n  setEditable: function(editable) {\r\n    if(this._editable !== editable) {\r\n      this._editable = editable;\r\n      if(!editable) {\r\n        this._detachEditHandler();\r\n      } else {\r\n        if(this._drawn) {\r\n          this._attachEditHandler();\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *     .\r\n   * @returns {Boolean} true     .\r\n   */\r\n  isEditable: function() {\r\n    return this._editable;\r\n  },\r\n  \r\n  _attachEditHandler: function() {\r\n    if(this._editHandler) {\r\n      this._editHandler.refresh();\r\n    } else {\r\n      var editHandlerClass = olleh.maps.vector.Vector.prototype.editHandlerRegistry[this.$classname];\r\n      if(editHandlerClass) {\r\n        var editHandler = new editHandlerClass(this);\r\n        editHandler.activate();\r\n        this._editHandler = editHandler;\r\n      }\r\n    }\r\n  },\r\n  \r\n  _detachEditHandler: function() {\r\n    this._editHandler && this._editHandler.deactivate();\r\n    this._editHandler = null;\r\n  }\r\n\r\n});\r\n/**\r\n * geometry  {@link olleh.maps.Path}   Polyline, Polygon   base class\r\n * @private\r\n */\r\n$class('olleh.maps.vector.Path').extend(olleh.maps.vector.Vector).define({\r\n\r\n  /**\r\n   * Path  Layer Pixel Array  .\r\n   * @param {olleh.maps.Path} path\r\n   * @returns {Array.<olleh.maps.Point>}\r\n   * @private\r\n   */\r\n  _convertPathToPoints: function (path) {\r\n    var points = [];\r\n    var lm = this.layer.layerMgr;\r\n    for ( var i = 0, len = path.getLength(); i < len; i++) {\r\n      var coord = path.getAt(i);\r\n      var layerPx = lm.getLayerPxFromCoord(coord);\r\n      points.push(layerPx);\r\n    }\r\n    return points;\r\n  }\r\n\r\n});/**\r\n * {@link olleh.maps.vector.Polygon} \r\n * @typedef olleh.maps.vector.PolygonOptions\r\n * @property {olleh.maps.Path|Array.<olleh.maps.Path>} paths Polygon   Path   \r\n * @property {String} [fillColor='transpraent'] Polygon   , CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Polygon  , 0.0  1.0    \r\n *        .\r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokeStyle]   .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\n * @property {Boolean} [visible=true]   .\r\n * @extends olleh.maps.vector.VectorOptions\n */\r\n\r\n/**\r\n * Polygon    vector class. {@link olleh.maps.Path}   {@link olleh.maps.Path}   geometry  .\r\n * \r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Polygon#event:paths_changed|paths_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>\r\n */\r\n$class('olleh.maps.vector.Polygon').extend(olleh.maps.vector.Path).define({\r\n  rendererName: 'PolygonRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.PolygonOptions} opts Polygon  \r\n   */\r\n  Polygon: function (opts) {\r\n  },\r\n  \r\n  init: function() {\r\n    olleh.maps.vector.Polygon.$super.init.call(this);\r\n    var paths = this.getPaths();\r\n    for(var i=0; i<paths.length; i++) {\r\n      paths[i].onChange(this.draw, this);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Polygon#setOptions\r\n   * @param {olleh.maps.vector.PolygonOptions} options Polygon \r\n   */\r\n\r\n  /**\r\n   * Polygon   path    .\r\n   * @param {olleh.maps.Path | Array} paths\r\n   */\r\n  setPaths: function (paths) {\r\n    var existingPaths = this.getPaths();\r\n    for(var i=0; i<existingPaths.length; i++) {\r\n      existingPaths[i].unsubscribeChange(this.draw, this);\r\n    }\r\n    this.erase();\r\n    paths = paths || [];\r\n    if (!olleh.maps.isArray(paths))\r\n      paths = [ paths ];\r\n    this._opts.paths = paths;\r\n    if (paths.length > 0) {\r\n      for(var i=0; i<paths.length; i++) {\r\n        paths[i].onChange(this.draw, this);\r\n      }\r\n      this.draw();\r\n    }\r\n    /**\r\n     * paths  . \r\n     *    path  coord     \r\n     * {@link olleh.maps.Path#onChange(callbackFn,ctx)}  .    \r\n     * @event olleh.maps.vector.Polygon#event:paths_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('paths_changed');\r\n  },\r\n\r\n  _doDraw: function () {\r\n    var paths = this.getPaths();\r\n    var pointsArray = [];\r\n    for(var i=0; i<paths.length; i++) {\r\n      var points = this._convertPathToPoints(paths[i]);\r\n      pointsArray.push(points);\r\n      this._renderer.draw(pointsArray);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Path  .\r\n   * @returns {Array.<olleh.maps.Path>} Polygon   Path . \r\n   *  Path     empty array\r\n   */\r\n  getPaths: function () {\r\n    if(olleh.maps.isArray(this._opts.paths))\r\n      return this._opts.paths;\r\n    return this._opts.paths ? [this._opts.paths] : [];\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      fillColor: 'transparent',\r\n      fillOpacity: 1.0,\r\n      fillRule: 'evenodd',\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n\r\n  getCenter: function() {\r\n    return this.getBounds().getCenter();\r\n  },\r\n  \r\n  getBounds: function() {\r\n    return this.getPaths()[0].getBounds();\r\n  }\r\n\r\n});\r\n/**\r\n * {@link olleh.maps.vector.Polyline} \r\n * @typedef olleh.maps.vector.PolylineOptions\r\n * @property {olleh.maps.Path} path Polyline   Path \r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokeStyle]   .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @extends olleh.maps.vector.VectorOptions\r\n */\r\n\r\n/**\r\n * Polyline    Vector class. {@link olleh.maps.Path}  geometry  .\r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Polyline#event:path_changed|path_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>\r\n */\r\n$class('olleh.maps.vector.Polyline').extend(olleh.maps.vector.Path).define({\r\n  rendererName: 'PolylineRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.PolylineOptions} opts Polyline  \r\n   */\r\n  Polyline: function (opts) {\r\n  },\r\n  \r\n  init: function() {\r\n    olleh.maps.vector.Polyline.$super.init.call(this);\r\n    if(this._opts.path) {\r\n      this._opts.path.onChange(this.draw, this);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Polyline#setOptions\r\n   * @param {olleh.maps.vector.PolylineOptions} options Polyline \r\n   */\r\n\r\n  _doDraw: function () {\r\n    if (this._opts.path) {\r\n      var points = this._convertPathToPoints(this._opts.path);\r\n      this._renderer.draw(points);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Path  .\r\n   * @param {olleh.maps.Path} path\r\n   */\r\n  setPath: function (path) {\r\n    if (this._opts.path) {\r\n      this._opts.path.unsubscribeChange(this.draw, this);\r\n    }\r\n    this._opts.path = path;\r\n    if (path) {\r\n      path.onChange(this.draw, this);\r\n      this.draw();\r\n    } else {\r\n      this.erase();\r\n    }\r\n    /**\r\n     * path  . \r\n     *    path  coord     \r\n     * {@link olleh.maps.Path#onChange(callbackFn,ctx)}  .    \r\n     * @event olleh.maps.vector.Polyline#event:path_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('path_changed');\r\n  },\r\n\r\n  /**\r\n   * Path  .\r\n   * @returns {olleh.maps.Path} Path \r\n   */\r\n  getPath: function () {\r\n    return this._opts.path;\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      icons: [],\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n  \r\n  getCenter: function() {\r\n    return this.getBounds().getCenter();\r\n  },\r\n  \r\n  getBounds: function() {\r\n    return this.getPath().getBounds();\r\n  }\r\n\r\n});\r\n/**\r\n * {@link olleh.maps.vector.Rectangle} \r\n * @typedef olleh.maps.vector.RectangleOptions\r\n * @property {olleh.maps.Bounds} bounds   Bounds\r\n * @property {String} [fillColor='transpraent'] Rectangle   . CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Rectangle   . 0.0  1.0     .\r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokePosition=center]  . center, inside, outside \r\n *            .\r\n * @property {String} [strokeStyle]   . \r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @extends olleh.maps.vector.VectorOptions\r\n */\r\n\r\n/**\r\n *    vector class. {@link olleh.maps.Bounds}  geometry  .\r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Rectangle#event:bounds_changed|bounds_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>\r\n */\r\n$class('olleh.maps.vector.Rectangle').extend(olleh.maps.vector.Vector).define({\r\n  rendererName: 'RectangleRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.RectangleOptions} opts Rectangle  \r\n   */\r\n  Rectangle: function (opts) {\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Rectangle#setOptions\r\n   * @param {olleh.maps.vector.RectangleOptions} options Rectangle \r\n   */\r\n\r\n  _doDraw: function () {\r\n    var lm = this.layer.layerMgr;\r\n    var resolution = lm.getResolution();\r\n    var bounds = this._opts.bounds;\r\n    var leftTopPx = lm.getLayerPxFromCoord(bounds.getLeftTopCoord());\r\n    var widthPx = bounds.getWidth() / resolution;\r\n    var heightPx = bounds.getHeight() / resolution;\r\n    this._renderer.draw(leftTopPx, widthPx, heightPx);\r\n  },\r\n\r\n  /**\r\n   * bounds  .\r\n   * @param {olleh.maps.Bounds} bounds Rectangle    .\r\n   */\r\n  setBounds: function (bounds) {\r\n    this._opts.bounds = bounds;\r\n    this.draw();\r\n    /**\r\n     * bounds  . \r\n     * @event olleh.maps.vector.Rectangle#event:bounds_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('bounds_changed');\r\n  },\r\n\r\n  /**\r\n   *  bounds  .\r\n   * @returns {olleh.maps.Bounds}\r\n   */\r\n  getBounds: function () {\r\n    return this._opts.bounds;\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      fillColor: 'transparent',\r\n      fillOpacity: 1.0,\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokePosition: 'center', // center, insdie, outside\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n  \r\n  getCenter: function() {\r\n    var bounds = this.getBounds();\r\n    var center = bounds.getCenter();\r\n    return center.transform(bounds.getType());\r\n  }\r\n  \r\n});\r\n/**\r\n * {@link olleh.maps.vector.Circle} \r\n * @typedef olleh.maps.vector.CircleOptions\r\n * @property {olleh.maps.Coord} center Circle \r\n * @property {Number} radius Circle \r\n * @property {String} [fillColor='transpraent'] Circle   . CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Circle   . 0.0  1.0   \r\n *         .\r\n * @property {String} [strokeColor='black']  . CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  . 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokePosition=center]  . center, inside, outside \r\n *            .\r\n * @property {String} [strokeStyle]   .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @property {Boolean} [visible=true]   .\r\n * @extends olleh.maps.vector.VectorOptions\r\n */\r\n\r\n/**\r\n *   vector class. (center)  (radius) .\r\n * \r\n * <p/>\r\n * <h5> </h5>\r\n * <ul>\r\n * <li>{@link olleh.maps.vector.Vector#event:visible_changed|visible_changed}</li>\r\n * <li>{@link olleh.maps.vector.Circle#event:center_changed|center_changed}</li>\r\n * <li>{@link olleh.maps.vector.Circle#event:radius_changed|radius_changed}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:click|click}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:rightclick|rightclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dblclick|dblclick}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mousedown|mousedown}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseover|mouseover}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseout|mouseout}</li>\r\n * <li>{@link olleh.maps.event.EventDelegator#event:mouseup|mouseup}</li>\r\n * </ul>\r\n * <p/>  \r\n */\r\n$class('olleh.maps.vector.Circle').extend(olleh.maps.vector.Vector).define({\r\n  rendererName: 'CircleRenderer',\r\n\r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.vector.CircleOptions} opts Circle \r\n   * \r\n   */\r\n  Circle: function (opts) {\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @method olleh.maps.vector.Circle#setOptions\r\n   * @param {olleh.maps.vector.CircleOptions} options Circle \r\n   */\r\n\r\n  /**\r\n   *   .\r\n   * @returns {olleh.maps.Coord}\r\n   */\r\n  getCenter: function () {\r\n    return this._opts.center;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @returns {Number}\r\n   */\r\n  getRadius: function () {\r\n    return this._opts.radius;\r\n  },\r\n\r\n  _doDraw: function () {\r\n    var centerPx = this.layer.layerMgr.getLayerPxFromCoord(this._opts.center);\r\n    var resolution = this.layer.layerMgr.getResolution();\r\n    var radiusPx = this._opts.radius / resolution;\r\n    this._renderer.draw(centerPx, radiusPx);\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @param {olleh.maps.Coord} center\r\n   * @param {Number} radius\r\n   */\r\n  setCenterAndRadius: function (center, radius) {\r\n    this._opts.center = center;\r\n    this._opts.radius = radius;\r\n    this.draw();\r\n    this.fireEvent('center_changed');\r\n    this.fireEvent('radius_changed');\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.Coord} center\r\n   */\r\n  setCenter: function(center) {\r\n    this._opts.center = center;\r\n    this.draw();\r\n    /**\r\n     * center  . \r\n     * @event olleh.maps.vector.Circle#event:center_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('center_changed');\r\n  },\r\n  \r\n  /**\r\n   *   .\r\n   * @param {Number} radius\r\n   */\r\n  setRadius: function(radius) {\r\n    this._opts.radius = radius;\r\n    this.draw();\r\n    /**\r\n     * radius  . \r\n     * @event olleh.maps.vector.Circle#event:radius_changed\r\n     * @param {olleh.maps.event.Event} event\r\n     */\r\n    this.fireEvent('radius_changed');\r\n  },\r\n\r\n  _getDefaultOptions: function () {\r\n    return {\r\n      fillColor: 'transparent',\r\n      fillOpacity: 1.0,\r\n      strokeColor: 'black',\r\n      strokeOpacity: 1.0,\r\n      strokePosition: 'center', // center, insdie, outside\r\n      strokeWeight: 5,\r\n      visible: true\r\n    };\r\n  },\r\n  \r\n  getBounds: function() {\r\n    var r = this.getRadius();\r\n    var center = this.getCenter();\r\n    var center_ =  center.asDefault();\r\n    var leftBottom = center_.clone();\r\n    leftBottom.x -= r;\r\n    leftBottom.y -= r;\r\n    var rightTop = center_.clone();\r\n    rightTop.x += r;\r\n    rightTop.y += r;\r\n    var bounds = new olleh.maps.Bounds(leftBottom, rightTop);\r\n    return bounds.transform(center.getClass());\r\n  }\r\n  \r\n});\r\n/**\r\n * vector({@link olleh.maps.vector.Vector})     .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.BaseRenderer').define({\r\n\r\n  /**\r\n   *  DOM  {@link olleh.maps.Element} .\r\n   * @returns {olleh.maps.Element}\r\n   */\r\n  getRootElement: function () { return null; },\r\n  \r\n  /**\r\n   * hit test  DOM Element .\r\n   * @returns {HTMLElement}\r\n   */\r\n  getEventDom: function () { return null; },\r\n\r\n  /**\r\n   *  .\r\n   * @param {Object} opts \r\n   */\r\n  setOptions: function (opts) {},\r\n\r\n  /**\r\n   * Vector   .\r\n   * @returns {Boolean}\r\n   */\r\n  isDrawn: function () {},\r\n  \r\n  /**\r\n   * Vector     .\r\n   */\r\n  prepareToDraw: function () {}\r\n});/**\n * vector {@link olleh.maps.vector.Vector}   container element   \n * .   svg   (path, circle )  svg element   . \n * @private\n */\n$class('olleh.maps.vector.ContainerRenderer').define({\n  \n  /**\n   * ContainerRenderer \n   * @param {Object} opts \n   * @param {VectorLayer} opts.layer VectorLayer \n   * @returns {olleh.maps.vector.ContainerRenderer}\n   */\n  ContainerRenderer: function(opts) {\n    /**\n     * Layer . ContainerRenderer    .\n     */\n    opts && (this.layer = opts.layer);\n  },\n  \n  /**\n   * Container element  .\n   * <p/>\n   *    API override .\n   * @returns {HTMLElement}\n   */\n  createContainer: function () {},\n  \n  /**\n   * Container element    . VectorLayer  draw  layer offset    . \n   */\n  setBounds: function() {}\n  \n});/**\r\n * {@link olleh.maps.vector.PathRenderer} \r\n * @private\r\n * @typedef olleh.maps.vector.PathRendererOptions\r\n * @property {String} [fillColor='transpraent'] Polygon   , CSS    .\r\n *        'transparent'     .\r\n * @property {Number} [fillOpacity=1.0] Polygon  , 0.0  1.0    \r\n *        .\r\n * @property {String} [strokeColor='black']  , CSS    .\r\n * @property {Number} [strokeOpacity=1.0]  , 0.0  1.0     .\r\n * @property {Number} [strokeWeight=5]    .\r\n * @property {String} [strokeLinecap='round']    . 'butt', 'round', 'square'    .\r\n * @property {String} [strokeLinejoin='round']     . 'miter', 'round', 'bevel'    .\r\n * @property {String} [strokeStyle]    .\r\n * 'solid', 'shortdashdotdot','shortdash','shortdot','shortdashdot','dot','dash',\r\n * 'longdash','dashdot','longdashdot','longdashdotdot'    .\r\n */\r\n\r\n/**\r\n * VML shape  SVG path     vector     renderer\r\n * @private  \r\n */\r\n$class('olleh.maps.vector.PathRenderer').define({\r\n  /**\r\n   * \r\n   * @param {olleh.maps.vector.PathRendererOptions} opts\r\n   */\r\n  PathRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   * {@link #lineTo}     .\r\n   * @param {Number} x  x \r\n   * @param {Number} y  y \r\n   */\r\n  moveTo: function(x, y) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *    .\r\n   * @param {Number} x x \r\n   * @param {Number} y y \r\n   */\r\n  lineTo: function(px) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {Number} cx   x\r\n   * @param {Number} cy   y\r\n   * @param {Number} r  \r\n   */\r\n  circle: function(cx, cy, r) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *    polyline  .\r\n   * @param {array.<olleh.maps.Point>} points\r\n   */\r\n  path: function(points) {\r\n    \r\n  },\r\n  \r\n  /**\r\n   * {@link #path}    polyline    .\r\n   */\r\n  closePath: function() {\r\n    \r\n  },\r\n  \r\n  /**\r\n   *   svg element ( vml element)  .\r\n   */\r\n  commit: function() {\r\n    \r\n  }\r\n\r\n});\n/**\r\n * vector {@link olleh.maps.vector.Polyline}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.PolylineRenderer').define({\r\n  \r\n  /**\r\n   * vector {@link olleh.maps.vector.Polyline}    .\r\n   * <p/>\r\n   *   . {@link olleh.maps.vector.RendererFactory} \r\n   *    SVG, Canvas, VML Renderer .\r\n   * @param {olleh.maps.vector.PolylineOptions} opts\r\n   */\r\n  PolylineRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *     polyline .\r\n   * <p/>\r\n   *    API override .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   */\r\n  draw: function (points) {\r\n  }\r\n});/**\r\n * vector {@link olleh.maps.vector.Rectangle}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.RectangleRenderer').define({\r\n  /**\r\n   * vector {@link olleh.maps.vector.Rectangle}    .\r\n   * <p/>\r\n   *   . {@link olleh.maps.vector.RendererFactory} \r\n   *    SVG, Canvas, VML Renderer .\r\n   * @param {olleh.maps.vector.RectangleOptions} opts\r\n   */\r\n  RectangleRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *      .\r\n   * <p/>\r\n   *    API override .\r\n   * @param {olleh.maps.Point} leftTop  \r\n   * @param {Number} width \r\n   * @param {Number} height \r\n   */\r\n  draw: function (leftTop, width, height) {\r\n  }\r\n});/**\r\n * vector {@link olleh.maps.vector.Circle}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.CircleRenderer').define({\r\n  \r\n  /**\r\n   * vector {@link olleh.maps.vector.Circle}    .\r\n   * <p/>\r\n   *   . {@link olleh.maps.vector.RendererFactory} \r\n   *    SVG, Canvas, VML Renderer .\r\n   * @param {olleh.maps.vector.CircleOptions} opts\r\n   */\r\n  CircleRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *     . \r\n   * <p/>\r\n   *    API override .\r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   */\r\n  draw: function (center, radius) {}\r\n});/**\r\n * vector {@link olleh.maps.vector.Polygon}   {@link #draw} API .\r\n * @private\r\n */\r\n$class('olleh.maps.vector.PolygonRenderer').define({\r\n  \r\n  /**\r\n   * vector {@link olleh.maps.vector.Polygon}    .\r\n   * @param {olleh.maps.vector.PolygonOptions} opts\r\n   */\r\n  PolygonRenderer: function (opts) {\r\n    this.opts = opts;\r\n  },\r\n  \r\n  /**\r\n   *     polygon .\r\n   * @param {Array.<Array.<olleh.maps.Point>>} pointsArray Polygon    2 \r\n   *          polygon      polygon  hole  . \r\n   */\r\n  draw: function (pointsArray) {\r\n    \r\n  }\r\n\r\n});/**\r\n * SVG vector({@link olleh.maps.vector.Vector})  .\r\n * @private\r\n */\r\nolleh.maps.browser.hasSVG &&\r\n$class('olleh.maps.vector.svg.Renderer').extend(olleh.maps.vector.BaseRenderer).define({\r\n  \r\n  $static: { \r\n    /**\r\n     *   SVG Element  .\r\n     * @param {String} name \r\n     * @returns {SVGElement}\r\n     */\r\n    createElement: function (name) {\r\n      var elem = document.createElementNS('http://www.w3.org/2000/svg', name);\r\n      olleh.maps.util.dom.setStyle(elem, 'userSelect', 'none');\r\n      elem.setAttribute('fill', 'none');\r\n      if (olleh.maps.browser.browserName === olleh.maps.browser.BROWSER_NAME.ie) {\r\n        // ie9  class   .\r\n        olleh.maps.util.dom.setStyle(elem, 'pointer-events', 'visiblePainted');\r\n      }\r\n      return elem;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'path',\r\n  \r\n  /**\r\n   * hit test  DOM Element .\r\n   * @returns {SVGElement}\r\n   * @see olleh.maps.vector.BaseRenderer#getEventDom\r\n   */\r\n  getEventDom: function () {\r\n    return this.elem;\r\n  },\r\n  \r\n  /**\r\n   * Vector     .\r\n   * @see olleh.maps.vector.BaseRenderer#prepareToDraw\r\n   */\r\n  prepareToDraw: function () {\r\n    this.getRootElement();\r\n    this._drawn = true;\r\n    this.setOptions();\r\n  },\r\n  \r\n  /**\r\n   * Vector   .\r\n   * @returns {Boolean}\r\n   * @see olleh.maps.vector.BaseRenderer#isDrawn\r\n   */\r\n  isDrawn: function () {\r\n    return !!this._drawn;\r\n  },\r\n  \r\n  /**\r\n   *  DOM  {@link olleh.maps.Element} .\r\n   * @returns {olleh.maps.Element}\r\n   * @see olleh.maps.vector.BaseRenderer#getRootElement\r\n   */\r\n  getRootElement: function () {\r\n    if (!this.rootElem) {\r\n      var rootElem = olleh.maps.vector.svg.Renderer.createElement(this.tag);\r\n      this.rootElem = new olleh.maps.Element(rootElem); \r\n      this.elem = rootElem;\r\n    }\r\n    return this.rootElem;\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {Object} opts \r\n   * @see olleh.maps.vector.BaseRenderer#setOptions\r\n   */\r\n  setOptions: function (opts) {\r\n    this.opts = olleh.maps.mixin(this.opts, opts, true);\r\n    \r\n    if (!this.isDrawn())return;\r\n    \r\n    var opts = this.opts;\r\n    var weight = opts.strokeWeight;\r\n    var elem = this.elem;\r\n    \r\n    opts.strokeColor ? elem.setAttribute('stroke', opts.strokeColor) : \r\n      elem.removeAttribute('stroke');\r\n    opts.strokeOpacity ? elem.setAttribute('stroke-opacity', opts.strokeOpacity) : \r\n      elem.removeAttribute('stroke-opacity');\r\n    opts.fillColor ? elem.setAttribute('fill', opts.fillColor) : \r\n      elem.setAttribute('fill', 'none');\r\n    opts.fillOpacity ? elem.setAttribute('fill-opacity', opts.fillOpacity) : \r\n      elem.removeAttribute('fill-opacity');\r\n\r\n    elem.setAttribute('stroke-linecap',opts.strokeLinecap || 'round');  // butt | round | square\r\n    elem.setAttribute('stroke-linejoin',opts.strokeLinejoin || 'round'); // miter | round | bevel\r\n    \r\n    opts.fillRule? elem.setAttribute('fill-rule',opts.fillRule) :\r\n      elem.removeAttribute('fill-rule') ;\r\n\r\n    if(opts.strokeStyle) {\r\n      var strokeDasharray;\r\n      if(olleh.maps.isArray(opts.strokeStyle))\r\n        strokeDasharray = opts.strokeStyle.join(' ');\r\n      else\r\n        strokeDasharray = this._strokeDashArray(opts.strokeStyle, weight);\r\n      elem.setAttribute('stroke-dasharray', strokeDasharray);\r\n    } else {\r\n      elem.removeAttribute('stroke-dasharray');\r\n    }\r\n    elem.setAttribute('stroke-width', weight || 0);\r\n  },\r\n  \r\n  // VML  strokeStyle  SVG    \r\n  _strokeDashArray: function(strokeStyle, weight) {\r\n    if(!weight)\r\n      weight = 1;\r\n    strokeStyle = strokeStyle.toLowerCase();\r\n    if(strokeStyle == 'solid') {\r\n      return '0';\r\n    } else if(strokeStyle == 'dot') {\r\n      return weight+ ',' +weight*3;\r\n    } else if(strokeStyle == 'dash') {\r\n      return weight*4+','+weight*3;\r\n    } else if(strokeStyle == 'shortdot') {\r\n      return weight+','+weight;\r\n    } else if(strokeStyle == 'shortdash') {\r\n      return weight*3+','+weight;\r\n    } else if(strokeStyle == 'longdash') {\r\n      return weight*8+','+weight*3;\r\n    } else if(strokeStyle == 'dashdot') {\r\n      return weight*4+','+weight*3+','+weight+','+weight*3;\r\n    } else if(strokeStyle == 'shortdashdot') {\r\n      return weight*3+','+weight+','+weight+','+weight;\r\n    } else if(strokeStyle == 'longdashdot') {\r\n      return weight*8+','+weight*3+','+weight+','+weight*3;\r\n    } else if(strokeStyle == 'shortdashdotdot') {\r\n      return weight*3+','+weight+','+weight+','+weight+','+weight+','+weight;\r\n    } else if(strokeStyle == 'longdashdotdot') {\r\n      return weight*8+','+weight*3+','+weight+','+weight*3+','+weight+','+weight*3;\r\n    }\r\n    return strokeStyle;\r\n  }\r\n  \r\n});/**\r\n * SVG    {@link olleh.maps.vector.PathRenderer}   \r\n * @private\r\n */\r\nolleh.maps.vector.svg &&\r\n$class('olleh.maps.vector.svg.PathRenderer').extend(olleh.maps.vector.PathRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n  \r\n  moveTo: function(x, y) {\r\n    this._initCommand();\r\n    this._command += 'M ' + x + ' ' + y;\r\n  },\r\n  \r\n  lineTo: function(x, y) {\r\n    this._initCommand();\r\n    this._command += 'L ' + x + ' ' + y;\r\n  },\r\n  \r\n  circle: function(cx, cy, r) {\r\n    this._initCommand();\r\n    this._command +='M '+cx+' '+cy+' '\r\n                  + 'm -'+r+',0 '\r\n                  + 'a ' +r+','+r+' 0 1,0 ' + r*2 +',0 '\r\n                  + 'a ' +r+','+r+' 0 1,0 -'+ r*2 +',0';\r\n  },\r\n  \r\n  path: function(points) {\r\n    this._initCommand();\r\n    for(var i=0;i<points.length;i++) {\r\n      var p = points[i];\r\n      if(i==0) {\r\n        this.moveTo(p.x, p.y);\r\n      } else {\r\n        this.lineTo(p.x, p.y);\r\n      }\r\n    }\r\n  },\r\n  \r\n  closePath: function() {\r\n    this._initCommand();\r\n    this._command += 'Z';\r\n  },\r\n  \r\n  _initCommand: function() {\r\n    if(!this._command)\r\n      this._command = '';\r\n    else\r\n      this._command += ' ';\r\n  },\r\n  \r\n  commit: function() {\r\n    this.elem.setAttribute('d',this._command);\r\n    this._command = null;\r\n  }\r\n\r\n});/**\n * SVG container  .\n * @private\n */\nolleh.maps.vector.svg &&\n$class('olleh.maps.vector.svg.ContainerRenderer').extend(olleh.maps.vector.ContainerRenderer).define({\n\n  buffer: 1,\n  \n  /**\n   * SVG  .        .\n   * @returns {SVGElement}\n   */\n  createContainer: function () {\n    if (!this._svgElem) {\n      var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      this._svgElem = svg;\n      svg.style.position = 'absolute';\n      olleh.maps.util.dom.setStyle(svg, 'userSelect', 'none');\n      if (olleh.maps.browser.browserName === olleh.maps.browser.BROWSER_NAME.ie) {\n        // ie9  class   .\n        olleh.maps.util.dom.setStyle(svg, 'pointer-events', 'none');\n      }\n      olleh.maps.util.dom.addClass(svg, 'ollehmap-noevent');\n    }\n    return this._svgElem;\n  },\n  \n  \n  /**\n   * SVG ,  .\n   */ \n  setBounds: function() {\n    var svg = this.createContainer();\n    var layerMgr = this.layer.layerMgr;\n    var viewportSize = layerMgr.getViewportSize();\n    var layerOffset = layerMgr.getLayerOffset().multiplyBy(-1);\n    //  viewport  buffer       return  .\n    var bounds;\n    if(this._bounds) {\n      bounds = this._bounds;\n      if(bounds.left <= layerOffset.x && layerOffset.x <= bounds.right &&\n         bounds.top <= layerOffset.y && layerOffset.y <= bounds.bottom) {\n        return;\n      }\n    }\n    bounds = {\n      left: layerOffset.x - viewportSize.width * this.buffer,\n      right: layerOffset.x + viewportSize.width * this.buffer,\n      top: layerOffset.y - viewportSize.height * this.buffer,\n      bottom: layerOffset.y + viewportSize.height * this.buffer\n    };\n    this._bounds = bounds;\n    svg.setAttribute('viewBox', bounds.left + ' ' + bounds.top + ' ' + viewportSize.width * (1 + 2 * this.buffer) + ' ' + viewportSize.height * (1 + 2 * this.buffer));\n    var use3d = olleh.maps.browser.osName !== olleh.maps.browser.OS_NAME.ios; // iOS  translate3d        \n    var styles = olleh.maps.util.dom.getPositionStyles(bounds.left, bounds.top, use3d); // buffer    \n    styles.width = viewportSize.width * (1 + 2 * this.buffer) + 'px'; \n    styles.height = viewportSize.height * (1 + 2 * this.buffer) + 'px'; \n    olleh.maps.util.dom.setStyles(svg, styles);\n  }\n\n});\n/**\r\n * vector({@link olleh.maps.vector.Polyline})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg && \r\n$class('olleh.maps.vector.svg.PolylineRenderer').extend(\r\n    olleh.maps.vector.PolylineRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'polyline',\r\n  \r\n  /**\r\n   *     polyline .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   * @see olleh.maps.vector.PolylineRenderer#draw\r\n   */\r\n  draw: function (points) {\r\n    if (!points || !points.length) return;\r\n    \r\n    this.prepareToDraw();\r\n    \r\n    var len = points.length;\r\n    var polyline = this.elem;\r\n    var value = [];\r\n    var i, preX = 0, preY = 0, curX, curY;\r\n    \r\n    for(i = 0; i < len; i++) {\r\n      \r\n      curX = points[i].x;\r\n      curY = points[i].y;\r\n\r\n      if (curX != preX || curY != preY) {\r\n        value.push(curX + ',' + curY);\r\n      }\r\n      preX = curX;\r\n      preY = curY;\r\n    }\r\n    if (value.length == 1) {\r\n      value.push(curX + ',' + curY);\r\n    }\r\n    polyline.setAttribute('points', value.join(' '));\r\n  }\r\n});/**\r\n * vector({@link olleh.maps.vector.Polygon})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg &&\r\n$class('olleh.maps.vector.svg.PolygonRenderer').extend(olleh.maps.vector.PolygonRenderer)\r\n  .mixin(olleh.maps.vector.svg.PathRenderer).define({\r\n    \r\n    draw: function(pointsArray) {\r\n      if(!olleh.maps.isArray(pointsArray))\r\n        throw TypeError('Type of pointsArray must be array.');\r\n      this.prepareToDraw();\r\n      if(pointsArray[0] instanceof olleh.maps.Point)\r\n        pointsArray = [pointsArray];\r\n      for(var i=0; i<pointsArray.length;i++ ) {\r\n        var points = pointsArray[i];\r\n        this.path(points);\r\n        this.closePath();\r\n      }\r\n      this.commit();\r\n    }\r\n    \r\n  \r\n});/**\r\n * vector({@link olleh.maps.vector.Circle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg && \r\n$class('olleh.maps.vector.svg.CircleRenderer').extend(\r\n    olleh.maps.vector.CircleRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'circle',\r\n  \r\n  /**\r\n   *     . \r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   * @see olleh.maps.vector.CircleRenderer#draw\r\n   */\r\n  draw: function (center, radius) {\r\n    if (!(center instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(radius))) return;\r\n    \r\n    this.prepareToDraw();\r\n    var elem = this.elem;\r\n    \r\n    elem.setAttribute('cx', center.x); \r\n    elem.setAttribute('cy', center.y); \r\n    elem.setAttribute('r', radius);\r\n  }\r\n});/**\r\n * vector({@link olleh.maps.vector.Rectangle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.svg && \r\n$class('olleh.maps.vector.svg.RectangleRenderer').extend(\r\n    olleh.maps.vector.RectangleRenderer).mixin(olleh.maps.vector.svg.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'rect',\r\n  \r\n  /**\r\n   *      .\r\n   * @param {olleh.maps.Point} leftTop  \r\n   * @param {Number} width \r\n   * @param {Number} height \r\n   * @see olleh.maps.vector.RectangleRenderer#draw\r\n   */\r\n  draw: function (leftTop, width, height) {\r\n    if (!(leftTop instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(width))) return;\r\n    if (!(olleh.maps.isNumber(height))) return;\r\n    \r\n    this.prepareToDraw();\r\n    \r\n    var rootElem = this.rootElem.elem;\r\n    \r\n    rootElem.setAttribute('x', leftTop.x);\r\n    rootElem.setAttribute('y', leftTop.y);\r\n    \r\n    if (olleh.maps.isNumber(width)) {\r\n      rootElem.setAttribute('width', width);\r\n    }\r\n    if (olleh.maps.isNumber(height)) {\r\n      rootElem.setAttribute('height', height);\r\n    }\r\n  }\r\n});if (olleh.maps.browser.hasVML) {\r\n\r\n  document.namespaces.add('ollehmap-vml', 'urn:schemas-microsoft-com:vml');\r\n  \r\n\r\n  /**\r\n   * VML vector({@link olleh.maps.vector.Vector})  .\r\n   * @private\r\n   */\r\n  $class('olleh.maps.vector.vml.Renderer').extend(olleh.maps.vector.BaseRenderer).define({\r\n    \r\n    $static: {\r\n      /**\r\n       *   VML Element  .\r\n       * @param {String} name \r\n       * @returns {VMLElement}\r\n       */\r\n      createElement: function (name) {\r\n        var elem = document.createElement('<ollehmap-vml:' + name + '>');\r\n        elem.className = 'ollehmap-vml';\r\n        elem.unselectable = 'on';\r\n        return elem;\r\n      }\r\n    },\r\n    \r\n    /**\r\n     *  \r\n     * @type String\r\n     */\r\n    tag: 'shape',\r\n    \r\n    /**\r\n     * hit test  DOM Element .\r\n     * @returns {HTMLElement}\r\n     * @see olleh.maps.vector.BaseRenderer#getEventDom\r\n     */\r\n    getEventDom: function () {\r\n      return this.rootElem.elem;\r\n    },\r\n    \r\n    /**\r\n     * Vector     .\r\n     * @see olleh.maps.vector.BaseRenderer#prepareToDraw\r\n     */\r\n    prepareToDraw: function () {\r\n      this.getRootElement();\r\n      this._drawn = true;\r\n      this.setOptions();\r\n    },\r\n    \r\n    /**\r\n     * Vector   .\r\n     * @returns {Boolean}\r\n     * @see olleh.maps.vector.BaseRenderer#isDrawn\r\n     */\r\n    isDrawn: function () {\r\n      return !!this._drawn;\r\n    },\r\n    \r\n    /**\r\n     *  DOM  {@link olleh.maps.Element} .\r\n     * @returns {olleh.maps.Element}\r\n     * @see olleh.maps.vector.BaseRenderer#getRootElement\r\n     */\r\n    getRootElement: function () {\r\n      if (!this.rootElem) {\r\n        var rootElem = olleh.maps.vector.vml.Renderer.createElement(this.tag);\r\n        this.rootElem = new olleh.maps.Element(rootElem);\r\n        this._containerElem = this.rootElem.elem; \r\n      }\r\n      return this.rootElem;\r\n    },\r\n    \r\n    /**\r\n     *  .\r\n     * @param {Object} opts \r\n     * @see olleh.maps.vector.BaseRenderer#setOptions\r\n     */\r\n    setOptions: function (opts) {\r\n      this.opts = olleh.maps.mixin(this.opts, opts, true);\r\n      \r\n      if (!this.isDrawn())return;\r\n      \r\n      var opts = this.opts;\r\n      var container = this._containerElem;\r\n      var clazz = olleh.maps.vector.vml.Renderer;\r\n      container.stroked = !!(opts.strokeWeight || olleh.maps.isUndefined(opts.strokeWeight));\r\n      \r\n      if (opts.strokeLinecap === 'butt') {\r\n        opts.strokeLinecap = 'flat';\r\n      }\r\n      if (container.stroked) {\r\n        !this._stroke && (this._stroke = clazz.createElement('stroke'));\r\n        this._stroke.color = opts.strokeColor;\r\n        this._stroke.weight = opts.strokeWeight;\r\n        this._stroke.opacity = opts.strokeOpacity || 1;\r\n        this._stroke.endcap = opts.strokeLinecap || 'round'; // butt | round | square\r\n        this._stroke.joinstyle = opts.strokeLinejoin || 'round'; // miter | round | bevel\r\n        \r\n        // http://msdn.microsoft.com/en-us/library/bb264085(v=vs.85).aspx\r\n        if (opts.strokeStyle) { \r\n          this._stroke.dashStyle = olleh.maps.isArray(opts.strokeStyle) ?\r\n              opts.strokeStyle.join(' ') :\r\n                (opts.strokeStyle + \"\").replace(/ *, */g, ' ');\r\n        } else {\r\n          this._stroke.dashStyle = '';\r\n        }\r\n        \r\n        container.appendChild(this._stroke);\r\n      } else {\r\n        if (this._stroke) {\r\n          container.removeChild(this._stroke);\r\n          delete this._stroke;\r\n        } \r\n      }\r\n      \r\n      container.filled = !(opts.fillColor === 'none' || opts.fillColor === 'transparent' || olleh.maps.isUndefined(opts.fillColor));\r\n      if (container.filled) {\r\n        !this._fill && (this._fill = clazz.createElement('fill'));\r\n        this._fill.color = opts.fillColor;\r\n        this._fill.opacity = opts.fillOpacity || 1;\r\n        container.appendChild(this._fill);\r\n      } else {\r\n        if (this._fill) {\r\n          container.removeChild(this._fill);\r\n          delete this._fill;\r\n        }\r\n      }\r\n      \r\n      \r\n    },\r\n    \r\n    /**\r\n     * VML  .\r\n     * @param {olleh.maps.Point} leftTop\r\n     * @private\r\n     */\r\n    _updatePosition: function (leftTop) {\r\n      if (!leftTop) return;\r\n      \r\n      if (this.isDrawn()) {\r\n        this.rootElem.setStyle('left', leftTop.x + 'px');\r\n        this.rootElem.setStyle('top', leftTop.y + 'px');\r\n      }\r\n    },\r\n    \r\n    /**\r\n     * VML  .\r\n     * @param {Number} width\r\n     * @param {Number} height\r\n     * @private\r\n     */\r\n    _updateSize: function (width, height) {\r\n      this._width = width;\r\n      this._height = height;\r\n      \r\n      if (this.isDrawn()) {\r\n        var rootElem = this.rootElem;\r\n        rootElem.setStyle('width', width +'px');\r\n        rootElem.setStyle('height', height + 'px');\r\n        if(this.tag == 'shape') {\r\n          rootElem.elem.coordsize = width + ' ' + height;\r\n        }\r\n      }\r\n    }\r\n  });\r\n}  /**\r\n * VML    {@link olleh.maps.vector.PathRenderer}   \r\n * @private\r\n */\r\nolleh.maps.vector.vml &&\r\n$class('olleh.maps.vector.vml.PathRenderer').extend(olleh.maps.vector.PathRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n  \r\n  PathRenderer: function() {\r\n    this._translateX = 0;\r\n    this._translateY = 0;\r\n  },\r\n\r\n  prepareToDraw: function () {\r\n    this._command = [];\r\n    olleh.maps.vector.vml.Renderer.prototype.prepareToDraw.call(this);\r\n  },\r\n  \r\n  moveTo: function(x, y) {\r\n    this._command.push(['M', x, y]);\r\n    if(!this._bounds) {\r\n      this._bounds = {left:x, top:y, right:x, bottom:y};\r\n    } else {\r\n      this._union(x, y);\r\n    }\r\n  },\r\n  \r\n  lineTo: function(x, y) {\r\n    this._command.push(['L', x, y]);\r\n    if(!this._bounds) {\r\n      this._bounds = {left: x, top:y, right:x, bottom:y};\r\n    } else {\r\n      this._union(x, y);\r\n    }\r\n  },\r\n  \r\n  circle: function(cx, cy, r) {\r\n    var left = cx-r;\r\n    var top = cy-r;\r\n    var right = cx+r;\r\n    var bottom = cy+r;\r\n    this._command.push(['AT',cx,cy,r]);\r\n    if(!this._bounds) {\r\n      this._bounds = {left: left, top:top, right:right, bottom:bottom};\r\n    } else {\r\n      this._union(left, top);\r\n      this._union(right, bottom);\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * @param {array.<olleh.maps.Point>} points\r\n   */\r\n  path: function(points) {\r\n    for(var i=0;i<points.length;i++) {\r\n      var p = points[i];\r\n      if(i==0) {\r\n        this.moveTo(p.x, p.y);\r\n      } else {\r\n        this.lineTo(p.x, p.y);\r\n      }\r\n    }\r\n  },\r\n  \r\n  closePath: function() {\r\n    this._command.push(['X']);\r\n  },\r\n  \r\n  commit: function() {\r\n    var bounds = this._bounds;\r\n    var str='';\r\n    for(var i=0; i<this._command.length;i++) {\r\n      var command = this._command[i];\r\n      if(str.length > 0) str += ' ';\r\n      str += this._toCommandStr(command, -bounds.left, -bounds.top);\r\n    }\r\n    this.rootElem.elem.path = str;\r\n    this._updatePosition({x: bounds.left, y: bounds.top});\r\n    this._updateSize(bounds.right-bounds.left, bounds.bottom-bounds.top);\r\n  },\r\n  \r\n  _toCommandStr: function(command, dx, dy) {\r\n    if(command[0] == 'M' || command[0] == 'L') {\r\n      return command[0] + ' '+ (command[1]+dx) + ' ' + (command[2]+dy);  \r\n    }\r\n    if(command[0] == 'AT') {\r\n      var cx = command[1] + dx;\r\n      var cy = command[2] + dy;\r\n      var r = command[3];\r\n      var left = cx-r;\r\n      var top = cy-r;\r\n      var right = cx+r;\r\n      var bottom = cy+r;\r\n      var startX = cx;\r\n      var startY = cy-r;\r\n      return 'AT '+left+' '+top+' '+right+' '+bottom+' '+ startX+' '+startY+' '+startX+' '+startY + ' X E';\r\n    }\r\n    return command.join(' ');\r\n  },\r\n  \r\n  \r\n  _union: function(x, y) {\r\n    var bounds = this._bounds;\r\n    bounds.left = Math.min(bounds.left, x);\r\n    bounds.top = Math.min(bounds.top, y);\r\n    bounds.right = Math.max(bounds.right, x);\r\n    bounds.bottom = Math.max(bounds.bottom, y);\r\n  }\r\n\r\n});/**\r\n * vector({@link olleh.maps.vector.Polyline})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml &&\r\n$class('olleh.maps.vector.vml.PolylineRenderer').extend(\r\n    olleh.maps.vector.PolylineRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @String\r\n   */\r\n  tag: 'polyline',\r\n  \r\n  /**\r\n   * point  bounds   bounds      .\r\n   * @param {Array.<olleh.maps.Point>} points\r\n   * @returns {Object} {points: Array.<olleh.maps.Point>, leftTop: new olleh.maps.Point(x1, y1), rightBottom: new olleh.maps.Point(x2, y2)}\r\n   * @private\r\n   */\r\n  _getPoints: function (points) {\r\n    if (!points || !points.length) return null;\r\n    \r\n    var x1 = x2 = points[0].x;\r\n    var y1 = y2 = points[0].y;\r\n    var len = points.length;\r\n    var x, y, point, i, preX, preY, curX, curY;\r\n    var value = [];\r\n    \r\n    for(i = 0; i < len; i++) {\r\n      point = points[i];\r\n      x = point.x;\r\n      y = point.y;\r\n      x1=Math.min(x1,x);\r\n      y1=Math.min(y1,y);\r\n      x2=Math.max(x2,x);\r\n      y2=Math.max(y2,y);\r\n    }\r\n    for(i = 0; i < len; i++) {\r\n      point = points[i];\r\n      curX = point.x;\r\n      curY = point.y;\r\n      \r\n      if (curX != preX || curY != preY) {\r\n        value.push((curX - x1)+ ',' + (curY - y1));\r\n      }\r\n      preX = curX;\r\n      preY = curY;\r\n    }\r\n    return {points: value, leftTop: new olleh.maps.Point(x1, y1), rightBottom: new olleh.maps.Point(x2, y2)};\r\n  },\r\n  \r\n    \r\n  /**\r\n   *     polyline .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   * @see olleh.maps.vector.PolylineRenderer#draw\r\n   */\r\n  draw: function (points) {\r\n    if (!points || !points.length) return;\r\n    \r\n    this.prepareToDraw();\r\n    var data = this._getPoints(points);\r\n    \r\n    if (!data) return;\r\n    \r\n    var polyline = this.getRootElement().elem;\r\n    var size = data.rightBottom.subtract(data.leftTop);\r\n    var value = data.points.join(' ');\r\n    \r\n    if (!polyline.points) {\r\n      polyline.points = value;\r\n    } else {\r\n      polyline.points.value = value;\r\n    }\r\n    \r\n    this._updatePosition(data.leftTop);\r\n    this._updateSize(size.x, size.y);\r\n  }\r\n  \r\n});/**\r\n * vector({@link olleh.maps.vector.Polygon})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml && \r\n$class('olleh.maps.vector.vml.PolygonRenderer').extend(olleh.maps.vector.PolygonRenderer).\r\n  mixin(olleh.maps.vector.vml.PathRenderer).define({\r\n\r\n  /**\r\n   * @param {array.<array.<olleh.maps.Point>>} pointsArray\r\n   */  \r\n  draw: function(pointsArray) {\r\n    if(!olleh.maps.isArray(pointsArray))\r\n      throw TypeError('Type of pointsArray must be array.');\r\n    this.prepareToDraw();\r\n    if(pointsArray[0] instanceof olleh.maps.Point)\r\n      pointsArray = [pointsArray];\r\n    for(var i=0; i<pointsArray.length;i++ ) {\r\n      var points = pointsArray[i];\r\n      this.path(points);\r\n      this.closePath();\r\n    }\r\n    this.commit();\r\n  }\r\n\r\n});/**\r\n * vector({@link olleh.maps.vector.Circle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml && \r\n$class('olleh.maps.vector.vml.CircleRenderer').extend(\r\n    olleh.maps.vector.CircleRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'oval',\r\n  \r\n  /**\r\n   *     . \r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   * @see olleh.maps.vector.CircleRenderer#draw\r\n   */\r\n  draw: function (center, radius) {\r\n    if (!(center instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(radius))) return;\r\n    \r\n    this.prepareToDraw();\r\n    var size = radius * 2;\r\n    \r\n    this._updatePosition(center.subtract(new olleh.maps.Point(radius, radius)));\r\n    this._updateSize(size, size);\r\n  }\r\n});/**\r\n * vector({@link olleh.maps.vector.Rectangle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.vml && \r\n$class('olleh.maps.vector.vml.RectangleRenderer').extend(\r\n    olleh.maps.vector.RectangleRenderer).mixin(olleh.maps.vector.vml.Renderer).define({\r\n      \r\n  /**\r\n   *  \r\n   * @type String\r\n   */\r\n  tag: 'rect',\r\n  \r\n  /**\r\n   *      .\r\n   * @param {olleh.maps.Point} leftTop  \r\n   * @param {Number} width \r\n   * @param {Number} height \r\n   * @see olleh.maps.vector.RectangleRenderer#draw\r\n   */\r\n  draw: function (leftTop, width, height) {\r\n    if (!(leftTop instanceof olleh.maps.Point)) return;\r\n    if (!(olleh.maps.isNumber(width))) return;\r\n    if (!(olleh.maps.isNumber(height))) return;\r\n    \r\n    this.prepareToDraw();\r\n    this._updatePosition(leftTop);\r\n    this._updateSize(width, height);\r\n  }\r\n});/**\r\n * Canvas   vector   Renderer   base class\r\n * @private\r\n */\r\nolleh.maps.browser.hasCanvas &&\r\n$class('olleh.maps.vector.canvas.Renderer').extend(\r\n    olleh.maps.vector.BaseRenderer).define({\r\n  /**\r\n   *   canvas     \r\n   * @type Number\r\n   */\r\n  weightFactor: Math.sqrt(2),\r\n  \r\n  /**\r\n   * hit test  DOM Element . \r\n   * @returns {HTMLElement}\r\n   * @see olleh.maps.vector.BaseRenderer#getEventDom\r\n   */\r\n  getEventDom: function () {\r\n    return this.getRootElement().elem;\r\n  },\r\n  \r\n  /**\r\n   * Vector     .\r\n   * @see olleh.maps.vector.BaseRenderer#prepareToDraw\r\n   */\r\n  prepareToDraw: function () {\r\n    this.getRootElement();\r\n  },\r\n  \r\n  /**\r\n   * Vector   .\r\n   * @returns {Boolean}\r\n   * @see olleh.maps.vector.BaseRenderer#isDrawn\r\n   */\r\n  isDrawn: function () {\r\n    return !!this.canvas;\r\n  },\r\n  \r\n  /**\r\n   *  DOM   {@link olleh.maps.Element} .\r\n   * @returns {olleh.maps.Element}\r\n   * @see olleh.maps.vector.BaseRenderer#getRootElement\r\n   */\r\n  getRootElement: function () {\r\n    if (!this.canvas) {\r\n      var canvasElem = document.createElement('canvas');\r\n      var setStyle = function(key, value) {\r\n        switch (key) {\r\n        case 'left':\r\n        case 'top':\r\n          value = parseFloat(value) - (this._padding || 0) + 'px';\r\n          break;\r\n        }\r\n        olleh.maps.Element.prototype.setStyle.call(this, key, value);\r\n      };\r\n      this.canvas = olleh.maps.mixin(new olleh.maps.Element(canvasElem), {setStyle: setStyle}, true);\r\n      this.canvas.setStyle('position', 'absolute');\r\n      var ctx = canvasElem.getContext('2d');\r\n      ctx.lineCap = 'round';\r\n      ctx.lineJoin = 'round';\r\n      this.ctx = ctx;\r\n    }\r\n    return this.canvas;\r\n  },\r\n  \r\n  \r\n  /**\r\n   * Option  .\r\n   * @param {Object} opts\r\n   * @see olleh.maps.vector.BaseRenderer#setOptions\r\n   */\r\n  setOptions: function (opts) {\r\n    this.opts = olleh.maps.mixin(this.opts, opts, true);\r\n  },\r\n  \r\n  /**\r\n   *   option   Canvas Context    .\r\n   * @private\r\n   */\r\n  _updateStyle: function () {\r\n    var opts = this.opts;\r\n    var ctx = this.ctx;\r\n    ctx.save();\r\n    \r\n    if (opts.fillColor) {\r\n      ctx.fillStyle = opts.fillColor;\r\n      if (opts.fillOpacity < 1) {\r\n        ctx.globalAlpha = opts.fillOpacity;\r\n      }\r\n      ctx.fill();\r\n    }\r\n    \r\n    if (opts.strokeColor && opts.strokeWeight) {\r\n      ctx.strokeStyle = opts.strokeColor;\r\n      ctx.lineWidth = opts.strokeWeight;\r\n      ctx.lineCap = opts.strokeLinecap || 'round';\r\n      ctx.lineJoin = opts.strokeLinejoin || 'round';\r\n      if (opts.strokeOpacity < 1) {\r\n        ctx.globalAlpha = opts.strokeOpacity;\r\n      }\r\n      ctx.stroke();\r\n    }\r\n    \r\n    ctx.restore();\r\n  },\r\n  \r\n  /**\r\n   * Canvas    .\r\n   * @param {olleh.maps.Point} leftTop canvas \r\n   * @param {Number} width canvas width\r\n   * @param {Number} height canvas height\r\n   */\r\n  _updateCanvas: function(leftTop, width, height) {\r\n    if (this.canvas) {\r\n      var canvasElem = this.canvas.elem;\r\n      // update size\r\n      var weight = this.opts.strokeWeight;\r\n      var padding = weight ? this.weightFactor * weight : 0;\r\n      this.canvas._padding = padding;\r\n      var padding2 = 2 * padding;\r\n      var rootWidth = width + padding2;\r\n      var rootHeight = height + padding2;\r\n      if (olleh.maps.isNumber(width)) {\r\n        canvasElem.setAttribute('width', rootWidth + 'px');\r\n      }\r\n      if (olleh.maps.isNumber(height)) {\r\n        canvasElem.setAttribute('height', rootHeight + 'px');\r\n      }\r\n      // update position\r\n      this.canvas.setStyle('left', leftTop.x + 'px');\r\n      this.canvas.setStyle('top', leftTop.y + 'px');\r\n    }\r\n  }\r\n});/**\r\n * Polyline({@link olleh.maps.vector.Polyline})  .\r\n * @private\r\n */\r\nolleh.maps.vector.canvas && \r\n$class('olleh.maps.vector.canvas.PolylineRenderer').extend(\r\nolleh.maps.vector.PolylineRenderer).mixin(olleh.maps.vector.canvas.Renderer).define({\r\n  /**\r\n   * path     polygon    .\r\n   * @type Boolean\r\n   */\r\n  closePath: false,\r\n  /**\r\n   *     polyline  Polygon  .\r\n   * @param {Array.<olleh.maps.Point>} points   \r\n   * @see olleh.maps.vector.PolylineRenderer#draw\r\n   */\r\n  draw: function (points) {\r\n    if (!points || !points.length)\r\n      return;\r\n\r\n    this.prepareToDraw();\r\n    var ctx = this.ctx;\r\n    var x1 = x2 = points[0].x;\r\n    var y1 = y2 = points[0].y;\r\n    for ( var i = 0, len = points.length; i < len; i++) {\r\n      var p = points[i];\r\n      x1 = Math.min(p.x, x1);\r\n      y1 = Math.min(p.y, y1);\r\n      x2 = Math.max(p.x, x2);\r\n      y2 = Math.max(p.y, y2);\r\n    }\r\n    this._updateCanvas(new olleh.maps.Point(x1, y1), x2 - x1, y2 - y1);\r\n    \r\n    ctx.translate(this.canvas._padding, this.canvas._padding);\r\n    ctx.beginPath();\r\n    ctx.moveTo(points[0].x - x1, points[0].y - y1);\r\n    for ( var i = 1, len = points.length; i < len; i++) {\r\n      var p = points[i];\r\n      ctx.lineTo(p.x - x1, p.y - y1);\r\n    }\r\n    if (this.closePath) {\r\n      ctx.closePath();\r\n    }\r\n    this._updateStyle();\r\n  }\r\n});/**\r\n * Polygon({@link olleh.maps.vector.Polygon})  .\r\n * @private\r\n */\r\nolleh.maps.vector.canvas &&\r\n$class('olleh.maps.vector.canvas.PolygonRenderer').extend(\r\n    olleh.maps.vector.canvas.PolylineRenderer).define({\r\n  /**\r\n   * @type Boolean\r\n   */\r\n  closePath: true\r\n});/**\r\n * Circle({@link olleh.maps.vector.Circle})  .\r\n * @private\r\n */\r\nolleh.maps.vector.canvas &&\r\n$class('olleh.maps.vector.canvas.CircleRenderer').extend(\r\n    olleh.maps.vector.CircleRenderer).mixin(olleh.maps.vector.canvas.Renderer).define({\r\n  /**\r\n   * @type Number\r\n   */\r\n  weightFactor: .5,\r\n  \r\n  /**\r\n   *     . \r\n   * @param {olleh.maps.Point} center \r\n   * @param {Number} radius \r\n   * @see olleh.maps.vector.CircleRenderer#draw\r\n   */\r\n  draw: function (center, radius) {\r\n    this.prepareToDraw();\r\n    var size = radius * 2;\r\n    var leftTop = center.subtract(new olleh.maps.Point(radius,\r\n        radius));\r\n    this._updateCanvas(leftTop, size, size);\r\n    \r\n    var ctx = this.ctx;\r\n    ctx.translate(this.canvas._padding, this.canvas._padding);\r\n    ctx.beginPath();\r\n    ctx.arc(radius, radius, radius, 0, Math.PI * 2, false);\r\n    \r\n    this._updateStyle();\r\n  }\r\n});/**\r\n * Rectangle({@link olleh.maps.vector.Rectangle })  .\r\n * @private \r\n */\r\nolleh.maps.vector.canvas && \r\n$class('olleh.maps.vector.canvas.RectangleRenderer').extend(\r\n    olleh.maps.vector.RectangleRenderer).mixin(olleh.maps.vector.canvas.Renderer).define({\r\n\r\n  /**\r\n   * @type Number\r\n   */\r\n  weightFactor: .5,\r\n /**\r\n  *      .\r\n  * @param {olleh.maps.Point} leftTop  \r\n  * @param {Number} width \r\n  * @param {Number} height \r\n  * @see olleh.maps.vector.RectangleRenderer#draw\r\n  */\r\n  draw: function (leftTop, width, height) {\r\n    this.prepareToDraw();\r\n    this._updateCanvas(leftTop, width, height);\r\n    \r\n    var ctx = this.ctx;\r\n    ctx.translate(this.canvas._padding, this.canvas._padding);\r\n    ctx.beginPath();\r\n    ctx.rect(0, 0, width, height);\r\n    \r\n    this._updateStyle();\r\n  }\r\n});!function (ns) {\r\n  /**\r\n   * vector {@link olleh.maps.vector.Vector}     API .\r\n   * <p/>\r\n   *    SVG, Canvas, VML Renderer .\r\n   * @private\r\n   */\r\n  ns && $class('olleh.maps.vector.RendererFactory').define({\r\n    \r\n    /**\r\n     * PolylineRenderer  .\r\n     * @param {olleh.maps.vector.PolylineRendererOptions} opts\r\n     * @returns {olleh.maps.vector.PolylineRenderer}\r\n     */\r\n    createPolylineRenderer: function (opts) {\r\n      var clazz = ns.PolylineRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * PolygonRenderer  .\r\n     * @param {olleh.maps.vector.PolygonRendererOptions} opts\r\n     * @returns {olleh.maps.vector.PolygonRenderer}\r\n     */\r\n    createPolygonRenderer: function (opts) {\r\n      var clazz = ns.PolygonRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * RectangleRenderer  .\r\n     * @param {olleh.maps.vector.RectangleRendererOptions} opts\r\n     * @returns {olleh.maps.vector.RectangleRenderer}\r\n     */\r\n    createRectangleRenderer: function (opts) {\r\n      var clazz = ns.RectangleRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * CircleRenderer  .\r\n     * @param {olleh.maps.vector.CircleRendererOptions} opts\r\n     * @returns {olleh.maps.vector.CircleRenderer}\r\n     */\r\n    createCircleRenderer: function (opts) {\r\n      var clazz = ns.CircleRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    },\r\n    /**\r\n     * ContainerRenderer  .\r\n     * @param {Object} opts\r\n     * @returns {olleh.maps.vector.ContainerRenderer}\r\n     */\r\n    createContainerRenderer: function (opts) {\r\n      if (!this._containerRenderer) {\r\n        var clazz = ns.ContainerRenderer;\r\n        this._containerRenderer = clazz ? new clazz(opts) : null;\r\n      }\r\n      return this._containerRenderer;\r\n    },\r\n    \r\n    /**\r\n     * SVG path  vml shape       PathRenderer  .\r\n     */\r\n    createPathRenderer: function(opts) {\r\n      var clazz = ns.PathRenderer;\r\n      return clazz ? new clazz(opts) : null;\r\n    }\r\n    \r\n  });\r\n} (olleh.maps.vector[olleh.maps.browser.vector.toLowerCase()]);/**\n * Vector   Layer \n */\n$class('olleh.maps.vector.VectorLayer').extend(olleh.maps.layer.Layer).define({\n\n  name: 'Vector',\n\n  label: olleh.maps.msg(''),\n\n  autoActivate: true,\n  \n  zIndex: 999,\n\n  /**\n   * VectorLayer  .\n   */\n  VectorLayer: function () {\n    this._vectors = [];\n    this._rendererFactory = new olleh.maps.vector.RendererFactory();\n    this._containerRenderer = this._rendererFactory.createContainerRenderer({\n      layer: this\n    });\n    this._zoomAnim = false; // zoom animation  . transform   zoom animation .\n  },\n\n  start: function () {\n    var style = olleh.maps.browser.style;\n    if (style.transform) {\n      this._zoomAnim = true;\n    }\n    olleh.maps.vector.VectorLayer.$super.start.call(this);\n  },\n\n  /**\n   * VectorLayer    .\n   * @param {Boolean} visible false  VectorLayer   . \n   */\n  setVisible: function (visible) {\n    if (this._isVisible != visible) {\n      this._isVisible = visible;\n      visible && this.draw();\n      var pane = this.getPane();\n      var visibility = visible ? 'visible' : 'hidden';\n      pane.style.visibility = visibility;\n    }\n  },\n\n  /**\n   *  VectorLayer     .\n   * @returns {Boolean}\n   */\n  isVisible: function () {\n    return this._isVisible;\n  },\n\n  /**\n   * VectorLayer   Vector  .\n   */\n  draw: function () {\n    if (this._zoomAnim) {\n      this._ensureStopAnimation();\n    }\n    this._containerRenderer && this._containerRenderer.setBounds();\n    this.drawAll();\n  },\n\n  /**\n   *  Vector  draw()  .\n   * @private\n   */\n  drawAll: function () {\n    var i, len = this._vectors.length;\n    for (i = 0; i < len; i++) {\n      this._vectors[i].isVisible() && this._vectors[i].draw();\n    }\n  },\n\n  /**\n   * Zoom    .\n   * @param {Number} scale\n   * @param {olleh.maps.Point} origin\n   * @param {Number} duration\n   * @param {olleh.maps.fx.Pulse} [pulse]\n   * @private\n   */\n  zoomStart: function (scale, origin, duration, pulse) {\n    if (this._vectors.length === 0)\n      return;\n    var pane = this.getPane();\n    if (this._zoomAnim) {\n      var from;\n      \n      if (this._isZooming) {\n        from = this._animator.ignore();\n      } else {\n        olleh.maps.util.dom.setStyle(pane, 'transformOrigin', origin.x + 'px '\n            + origin.y + 'px');\n        from = {\n          transform: olleh.maps.util.dom.getScaleString(1)\n        };\n      }\n      \n      this._animator = new olleh.maps.fx.Animation({\n        from: from,\n        to: {\n          transform: olleh.maps.util.dom.getScaleString(scale)\n        },\n        defaultType: '=',\n        duration: duration,\n        pulse: pulse,\n        timing: olleh.maps.fx.timing.easeOut\n      }).animate(pane);\n    } else {\n      pane.style.visibility = 'hidden';\n    }\n    this._isZooming = true;\n  },\n  \n  \n\n  /**\n   * Zoom    .\n   * @private\n   */\n  zoomEnd: function () {\n    if (this._isZooming) {\n      if (this._zoomAnim) {\n        this._ensureStopAnimation();\n      } else {\n        var pane = this.getPane();\n        pane.style.visibility = 'visible';\n      }\n      this._isZooming = false;\n    }\n    // workaround for chrome bug: zoom in / out  ?   \n    if (olleh.maps.browser.browserName === olleh.maps.browser.BROWSER_NAME.chrome) {\n      this._eraseAll();\n    }\n    this.drawAll();\n  },\n  \n  _eraseAll: function() {\n    var i, len = this._vectors.length;\n    for (i = 0; i < len; i++) {\n      this._vectors[i].isVisible() && this._vectors[i].erase();\n    }\n  },\n  \n  _ensureStopAnimation: function() {\n    var pane = this.getPane();\n    var animator = this._animator;\n    if (animator && this._animator.status === 'started') {\n      this._animator.cancel();\n    }\n    pane && olleh.maps.util.dom.setStyle(pane, 'transform','');\n  },\n\n  /**\n   * Pan    .\n   * @private\n   */\n  moveEnd: function () {\n    this._containerRenderer && this._containerRenderer.setBounds();\n  },\n\n  /**\n   * VectorLayer    Vector  .\n   * @returns {Array} consists of olleh.maps.vector.Vector\n   */\n  getVectors: function () {\n    return this._vectors;\n  },\n\n  /**\n   * VectorLayer   Pane  . Pane    .\n   * @returns {HTMLElement}\n   */\n  getPane: function () {\n    if (!this._pane) {\n      var pane = document.createElement('div');\r\n      pane.style.position = 'absolute';\r\n      this._pane = pane;\r\n    }\r\n    return this._pane;\r\n  },\r\n  \r\n  /**\r\n   * Vector   container element  . Vector  pane   container  element   .\n   * SVG   ContainerRenderer    svg element   VML,Canvas   div pane  .  \r\n   * @returns {HTMLElement}\r\n   */\r\n  getContainer: function() {\r\n    if (!this._container) {\r\n      var pane = this.getPane();\r\n      if (this._containerRenderer) {\n        this._container = this._containerRenderer.createContainer();\n        pane.appendChild(this._container);\r\n      } else {\n        this._container = pane;\r\n      }\n    }\n    return this._container;\r\n  },\n\n  /**\n   * RendererFactory  .\n   * @returns {olleh.maps.vector.RendererFactory}\n   * @private\n   */\n  getRendererFactory: function () {\n    return this._rendererFactory;\n  },\n\n  /**\n   * Vector  .\n   * @param {olleh.maps.vector.Vector} vector\n   */\n  add: function (vector) {\n    this._vectors.push(vector);\n    vector.layer = this;\n    if (this.isStarted())\n      vector.onAdd(this);\n  },\n\n  /**\n   * Vector  .\n   * @param {olleh.maps.vector.Vector} vector\n   */\n  remove: function (vector) {\n    olleh.maps.util.removeFromArray(this._vectors, vector);\n    if (this.isStarted()) {\n      vector.onRemove();\n    }\n    vector.layer = null;\n  }\n});/**\r\n * EditHandler interface\r\n * @private\r\n */\r\n$class('olleh.maps.vector.EditHandler').define({\r\n  \r\n  EditHandler: function(target) {\r\n    this.target = target;\r\n  },\r\n  \r\n  activate: function() {\r\n    \r\n  },\r\n  \r\n  deactivate: function() {\r\n    \r\n  },\r\n  \r\n  getTarget: function() {\r\n    return this.target;\r\n  },\r\n  \r\n  refresh: function() {\r\n    \r\n  }\r\n\r\n});/**\n * @private\n */\n$class('olleh.maps.plugin.VectorPlugin').extend(olleh.maps.Adaptable).define({\n  \n  attach: function () {\n    this.vector = new olleh.maps.vector.VectorLayer({\n      map: this.map\n    });\n  },\n  \n  detach: function () {\n    // ????\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.VectorPlugin);/* Copyright (c) 2012 the authors listed at the following URL, and/or\nthe authors of referenced articles or incorporated external code:\nhttp://en.literateprograms.org/Quickhull_(Javascript)?action=history&offset=20120410175256\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nRetrieved from: http://en.literateprograms.org/Quickhull_(Javascript)?oldid=18434\n*/\nvar Quickhull = {\n  getDistant: function (cpt, bl) {\n    return (bl[0].y - bl[1].y) * (cpt.x - bl[0].x) + (bl[1].x - bl[0].x) * (cpt.y - bl[0].y);\n  },\n  findMostDistantPointFromBaseLine: function (baseLine, points) {\n    var i, l, maxD = 0, maxPt = null, newPoints = [];\n    for (i = 0, l = points.length; i < l; i++) {\n      var pt = points[i];\n      var d = this.getDistant(pt, baseLine);\n      if (d > 0) {\n        newPoints.push(pt);\n        if (d > maxD) {\n          maxD = d;\n          maxPt = pt;\n        }\n      }\n    }\n    return {\n      'maxPoint': maxPt,\n      'newPoints': newPoints\n    };\n  },\n  buildConvexHull: function (baseLine, points) {\n    var convexHullBaseLines = [], t = this.findMostDistantPointFromBaseLine(baseLine, points);\n    if (t.maxPoint) { // if there is still a point \"outside\" the base line\n      convexHullBaseLines = convexHullBaseLines.concat(this.buildConvexHull([ baseLine[0], t.maxPoint ], t.newPoints));\n      convexHullBaseLines = convexHullBaseLines.concat(this.buildConvexHull([ t.maxPoint, baseLine[1] ], t.newPoints));\n      return convexHullBaseLines;\n    }\n    // if there is no more point \"outside\" the base line, the current base line is part of the convex hull\n    return [ baseLine ];\n  },\n  getConvexHull: function (points) {\n    var i, l, maxPt, minPt, maxX = Number.MIN_VALUE, minX = Number.MAX_VALUE;\n    for (i = 0, l = points.length; i < l; i++) {\n      var pt = points[i];\n      if (pt.x > maxX) {\n        maxPt = pt;\n        maxX = pt.x;\n      }\n      if (pt.x < minX) {\n        minPt = pt;\n        minX = pt.x;\n      }\n    }\n    return [].concat(this.buildConvexHull([ minPt, maxPt ], points), this.buildConvexHull([ maxPt, minPt ], points));\n  }\n};/**\r\n * MarkerClusterOptions Object Specification\r\n * @typedef olleh.maps.overlay.MarkerClusterOptions\r\n * @property {boolean} [resetPosition=false]           .\r\n * @property {boolean} [clickToZoom=false]      <code>maxZoom + 1</code>  .\r\n * @property {boolean} [clickToExpand=true]        . <code>clickToZoom</code>    .\r\n * @property {boolean} [displaySize=true]       .\r\n * @property {number} [fontSize]    .  .\r\n * @property {boolean} [displayArea=true]        .\r\n * @property {olleh.maps.vector.PolygonOptions} [areaStyle]    .\r\n * @property {function} [iconFn]     .        {@link olleh.maps.overlay.MarkerOptions} .\r\n * @extends olleh.maps.overlay.PointedOverlayOptions\r\n */\r\n\r\n/**\r\n *        .\r\n */\r\n$class('olleh.maps.overlay.MarkerCluster').extend(olleh.maps.overlay.PointedOverlay).define({\r\n\r\n  $static: {\r\n    /**\r\n     * @private\r\n     * @constants\r\n     * @type number\r\n     */\r\n    DEFAULT_FONT_SIZE: 10,\r\n\r\n    /**\r\n     * @private\r\n     * @constants\r\n     * @type String\r\n     */\r\n    DEFAULT_FONT_COLOR: '#000',\r\n\r\n    /**\r\n     * @private\r\n     * @constants\r\n     * @type olleh.maps.vector.PolygonOptions\r\n     */\r\n    DEFAULT_AREA_STYLE: {\r\n      strokeColor: '#69F',\r\n      strokeWeight: 5,\r\n      strokeOpacity: .8,\r\n      fillColor: '#69F',\r\n      fillOpacity: .4\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {number} size\r\n     * @returns {olleh.maps.overlay.MarkerIconOptions}\r\n     */\r\n    DEFAULT_ICON_FN: function (size) {\r\n      return {\r\n        url: olleh.maps.env.RESOURCE_URL + 'img/clusters.png',\r\n        size: new olleh.maps.Size(50, 50),\r\n        anchor: new olleh.maps.Point(25, 25),\r\n        origin: new olleh.maps.Point((4 - Math.min(Math.floor(size / 20), 4)) * 51, 0)\r\n      };\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @constants\r\n   * @type number\r\n   */\r\n  MARKER_ANIMATE_DURATION: .2,\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.MarkerClusterOptions} opts .\r\n   */\r\n  MarkerCluster: function (opts) {\r\n    var MarkerCluster = olleh.maps.overlay.MarkerCluster;\r\n    this._clickToExpand = true;\r\n    this._clickToZoom = false;\r\n    this._displaySize = true;\r\n    this._fontSize = MarkerCluster.DEFAULT_FONT_SIZE;\r\n    this._fontColor = MarkerCluster.DEFAULT_FONT_COLOR;\r\n    this._displayArea = true;\r\n    this._areaStyle = MarkerCluster.DEFAULT_AREA_STYLE;\r\n    this._iconFn = MarkerCluster.DEFAULT_ICON_FN;\r\n\r\n    this._areaPath = null;\r\n    this._originMap = null;\r\n    this._area = null;\r\n\r\n    this._children = [];\r\n    this._size = -1; // -1 indicates invalidate; should be recalculated before draw\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   * @returns {boolean}     <code>true</code>,    <code>false</code>\r\n   */\r\n  isExpanded: function () {\r\n    var i, l, children = this._children;\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      if (children[i].isAdded()) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @param {olleh.maps.overlay.MarkerClusterOptions} opts\r\n   */\r\n  setOptions: function (opts) {\r\n    opts.resetPosition !== undefined && this.setResetPosition(opts.resetPosition);\r\n    opts.clickToZoom !== undefined && this.setClickToZoom(opts.clickToZoom);\r\n    opts.clickToExpand !== undefined && this.setClickToExpand(opts.clickToExpand);\r\n    opts.displaySize !== undefined && this.setDisplaySize(opts.displaySize);\r\n    opts.fontSize && this.setFontSize(opts.fontSize);\r\n    opts.fontColor && this.setFontColor(opts.fontColor);\r\n    opts.displayArea !== undefined && this.setDisplayArea(opts.displayArea);\r\n    opts.areaStyle && this.setAreaStyle(opts.areaStyle);\r\n    opts.iconFn && this.setIconFn(opts.iconFn);\r\n    olleh.maps.overlay.MarkerCluster.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  update: function () {\r\n    this._updateIcon();\r\n    this._updateSize();\r\n    olleh.maps.overlay.MarkerCluster.$super.update.apply(this, arguments);\r\n  },\r\n\r\n  /**\r\n   * @param zoom\r\n   * @returns {boolean}\r\n   */\r\n  isVisibleAtZoom: function (zoom) {\r\n    return this.minZoom <= zoom && zoom <= this.maxZoom;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#resetPosition}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isResetPosition: function () {\r\n    return this._resetPosition;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#resetPosition}  .\r\n   * @param {boolean} resetPosition  .\r\n   */\r\n  setResetPosition: function (resetPosition) {\r\n    this._resetPosition = resetPosition;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToZoom}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isClickToZoom: function () {\r\n    return this._clickToZoom;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToZoom}  .\r\n   * @param {boolean} clickToZoom  .\r\n   */\r\n  setClickToZoom: function (clickToZoom) {\r\n    this._clickToZoom = clickToZoom;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToExpand}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isClickToExpand: function () {\r\n    return this._clickToExpand;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#clickToExpand}  .\r\n   * @param {boolean} clickToExpand  .\r\n   */\r\n  setClickToExpand: function (clickToExpand) {\r\n    this._clickToExpand = clickToExpand;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displaySize}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isDisplaySize: function () {\r\n    return this._displaySize;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displaySize}  .\r\n   * @param {boolean} displaySize  .\r\n   */\r\n  setDisplaySize: function (displaySize) {\r\n    this._displaySize = displaySize;\r\n    this.isDrawn() && this._updateSize();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _updateSize: function () {\r\n    this._sizeDiv.setProperty('innerHTML', this._displaySize ? this.getSize() : '');\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontSize}   .\r\n   * @returns {number}  .\r\n   */\r\n  getFontSize: function () {\r\n    return this._fontSize;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontSize}  .\r\n   * @param {boolean} fontSize  .\r\n   */\r\n  setFontSize: function (fontSize) {\r\n    this._fontSize = fontSize;\r\n    this.isDrawn() && this._updateIcon();\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontColor}   .\r\n   * @returns {string}  .\r\n   */\r\n  getFontColor: function () {\r\n    return this._fontColor;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#fontColor}  .\r\n   * @param {string} fontColor  .\r\n   */\r\n  setFontColor: function (fontColor) {\r\n    this._fontColor = fontColor;\r\n    this.isDrawn() && this._updateIcon();\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displayArea}    .\r\n   * @returns {boolean}   <code>true</code>,    <code>false</code>\r\n   */\r\n  isDisplayArea: function () {\r\n    return this._displayArea;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#displayArea}  .\r\n   * @param {boolean} displayArea  .\r\n   */\r\n  setDisplayArea: function (displayArea) {\r\n    this._displayArea = displayArea;\r\n    if (this.isDrawn() && !displayArea) {\r\n      this.hideArea();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#areaStyle}   .\r\n   * @returns {olleh.maps.vector.PolygonOptions}  .\r\n   */\r\n  getAreaStyle: function () {\r\n    return this._areaStyle;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#areaStyle}  .\r\n   * @param {olleh.maps.vector.PolygonOptions} areaStyle  .\r\n   */\r\n  setAreaStyle: function (areaStyle) {\r\n    this._areaStyle = areaStyle;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#iconFn}   .\r\n   * @returns {function}  .\r\n   */\r\n  getIconFn: function () {\r\n    return this._iconFn;\r\n  },\r\n\r\n  /**\r\n   * {@link olleh.maps.overlay.MarkerClusterOptions#iconFn}  .\r\n   * @param {function} iconFn  .\r\n   */\r\n  setIconFn: function (iconFn) {\r\n    this._iconFn = iconFn;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _updateIcon: function () {\r\n    var icon = this._iconFn(this.getSize());\r\n    var fontSize = this._fontSize;\r\n    var fontColor = this._fontColor;\r\n    var img = this._img;\r\n\r\n    if (!this._img) {\r\n      img = this._img = new olleh.maps.SpritedImage();\r\n\r\n      this._sizeDiv = olleh.maps.Element.create('div').setStyles({\r\n        position: 'absolute',\r\n        width: '100%',\r\n        textAlign: 'center',\r\n        fontWeight: 'bold',\r\n        zIndex: 1\r\n      });\r\n      this._sizeDiv.setStyle('userSelect', 'none');\r\n      img.appendChild(this._sizeDiv);\r\n      this.registerElement('upper_overlay_pane', img.elem);\r\n      this.registerEventDom(img.elem);\r\n    }\r\n\r\n    img.setStyles({\r\n      width: icon.size.width + 'px',\r\n      height: icon.size.height + 'px',\r\n      marginLeft: -icon.anchor.x + 'px',\r\n      marginTop: -icon.anchor.y + 'px'\r\n    }).setImage(icon.url, icon.origin, icon.scaledSize);\r\n\r\n    this._sizeDiv.setStyles({\r\n      paddingTop: (icon.size.height / 2 - fontSize / 2) + 'px',\r\n      fontSize: fontSize + 'px',\r\n      color: fontColor\r\n    });\r\n  },\r\n\r\n  /**\r\n   *      .\r\n   * @returns {number}    .\r\n   */\r\n  getSize: function () {\r\n    var i, l, child, children, size = this._size;\r\n    if (size == -1) {\r\n      size = 0;\r\n      children = this._children;\r\n      for (i = 0, l = children.length; i < l; i++) {\r\n        child = children[i];\r\n        size += child.getSize ? child.getSize() : 1;\r\n      }\r\n      this._size = size;\r\n    }\r\n    return size;\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @private\r\n   */\r\n  _invalidate: function (depth) {\r\n    var parent = this.parent;\r\n    var areaAdded = this._area && this._area.isAdded();\r\n\r\n    if (areaAdded) {\r\n      this.hideArea();\r\n    }\r\n\r\n    this._size = -1;\r\n    this._bounds = null;\r\n    this._area = null;\r\n\r\n    if (parent && parent._size != -1) {\r\n      parent._invalidate();\r\n    }\r\n\r\n    if (this.isDrawn()) {\r\n      this._updateIcon();\r\n      this._updateSize();\r\n      if (areaAdded) {\r\n        this.showArea();\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   *        .\r\n   * @returns {olleh.maps.Bounds} \r\n   */\r\n  getBounds: function () {\r\n    var markers, i, coord, bounds = this._bounds;\r\n    var minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n\r\n    if (!bounds) {\r\n      if (!this._children.length) {\r\n        return null;\r\n      }\r\n\r\n      markers = this.getAllMarkers();\r\n      for (i = 0; i < markers.length; i++) {\r\n        coord = markers[i].getPosition().asDefault();\r\n        if (minX > coord.x) {\r\n          minX = coord.x;\r\n        }\r\n        if (minY > coord.y) {\r\n          minY = coord.y;\r\n        }\r\n        if (maxX < coord.x) {\r\n          maxX = coord.x;\r\n        }\r\n        if (maxY < coord.y) {\r\n          maxY = coord.y;\r\n        }\r\n      }\r\n\r\n      bounds = this._bounds = new olleh.maps.Bounds(new olleh.maps.UTMK(minX, minY), new olleh.maps.UTMK(maxX, maxY));\r\n    }\r\n\r\n    return bounds;\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * @returns {Array.<olleh.maps.overlay.PointedOverlay>}     \r\n   */\r\n  getChildren: function () {\r\n    return this._children;\r\n  },\r\n\r\n  /**\r\n   * {#getChildren} .\r\n   * @deprecated\r\n   * @returns {Array.<olleh.maps.overlay.PointedOverlay>}     \r\n   */\r\n  getMarkers: function () {\r\n    return this._children;\r\n  },\r\n\r\n  /**\r\n   *       .\r\n   * , <code>getAllMarkers().length == getSize()</code> .\r\n   * @returns {Array.<olleh.maps.overlay.Marker>}   \r\n   */\r\n  getAllMarkers: function () {\r\n    var i, l, children = this._children, result = [];\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n      if (child.getAllMarkers) {\r\n        result = result.concat(child.getAllMarkers());\r\n      } else {\r\n        result.push(child);\r\n      }\r\n    }\r\n    return result;\r\n  },\r\n\r\n  /**\r\n   *    .\r\n   * @returns {olleh.maps.Coord}  \r\n   */\r\n  getCenter: function () {\r\n    var i, coord, x = 0, y = 0;\r\n    var children = this._children, length = children.length;\r\n    for (i = 0; i < length; i++) {\r\n      coord = children[i].getPosition().asDefault();\r\n      x += coord.x;\r\n      y += coord.y;\r\n    }\r\n    return new olleh.maps.UTMK(x / length, y / length);\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.PointedOverlay} child  \r\n   */\r\n  add: function (child) {\r\n    if (child.parent == this) {\r\n      return;\r\n    }\r\n\r\n    if (child.parent) {\r\n      child.parent.remove(child);\r\n    }\r\n\r\n    child.parent = this;\r\n    this._children.push(child);\r\n\r\n    if (this._resetPosition || this._children.length <= 2) {\r\n      this.setPosition(this.getCenter());\r\n    }\r\n\r\n    this._invalidate();\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.PointedOverlay} child  \r\n   */\r\n  remove: function (child) {\r\n    if (child.parent != this) {\r\n      return;\r\n    }\r\n\r\n    child.parent = null;\r\n    child.setMap(null);\r\n    olleh.maps.util.removeFromArray(this._children, child);\r\n\r\n    if (this._resetPosition && this._children.length) {\r\n      this.setPosition(this.getCenter());\r\n    }\r\n\r\n    this._invalidate();\r\n  },\r\n\r\n  expand: function () {\r\n    if (this.maxZoom !== undefined) {\r\n      this.getMap().panTo(this.getPosition(), this.maxZoom + 1);\r\n    } else {\r\n      this.expandToDepth();\r\n    }\r\n  },\r\n\r\n  /**\r\n   *  .          .\r\n   * @param {Number} [depth=1]  .           .\r\n   * @param {olleh.maps.overlay.MarkerCluster} [root]  .      .\r\n   */\r\n  expandToDepth: function (depth, root) {\r\n    var i, l, children, map, rootPx, child;\r\n    var MARKER_ANIMATE_DURATION = this.MARKER_ANIMATE_DURATION;\r\n\r\n    if (this.isMoving()) {\r\n      this.stopAnimators();\r\n    }\r\n\r\n    depth || (depth = 1);\r\n    root || (root = this);\r\n\r\n    map = root.getMap();\r\n    rootPx = root.getOriginalLayerPx();\r\n\r\n    depth--;\r\n\r\n    children = this._children;\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n      if (child.isAdded()) {\r\n        continue;\r\n      }\r\n\r\n      if (child.expandToDepth && depth > 0) {\r\n        child.expandToDepth(depth, root);\r\n      } else {\r\n        if (!child.isAdded()) {\r\n          child.onAdd = this._markerOnAdd.bind(child, rootPx, MARKER_ANIMATE_DURATION);\r\n          child.setMap(map);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.isAdded()) {\r\n      this.hideArea();\r\n      if (this.isDrawn()) {\r\n        this.onRemove = this._clusterOnRemove;\r\n      }\r\n      this.setMap(null);\r\n    }\r\n\r\n    if (this._clickToExpand && !this._clickToZoom && !this.parent) {\r\n      this._originMap = map; //       \r\n      map.onEvent('click', this._onMapClick, this);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   *      <code>maxZoom</code>      .\r\n   * @param {Number} zoom  .\r\n   * @param {olleh.maps.Bounds} [bounds]  .\r\n   * @param {olleh.maps.overlay.MarkerCluster} [root]  .      .\r\n   * @return expand   \r\n   */\r\n  expandToZoom: function (zoom, bounds, root) {\r\n    var i, l, children, map, rootPx, child, result;\r\n    var MARKER_ANIMATE_DURATION = this.MARKER_ANIMATE_DURATION;\r\n\r\n    if (this.isMoving()) {\r\n      this.stopAnimators();\r\n    }\r\n\r\n    root || (root = this);\r\n\r\n    map = root.getMap();\r\n    rootPx = root.getOriginalLayerPx();\r\n\r\n    if (this == root && this.maxZoom >= zoom) {\r\n      return [this];\r\n    }\r\n\r\n    children = this._children;\r\n    result = [];\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n      if (!bounds || bounds.intersects(child.getBounds() || child.getPosition())) {\r\n        if (child.expandToZoom && child.maxZoom < zoom) {\r\n          result = result.concat(child.expandToZoom(zoom, bounds, root));\r\n        } else {\r\n          if (!child.isAdded()) {\r\n            child.onAdd = this._markerOnAdd.bind(child, rootPx, MARKER_ANIMATE_DURATION);\r\n            child.setMap(map);\r\n          }\r\n          result.push(child);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.isAdded()) {\r\n      this.hideArea();\r\n      if (this.isDrawn()) {\r\n        this.onRemove = this._clusterOnRemove;\r\n      }\r\n      this.setMap(null);\r\n    }\r\n\r\n    return result;\r\n  },\r\n\r\n  /**\r\n   *      .         .\r\n   * @param {olleh.maps.Map} map  .\r\n   * @param {olleh.maps.overlay.MarkerCluster} [root]  .      .\r\n   */\r\n  collapse: function (map, root) {\r\n    var i, l, children = this._children, rootPx, child;\r\n    var MARKER_ANIMATE_DURATION = this.MARKER_ANIMATE_DURATION;\r\n\r\n    if (this.isMoving()) {\r\n      this.stopAnimators();\r\n    }\r\n\r\n    root || (root = this);\r\n\r\n    rootPx = map.layerMgr.getLayerPxFromCoord(root.getPosition()); // root setMap  getOriginalLayerPx  \r\n\r\n    for (i = 0, l = children.length; i < l; i++) {\r\n      child = children[i];\r\n\r\n      if (child.isAdded()) {\r\n        if (child.isDrawn()) {\r\n          child.onRemove = this._markerOnRemove.bind(child, rootPx, MARKER_ANIMATE_DURATION);\r\n        }\r\n        child.setMap(null);\r\n      } else if (child.collapse) {\r\n        child.collapse(map, root);\r\n      }\r\n    }\r\n\r\n    if (this == root) {\r\n      this.onAdd = this._clusterOnAdd;\r\n      this.setMap(map);\r\n    }\r\n\r\n    if (this._originMap) {\r\n      map.unsubscribeEvent('click', this._onMapClick, this);\r\n      this._originMap = null;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *        .\r\n   * @returns {olleh.maps.vector.Polygon} \r\n   */\r\n  getArea: function () {\r\n    var area = this._area;\r\n\r\n    if (!area) {\r\n      var i, l;\r\n      var markerCoords = [], pathCoords = [];\r\n      var markers = this.getAllMarkers();\r\n\r\n      for (i = 0, l = markers.length; i < l; i++) {\r\n        markerCoords.push(markers[i].getPosition().asDefault());\r\n      }\r\n\r\n      var convexHull = Quickhull.getConvexHull(markerCoords);\r\n\r\n      for (i = 0, l = convexHull.length; i < l; i++) {\r\n        pathCoords.push(convexHull[i][0]);\r\n      }\r\n\r\n      area = new olleh.maps.vector.Polygon(this._areaStyle);\r\n      area.setPaths(new olleh.maps.Path(pathCoords));\r\n      this._area = area;\r\n    }\r\n\r\n    return area;\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  showArea: function () {\r\n    var area = this.getArea();\r\n    if (!area.isAdded()) {\r\n      area.setMap(this.map);\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   */\r\n  hideArea: function () {\r\n    if (this._area) {\r\n      this._area.setMap(null);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  $default_click: function () {\r\n    this.expand();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  $default_mouseover: function () {\r\n    if (this._displayArea) {\r\n      this.showArea();\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  $default_mouseout: function () {\r\n    this.hideArea();\r\n  },\r\n\r\n  /**\r\n   *     \r\n   * @private\r\n   */\r\n  _onMapClick: function (event) {\r\n    if (event.getSource() instanceof olleh.maps.layer.LayerManager) {\r\n      this.collapse(this._originMap);\r\n    }\r\n  },\r\n\r\n  _clusterReady: function () {\r\n    this.setVisible(true);\r\n    this.ready();\r\n  },\r\n\r\n  _clusterOnAdd: function () {\r\n    this.setVisible(false);\r\n    olleh.maps.util.delay(this._clusterReady, this.MARKER_ANIMATE_DURATION * 1000, this);\r\n    delete this.onAdd;\r\n  },\r\n\r\n  _clusterOnRemove: function () {\r\n    olleh.maps.util.defer(this.cleanup, this);\r\n    delete this.onRemove;\r\n  },\r\n\r\n  _markerOnRemove: function (rootPx, duration) {\r\n    this.moveTo(rootPx, duration, false, this.cleanup);\r\n    delete this.onRemove;\r\n  },\r\n\r\n  _markerOnAdd: function (rootPx, duration) {\r\n    this.moveTo(rootPx);\r\n    this.moveTo(this.getOriginalLayerPx(), duration, false, this.ready);\r\n    delete this.onAdd;\r\n  },\r\n\r\n  attach: function () {\r\n    this.hideArea();\r\n    olleh.maps.overlay.MarkerCluster.$super.attach.apply(this, arguments);\r\n  },\r\n\r\n  detach: function () {\r\n    this.hideArea();\r\n    olleh.maps.overlay.MarkerCluster.$super.detach.apply(this, arguments);\r\n  }\r\n\r\n});\r\n/**\r\n * MarkerClustererOptions Object Specification\r\n * @typedef olleh.maps.overlay.MarkerClustererOptions\r\n * @property {number} [minZoom=0]    .\r\n * @property {number} [maxZoom=12]    .\r\n * @property {number} [gap=200]   .      .\r\n * @property {olleh.maps.overlay.MarkerClusterOptions} [clusterOpts]     . , <code>clickToZoom</code>  <code>resetPosition</code>  <code>true</code> .\r\n * @property {function} [afterCluster]     .\r\n * @property {function} [getDistance]     .\r\n * @property {function} [getThreshold]     .\r\n */\r\n\r\n/**\r\n *   .<br/>\r\n *        .\r\n *           ,\r\n *        .\r\n * @example\r\n * var map = new olleh.maps.Map(document.getElementById('map'), {\r\n *   center: new olleh.maps.UTMK(953755.70, 1949715.52),\r\n *   zoom: 8\r\n * });\r\n * var clusterer = new olleh.maps.overlay.MarkerClusterer();\r\n * clusterer.add(marker1); // marker.setMap()  .\r\n * clusterer.add(marker2);\r\n * clusterer.add(marker3);\r\n * clusterer.setMap(map); // marker1~3   .\r\n * clusterer.add(marker4); //  setMap()      . \r\n * clusterer.add(marker5);\r\n * clusterer.setMap(null); // marker1~5  .\r\n */\r\n$class('olleh.maps.overlay.MarkerClusterer').mixin(olleh.maps.Plugin).define({\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.MarkerClustererOptions} opts  .\r\n   */\r\n  MarkerClusterer: function (opts) {\r\n    opts || (opts = {});\r\n\r\n    this.pluginInfo = olleh.maps.mixin({\r\n      autoActivate: true\r\n    }, opts.pluginInfo, true);\r\n\r\n    this._clusterOpts = olleh.maps.util.clone(opts.clusterOpts) || {};\r\n    if (!opts.clusterOpts || opts.clusterOpts.clickToZoom === undefined) {\r\n      this._clusterOpts.clickToZoom = true;\r\n    }\r\n    this._clusterOpts.clickToExpand = false;\r\n    this._clusterOpts.resetPosition = true;\r\n    this._minZoom = opts.minZoom || 0;\r\n    this._maxZoom = opts.maxZoom || 12;\r\n    this._gap = opts.gap || 100;\r\n    this._getDistance = opts.getDistance || this.defaultGetDistance;\r\n    this._getThreshold = opts.getThreshold || this.defaultGetThreshold;\r\n    this._afterCluster = opts.afterCluster || null;\r\n\r\n    this._displayed = [];\r\n    this._zoom = -2;\r\n\r\n    this._bound_onClusterPositionChanged = this._onClusterPositionChanged.bind(this);\r\n    this.clear();\r\n  },\r\n\r\n  /**\r\n   *     .\r\n   */\r\n  clear: function () {\r\n    var i, l, markers = this._displayed;\r\n    var LayerManager = olleh.maps.layer.LayerManager;\r\n\r\n    for (i = 0, l = markers.length; i < l; i++) {\r\n      markers[i].setMap(null);\r\n    }\r\n    this._displayed = [];\r\n\r\n    this._rootCluster = new olleh.maps.overlay.MarkerCluster();\r\n    this._rootCluster.minZoom = -1;\r\n    this._rootCluster.maxZoom = -1;\r\n\r\n    for (i = 0, l = this._index ? this._index.length : 0; i < l; i++) {\r\n        this._index[i] && this._index[i].clear();\r\n    }\r\n    this._index = [];\r\n\r\n    for (i = this._minZoom, l = this._maxZoom + 2; i < l; i++) {\r\n      this._index[i] = new olleh.maps.overlay.GridIndex(256 * LayerManager.getResolutionForZoom(i));\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   * @param {olleh.maps.overlay.Marker} otherMarker\r\n   * @param {number} zoom\r\n   * @returns {number}\r\n   */\r\n  defaultGetDistance: function (marker, otherMarker, zoom) {\r\n    return marker.getPosition().distanceTo(otherMarker.getPosition());\r\n  },\r\n  \r\n  /**\r\n   * @private\r\n   * @param {number} zoom\r\n   * @returns {number}\r\n   */\r\n  defaultGetThreshold: function (zoom) {\r\n    return this._gap * olleh.maps.layer.LayerManager.getResolutionForZoom(zoom);\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  remove: function (marker) {\r\n    var parent, grandparent, sibling, children;\r\n\r\n    if (!marker || !this._index[this._maxZoom + 1].contains(marker)) {\r\n      return;\r\n    }\r\n\r\n    this._removeFromIndex(marker, marker.minZoom, marker.maxZoom);\r\n\r\n    parent = marker.parent;\r\n    parent.remove(marker);\r\n    children = parent.getChildren();\r\n\r\n    //         \r\n    //         \r\n    if (parent != this._rootCluster && children.length == 1) {\r\n      grandparent = parent.parent;\r\n      sibling = children[0];\r\n\r\n      sibling.minZoom = parent.minZoom;\r\n\r\n      this._removeFromIndex(parent, parent.minZoom, parent.maxZoom);\r\n      this._addToIndex(sibling, parent.minZoom, parent.maxZoom);\r\n\r\n      grandparent.remove(parent);\r\n      grandparent.add(sibling);\r\n      parent.unsubscribeEvent('position_changed', this._bound_onClusterPositionChanged);\r\n\r\n      parent = grandparent;\r\n    }\r\n  },\r\n\r\n  /**\r\n   *   .\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  add: function (marker) {\r\n    var cluster, minZoom, parent;\r\n    var closest = null, zoom = this._maxZoom;\r\n\r\n    if (!marker || this._index[this._maxZoom + 1].contains(marker)) {\r\n      return;\r\n    }\r\n\r\n    if (marker.isAdded()) {\r\n      marker.setMap(null);\r\n    }\r\n\r\n    while (zoom >= this._minZoom) {\r\n      closest = this._getClosest(marker, zoom);\r\n      if (closest) {\r\n        break;\r\n      }\r\n      zoom--;\r\n    }\r\n\r\n    if (!closest) { //  \r\n      this._rootCluster.add(marker);\r\n    } else {\r\n      if (closest.add && closest.maxZoom == zoom) { //     ,  \r\n        closest.add(marker);\r\n      } else { //      \r\n        minZoom = closest.minZoom;\r\n        parent = closest.parent;\r\n\r\n        this._removeFromIndex(closest, closest.minZoom, zoom);\r\n        closest.minZoom = zoom + 1;\r\n\r\n        cluster = new olleh.maps.overlay.MarkerCluster(this._clusterOpts);\r\n        cluster.minZoom = minZoom;\r\n        cluster.maxZoom = zoom;\r\n\r\n        cluster.add(closest);\r\n        cluster.add(marker);\r\n        if (this._afterCluster) {\r\n          this._afterCluster(cluster);\r\n        }\r\n\r\n        this._addToIndex(cluster, cluster.minZoom, cluster.maxZoom);\r\n\r\n        cluster.onEvent('position_changed', this._bound_onClusterPositionChanged);\r\n\r\n        parent.add(cluster);\r\n      }\r\n    }\r\n\r\n    marker.minZoom = zoom + 1;\r\n    marker.maxZoom = this._maxZoom + 1;\r\n    this._addToIndex(marker, marker.minZoom, marker.maxZoom);\r\n  },\r\n  \r\n  _getClosest: function (marker, zoom) {\r\n    var position = marker.getPosition();\r\n    var meter = this.defaultGetThreshold(zoom) * 2;\r\n    var bounds = new olleh.maps.Bounds(position, position).expand(meter, meter);\r\n    var overlays = this._index[zoom].getOverlays(bounds);\r\n    var threshold = this._getThreshold(zoom);\r\n    var i, l, distance, minDistance = Infinity, closest = null, overlay;\r\n\r\n    for (i = 0, l = overlays.length; i < l; i++) {\r\n      overlay = overlays[i];\r\n      distance = this._getDistance(marker, overlay, zoom);\r\n      if (distance < minDistance && distance < threshold) {\r\n        minDistance = distance;\r\n        closest = overlay;\r\n      }\r\n    }\r\n\r\n    return closest;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  _addToIndex: function (marker, minZoom, maxZoom) {\r\n    var i, zoom = this._zoom;\r\n    for (i = minZoom; i <= maxZoom; i++) {\r\n      if (this.map && i == zoom && !marker.isAdded()) {\r\n        marker.setMap(this.map);\r\n        this._displayed.push(marker);\r\n      }\r\n      this._index[i].add(marker, marker.getPosition());\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.Marker} marker\r\n   */\r\n  _removeFromIndex: function (marker, minZoom, maxZoom) {\r\n    var i, zoom = this._zoom;\r\n\r\n    for (i = minZoom; i <= maxZoom; i++) {\r\n      if (this.map && i == zoom && marker.isAdded()) {\r\n        marker.setMap(null);\r\n        this._displayed.splice(olleh.maps.util.indexOf(this._displayed, marker), 1);\r\n      }\r\n      this._index[i].remove(marker, marker.getPosition());\r\n    }\r\n  },\r\n\r\n  /**\r\n   *    <code>minZoom</code> <code>maxZoom</code>   .\r\n   * @private\r\n   */\r\n  _getAdjustedZoom: function () {\r\n    if (!this.map) {\r\n      return -2;\r\n    }\r\n\r\n    var zoom = this.map.getZoom();\r\n    if (zoom < this._minZoom) {\r\n      zoom = this._minZoom;\r\n    } else if (zoom > this._maxZoom + 1) {\r\n      zoom = this._maxZoom + 1;\r\n    }\r\n\r\n    return zoom;\r\n  },\r\n\r\n  doActivate: function () {\r\n    var i, l, markers, marker, map = this.map;\r\n    var zoom = this._getAdjustedZoom();\r\n    var bounds = map.layerMgr.getOverlayLayer().getBounds();\r\n\r\n    this._zoom = zoom;\r\n    this._bounds = bounds;\r\n\r\n    this._displayed = this._index[zoom].getOverlays(bounds);\r\n    for (i = 0, l = this._displayed.length; i < l; i++) {\r\n      this._displayed[i].setMap(map);\r\n    }\r\n\r\n    map.onEvent('overlay_layer_bounds_changed', this._onboundschanged, this);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var i, l, markers, map = this.map;\r\n\r\n    this._zoom = -2;\r\n    this._bounds = null;\r\n\r\n    for (i = 0, l = this._displayed.length; i < l; i++) {\r\n      this._displayed[i].setMap(null);\r\n    }\r\n    this._displayed = [];\r\n\r\n    map.unsubscribeEvent('overlay_layer_bounds_changed', this._onboundschanged, this);\r\n  },\r\n\r\n  _onClusterPositionChanged: function (e, payload) {\r\n    var i, marker = e.getSource();\r\n    for (i = marker.minZoom; i <= marker.maxZoom; i++) {\r\n      this._index[i].remove(marker, payload.from);\r\n      this._index[i].add(marker, payload.to);\r\n    }\r\n  },\r\n\r\n  _onboundschanged: function (event, payload) {\r\n    var oldZoom = this._zoom, zoom = this._getAdjustedZoom();\r\n    this._bounds = payload.to;\r\n    if (oldZoom == zoom) {\r\n      this._updateBounds();\r\n    } else {\r\n      this._zoom = zoom;\r\n      this._updateZoom(oldZoom < zoom ? this._expand : this._collapse);\r\n    }\r\n  },\r\n\r\n  _updateBounds: function () {\r\n    var marker, map = this.map, oldMarkers = this._displayed;\r\n    var newMarkers = this._index[this._zoom].getOverlays(this._bounds);\r\n\r\n    for (var i = 0; i < newMarkers.length; i++) {\r\n      marker = newMarkers[i];\r\n      if (marker.isAdded()) {\r\n        oldMarkers[olleh.maps.util.indexOf(oldMarkers, marker)] = null;\r\n      } else {\r\n        marker.setMap(map);\r\n      }\r\n    }\r\n\r\n    for (var i = 0; i < oldMarkers.length; i++) {\r\n      marker = oldMarkers[i];\r\n      if (marker) {\r\n        marker.setMap(null);\r\n      }\r\n    }\r\n\r\n    this._displayed = newMarkers;\r\n  },\r\n\r\n  _updateZoom: function (fn) {\r\n    this._displayed = this._recursevely(this._rootCluster, fn);\r\n    // zoom    .\r\n    this._hideNonDisplayedMarkers(this._rootCluster);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {olleh.maps.overlay.MarkerCluster} markCluster\r\n   */\r\n  _hideNonDisplayedMarkers: function(cluster){\r\n    //  _displayed     .\r\n    if (cluster.isDrawn() && (olleh.maps.util.indexOf(this._displayed, cluster) === -1)){\r\n      cluster.setMap(null);\r\n    }\r\n    // children \r\n    if (!cluster.getChildren) return;\r\n    \r\n    var children = cluster.getChildren();\r\n    for (var i = 0, childCnt = children.length ; i < childCnt; i++){\r\n      this._hideNonDisplayedMarkers(children[i]);\r\n    }\r\n  },\r\n\r\n  _recursevely: function (cluster, fn) {\r\n    var map = this.map, zoom = this._zoom, bounds = this._bounds;\r\n    var i, child, result = [], children = cluster.getChildren();\r\n    for (i = 0; i < children.length; i++) {\r\n      child = children[i];\r\n      if (bounds.intersects(child.getBounds() || child.getPosition())) {\r\n        if (child.getChildren) {\r\n          //    expand/collapse.\r\n          result = result.concat(fn.call(this, child, zoom, bounds));\r\n        } else {\r\n          //     setMap().   \r\n          // !isVisibleAtZoom    min/max zoom\r\n          //   .\r\n          if (!child.isAdded()) {\r\n            child.setMap(map);\r\n          }\r\n          result.push(child);\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  },\r\n\r\n  _expand: function (cluster, zoom, bounds) {\r\n    if (cluster.isAdded()) {\r\n      return cluster.expandToZoom(zoom, bounds);\r\n    }\r\n    if (cluster.isVisibleAtZoom(zoom)) {\r\n      cluster.setMap(this.map);\r\n      return cluster;\r\n    }\r\n    return this._recursevely(cluster, this._expand);\r\n  },\r\n\r\n  _collapse: function (cluster, zoom, bounds) {\r\n    if (cluster.isVisibleAtZoom(zoom)) {\r\n      cluster.collapse(this.map);\r\n      return cluster;\r\n    }\r\n    if (cluster.maxZoom == -1 || cluster.maxZoom < zoom) {\r\n      return this._recursevely(cluster, this._collapse);\r\n    }\r\n    return [];\r\n  }\r\n\r\n});\r\n/**\r\n *   ,     \r\n * <ul>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragstart|dragstart}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:drag|drag}</li>\r\n *   <li>{@link olleh.maps.event.EventDelegator#event:dragend|dragend}</li>\r\n * </ul>\r\n *      .\r\n * @summary <code>dragstart</code>, <code>drag</code>, <code>dragend</code>    ,   .\r\n */\r\n$class('olleh.maps.event.Drag').mixin(olleh.maps.event.Recognizer).define({\r\n\r\n  /**\r\n   * ,  Drag  .\r\n   */\r\n  Drag: function () {\r\n    this._mousedown = false;\r\n    this._startEvent = null;\r\n    this._isDragStart = false;\r\n    this._isDragging = false;\r\n    this._xy = null;\r\n\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousedown: function (event) {\r\n    if (this._isDragStart && this._isDragging) {\r\n      return this.mouseup(event);\r\n    }\r\n    if (olleh.maps.event.EventManager.isRightClick(event.originEvent)) {\r\n       this._reset();\r\n       return;\r\n    }\r\n    this._mousedown = true;\r\n    this._startEvent = event;\r\n    this._isDragStart = false;\r\n    this._isDragging = false;\r\n    \r\n    // movementXY    pageXY .\r\n    // http://dvcs.w3.org/hg/pointerlock/raw-file/default/index.html#idl-def-MouseEvent\r\n    this._xy = event.pageXY;\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousemove: function (event) {\r\n    if (!this._mousedown) return;\r\n    \r\n    var domEvent = event.originEvent;\r\n    var startEvent = this._startEvent;\r\n    var prevXY = this._xy;\r\n    \r\n    this._xy = event.pageXY;\r\n    \r\n    var movementXY = this._xy.subtract(prevXY);\r\n    \r\n    if (movementXY.x === 0 && movementXY.y === 0) {\r\n      event.stopPropagation();\r\n      return;\r\n    } else if (!this._isDragStart) {\r\n\r\n      if (startEvent.getSource() !== event.getSource()) return this._reset();\r\n      \r\n      this._isDragStart = true;\r\n      /**\r\n       * dragstart \r\n       * <p/>\r\n       *   mousedown & mousemove   dragstart  .\r\n       *   touchstart & touchmove   dragstart  .\r\n       * @event olleh.maps.event.EventDelegator#event:dragstart\r\n       * @param {olleh.maps.event.Event} event\r\n       */\r\n      return {\r\n        name: 'dragstart', \r\n        opts: {\r\n          originEvent: domEvent, \r\n          targetDOM: startEvent.targetDOM, \r\n          pageXY: event.pageXY\r\n        }\r\n      };\r\n    }\r\n    this._isDragging = true;\r\n    /**\r\n     * drag \r\n     * <p/>\r\n     * dragstart   \r\n     *   mousemove   drag  .\r\n     *   touchmove   drag  .\r\n     * @event olleh.maps.event.EventDelegator#event:drag\r\n     * @param {olleh.maps.event.Event} event\r\n     * @param {Object} payload\r\n     * @param {Number} payload.movementXY  <p/> drag {@link olleh.maps.event.Event#pageXY}  {@link olleh.maps.event.Event#pageXY} . \r\n     * @see http://dvcs.w3.org/hg/pointerlock/raw-file/default/index.html#idl-def-MouseEvent|w3c mouse event\r\n     */\r\n    return {\r\n      name: 'drag', \r\n      src: startEvent.getSource(), \r\n      opts: {\r\n        originEvent: domEvent, \r\n        pageXY: event.pageXY,\r\n        targetDOM: startEvent.targetDOM\r\n      },\r\n      payload: {movementXY: movementXY}\r\n    };\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mouseup: function (event) {\r\n    if (!this._mousedown || !this._isDragStart) {\r\n      return this._reset();\r\n    }\r\n    var domEvent = event.originEvent;\r\n    var startEvent = this._startEvent;\r\n    var prevXY = this._xy;\r\n    var movementXY = event.pageXY.subtract(prevXY);\r\n    \r\n    olleh.maps.event.EventManager.preventDefault(domEvent);\r\n    this._reset();\r\n    this._isDragging = true;\r\n    /**\r\n     * drag \r\n     * <p/>\r\n     * drag   \r\n     *   mouseup   dragend  .\r\n     *   touchend   dragend  .\r\n     * @event olleh.maps.event.EventDelegator#event:dragend\r\n     * @param {olleh.maps.event.Event} event\r\n     * @param {Object} payload\r\n     * @param {Number} payload.movementXY  <p/> drag {@link olleh.maps.event.Event#pageXY}  {@link olleh.maps.event.Event#pageXY} . \r\n     * @see http://dvcs.w3.org/hg/pointerlock/raw-file/default/index.html#idl-def-MouseEvent|w3c mouse event\r\n     */\r\n    return {\r\n      name: 'dragend', \r\n      src: startEvent.getSource(),\r\n      opts: {\r\n        originEvent: domEvent, pageXY: event.pageXY,\r\n        targetDOM: startEvent.targetDOM\r\n      },\r\n      payload: {movementXY: movementXY}\r\n    };\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  click: function (event) {\r\n    if (this._isDragging) {\r\n      var domEvent = event.originEvent;\r\n      event.stopPropagation();\r\n      olleh.maps.event.EventManager.preventDefault(domEvent);\r\n    }\r\n    this._reset(); // reset          \r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  touchstart: function (event) {\r\n    var touches = event.touches;\r\n    if (!touches || touches.length !== 1) return this._reset();\r\n    return this.mousedown(event);\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  touchmove: function (event) {\r\n    var touches = event.touches;\r\n    var result;\r\n    \r\n    if (!touches || touches.length !== 1) return this._reset();\r\n    if (result = this.mousemove(event)) {\r\n      olleh.maps.event.EventManager.preventDefault(event.originEvent);\r\n    }\r\n    return result;\r\n  },\r\n\r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  touchend: function (event) {\r\n    return this.mouseup(event);\r\n  },\r\n  \r\n  /**\r\n   *  trackking .\r\n   * @private\r\n   */\r\n  _reset: function () {\r\n    this._mousedown = false;\r\n    this._startEvent = null;\r\n    this._isDragStart = false;\r\n    this._isDragging = false;\r\n    this._xy = null;\r\n  }\r\n});/**\r\n * drag   {@link olleh.maps.Map}     .\r\n * \r\n * {@link olleh.maps.Map}  <code>olleh.maps.handler.Drag.prototype</code> mixin .\r\n * @example\r\n *   \r\n * olleh.maps.mixin(map, olleh.maps.handler.Drag.prototype, true);\r\n *   \r\n * for(var key in olleh.maps.handler.Drag.prototype) {\r\n *   delete map[key];\r\n * }\r\n * @private\r\n */\r\n$class('olleh.maps.handler.Drag').define({\r\n  \r\n  $static: {\r\n    // Drag   map option  default  map options  mixin .\r\n    attach: function(map) {\r\n      map.mergeDefaultOptions({\r\n        dragInertia: true,\r\n        dragInertiaThreshold: olleh.maps.browser.isMobile ? 45 : 65,\r\n        dragInertiaDeceleration: olleh.maps.browser.isMobile ? 4000 : 4500\r\n      });\r\n    }\r\n  },\r\n  \r\n  _zeroPoint: new olleh.maps.Point(0,0),\r\n  \r\n  $default_dragstart: function (event, payload) {\r\n    var point = event.getPoint();\r\n\r\n    if (!point) return;\r\n    \r\n    olleh.maps.util.dom.addClass(this._root_pane, 'ollehmap-drag');\r\n    if(!this._map.getOption('disableDraggingCursor'))\r\n      this._map.setCursor('dragging');\r\n    if(this._opts.dragInertia) {\r\n      this._times = [];\r\n      this._points = [];\r\n    }\r\n  },\r\n  \r\n  $default_drag: function (event, payload) {\r\n    var point = event.getPoint();\r\n    \r\n    if (!point) return;\r\n    var movementXY = payload.movementXY;\r\n    var newCenter = this.calcNewCenter(-movementXY.x, -movementXY.y);\r\n    this.moveTo(newCenter, null, 'off');\r\n    \r\n    if(this._opts.dragInertia) {\r\n      var time = event.timeStamp;\r\n      this._times.push(time);\r\n      this._points.push(point);\r\n    }\r\n  },\r\n  \r\n  $default_dragend: function (event, payload) {\r\n    var opts = this._opts;\r\n    var time = event.timeStamp;\r\n    var lastIndex = this._times.length - 1;\r\n    var i = Math.max(0, Math.min(lastIndex, 3)); // i  delay     event   index\r\n    var prevTime = this._times[lastIndex - i] || time;\r\n    var delay = time - prevTime; //  i event   event  delay\r\n    \r\n    if(opts.dragInertia && delay / (i + 1) < opts.dragInertiaThreshold) {\r\n      var direction = delay === 0 ? payload.movementXY : event.getPoint().subtract(this._points[lastIndex - i]);\r\n      var momentum = this._momentum(delay, direction);\r\n      var newCenter = this.calcNewCenter(momentum.x, momentum.y);\r\n      this.moveTo(newCenter, null, 'on', momentum.duration);\r\n    }\r\n    olleh.maps.util.dom.removeClass(this._root_pane, 'ollehmap-drag');\r\n    if(!this._map.getOption('disableDraggingCursor'))\r\n      this._map.resetCursor();\r\n  },\r\n  \r\n  \r\n  _momentum: function (delay, direction) {\r\n    var opts = this._opts;\r\n    var easeLinearity = opts.panAnimEaseLinearity2 || 0.25;\r\n    var inertiaDeceleration = opts.dragInertiaDeceleration;\r\n    var duration = delay / 1000 || 0.1; // 0.1     .\r\n    var speedVector = direction.multiplyBy(easeLinearity / duration);\r\n    var speed = speedVector.distanceTo(this._zeroPoint);\r\n    speed = Math.min(speed, 2500); //       speed \r\n    var deccelerationDuration = speed / (inertiaDeceleration * easeLinearity);\r\n    var offset = speedVector.multiplyBy(-deccelerationDuration / 2)._round();\r\n    return {x: offset.x, y: offset.y, duration: deccelerationDuration};\r\n  }\r\n  \r\n});\r\n/**\n * {@link olleh.maps.event.EventDelegator#event:req_zoomin}, {@link olleh.maps.event.EventDelegator#event:req_zoomout}\n *    .\n * @private\n */\n$class('olleh.maps.handler.Zoom').define({\n  \n  /**\n   * @param {Number}\n   * @param {olleh.maps.Point}\n   * @private\n   */\n  _calcZoomCenter: function (zoom, mousePx) {\n    var viewportCenter = this.getViewportCenter();\n    var scale = this._getScaleForZoom(zoom);\n    // mouse cursor     1-1/scale  , 1-1/scale  ?\n    var centerOffsetPx = mousePx.subtract(viewportCenter)._multiplyBy(\n        1 - 1 / scale);\n    var newCenterPx = viewportCenter._add(centerOffsetPx);\n    var coord = this.getCoordFromViewportPx(newCenterPx, false);\n    return coord;\n  },\n\n  /**\n   * @param {Number} zoom\n   * @returns {Boolean}\n   * @private\n   */\n  _checkZoomLevel: function (zoom) {\n    var minZoom = this.getMinZoom();\n    var maxZoom = this.getMaxZoom();\n    return minZoom <= zoom && zoom <= maxZoom;\n  },\n\n  $default_req_zoomin: function (event, payload) {\n    var zoom = this.getPendingZoom() + 1;\n\n    event.stopPropagation();\n\n    if (!this._checkZoomLevel(zoom))\n      return;\n\n    var mousePx = event.getPoint();\n    if (!mousePx)\n      return this.zoomIn(); // keyboardZoom   .\n    var coord = this._calcZoomCenter(zoom, mousePx);\n    this.panTo(coord, zoom);\n  },\n\n  $default_req_zoomout: function (event, payload) {\n    var zoom = this.getPendingZoom() - 1;\n\n    event.stopPropagation();\n    if (!this._checkZoomLevel(zoom))\n      return;\n    var mousePx = event.getPoint();\n    if (!mousePx)\n      return this.zoomOut(); // keyboardZoom   .\n    var coord = this._calcZoomCenter(zoom, mousePx);\n    this.panTo(coord, zoom);\n  }\n\n});\n/**\r\n * dblclick   {@link olleh.maps.Map}     .\r\n * \r\n * {@link olleh.maps.Map}  <code>olleh.maps.handler.DoubleClickZoom.prototype</code> mixin .\r\n * @example\r\n *   \r\n * olleh.maps.mixin(map, olleh.maps.handler.DoubleClickZoom.prototype, true);\r\n *   \r\n * for(var key in olleh.maps.handler.DoubleClickZoom.prototype) {\r\n *   delete map[key];\r\n * }\r\n * @private\r\n */\r\n$class('olleh.maps.handler.DoubleClickZoom').define({\r\n  $default_dblclick: function (event) {\r\n    return !this._opts.disableDoubleClickZoom && olleh.maps.handler.Zoom.\r\n      prototype['$default_req_zoomin'].apply(this, arguments);\r\n  },\r\n  \r\n  $default_dblrightclick: function (event) {\r\n    return !this._opts.disableDoubleClickZoom && olleh.maps.handler.Zoom.\r\n      prototype['$default_req_zoomout'].apply(this, arguments);\r\n  }\r\n});/**\n * @private\n */\n$class('olleh.maps.plugin.DefautlHandlers').extend(olleh.maps.Adaptable).define({\n  \n  $static: {\n    HANDLERS: [\n      olleh.maps.handler.Drag, \n      olleh.maps.handler.Zoom\n    ]\n  },\n  \n  attach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.DefautlHandlers.HANDLERS;\n    var i = handlers.length;\n    \n    eventMgr.addRecognizer(new olleh.maps.event.Drag());\n\n    if(!map.getOption('disableDoubleClickZoom')) \n      olleh.maps.event.handler.attach(layerMgr, \n          olleh.maps.handler.DoubleClickZoom);\n    \n    while(i--) {\n      olleh.maps.event.handler.attach(layerMgr, handlers[i]);\n    }\n    olleh.maps.handler.Drag.attach(map);\n  },\n  \n  detach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.DefautlHandlers.HANDLERS;\n    var i = handlers.length;\n    \n    eventMgr.removeRecognizer('olleh.maps.event.Drag');\n\n    if(!map.getOption('disableDoubleClickZoom'))\n      olleh.maps.event.handler.detach(layerMgr, \n          olleh.maps.handler.DoubleClickZoom);\n\n    while(i--) {\n      olleh.maps.event.handler.detach(layerMgr, handlers[i]);\n    }\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.DefautlHandlers);\n/**\r\n *     <code>dblclick</code>      .\r\n *    recognizer .\r\n * @summary <code>dblclick</code>      .\r\n */\r\n$class('olleh.maps.event.DoubleClick').mixin(olleh.maps.event.Recognizer).define({\r\n\r\n  /**\r\n   * ,  DoubleClick  .\r\n   * @param {Object} [opts] zoom \r\n   * @param {Boolean} [opts.dblrightclick=true] \r\n   * @param {Number} [opts.clickThreshold=4]    (px)\r\n   * @param {Number} [opts.clickDuration=400]    timestamp(ms) \r\n   */\r\n  DoubleClick: function (opts) {\r\n    this.isDblclicked = false;\r\n    this._history = {};\r\n    this.opts = olleh.maps.mixin({\r\n      clickThreshold: 4,\r\n      dblrightclick: true,\r\n      clickDuration: 400\r\n    }, opts, true);\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   *  .\r\n   * @param {Object} [opts] \r\n   * @param {Boolean} [opts.dblrightclick=true] \r\n   * @param {Number} [opts.clickThreshold=4]    (px).\r\n   * @param {Number} [opts.clickDuration=400]    timestamp(ms). \r\n   */\r\n  setOptions: function (opts) {\r\n    opts && olleh.maps.mixin(this.opts, opts, true, \r\n        ['dblrightclick', 'clickThreshold', 'clickDuration']);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousedown: function (event) {\r\n    var prevClick = this._history['click'];\r\n    \r\n    this.isDblclicked = false;\r\n    \r\n    if (!prevClick) return;\r\n    if (event.timeStamp - prevClick.timeStamp > this.opts.clickDuration) {\r\n      this._history['click'] = null;\r\n      return;\r\n    }\r\n\r\n    this._history['mouse'] = {\r\n      timeStamp: event.timeStamp,\r\n      pageXY: event.pageXY,\r\n      button: event.originEvent.button\r\n    };\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mouseup: function (event) {\r\n    var prevClick = this._history['click'];\r\n    var domEvent = event.originEvent;\r\n\r\n    if (!this.isDblclicked && this.opts.dblrightclick && !prevClick && \r\n        olleh.maps.event.EventManager.isRightClick(event.originEvent)) {\r\n      return this.click(event);\r\n    } else if (!prevClick) {\r\n      return;\r\n    }\r\n    var click = this._history['mouse'] || {pageXY: event.pageXY, \r\n      button: domEvent.button === 1 ? 0 : 2};\r\n\r\n    this._history['click'] = null;\r\n    this._history['mouse'] = null;\r\n    \r\n    if (prevClick && prevClick.button === click.button &&\r\n        prevClick.pageXY.distanceTo(click.pageXY) < this.opts.clickThreshold) {\r\n      this.isDblclicked = true;\r\n      return {name: click.button === 2 ? 'dblrightclick' : 'dblclick', opts: {originEvent: domEvent}};\r\n    }\r\n    return;\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  click: function (event) {\r\n    if (this.isDblclicked) {\r\n      this.isDblclicked = false;\r\n      return;\r\n    }\r\n    this._history['click'] = {\r\n      timeStamp: event.timeStamp,\r\n      pageXY: event.pageXY,\r\n      button: event.originEvent.button\r\n    };\r\n  }\r\n});/**\r\n *      <code>rightclick</code>      .\r\n * <p/>\r\n *    recognizer . \r\n * @summary <code>rightclick</code>      .\r\n */\r\n$class('olleh.maps.event.RightClick').mixin(olleh.maps.event.Recognizer).define({\r\n  \r\n  /**\r\n   * ,  RightClick  .\r\n   */\r\n  RightClick: function () {\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mouseup: function (event) {\r\n    var domEvent = event.originEvent;\r\n    return olleh.maps.event.EventManager.isRightClick(domEvent) ? \r\n        {name: 'rightclick', opts: {originEvent: domEvent}} : null; \r\n  }\r\n});/**\r\n *   <code>req_zoomin</code>, <code>req_zoomout</code>      .\r\n * <p/>\r\n *    recognizer .\r\n * @summary <code>req_zoomin</code>, <code>req_zoomout</code>        .\r\n */\r\n$class('olleh.maps.event.ScrollWheelZoom').mixin(olleh.maps.event.Recognizer).define({\r\n  \r\n  /**\r\n   * ,  ScrollWheelZoom  .\r\n   */\r\n  ScrollWheelZoom: function () {\r\n    this._timeStamp = null;\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  mousewheel: function (event) { // mousewheel, DOMMouseScroll\r\n    var domEvent = event.originEvent;\r\n    var delta = domEvent.wheelDelta || -domEvent.detail;  // FF:detail\r\n    var timeStamp = this._timeStamp;\r\n\r\n    this._timeStamp = event.timeStamp;\r\n    \r\n    if (timeStamp && event.timeStamp - timeStamp < 100) {\r\n      return null;\r\n    }\r\n    return {name: delta > 0 ? 'req_zoomin' : 'req_zoomout', opts: {originEvent: domEvent}};\r\n  }\r\n});/**\r\n *  +, -   <code>req_zoomin</code>, <code>req_zoomout</code>      .\r\n * <p/>\r\n *    recognizer .\r\n * @summary <code>req_zoomin</code>, <code>req_zoomout</code>      .\r\n */\r\n$class('olleh.maps.event.KeyboardZoom').mixin(olleh.maps.event.Recognizer).define({\r\n\r\n  /**\r\n   * ,  KeyboardZoom  .\r\n   */\r\n  KeyboardZoom: function () {\r\n    this.setEnabled(true);\r\n  },\r\n  \r\n  /**\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  keydown : function (event) { // keypress\r\n    \r\n    if (!olleh.maps.event.EventManager.checkEnabledKeyevent()) return;\r\n    \r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n\r\n    switch(keyCode) {\r\n      case 107: // +\r\n      case 187: // =+\r\n      case 61: // =+\r\n        return {name: 'req_zoomin'};\r\n      case 109: // -\r\n      case 189: // -_\r\n      case 173: // FF -_\r\n        return {name: 'req_zoomout'};\r\n    }\r\n  }\r\n});/**\r\n *    {@link olleh.maps.Map}     .\r\n * {@link olleh.maps.Map}  <code>olleh.maps.handler.Desktop.prototype</code> mixin .\r\n * @example\r\n *   \r\n * olleh.maps.mixin(map, olleh.maps.handler.Desktop.prototype, true);\r\n *   \r\n * for(var key in olleh.maps.handler.Drag.prototype) {\r\n *   delete map[key];\r\n * }\r\n * @private\r\n */\r\n$class('olleh.maps.handler.Desktop').define({\r\n\r\n  $capture_mousedown: function (event, payload) {\r\n    this._abortPanAnimationAndUpdateCenter();\r\n  },\r\n  \r\n  $default_mousewheel: function (event, payload) {\r\n    olleh.maps.event.EventManager.preventDefault(event.originEvent);\r\n  }\r\n \r\n});\n/**\r\n * key        \r\n * @private\r\n */\r\n$class('olleh.maps.handler.Keyboard').define({\r\n  \r\n  $default_keydown: function (event, payload) {\r\n    var EventManager = olleh.maps.event.EventManager;\r\n\r\n    if (!EventManager.checkEnabledKeyevent()) return;\r\n    \r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n    var moveSize = 2; // map      .\r\n    \r\n\r\n    switch(keyCode) { // 37 38 39 40 < ^ > v\r\n      case 33: // page up\r\n        this._keymoveX = moveSize;\r\n        this._keymoveY = -moveSize;\r\n        break;\r\n      case 34: // page down\r\n        this._keymoveX = moveSize;\r\n        this._keymoveY = moveSize;\r\n        break;\r\n      case 35: // end\r\n        this._keymoveX = -moveSize;\r\n        this._keymoveY = moveSize;\r\n        break;\r\n      case 36: // home\r\n        this._keymoveX = -moveSize;\r\n        this._keymoveY = -moveSize;\r\n        break;\r\n      case 37: // left\r\n        this._keymoveX = -moveSize;\r\n       break;\r\n      case 38: // up\r\n        this._keymoveY = -moveSize;\r\n        break;\r\n      case 39: // right\r\n        this._keymoveX = moveSize;\r\n        break;\r\n      case 40: // down\r\n        this._keymoveY = moveSize;\r\n        break;\r\n      default:\r\n        if (this._moveTimeout) {\r\n          window.clearTimeout(this._moveTimeout); \r\n          delete this._moveTimeout;\r\n        }\r\n        return true;\r\n    }\r\n    this._keyboardMoveStart = true;\r\n    \r\n    EventManager.preventDefault(domEvent);\r\n    EventManager.stopPropagation(domEvent);\r\n    olleh.maps.util.deferAF(this._keyboardMove, this, event);\r\n  },\r\n  \r\n  $default_keyup: function (event, payload) {\r\n    var EventManager = olleh.maps.event.EventManager;\r\n\r\n    if (!EventManager.checkEnabledKeyevent()) return;\r\n    \r\n    if (this._moveTimeout) {\r\n      window.cancelAnimationFrame(this._moveTimeout);\r\n      delete this._moveTimeout;\r\n    }\r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n\r\n    switch(keyCode) { // 37 38 39 40 < ^ > v\r\n      case 33: // page up\r\n      case 34: // page down\r\n      case 35: // end\r\n      case 36: // home\r\n        this._keymoveX = 0;\r\n        this._keymoveY = 0;\r\n        break;\r\n      case 37: // left\r\n      case 39: // right\r\n        this._keymoveX = 0;\r\n       break;\r\n      case 38: // up\r\n      case 40: // down\r\n        this._keymoveY = 0;\r\n        break;\r\n      default:\r\n        return true;\r\n    }\r\n    EventManager.preventDefault(domEvent);\r\n    EventManager.stopPropagation(domEvent);\r\n    return false;\r\n  },\r\n  \r\n  /**\r\n   * @param {DOMTimeStamp} time\r\n   * @param {olleh.maps.event.Event} event\r\n   * @private\r\n   */\r\n  _keyboardMove: function (time, event) {\r\n    \r\n    if (!this._eventMgr.isMapClicked()) {\r\n      window.cancelAnimationFrame(this._moveTimeout); \r\n      delete this._moveTimeout;\r\n      return;\r\n    }\r\n\r\n    if (this._keyboardMoveStart && this._keymoveX || this._keymoveY) {\r\n      var newCenter = this.calcNewCenter(this._keymoveX || 0, this._keymoveY || 0);\r\n      this.moveTo(newCenter, null, 'off');\r\n      this._moveTimeout = olleh.maps.util.deferAF(this._keyboardMove, this, event);\r\n    } else {\r\n      if (this._moveTimeout || !this._eventMgr._ok) {\r\n        window.cancelAnimationFrame(this._moveTimeout); \r\n        delete this._moveTimeout;\r\n      }\r\n    }\r\n  }\r\n\r\n});\n/**\r\n * shift    drag      zoom  \r\n * @private\r\n */\r\n$class('olleh.maps.handler.BoxZoom').define({\r\n\r\n  $current_dragstart: function (event, payload) {\r\n    // boxZoom   \r\n    var domEvent = event.originEvent;\r\n    var keyCode = domEvent.which || domEvent.keyCode;\r\n    var shiftKey = domEvent.shiftKey;\r\n    var button = domEvent.button !== 1;\r\n    var dom = this._boxZoomElem;\r\n    \r\n    if (!shiftKey || (keyCode !== 1 && button)) return;\r\n\r\n    event.preventDefault();\r\n    \r\n    this._dragStartPosition = event.getPoint();\r\n    this._boxZoomStart = true;\r\n    \r\n    if (!dom) {\r\n      dom = this._boxZoomElem = document.createElement('div');\r\n      olleh.maps.util.dom.addClass(dom, 'ollehmap-boxzoom');\r\n    }\r\n    var divStyle = dom.style;\r\n    var px = this._dragStartPosition;\r\n    \r\n    divStyle.width = 0;\r\n    divStyle.height = 0;\r\n    divStyle.top = px.y + 'px';\r\n    divStyle.left = px.x + 'px';\r\n    \r\n    this._layer_container.appendChild(dom);\r\n  },\r\n  \r\n  $current_drag: function (event, payload) {\r\n    if (!this._boxZoomStart) return; // boxZoom   \r\n    \r\n    var px = event.getPoint();\r\n    var dragStartPx = this._dragStartPosition;\r\n    var x = Math.abs(px.x - dragStartPx.x);\r\n    var y = Math.abs(px.y - dragStartPx.y);\r\n    var divStyle = this._boxZoomElem.style; \r\n    \r\n    event.preventDefault();\r\n    divStyle.width =  x + 'px';\r\n    divStyle.height = y + 'px';\r\n    \r\n    px.y < dragStartPx.y && (divStyle.top = px.y + 'px');\r\n    px.x < dragStartPx.x && (divStyle.left = px.x + 'px');\r\n  },\r\n  \r\n  $current_dragend: function (event, payload) {\r\n    if (!this._boxZoomStart) return; // boxZoom   \r\n\r\n    var px = event.getPoint();\r\n    var left, right, top, bottom, leftBottom, rightTop;\r\n    var dragStartPx = this._dragStartPosition;\r\n\r\n    event.preventDefault();\r\n    this._boxZoomStart = false;\r\n    this._layer_container.removeChild(this._boxZoomElem);\r\n\r\n    if (px.x > dragStartPx.x) {\r\n      left = dragStartPx.x;\r\n      right = px.x;\r\n    } else {\r\n      left = px.x;\r\n      right = dragStartPx.x;\r\n    }\r\n    if (px.y > dragStartPx.y) {\r\n      top = dragStartPx.y;\r\n      bottom = px.y;\r\n    } else {\r\n      top = px.y;\r\n      bottom = dragStartPx.y;\r\n    }\r\n    leftBottom = this.getCoordFromViewportPx(new olleh.maps.Point(left, bottom), false);\r\n    rightTop = this.getCoordFromViewportPx(new olleh.maps.Point(right, top), false);\r\n    \r\n    leftBottom && rightTop && this.fitBounds(new olleh.maps.Bounds(leftBottom, rightTop));\r\n  }\r\n\r\n});/**\n * @private\n */\n$class('olleh.maps.plugin.Desktop').extend(olleh.maps.Adaptable).define({\n  \n  $static: {\n    HANDLERS: [\n      olleh.maps.handler.Desktop, \n      olleh.maps.handler.BoxZoom,\n      olleh.maps.handler.Keyboard\n    ]\n  },\n  \n  attach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.Desktop.HANDLERS;\n    var i = handlers.length;\n\n    eventMgr.addRecognizer(new olleh.maps.event.RightClick());\n    eventMgr.addRecognizer(new olleh.maps.event.DoubleClick());\n    if(!map.getOption('disableScrollWheelZoom'))\n      eventMgr.addRecognizer(new olleh.maps.event.ScrollWheelZoom());\n    eventMgr.addRecognizer(new olleh.maps.event.KeyboardZoom());\n    \n    while(i--) {\n      olleh.maps.event.handler.attach(layerMgr, handlers[i]);\n    }\n  },\n  \n  detach: function () {\n    var map = this.map;\n    var eventMgr = map.eventMgr;\n    var layerMgr = map.layerMgr;\n    var handlers = olleh.maps.plugin.Desktop.HANDLERS;\n    var i = handlers.length;\n    \n    eventMgr.removeRecognizer('olleh.maps.event.RightClick');\n    eventMgr.removeRecognizer('olleh.maps.event.DoubleClick');\n    eventMgr.removeRecognizer('olleh.maps.event.ScrollWheelZoom');\n    eventMgr.removeRecognizer('olleh.maps.event.KeyboardZoom');\n\n    while(i--) {\n      olleh.maps.event.handler.detach(layerMgr, handlers[i]);\n    }\n  }\n  \n});\n\nolleh.maps.$skeleton.push(olleh.maps.plugin.Desktop);\n/**\n * CopyrightControl          .\n */\n$class('olleh.maps.control.CopyrightControl').extend(olleh.maps.control.Control).define({\n    $static: {\n        /**\n         * @private\n         * @constant\n         * @type string\n         */\n        CONTENT: olleh.maps.env.TILE_COPYRIGHT.BASE\n    },\n\n    /**\n     * ,  CopyrightControl  .\n     * @example\n     * var map;\n     * var copyrightControl = new olleh.maps.control.CopyrightControl({\n     *     position: olleh.maps.control.Control.BOTTOM_RIGHT,\n     *     direction: olleh.maps.control.Control.VERTICAL\n     * });\n     * copyrightControl.setMap(map);\n     * @param {olleh.maps.control.ControlOptions} [opts] CopyrightControl  .<br>\n     * opts.position  : {@link olleh.maps.control.Control.BOTTOM_LEFT}<br>\n     * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n     */\n    CopyrightControl: function (opts) {\n        var Control = olleh.maps.control.Control;\n        var _opts = olleh.maps.mixin({\n            position: Control.BOTTOM_LEFT,\n            direction: Control.HORIZONTAL\n        }, opts, true);\n\n        this.position = _opts.position;\n        this.direction = _opts.direction;\n    },\n\n    /**\n     *  .\n     * @returns {olleh.maps.Element}  element\n     * @see olleh.maps.control.Control#draw\n     */\n    draw: function () {\n      var elem = olleh.maps.Element.create('div').addClass('ollehmap-copyright-control').setStyle('margin', '5px');\n\n      if(!this.map.hasMobileStylesheet){\n        this.contentElem = olleh.maps.Element.create('span');\n        elem.appendChild(this.contentElem);\n        this.map.onEvent('maptypeid_changed', this._updateContent, this);\n        this._updateContent();\n      }\n\n      return elem;\n    },\n\n    /**\n     * mapTypeId   copyright  .\n     * @private\n     */\n    _updateContent: function () {\n        var content;\n        var activeBaseLayer = this.map.layerMgr.getActiveBaseLayer();\n        if (activeBaseLayer) content = activeBaseLayer.copyright;\n        if (olleh.maps.isUndefined(content)) content = olleh.maps.control.CopyrightControl.CONTENT;\n        if(this.contentElem.elem.innerHTML !== content) {\n            this.contentElem.elem.innerHTML = content;\n        }\n    },\n\n    detach: function () {\n        var map = this.mgr.map;\n        !olleh.maps.browser.isMobile && map.unsubscribeEvent('maptypeid_changed', this._updateContent, this);\n        olleh.maps.control.CopyrightControl.$super.detach.apply(this, arguments);\n    }\n});\n\n/**\n * LogoControl          .\n */\n$class('olleh.maps.control.LogoControl').extend(olleh.maps.control.Control).define({\n  $static: {\n    /**\n     * @private\n     * @constant\n     * @type string\n     */\n    CONTENT: olleh.maps.env.TILE_COPYRIGHT.BASE\n  },\n\n  /**\n   * ,  LogoControl  .\n   * @example\n   * var map;\n   * var LogoControl = new olleh.maps.control.LogoControl({\n   *     position: olleh.maps.control.Control.BOTTOM_RIGHT,\n   *     direction: olleh.maps.control.Control.VERTICAL\n   * });\n   * @property {Boolean} [logoControl=true] LogoControl  .\n   * @property {olleh.maps.control.LogoControlOptions} [LogoControlOptions] LogoControl \n   * LogoControl.setMap(map);\n   * @param {olleh.maps.control.ControlOptions} [opts] LogoControl  .<br>\n   * opts.position  : {@link olleh.maps.control.Control.BOTTOM_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n  LogoControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    var _opts = olleh.maps.mixin({\n      position: Control.BOTTOM_RIGHT,\n      direction: Control.HORIZONTAL\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div')\n\n    if(this.map.hasMobileStylesheet){\n      elem.addClass('mobile-logo');\n      if(olleh.maps.browser.isHD) {\n        elem.addClass('retina').setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/retinas.png)');\n        //elem.setStyle('backgroundImage', 'url(../../resources/img/mobiles.png)');\n      } else{\n        elem.setStyle('backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/mobiles.png)');\n        //elem.setStyle('backgroundImage', 'url(../../resources/img/mobiles.png)');\n      }\n    } else {\n      elem.addClass('ollehmap-logo-control');\n      elem.setStyle('backgroundImage', 'url(' + olleh.maps.control.Control.IMG_URL + ')');\n    }\n    \n    // mapType  \n    if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ROADMAP){\n      if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ENGMAP){\n       elem.addClass('imagery')\n      }\n    }\n\n    return elem;\n  },\n\n  detach: function () {\n    olleh.maps.control.LogoControl.$super.detach.apply(this, arguments);\n  },\n\n  _updateActiveBaseLayer: function () {\n    var layerMgr = this.mgr.map.layerMgr;\n    var mode = layerMgr.getActiveBaseLayer();\n    \n    if(this.elem && mode) {\n      if(mode.logoType === 'black') {\n        this.elem.removeClass('imagery');\n      } else {\n        this.elem.addClass('imagery');\n      }\n    }\n  },\n\n  attach: function() {\n    olleh.maps.control.LogoControl.$super.attach.apply(this, arguments);\n    this.map.onEvent('set_base_layer', this._updateActiveBaseLayer, this);\n  },\n\n  detach: function() {\n    this.map.unsubscribeEvent('set_base_layer', this._updateActiveBaseLayer, this);\n    olleh.maps.control.LogoControl.$super.detach.apply(this, arguments);\n  }\n\n});\n\n/**\n *         .\n */\n$class('olleh.maps.control.ScaleControl').extend(olleh.maps.control.Control).define({\n  /**\n   * ,  ScaleControl  .\n   * @example var map; var ns = olleh.maps.control; var scaleControl = new\n   *          olleh.maps.control.ScaleControl({ position:\n   *          ns.Control.BOTTOM_LEFT, direction: ns.Control.HORIZONTAL });\n   *          scaleControl.setMap(map);\n   * @param {olleh.maps.control.ControlOptions} [opts] ScaleControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.BOTTOM_LEFT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n   ScaleControl: function (opts) {\n     var Control = olleh.maps.control.Control;\n     var _opts = olleh.maps.mixin({\n       position: Control.BOTTOM_RIGHT,\n       direction: Control.HORIZONTAL\n     }, opts, true);\n\n     this.scaleImg = null;\n     this.scaleStr = null;\n     this.topOutUnits = 'km';\n     this.topInUnits = 'm';\n     this.position = _opts.position;\n     this.direction = _opts.direction;\n   },\n\n   /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n   draw: function () {\n     var elem = olleh.maps.Element.create('div').addClass('ollehmap-scale-control')\n     this.scaleImg = olleh.maps.Element.create('div').addClass('ollehmap-scale-image')\n     this.scaleStr = olleh.maps.Element.create('div');\n\n     //   \n     if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ROADMAP){\n        if(this.mgr.map.getMapTypeId() !== olleh.maps.Map.ENGMAP){\n         this.scaleImg.addClass('imagery')\n        }\n     }\n\n     elem.pushElement(this.scaleImg);\n     elem.pushElement(this.scaleStr);\n     this._update();\n     return elem;\n  },\n\n  _update: function () {\n    var layerMgr = this.mgr.map.layerMgr;\n    var res = layerMgr.getResolution();\n    if (!res)\n        return;\n\n    var inches = olleh.maps.util.INCHES_PER_UNIT;\n    var maxSizeData = 50 * res * inches['Meter'];\n    var topUnits;\n\n    if (maxSizeData > 100000) {\n        topUnits = this.topOutUnits;\n    } else {\n        topUnits = this.topInUnits;\n    }\n    var numTopMax = (maxSizeData / inches[topUnits]).toFixed(0);\n    this.scaleStr.elem.innerHTML = numTopMax + topUnits;\n  },\n  \n  _updateActiveBaseLayer: function () {\n    var layerMgr = this.mgr.map.layerMgr;\n    var mode = layerMgr.getActiveBaseLayer();\n    \n    if(this.scaleImg && mode) {\n      if(mode.logoType === 'black') {\n        this.scaleImg.removeClass('imagery');\n      } else {\n        this.scaleImg.addClass('imagery');\n      }\n    }\n  },\n\n  attach: function() {\n    olleh.maps.control.ScaleControl.$super.attach.apply(this, arguments);\n    this.map.onEvent('zoom_changed', this._update, this);\n    this.map.onEvent('set_base_layer', this._updateActiveBaseLayer, this);\n  },\n\n  detach: function() {\n    this.map.unsubscribeEvent('zoom_changed', this._update, this);\n    this.map.unsubscribeEvent('set_base_layer', this._updateActiveBaseLayer, this);\n    olleh.maps.control.ScaleControl.$super.detach.apply(this, arguments);\n  }\n});\n\n/**\n * PanControl          .\n */\n$class('olleh.maps.control.PanControl').extend(olleh.maps.control.Control).define(\n{\n  $static: {\n\n    /**\n     * @constant\n     * @type Number\n     */\n    SLIDE_FACTOR: 200,\n\n    /**\n     * @constant\n     * @type Object\n     */\n    PAN_INFO: {\n      'panup': {\n        desc: ' ',\n        origin: new olleh.maps.Point(25, 6)\n      },\n      'panleft': {\n        desc: ' ',\n        origin: new olleh.maps.Point(8, 23)\n      },\n      'panright': {\n        desc: ' ',\n        origin: new olleh.maps.Point(44, 23)\n      },\n      'pandown': {\n        desc: ' ',\n        origin: new olleh.maps.Point(24, 44)\n      }\n    }\n  },\n\n  /**\n   * ,  PanControl  .\n   * @example var map; var ns = olleh.maps.control; var panControl = new\n   *          olleh.maps.control.PanControl({ position: ns.Control.TOP_LEFT,\n   *          direction: ns.Control.VERTICAL }); panControl.setMap(map);\n   * @param {olleh.maps.control.ControlOptions} [opts] PanControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_LEFT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\n   */\n  PanControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    var _opts = olleh.maps.mixin({\n      position: Control.TOP_LEFT,\n      direction: Control.VERTICAL\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n    this.panBtns = [];\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var btn, info;\n    var panInfos = olleh.maps.control.PanControl.PAN_INFO;\n    var elem = olleh.maps.Element.create('div').setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n    var pan = olleh.maps.Element.create('div').addClass('control-pan').setStyle(\n        'backgroundImage', 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n\n    elem.appendChild(pan);\n\n    for ( var i in panInfos) {\n      info = panInfos[i];\n      btn = this[i + 'Btn'] = olleh.maps.Element.create('div').addClass('control-' + i).addClass(\n          'ollehmap-control-clickable');\n      btn.setStyles({\n        backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)',\n        left: info.origin.x + this.padding + 'px',\n        top: info.origin.y + this.padding + 'px',\n        position: 'absolute'\n      });\n      btn.setProperty('title', info.desc);\n      elem.appendChild(btn);\n      this.registerEventDom(btn.elem);\n    }\n    return elem;\n  },\n\n  propagateEvent: function (event, payload) {\n    switch (event.getName()) {\n    case 'mousedown':\n    case 'touchstart':\n      this.mousedown(event, payload);\n      break;\n    case 'mouseup':\n    case 'touchend':\n    case 'dragend':\n    case 'mouseout':\n      this.mouseup(event, payload);\n      break;\n    }\n  },\n\n  mousedown: function (event, payload) {\n    var target = event.targetDOM;\n    var moveSize = 2;\n    this._pressTimeout = olleh.maps.util.delay(this.mousedown, 100, this, event);\n\n    if (target === this.panupBtn.elem) {\n      this._keymoveY = -moveSize;\n    } else if (target === this.pandownBtn.elem) {\n      this._keymoveY = moveSize;\n    } else if (target === this.panleftBtn.elem) {\n      this._keymoveX = -moveSize;\n    } else if (target === this.panrightBtn.elem) {\n      this._keymoveX = moveSize;\n    }\n    this._panMoveStart = true;\n    olleh.maps.util.deferAF(this._panMove, this, event);\n  },\n\n  mouseup: function (event, payload) {\n    var target = event.targetDOM;\n    if (this._moveTimeout) {\n      window.cancelAnimationFrame(this._moveTimeout);\n      delete this._moveTimeout;\n    }\n    if (this._pressTimeout) {\n      window.clearTimeout(this._pressTimeout);\n      delete this._pressTimeout;\n    }\n    if (target === this.panupBtn.elem || target === this.pandownBtn.elem) {\n      this._keymoveY = 0;\n    } else if (target === this.panleftBtn.elem || target === this.panrightBtn.elem) {\n      this._keymoveX = 0;\n    } else {\n      return;\n    }\n  },\n\n  /**\n   * @param {DOMTimeStamp} time\n   * @param {olleh.maps.event.Event} event\n   * @private\n   */\n  _panMove: function (time, event) {\n    if (this._panMoveStart && this._keymoveX || this._keymoveY) {\n      var lm = this.mgr.map.layerMgr;\n      var newCenter = lm.calcNewCenter(this._keymoveX || 0, this._keymoveY || 0);\n      lm.panTo(newCenter, lm.getZoom(), 'off');\n      this._moveTimeout = olleh.maps.util.deferAF(this._panMove, this, event);\n    } else {\n      if (this._moveTimeout) {\n        window.cancelAnimationFrame(this._moveTimeout);\n        delete this._moveTimeout;\n      }\n    }\n  }\n});\n/**\n * MapTypeControl  , , ,          .\n */\n$class('olleh.maps.control.MapTypeControl').extend(olleh.maps.control.Control).define({\n  $static: {\n\n    /**\n     *   \n     * @constant\n     * @type Array\n     */\n    DEFAULT_MAP_TYPE: [ 'roadmap', 'satellite', 'hybrid', 'engmap' ]\n  },\n\n  /**\n   * MapTypeControl \n   * @param {olleh.maps.control.ControlOptions} [opts] MapTypeControl  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\n   */\n  MapTypeControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    this.position = Control.TOP_RIGHT;\n    this.direction = Control.VERTICAL;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div');\n    var names = olleh.maps.control.MapTypeControl.DEFAULT_MAP_TYPE;\n    var backgroundImage = 'url('+ olleh.maps.control.Control.IMG_URL + ')';\n    var len = names.length;\n    var btn, name;\n\n    this._btnList = {};\n    elem.setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n\n    for(var i = 0 ; i < len ; i++){\n      name = names[i].toLowerCase();\n      if(name == 'engmap' && !this.mgr.map.getUseEngMap()) continue;\n      btn = olleh.maps.Element.create('div').addClass('control-'+name+'-out').addClass('olleh-maps-inline').addClass('ollehmap-control-clickable');\n      btn.setStyle('backgroundImage', backgroundImage);\n      btn.elem.name = name;\n      elem.appendChild(btn);\n      this.registerEventDom(btn.elem);\n      this._btnList[name] = btn;\n    }\n\n    this._changeButtonState(this.map.getMapTypeId());\n    return elem;\n  },\n\n  propagateEvent: function (event, payload) {\n    switch (event.getName()) {\n    case 'mouseup':\n    case 'touchend':\n      var target = event.targetDOM;\n      this._click(target);\n      break;\n    }\n  },\n\n  /**\n   * @private\n   * @param {HTMLElement} target\n   */\n  _click: function (target) {\n    var typeId = target.name;\n    typeId && this._changeButtonState(typeId);\n  },\n\n  /**\n   * @param key\n   * TODO:         .\n   */\n  _changeButtonState: function (key) {\n    if (!key) {\n      olleh.maps.log.warn('_changeButtonState: key is null', this);\n      return;\n    }\n    var list = this._btnList;\n    var mapTypeId = key.toUpperCase();\n    var classKey = key.toLowerCase();\n\n    this.map.setMapTypeId(mapTypeId);\n    for ( var k in list) {\n      list[k].removeClass('control-' + k + (k === classKey ? '-out' : '-selected'));\n      list[k].addClass('control-' + k + (k === classKey ? '-selected' : '-out'));\n    }\n  },\n\n  _onMapTypeIdChanged: function() {\n    if(this.isDrawn()) {\n      var mapTypeId = this.map.getMapTypeId();\n      this._changeButtonState(mapTypeId);\n    }\n  },\n\n  attach: function() {\n    olleh.maps.control.MapTypeControl.$super.attach.apply(this, arguments);\n    this.map.onEvent('maptypeid_changed', this._onMapTypeIdChanged, this); \n  },\n\n  detach: function() {\n    this.map.unsubscribeEvent('maptypeid_changed', this._onMapTypeIdChanged, this);\n    olleh.maps.control.MapTypeControl.$super.detach.apply(this, arguments);\n  }\n\n});\n/**\n * ZoomControlOptions Object Specification\n * @typedef olleh.maps.control.ZoomControlOptions\n * @extends olleh.maps.control.ControlOptions\n * @property {String} [style]   .  \n *           {@link olleh.maps.control.ZoomControl.LARGE}. <p/>  :\n *           <ul>\n *           <li>{@link olleh.maps.control.ZoomControl.LARGE}</li>\n *           <li>{@link olleh.maps.control.ZoomControl.SMALL}</li>\n *           </ul>\n */\n\n/**\n * ZoomControl         .\n */\n$class('olleh.maps.control.ZoomControl').extend(olleh.maps.control.Control).define({\n  $static: {\n\n    /**\n     * .  <code>olleh.maps.control.ZoomControl.LARGE</code> .\n     * @type String\n     */\n    DEFAULT: 'default',\n\n    /**\n     * zoomBar zoomButton  \n     * @type String\n     */\n    LARGE: 'large',\n\n    /**\n     * ,   \n     * @type String\n     */\n    SMALL: 'small',\n\n    /**\n     * @constant\n     * @type Object\n     */\n    ZOOM_INFO: {\n      // [1,3,5,8,11];\n      1: '',\n      3: '',\n      5: '',\n      8: '',\n      11: '',\n      13: ''\n    }\n  },\n\n  /**\n   * ,  ZoomControl  .\n   * @example var map; var ns = olleh.maps.control; var zoomControl = new\n   *          olleh.maps.control.ZoomControl({ position: ns.Control.TOP_RIGHT,\n   *          direction: ns.Control.VERTICAL, style: ns.ZoomControl.LARGE });\n   *          zoomControl.setMap(map);\n   * @param {olleh.maps.control.ZoomControlOptions} [opts] ZoomControl   <br>\n   * opts.position  : opts.position={@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}<br>\n   * opts.style  : {@link olleh.maps.control.ZoomControl.LARGE}\n   */\n  ZoomControl: function (opts) {\n    var ns = olleh.maps.control;\n    var _opts = olleh.maps.mixin({\n      position: ns.Control.TOP_RIGHT,\n      direction: ns.Control.VERTICAL,\n      style: ns.ZoomControl.LARGE\n    }, opts, true);\n\n    this.position = _opts.position;\n    this.direction = _opts.direction;\n    this.style = _opts.style;\n\n    this._gradation = 9;\n    this._zoom = null;\n  },\n\n  /**\n   *  .\n   * @returns {olleh.maps.Element}  element\n   * @see olleh.maps.control.Control#draw\n   */\n  draw: function () {\n    var elem = olleh.maps.Element.create('div').addClass('ollehmap-zoom-control').setStyles({\n      padding: this.padding + 'px'\n    });\n\n    this.elem = elem;\n    if(this.style === olleh.maps.control.ZoomControl.SMALL) {\n      this._drawSmallZoom(elem);\n    } else {\n      this._drawBigZoom(elem);\n    }\n    return elem;\n  },\n\n  /**\n   * @private\n   * @param parent {olleh.maps.Element}\n   */\n  _drawSmallZoom: function (parent) {\n    this._addZoomBtn(parent, 'zoomin').setProperty('title', '');\n    this._addZoomBtn(parent, 'zoomout').setProperty('title', '');\n  },\n\n  /**\n   * @private\n   * @param parent {olleh.maps.Element}\n   */\n  _drawBigZoom: function (parent) {\n    var map = this.mgr.map;\n\n    this._btnY = 26;\n    this._resetMinMaxZoom();\n    this._drawZoomInfo(parent);\n    this._addAbsoluteImgBtn(parent, 'zoomslider', new olleh.maps.Point(8, 0));\n    this._addZoomBtn(parent, 'zoomin').setProperty('title', '');\n    this._drawZoomBar(parent);\n    this._addZoomBtn(parent, 'zoomout').setProperty('title', '');\n    this.zoomoutBtn.setStyle('margin-top', '-1px');\n    this._updateSlider();\n    this.zoomslider.addClass('ollehmap-control-clickable');\n    this.registerEventDom(this.zoomslider.elem);\n    map.onEvent('zoomrange_changed', this._updateZoomRange, this);\n    map.onEvent('zoom_change', this._updateSlider, this);\n    map.onEvent('zoom_changed', this._updateSlider, this);\n\n    this._hideZoomInfo();\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   */\n  _drawZoomBar: function (parent) {\n    var activeBar = this._activeBar = olleh.maps.Element.create('div').addClass('control-zoombar-active').addClass('ollehmap-control-clickable');\n    var deactiveBar = this._deactiveBar = olleh.maps.Element.create('div').addClass('control-zoombar-deactive').addClass('ollehmap-control-clickable');\n    deactiveBar.setStyle('backgroundImage', 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n    activeBar.setStyle('backgroundImage', 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)');\n    parent.appendChild(deactiveBar.elem);\n    parent.appendChild(activeBar.elem);\n    this.registerEventDom(deactiveBar.elem);\n    this.registerEventDom(activeBar.elem);\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   */\n  _drawZoomInfo: function (parent) {\n    var point = new olleh.maps.Point(-35, 0);\n    var info = olleh.maps.Element.create('div');\n    var levels = olleh.maps.control.ZoomControl.ZOOM_INFO;\n    for ( var level in levels) {\n      this._addAbsoluteImgBtn(info, 'level' + level , point);\n    }\n    parent.elem.appendChild(info.elem);\n    this._updateZoomInfo();\n    this.zoomBarInfo = info;\n  },\n\n\n  /**\n   * max/minZoom   slider   zoom level .\n   * @private\n   */\n  _updateZoomRange: function () {\n    this._resetMinMaxZoom();\n    this._updateZoomInfo();\n    this._updateSlider();\n    this._setZoom(this.map.getZoom());\n  },\n\n  /**\n   * slider  \n   * @private\n   */\n  _updateSlider: function (event, zoom) {\n    if (!zoom) {\n      this._setZoom(this.mgr.map.getZoom());\n    } else if (zoom.newZoom !== this._zoom) {\n      this._setZoom(zoom.newZoom);\n    } \n  },\n\n  _updateZoomInfo: function () {\n    var levels = olleh.maps.control.ZoomControl.ZOOM_INFO;\n    for ( var level in levels) {\n      this._updateZoomLevelInfo(this['level' + level], level);\n    }\n  },\n\n  _updateZoomLevelInfo: function (btn, zoom) {\n    if (zoom >= this.minZoom && zoom <= this.maxZoom) {\n      btn.setStyles({\n        top: (this.maxZoom - zoom) * this._gradation + this.padding + this._btnY + 'px',\n        display: 'block'\n      });\n    } else\n      btn.setStyle('display', 'none');\n  },\n\n  _resetMinMaxZoom: function () {\n    var map = this.mgr.map;\n    this.maxZoom = map.getMaxZoom();\n    this.minZoom = map.getMinZoom();\n  },\n\n  /**\n   * @param {Number} zoom\n   * @private\n   */\n  _setZoom: function (zoom) {\n    this._zoom = zoom;\n    var sliderOffset = 3;\n    var sliderPosition = (this.maxZoom - zoom) * this._gradation + this.padding + this._btnY + sliderOffset;\n    this.zoomslider.setStyle('top', sliderPosition + 'px');\n    this._deactiveBar.setStyles({\n      height: this._gradation * (this.maxZoom - zoom + 1) + 'px'\n    });\n    this._activeBar.setStyles({\n      height: this._gradation * (zoom - this.minZoom + 1) + 'px'\n    });\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {String} id\n   * @param {olleh.maps.Point} point\n   * @returns {olleh.maps.Element} button\n   */\n  _addAbsoluteImgBtn: function (parent, id, size) {\n    var btn = this[id] = olleh.maps.Element.create('div').addClass('control-' + id);\n    btn.setStyles({\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)',\n      left:size.x + 'px',\n      top: size.y + 'px',\n      position: 'absolute'\n    });\n    parent.appendChild(btn.elem);\n    return btn;\n  },\n\n  /**\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {String} id\n   * @returns {olleh.maps.Element} zoomButton\n   */\n  _addZoomBtn: function (parent, id) {\n    var btn = olleh.maps.Element.create('div').addClass('control-' + id).addClass('ollehmap-control-clickable');\n    btn.setStyles({\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)',\n      display: 'block'\n    });\n    parent.appendChild(btn.elem);\n    this.registerEventDom(btn.elem);\n    this[id + 'Btn'] = btn;\n    return btn;\n  },\n\n  /**\n   * Zoomcontrol mouseover  zoomInfo  \n   * @private\n   */\n  _showZoomInfo: function () {\n    this.zoomBarInfo && this.zoomBarInfo.setStyle('display', 'block');\n  },\n\n  /**\n   * Zoomcontrol mouseout  zoomInfo   \n   * @private\n   */\n  _hideZoomInfo: function () {\n    this.zoomBarInfo && this.zoomBarInfo.setStyle('display', 'none');\n  },\n\n  propagateEvent: function (event, payload) {\n    var target = event.targetDOM;\n    switch (event.getName()) {\n    case 'mouseover':\n      this._showZoomInfo();\n      break;\n    case 'mouseout':\n      this._hideZoomInfo();\n      break;\n    case 'dragstart':\n      this.dragstart(target);\n      break;\n    case 'drag':\n      this.drag(event, payload);\n      break;\n    case 'dragend':\n      this.dragend(target);\n      this.mouseup(target);\n      break;\n    case 'click':\n    case 'rightclick':\n      if (!this.isDraggable(target))\n        return;\n      this.dragFlag = true;\n      this.drag(event, payload);\n      this.dragFlag = false;\n      break;\n    case 'mousedown':\n    case 'touchstart':\n      this.mousedown(target);\n      break;\n    case 'mouseup':\n    case 'touchend':\n      this.mouseup(target);\n      break;\n    }\n  },\n\n  /**\n   * @private\n   * @param elem\n   * @returns {boolean}\n   */\n  isDraggable: function (elem) {\n    if (this.style === olleh.maps.control.ZoomControl.LARGE)\n      return true;\n    return false;\n  },\n\n  dragstart: function (target) {\n    if (!this.isDraggable(target))\n      return;\n    this.zoomslider.addClass('ollehmap-dragging');\n    this.dragFlag = true;\n  },\n\n  drag: function (event) {\n    if (!this.dragFlag)\n      return;\n    var crTop = this.elem.elem.getBoundingClientRect().top;\n    var initPt = event.originEvent.clientY - this._btnY - crTop - this.padding;\n    var zoom = parseInt(this.maxZoom - (initPt / this._gradation) + 1);\n    if (zoom <= this.maxZoom && zoom >= this.minZoom && zoom !== this._zoom) {\n      this.mgr.map.setZoom(zoom);\n    }\n  },\n\n  dragend: function (target) {\n    if (this.zoomslider)\n      this.zoomslider.removeClass('ollehmap-dragging');\n    this.dragFlag = false;\n  },\n\n  mousedown: function (target) {\n    var map = this.mgr.map;\n    var action = null;\n    if (target === this.zoominBtn.elem)\n      action = map.zoomIn;\n    else if (target === this.zoomoutBtn.elem)\n      action = map.zoomOut;\n    else\n      return;\n    action.apply(map);\n    this._interval = window.setInterval(action.bind(map), 500);\n  },\n\n  mouseup: function (target) {\n    if (this._interval) {\n      window.clearTimeout(this._interval);\n      delete this._interval;\n    }\n  },\n\n  detach: function () {\n    var map = this.mgr.map;\n    map.unsubscribeEvent('zoomrange_changed', this._updateZoomRange, this);\n    map.unsubscribeEvent('zoom_change', this._updateSlider, this);\n    map.unsubscribeEvent('zoom_changed', this._updateSlider, this);\n    olleh.maps.control.ZoomControl.$super.detach.apply(this, arguments);\n  }\n});\n/**\n * PluginControl  Map  pluginRegstry   plugin       Control .\n */\n$class('olleh.maps.control.PluginControl').extend(olleh.maps.control.Control).define({\n  /**\n   * PluginControl  .\n   * @param {olleh.maps.control.ControlOptions} [opts]  <br>\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\n   * opts.direction  : {@link olleh.maps.control.Control.HORIZONTAL}\n   */\n  PluginControl: function (opts) {\n    var Control = olleh.maps.control.Control;\n    this.position = Control.TOP_RIGHT;\n    this.direction = Control.HORIZONTAL;\n    olleh.maps.mixin(this, opts, true);\n  },\n  \n  attach: function() {\n    olleh.maps.control.PluginControl.$super.attach.call(this);\n    var pluginRegistry = this.mgr.map.pluginRegistry;\n    pluginRegistry.onEvent('plugin_added', this._redrawItems, this);\n    pluginRegistry.onEvent('plugin_state_changed', this._redrawItems, this);\n  },\n  \n  detach: function() {\n    var pluginRegistry = this.mgr.map.pluginRegistry;\n    this.mgr.map.unsubscribeEvent('mouseover', this._hideExpand, this);\n    pluginRegistry.unsubscribeEvent('plugin_added', this._redrawItems, this);\n    pluginRegistry.unsubscribeEvent('plugin_state_changed', this._redrawItems, this);\n    olleh.maps.control.PluginControl.$super.detach.call(this);\n  },\n\n  draw: function () {\n    var elem = olleh.maps.Element.create('div').setStyles({\n      padding: this.padding + 'px',\n      position: 'relative'\n    });\n\n    this._drawExpandType(elem);\n    this.registerEventDom(elem.elem);\n    return elem;\n  },\n\n  _drawExpandType: function (parent) {\n    var expandBtn = olleh.maps.Element.create('a');\n    var form = this.form = olleh.maps.Element.create('form');\n\n    parent.addClass('ollehmap-maptype-control-expandtype');\n    expandBtn.addClass('ollehmap-maptype-control-toggle');\n    form.addClass('ollehmap-maptype-control-list');\n    expandBtn.setStyle('background', 'url('+ olleh.maps.env.RESOURCE_URL + 'img/layers.png)');\n    this._drawItems(form);\n    \n    parent.pushElement(expandBtn.elem);\n    parent.pushElement(form.elem);\n  },\n  \n  /**\n   * item    .\n   * @private\n   */\n  _redrawItems: function() {\n    if(!this.form)\n      return;\n    var childs = this.form.elem.childNodes;\n    var len = childs.length;\n    while(len--) {\n      this.form.removeChild(childs.item(len));\n    }\n    this._drawItems(this.form);\n  },\n  \n  \n  /**\n   * item  .\n   * @param {olleh.maps.Element} form\n   * @private\n   */\n  _drawItems: function(form) {\n    this.groups = this.mgr.map.pluginRegistry.getLabeledPluginsByGroup();\n    this._drawList(form, this.groups['$baseLayer'], 'radio', '$baseLayer');\n    for (var g in this.groups) {\n      if(g !== '$baseLayer' && g !== '$nogroup') {\n        this._drawSeparator(form);\n        this._drawList(form, this.groups[g], 'checkbox');\n      }\n    }\n    if(this.groups.$nogroup && this.groups.$nogroup.length) {\n      this._drawSeparator(form);\n      this._drawList(form, this.groups['$nogroup'], 'checkbox');\n    }\n  },\n  \n\n  /**\n   *  .\n   * @private\n   * @param {olleh.maps.Element} parent\n   */\n  _drawSeparator: function (parent) {\n    var separator = olleh.maps.Element.create('div').addClass(\n        'ollehmap-maptype-control-separator');\n    parent.appendChild(separator);\n  },\n\n  /**\n   *  input type  item  .\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {Object} list  baseLayer  group Object\n   * @param {String} type input type\n   * @param {String} name input name\n   */\n  _drawList: function (parent, list, type, name) {\n    for (var i = 0, len = list.length ; i < len ; i++) {\n      var plugin = list[i];\n      if(plugin.name == 'OllehEng' && !this.mgr.map.getUseEngMap()) continue;\n      this._drawChild(parent, plugin, type, name);\n    }\n  },\n\n  /**\n   * item  .\n   * @private\n   * @param {olleh.maps.Element} parent\n   * @param {String} label layer  group label\n   * @param {String} plugin layer  group\n   * @param {String} type input Type\n   * @param {String} name input name\n   */\n  _drawChild: function (parent, plugin, type, name) {\n    var div = olleh.maps.Element.create('div');\n    var label = plugin.pluginInfo.label;\n    \n    var tmpl = '<input type=\"#{type}\" name=\"#{name}\" #{checked}>#{label}</input>';\n    var html = olleh.maps.util.applyTemplate(tmpl,{\n      type: type,\n      name: name ? name : '',\n      checked: plugin.isActive() ? 'checked=\"checked\"' : '',\n      label: label\n    });\n    div.elem.innerHTML = html;\n    this.registerEventDom(div.elem);\n    div.setProperty('data-value', plugin);\n    div.setProperty('data-type', type);\n    parent.appendChild(div);\n  },\n\n  _showExpand: function () {\n    this.elem.addClass('ollehmap-maptype-control-expanded');\n    if (!this._expanded) {\n      this.mgr.map.onEvent('mouseover', this._hideExpand, this);\n      this._expanded = true;\n    }\n  },\n\n  _hideExpand: function (event, payload) {\n    if (event.getSource() !== this) {\n      this.elem && this.elem.removeClass('ollehmap-maptype-control-expanded');\n      this.mgr.map.unsubscribeEvent('mouseover', this._hideExpand, this);\n      this._expanded = false;\n    }\n  },\n\n  propagateEvent: function (event, payload) {\n    switch (event.getName()) {\n    case 'click':\n    case 'touchend':\n      this._click(event, payload);\n      break;\n    case 'mouseover':\n      this._showExpand();\n      break;\n    }\n  },\n\n  /**\n   *   .\n   * @private\n   * @param event\n   * @param payload\n   */\n  _click: function (event, payload) {\n    var target = event.targetDOM;\n    var plugin = target['data-value'];  \n    if (plugin) {\n      if(target['data-type'] === 'radio') {\n        !plugin.isActive() && plugin.activate();\n      } else {\n        plugin.isActive() ? plugin.deactivate() : plugin.activate();\n      }\n    }\n  },\n\n  _changeButtonState: function (key) {\n    var imgLoc = olleh.maps.control.Control.IMG_LOCATION;\n    var imgURLS = olleh.maps.control.PluginControl.IMG_URLS;\n    var list = this._dButtonList;\n    for ( var akey in list) {\n      list[akey].setProperty('src', imgLoc + imgURLS[akey + (akey === key ? '_ON' : '_OFF')]);\n    }\n  }\n});\n/**\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.DesktopControlsPlugin').extend(olleh.maps.Adaptable).define({\r\n\r\n  attach: function () {\r\n    var map = this.map;\r\n    if (map.checkDefaultControl('panControl')) {\r\n      this.panControl = new olleh.maps.control.PanControl();\r\n      this.panControl.setMap(map);\r\n    }\r\n    if (map.checkDefaultControl('logoControl')) {\r\n      this.logoControl = new olleh.maps.control.LogoControl();\r\n      this.logoControl.setMap(map);\r\n    }\r\n    if (map.checkDefaultControl('scaleControl')) {\r\n      this.scaleControl = new olleh.maps.control.ScaleControl();\r\n      this.scaleControl.setMap(map);\r\n    }\r\n    /*if (map.checkDefaultControl('copyrightControl')) {\r\n      this.copyrightControl = new olleh.maps.control.CopyrightControl();\r\n      this.copyrightControl.setMap(map);\r\n    }*/\r\n    if (map.checkDefaultControl('mapTypeControl')) {\r\n      this.mapTypeControl = new olleh.maps.control.MapTypeControl();\r\n      this.mapTypeControl.setMap(map);\r\n    }\r\n    if (map.checkDefaultControl('zoomControl')) {\r\n      this.zoomControl = new olleh.maps.control.ZoomControl();\r\n      this.zoomControl.setMap(map);\r\n    }\r\n  },\r\n\r\n  detach: function () {\r\n    // ????\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.DesktopControlsPlugin);/**\r\n * /   . measure      \r\n *  measureService  service id    .\r\n *  /      MeasureControl   .\r\n * service Id  measureService    / vector   \r\n * clear()       .\r\n * <br/>\r\n * <pre>\r\n *  map.services.measureService.clear();\r\n * </pre>\r\n * <br>\r\n *     api        .\r\n * <pre>\r\n *  map.services.measureArea.activate();\r\n * </pre>\r\n *         .\r\n * <pre>\r\n *  map.services.measureArea.deactivate();\r\n * </pre>\r\n * <br>\r\n *     api        .\r\n * <pre>\r\n *  map.services.measureDistance.activate();\r\n * </pre>\r\n *         .\r\n * <pre>\r\n *  map.services.measureDustabce.deactivate();\r\n * </pre>\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureService').extend(olleh.maps.Adaptable).define({\r\n  \r\n  /**\r\n   * Service ID: measureService\r\n   * @type String\r\n   */\r\n  serviceId: 'measureService',\r\n\r\n  attach: function () {\r\n    if(this.map.checkDefaultControl('measureControl')){\r\n      this.measureControl = new olleh.maps.control.MeasureControl();\r\n      this.measureControl.setMap(this.map);\r\n    }\r\n    this.measureDistancePlugin = new olleh.maps.plugin.measure.MeasureDistancePlugin();\r\n    this.measureDistancePlugin.setMap(this.map);\r\n    this.measureAreaPlugin = new olleh.maps.plugin.measure.MeasureAreaPlugin();\r\n    this.measureAreaPlugin.setMap(this.map);\r\n  },\r\n\r\n  detach: function () {\r\n    this.measureControl && this.measureControl.setMap(null);\r\n    this.measureDistancePlugin.setMap(null);\r\n    this.measureAreaPlugin.setMap(null);\r\n  },\r\n  \r\n  add: function(measureOverlay) {\r\n    if(!this._measureOverlays)\r\n      this._measureOverlays = [];\r\n    this._measureOverlays.push(measureOverlay);\r\n  },\r\n  \r\n  remove: function(measureOverlay) {\r\n    measureOverlay.setMap(null);\r\n    olleh.maps.util.removeFromArray(this._measureOverlays, measureOverlay);\r\n  },\r\n  \r\n  /**\r\n   *   /  vector  overlay   .\r\n   */\r\n  clear: function() {\r\n    this.map.services.measureDistance.deactivate();\r\n    this.map.services.measureArea.deactivate();\r\n    var measureOverlays = this._measureOverlays;\r\n    if(measureOverlays) {\r\n      for(var i = 0 ; i < measureOverlays.length; i++) {\r\n        measureOverlays[i].setMap(null);\r\n      }\r\n      delete this._measureOverlays;\r\n    }\r\n  }\r\n});\r\n\r\nolleh.maps.$skeleton.push(olleh.maps.plugin.measure.MeasureService);\r\n/**\r\n *   . MeasureService     measureDistance  service id  \r\n *  .   measureDistance service  activate   .\r\n * <br/>\r\n * <pre>\r\n *  map.services.measureDistance.activate();\r\n * </pre>\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureDistancePlugin').mixin(olleh.maps.Plugin).define({\r\n  \r\n  cursor: 'cursor/distance.cur',\r\n  deleteOrigin: new olleh.maps.Point(107, 156),\r\n  serviceId: 'measureDistance',\r\n  pointOrigin: new olleh.maps.Point(127, 145),\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('url(' + olleh.maps.env.RESOURCE_URL + this.cursor + '), default');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('rightclick',this._onRightClick, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  _onClick: function (event) {\r\n    var map = this.map;\r\n    // zoom animation  click    .\r\n    if(map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    var coord = event.getCoord();\r\n    if (!this._measureOverlayGroup) {\r\n      var vector = this._createVector(event.getCoord());\r\n      var detailInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n        map: map,\r\n        position: event.getCoord()\r\n      });\r\n      var inProgressVector = this._createInProgressVector(event.getCoord());\r\n      this._measureOverlayGroup = new olleh.maps.plugin.measure.MeasureOverlayGroup(vector, inProgressVector, detailInfo);\r\n      map.services.measureService.add(this._measureOverlayGroup);\r\n      detailInfo.bringToFront();\r\n      \r\n      var pointIcon = this._createPointIcon(coord);\r\n      this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      var pointInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n        map: map,\r\n        position: coord,\r\n        type: 'pointStart'\r\n      });\r\n      this._measureOverlayGroup.addPointInfo(pointInfo);\r\n      map.layerMgr.onEvent('mousemove', this._onMove, this, true);\r\n    } else {\r\n      var inProgressPath = this._measureOverlayGroup.inProgressVector.getPath();\r\n      var path = this._measureOverlayGroup.getPath();\r\n      if(!path.getLast().equals(inProgressPath.getLast())) {\r\n        var distance = inProgressPath.getDistance();\r\n        var pointIcon = this._createPointIcon(coord);\r\n        var pointInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n          map: map,\r\n          position: coord,\r\n          type: 'pointInfo',\r\n          distance: distance\r\n        });\r\n        this._measureOverlayGroup.addPointIcon(pointIcon);\r\n        this._measureOverlayGroup.addPointInfo(pointInfo);\r\n        path.push(coord);\r\n        inProgressPath.setAt(0, coord);\r\n        inProgressPath.setAt(1, coord);\r\n      }\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _onMove: function (event) {\r\n    if(!this._measureOverlayGroup)\r\n      return;\r\n    var inProgressPath = this._measureOverlayGroup.inProgressVector.getPath();\r\n    inProgressPath.setAt(1, event.getCoord());\r\n    var detailInfo = this._measureOverlayGroup.detailInfo;\r\n    detailInfo.setPosition(event.getCoord());\r\n    detailInfo.setDistance(this._measureOverlayGroup.getPath().getDistance() + inProgressPath.getDistance());\r\n    event.stopPropagation();\r\n  },\r\n\r\n  _onRightClick: function(event) {\r\n    if(this.map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    this.deactivate();\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _createPointIcon: function(coord) {\r\n    var pointIcon = new olleh.maps.overlay.Marker({\r\n      map: this.map,\r\n      position: coord,\r\n      flat: true,\r\n      icon: {\r\n        url: olleh.maps.env.RESOURCE_URL + 'img/controls.png',\r\n        origin: this.pointOrigin,\r\n        size: new olleh.maps.Size(11,11),\r\n        anchor: new olleh.maps.Point(5,5)\r\n      }\r\n    });\r\n    return pointIcon;\r\n  },\r\n  \r\n  _createInProgressVector: function(coord) {\r\n    var path = new olleh.maps.Path([ coord, coord ]);\r\n    var polyline = new olleh.maps.vector.Polyline({\r\n      map: this.map,\r\n      path: path,\r\n      strokeColor: '#df2428',\r\n      strokeOpacity: .3,\r\n      strokeWeight: 5\r\n    });\r\n    return polyline;\r\n  },\r\n\r\n  _createVector: function (coord) {\r\n    var path = new olleh.maps.Path([ coord , coord]);\r\n    var polyline = new olleh.maps.vector.Polyline({\r\n      map: this.map,\r\n      path: path,\r\n      strokeColor: '#df2428',\r\n      strokeOpacity: .7,\r\n      strokeWeight: 5\r\n    });\r\n    return polyline;\r\n  },\r\n  \r\n  _getDistance: function() {\r\n    return this._measureOverlayGroup.getPath().getDistance();\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    map.resetCursor();\r\n    var layerMgr = map.layerMgr;\r\n    layerMgr.unsubscribeEvent('mousemove', this._onMove, this);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this);\r\n    layerMgr.unsubscribeEvent('rightclick', this._onRightClick, this);\r\n    layerMgr.setEditMode(false);\r\n    if(this._measureOverlayGroup) {\r\n      var point;\r\n      if(this._measureOverlayGroup.inProgressVector) {\r\n        point = this._measureOverlayGroup.inProgressVector.getPath().getLast();\r\n        this._measureOverlayGroup.removeInProgressVector();\r\n      } else {\r\n        point = this._measureOverlayGroup.getPath().getLast();\r\n      }\r\n      this._measureOverlayGroup.getPath().push(point);\r\n      var pointIcon = this._createPointIcon(point);\r\n      this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      this._measureOverlayGroup.detailInfo.finish(this._getDistance());\r\n      this._createDeleteMarker();\r\n      this._measureOverlayGroup = null;\r\n    }\r\n  },\r\n  \r\n  _createDeleteMarker: function() {\r\n    var measureOverlayGroup = this._measureOverlayGroup;\r\n    var path = measureOverlayGroup.getPath();\r\n    var lastPoint = path.getAt(path.getLength() - 1);\r\n    var deleteMarker = new olleh.maps.overlay.Marker({map: this.map, position: lastPoint, flat: true,\r\n      icon:{\r\n        url: olleh.maps.env.RESOURCE_URL + 'img/controls.png',\r\n        origin: this.deleteOrigin,\r\n        size: new olleh.maps.Size(18,17),\r\n        anchor: new olleh.maps.Point(-10,8)\r\n    } });\r\n    measureOverlayGroup.setDeleteMarker(deleteMarker);\r\n    var map = this.map;\r\n    deleteMarker.onEvent('click',function() {\r\n      map.services.measureService.remove(measureOverlayGroup);\r\n    });\r\n  }\r\n});\r\n/**\r\n *   . MeasureService     measureArea  service id  \r\n *  .   measureArea service  activate   .\r\n * <br/>\r\n * <pre>\r\n *  map.services.measureArea.activate();\r\n * </pre>\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureAreaPlugin').extend(olleh.maps.plugin.measure.MeasureDistancePlugin).define({\r\n\r\n  cursor: 'cursor/area.cur',\r\n  deleteOrigin: new olleh.maps.Point(107, 112),\r\n  serviceId: 'measureArea',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n  pointOrigin: new olleh.maps.Point(127, 134),\r\n\r\n  _createVector: function (coord) {\r\n    var path = new olleh.maps.Path([ coord, coord ]);\r\n    return new olleh.maps.vector.Polygon({\r\n      map: this.map,\r\n      paths: path,\r\n      strokeColor: '#06b3f5',\r\n      strokeOpacity: .7,\r\n      strokeWeight: 5,\r\n      fillColor: '#06b3f5',\r\n      fillOpacity: .3\r\n    });\r\n  },\r\n  \r\n  _onClick: function (event) {\r\n    var map = this.map;\r\n    var coord = event.getCoord();\r\n    if (!this._measureOverlayGroup) {\r\n      var vector = this._createVector(event.getCoord());\r\n      var detailInfo = new olleh.maps.plugin.measure.MeasureOverlay({\r\n        map: map,\r\n        position: event.getCoord(),\r\n        type: 'areaInfo'\r\n      });\r\n      detailInfo.bringToFront();\r\n      this._measureOverlayGroup = new olleh.maps.plugin.measure.MeasureOverlayGroup(vector, null, detailInfo);\r\n      map.services.measureService.add(this._measureOverlayGroup);\r\n      var pointIcon = this._createPointIcon(coord);\r\n      this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      map.layerMgr.onEvent('mousemove', this._onMove, this, true);\r\n    } else {\r\n      var path = this._measureOverlayGroup.getPath();\r\n      var p = path.getAt(path.getLength() -2);\r\n      if(!path.getLast().equals(p)) {\r\n        path.setAt(path.getLength() - 1, coord);\r\n        path.push(coord);\r\n        var pointIcon = this._createPointIcon(coord);\r\n        this._measureOverlayGroup.addPointIcon(pointIcon);\r\n      }\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _onMove: function (event) {\r\n    if(!this._measureOverlayGroup)\r\n      return;\r\n    var path = this._measureOverlayGroup.getPath();\r\n    path.setAt(path.getLength() - 1, event.getCoord());\r\n    this._measureOverlayGroup.detailInfo.setPosition(event.getCoord());\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _getDistance: function() {\r\n    return this._measureOverlayGroup.getPath().getArea();\r\n  }\r\n\r\n});/**\r\n *     Control\r\n */\r\n$class('olleh.maps.control.MeasureControl').extend(olleh.maps.control.Control).define({\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {olleh.maps.control.ControlOptions} [opts] MeasureControl  <br>\r\n   * opts.position  : {@link olleh.maps.control.Control.TOP_RIGHT}<br>\r\n   * opts.direction  : {@link olleh.maps.control.Control.VERTICAL}\r\n   */\r\n  MeasureControl: function (opts) {\r\n    this.position = olleh.maps.control.Control.TOP_RIGHT;\r\n    this.direction = olleh.maps.control.Control.VERTICAL;\r\n    olleh.maps.mixin(this, opts, true);\r\n  },\r\n  \r\n  attach: function() {\r\n    olleh.maps.control.MeasureControl.$super.attach.apply(this, arguments);\r\n    this.map.pluginRegistry.onEvent('plugin_state_changed', this._onStateChanged, this);\r\n  },\r\n  \r\n  detach: function() {\r\n    this.map.pluginRegistry.unsubscribeEvent('plugin_state_changed', this._onStateChanged, this);\r\n    olleh.maps.control.MeasureControl.$super.detach.apply(this, arguments);\r\n  },\r\n\r\n  /**\r\n   *  .\r\n   * @returns {olleh.maps.Element}  element\r\n   * @see olleh.maps.control.Control#draw\r\n   */\r\n  draw: function () {\r\n    var div = olleh.maps.Element.create('div');\r\n    var url = 'url(' + olleh.maps.env.RESOURCE_URL + 'img/controls.png)';\r\n    div.setStyles({\r\n      position: 'relative',\r\n      height: '75px'\r\n    });\r\n\r\n    var distanceImg = this._distanceImg = olleh.maps.Element.create('div');\r\n    distanceImg.addClass('control-distance-out').addClass('ollehmap-control-clickable');\r\n    distanceImg.setProperty('title', '');\r\n    distanceImg.setStyles({\r\n      backgroundImage: url,\r\n      position: 'absolute',\r\n      top: '0px',\r\n      right: '5px'\r\n    });\r\n    div.appendChild(distanceImg.elem);\r\n    this.registerEventDom(distanceImg.elem);\r\n\r\n    var areaImg = this._areaImg = olleh.maps.Element.create('div');\r\n    areaImg.addClass('control-shape-out').addClass('ollehmap-control-clickable');\r\n    areaImg.setProperty('title', '');\r\n    areaImg.setStyles({\r\n      backgroundImage: url,\r\n      position: 'absolute',\r\n      top: '25px',\r\n      right: '5px'\r\n    });\r\n    div.appendChild(areaImg.elem);\r\n    this.registerEventDom(areaImg.elem);\r\n\r\n    var clearImg = this._clearImg = olleh.maps.Element.create('div');\r\n    clearImg.addClass('control-change').addClass('ollehmap-control-clickable');\r\n    clearImg.setProperty('title', '');\r\n    clearImg.setStyles({\r\n      backgroundImage: url,\r\n      position: 'absolute',\r\n      top: '50px',\r\n      right: '5px'\r\n    });\r\n    div.appendChild(clearImg.elem);\r\n    this.registerEventDom(clearImg.elem);\r\n\r\n    return div;\r\n  },\r\n  \r\n  propagateEvent: function (event, payload) {\r\n    switch (event.getName()) {\r\n    case 'click':\r\n    case 'touchend':\r\n      this._click(event);\r\n      break;\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n  \r\n  _click: function(event) {\r\n    var target = event.targetDOM;\r\n    var map = this.map;\r\n    if(target === this._distanceImg.elem) {\r\n      map.services.measureDistance.activate();\r\n    } else if(target === this._areaImg.elem) {\r\n      map.services.measureArea.activate();\r\n    } else if(target === this._clearImg.elem) {\r\n      map.services.measureService.clear();\r\n    }\r\n  },\r\n  \r\n  _onStateChanged: function(event, payload) {\r\n    var isActive;\r\n    var map = this.map;\r\n    if(payload.plugin === map.services.measureDistance) {\r\n      isActive =  map.services.measureDistance.isActive();\r\n      this._distanceImg.addClass('control-distance' + (isActive ? '-selected' : '-out'));\r\n      this._distanceImg.removeClass('control-distance' + (isActive ? '-out' : '-selected'));\r\n    } else if(payload.plugin === map.services.measureArea) {\r\n      isActive =  map.services.measureArea.isActive();\r\n      this._areaImg.addClass('control-shape' + (isActive ? '-selected' : '-out'));\r\n      this._areaImg.removeClass('control-shape' + (isActive ? '-out' : '-selected'));\r\n    }\r\n  }\r\n  \r\n});/**\r\n * /   vector  overlay  .\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.measure.MeasureOverlayGroup').define({\r\n  /**\r\n   * ,  vector, detailInfo    .\r\n   * @param {olleh.maps.vector.Vector} vector\r\n   * @param {olleh.maps.vector.Vector} inProgressVector\r\n   * @param {olleh.maps.plugin.measure.MeasureOverlay} detailInfo\r\n   */\r\n  MeasureOverlayGroup: function (vector, inProgressVector, detailInfo) {\r\n    this.vector = vector;\r\n    this.inProgressVector = inProgressVector;\r\n    this.detailInfo = detailInfo;\r\n    this.pointInfos = [];\r\n    this.pointIcons = [];\r\n    this.deleteMarker;\r\n  },\r\n  \r\n  removeInProgressVector: function() {\r\n    if(this.inProgressVector) {\r\n      this.inProgressVector.setMap(null);\r\n      this.inProgressVector = null;\r\n    }\r\n  },\r\n  \r\n  /**\r\n   * Overlay    .\r\n   * @param {olleh.maps.overlay.Marker} deleteMarker\r\n   * @private\r\n   */\r\n  setDeleteMarker: function(deleteMarker) {\r\n    this.deleteMarker = deleteMarker;\r\n  },\r\n  \r\n  /**\r\n   *     Overlay  .\r\n   * @param {olleh.maps.plugin.measure.MeasureOverlay} pointInfo\r\n   * @private\r\n   */\r\n  addPointInfo: function(pointInfo) {\r\n    this.pointInfos.push(pointInfo);\r\n  },\r\n  \r\n  /**\r\n   *    Marker  . \r\n   * @param {olleh.maps.overlay.Marker} pointIcon\r\n   * @private\r\n   */\r\n  addPointIcon: function(pointIcon) {\r\n    this.pointIcons.push(pointIcon);\r\n  },\r\n  \r\n  /**\r\n   *   path  .\r\n   * @returns {olleh.maps.Path}\r\n   * @private\r\n   */\r\n  getPath: function() {\r\n    if(this.vector.getPath)\r\n      return this.vector.getPath();\r\n    if(this.vector.getPaths) // vector is Polygon\r\n      return this.vector.getPaths()[0];\r\n  },\r\n  \r\n  /**\r\n   *   vector  overlay  setMap(map)  .\r\n   * @param {olleh.maps.Map} map\r\n   * @private\r\n   */\r\n  setMap: function(map) {\r\n    this.vector.setMap(map);\r\n    this.inProgressVector && this.inProgressVector.setMap(map);\r\n    this.detailInfo.setMap(map);\r\n    this.deleteMarker && this.deleteMarker.setMap(map);\r\n    for(var i = 0 ; i < this.pointInfos.length ; i++) {\r\n      this.pointInfos[i].setMap(map);\r\n    }\r\n    for(var j = 0 ; j < this.pointIcons.length ; j++) {\r\n      this.pointIcons[j].setMap(map);\r\n    }\r\n  }\r\n\r\n});/**\r\n *  /   Overlay\r\n * @private \r\n */\r\n$class('olleh.maps.plugin.measure.MeasureOverlay').extend(olleh.maps.overlay.PointedOverlay).define({\r\n  \r\n  /**\r\n   * ,  opts    .\r\n   * @param {Object} opts\r\n   * @param {String} opts.type \r\n   *  pointStart:, areaInfo: , distanceInfo: , detailInfo:    \r\n   * @param {Number} opts.distance    \r\n   * @param {Number} opts.anchroX position  measureInfo  x  \r\n   * @param {Number} opts.anchroY position  measureInfo  y  \r\n   */\r\n  MeasureOverlay: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      type: 'distanceInfo'\r\n    },opts, true);\r\n  },\r\n  \r\n  update: function() {\r\n    if(!this.div) {\r\n      this.div = olleh.maps.Element.create('div');\r\n      this.div.addClass('ollehmap-measure');\r\n      this.div.setStyles({\r\n        boxShadow: '0 0 1px rgba(0,0,0,0.5)',\r\n        userSelect: 'none'\r\n      });\r\n      var opts = this._opts;\r\n      if(opts.type === 'areaInfo') { //  \r\n        this._updateAreaInfo();\r\n      } else if(opts.type === 'pointStart') { //  : \r\n        this._updatePointStart();\r\n      } else if(opts.type === 'pointInfo') { //  : \r\n        this._updatePointInfo();\r\n      } else { // opts.type === 'pointDetail'  : \r\n        this._updatePointDetail();\r\n      }\r\n      this.registerElement('upper_overlay_pane', this.div.elem);\r\n    }\r\n    olleh.maps.plugin.measure.MeasureOverlay.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  // \r\n  _updateAreaInfo: function() {\r\n    this.div.addClass('ollehmap-measure-areaInfo');\r\n    var imgUrl = 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)'; \r\n    this.div.elem.innerHTML = '  <br>  <div class=\"control-measure-bluemouse olleh-maps-inline\" style=\"background-image:'+ imgUrl +'\"></div>';\r\n  },\r\n  \r\n  //  \r\n  _updateFinalAreaInfo: function(area) {\r\n    this.div.removeClass('ollehmap-measure-areaInfo');\r\n    this.div.addClass('ollehmap-measure-finalAreaInfo');\r\n    var areaHtml = olleh.maps.util.applyTemplate(' <strong>#{value}</strong>#{unit}', this._getArea(area));\r\n    this.div.elem.innerHTML = areaHtml;\r\n  },\r\n  \r\n  //  \r\n  _updatePointStart: function() {\r\n    this.div.addClass('ollehmap-measure-pointStart');\r\n    this.div.elem.innerHTML = '';\r\n  },\r\n  \r\n  //  \r\n  _updatePointInfo: function() {\r\n    this.div.addClass('ollehmap-measure-pointInfo');\r\n    var dist = this._getDistance(this._opts.distance);\r\n    this.div.elem.innerHTML = dist.value + '' + dist.unit;\r\n  },\r\n  \r\n  _updatePointDetail: function() {\r\n    var div = this.div;\r\n    div.addClass('ollehmap-measure-pointDetail');\r\n    var distLabel = olleh.maps.Element.create('div');\r\n    distLabel.addClass('ollehmap-measure-pointDetail1');\r\n    distLabel.elem.innerHTML = '';\r\n    distLabel.setStyle('margin-bottom','5px');\r\n    div.appendChild(distLabel);\r\n    this._distValue = olleh.maps.Element.create('div');\r\n    this._distValue.setStyle('margin-bottom','5px');\r\n    this._distValue.addClass('ollehmap-measure-pointDetail2');\r\n    div.appendChild(this._distValue);\r\n    var walkLabel = olleh.maps.Element.create('div');\r\n    walkLabel.addClass('ollehmap-measure-pointDetail1');\r\n    walkLabel.setStyle('margin-bottom','5px');\r\n    walkLabel.elem.innerHTML = '';\r\n    div.appendChild(walkLabel);\r\n    this._walkValue = olleh.maps.Element.create('div');\r\n    this._walkValue.setStyle('margin-bottom','5px');\r\n    this._walkValue.addClass('ollehmap-measure-pointDetail2');\r\n    div.appendChild(this._walkValue);\r\n    var bikeLabel = olleh.maps.Element.create('div');\r\n    bikeLabel.elem.innerHTML = '';\r\n    bikeLabel.addClass('ollehmap-measure-pointDetail1');\r\n    div.appendChild(bikeLabel);\r\n    this._bikeValue = olleh.maps.Element.create('div');\r\n    this._bikeValue.addClass('ollehmap-measure-pointDetail2');\r\n    div.appendChild(this._bikeValue);\r\n    \r\n    this._rightButtonToFinish = olleh.maps.Element.create('div');\r\n    this._rightButtonToFinish.addClass('ollehmap-measure-finish');\r\n    var imgUrl = 'url('+ olleh.maps.env.RESOURCE_URL + 'img/controls.png)'; \r\n    this._rightButtonToFinish.elem.innerHTML = '  <br>  <span class=\"control-measure-redmouse olleh-maps-inline\" style=\"background-image:'+ imgUrl +'\"></span>';\r\n    div.appendChild(this._rightButtonToFinish);\r\n  },\r\n  \r\n  _updateFinalDistanceInfo: function() {\r\n    this.div.setStyles({\r\n      paddingBottom:'8px',\r\n      marginTop:'-88px',\r\n      marginLeft:'30px'\r\n     });\r\n    this._rightButtonToFinish.setStyle('display','none');\r\n  },\r\n  \r\n  setDistance: function(dist) {\r\n    var valueHtml = olleh.maps.util.applyTemplate(\r\n        '<strong>#{value}</strong>#{unit}',this._getDistance(dist));\r\n    this._distValue.elem.innerHTML = valueHtml;\r\n    this._walkValue.elem.innerHTML = this._getTimeHtml(dist, 66.6); //  4km/h = 66.6m/m\r\n    this._bikeValue.elem.innerHTML = this._getTimeHtml(dist, 266.6); //  16km/h = 266.6m/m\r\n  },\r\n  \r\n  finish: function(distOrArea) {\r\n    if(this._opts.type === 'areaInfo')\r\n      this._updateFinalAreaInfo(distOrArea);\r\n    else \r\n      this._updateFinalDistanceInfo();\r\n  },\r\n  \r\n  _getTimeHtml: function(dist, speed) {\r\n    var time = this._getTime(dist, speed);\r\n    var html = olleh.maps.util.applyTemplate(\r\n      '<strong>#{m}</strong>',time);\r\n    if(time.h) {\r\n      html = olleh.maps.util.applyTemplate(\r\n          '<strong>#{h}</strong> ',time) + html;\r\n    }\r\n    return html;\r\n  },\r\n  \r\n  _getTime: function(dist, speed) {\r\n    var time = dist / speed;\r\n    var h = Math.floor(time / 60);\r\n    var m = Math.floor(time % 60);\r\n    var result  = {m: m};\r\n    if(h > 0) {\r\n      result.h = h;\r\n    }\r\n    return result;\r\n  },\r\n    \r\n  _getDistance: function(dist) {\r\n    var unit = 'm';\r\n    if(dist > 1000) {\r\n      unit = 'km';\r\n      dist = dist / 1000;\r\n    }\r\n    return {value: dist.toFixed(3), unit: unit};\r\n  },\r\n  \r\n  _getArea: function(area) {\r\n    var unit;\r\n    if(area > 1000000) {\r\n      area = area / 1000000;\r\n      unit = 'km';\r\n    } else {\r\n      unit = 'm';\r\n    }\r\n    return {value: area.toFixed(3), unit: unit};\r\n  }\r\n  \r\n});/**\r\n * DrawCircle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawCircle').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawCircle',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawCircleOptions\r\n   * @property {olleh.maps.vector.CircleOptions} circleOpts Circle  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawCircleOptions} opts \r\n   * @private \r\n   */\r\n  DrawCircle: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n    circleOpts: {\r\n      fillColor: '#05A15C',\r\n      fillOpacity: .3,\r\n      strokeColor: '#05A15C',\r\n      strokeOpacity: .7,\r\n      strokePosition: 'center', // center, insdie, outside\r\n      strokeWeight: 5}\r\n    }, opts, 'remix');\r\n  },\r\n  \r\n  setOptions: function (opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.onEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this, true);\r\n    layerMgr.unsubscribeEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.unsubscribeEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(false);\r\n  },\r\n  \r\n  _complete: function() {\r\n    if(this._circle) {\r\n      var vectorLayer = this.map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._circle);\r\n      this._circle = null;\r\n    }\r\n  },\r\n  \r\n  _onClick: function(event, payload) {\r\n    if(!this._circle) {\r\n      this._circle = this._createCircle(event.getCoord());\r\n      this.map.layerMgr.onEvent('mousemove',this._onDrag, this);\r\n    } else {\r\n      this.map.layerMgr.unsubscribeEvent('mousemove', this._onDrag, this);\r\n      this._complete();\r\n    }\r\n  },\r\n  \r\n  _onDragStart: function(event, payload) {\r\n    event.preventDefault();\r\n    if(!this._circle) {\r\n      this._circle = this._createCircle(event.getCoord());\r\n      this.map.layerMgr.onEvent('drag',this._onDrag,this);\r\n    }\r\n  },\r\n  \r\n  _onDrag: function(event, payload) {\r\n    event.preventDefault();\r\n    var r = this._center.distanceTo(event.getCoord());\r\n    this._circle.setRadius(r);\r\n  },\r\n  \r\n  _onDragEnd: function(event, payload) {\r\n    event.preventDefault();\r\n    this.map.layerMgr.unsubscribeEvent('drag',this._onDrag,this);\r\n    this._complete();\r\n  },\r\n  \r\n  _createCircle: function(coord) {\r\n    this._center = coord;\r\n    var opts = olleh.maps.mixin({\r\n      map: this.map,\r\n      center: coord,\r\n      radius: 1\r\n    }, this._opts.circleOpts, true);\r\n    var circle = new olleh.maps.vector.Circle(opts);\r\n    return circle;\r\n  }\r\n\r\n});/**\r\n * DrawPolygon\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawPolygon').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawPolygon',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawPolygonOptions\r\n   * @property {olleh.maps.vector.PolygonOptions} polygonOpts Polygon  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawPolygonOptions} opts \r\n   * @private \r\n   */\r\n  DrawPolygon: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      polygonOpts: {\r\n        fillRule: 'evenodd',\r\n        strokeColor: '#06b3f5',\r\n        strokeOpacity: .7,\r\n        strokeWeight: 5,\r\n        fillColor: '#06b3f5',\r\n        fillOpacity: .3\r\n      }\r\n    }, opts, 'remix');\r\n  },\r\n  \r\n  \r\n  setOptions: function(opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('dblclick', this._onDblClick, this, true);\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n  \r\n  _onDblClick: function(event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n    this._complete();\r\n    this._prevCoord = event.getCoord();\r\n  },\r\n  \r\n  _onClick: function(event) {\r\n    var map = this.map;\r\n    // zoom animation  click    .\r\n    if(map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    var coord = event.getCoord();\r\n    if(coord.equals(this._prevCoord))\r\n      return;\r\n    this._prevCoord = coord;\r\n    if(!this._polygon) {\r\n      var opts = olleh.maps.mixin({map: this.map, paths: new olleh.maps.Path([coord , coord])}, this._opts.polygonOpts);\r\n      this._polygon = new olleh.maps.vector.Polygon(opts);\r\n      map.layerMgr.onEvent('mousemove', this._onMouseMove, this);\r\n    } else {\r\n      this._completePoint(coord);\r\n    }\r\n  },\r\n  \r\n  _completePoint: function(coord) {\r\n    var path = this._polygon.getPaths()[0];\r\n    path.push(coord);\r\n  },\r\n  \r\n  _onMouseMove: function(event, payload) {\r\n    var path = this._polygon.getPaths()[0];\r\n    path.setAt(path.getLength()-1, event.getCoord());\r\n  },\r\n  \r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this);\r\n    layerMgr.unsubscribeEvent('dblclick',this._onDblClick, this);\r\n    layerMgr.setEditMode(false);\r\n    this._complete();\r\n  },\r\n  \r\n  _complete: function() {\r\n    if(this._polygon) {\r\n      var path = this._polygon.getPaths()[0];\r\n      var last = path.getLength()-1;\r\n      if(path.getAt(last).equals(path.getAt(last-1))) {\r\n        path.pop();\r\n      }\r\n      var map = this.map;\r\n      var vectorLayer = map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._polygon);\r\n      this._polygon = null;\r\n      map.layerMgr.unsubscribeEvent('mousemove',this._onMouseMove, this);\r\n    }    \r\n  }\r\n\r\n});/**\r\n * DrawPolyline\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawPolyline').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawPolyline',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawPolylineOptions\r\n   * @property {olleh.maps.vector.PolylineOptions} polylineOpts Polyline  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawPolylineOptions} opts \r\n   * @private \r\n   */\r\n  DrawPolyline: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      polylineOpts: {\r\n        strokeColor: '#df2428',\r\n        strokeOpacity: .7,\r\n        strokeWeight: 5\r\n      }\r\n    }, opts, 'remix');\r\n  },\r\n\r\n  setOptions: function (opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('dblclick', this._onDblClick, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  _onDblClick: function (event) {\r\n    event.stopPropagation();\r\n    event.preventDefault();\r\n    this._finishDrawing();\r\n    this._dblClickCoord = event.getCoord();\r\n  },\r\n\r\n  _onClick: function (event) {\r\n    var map = this.map;\r\n    // zoom animation  click    .\r\n    if (map.layerMgr.isZooming()) {\r\n      event.stopPropagation();\r\n      return;\r\n    }\r\n    var coord = event.getCoord();\r\n    if(coord.equals(this._dblClickCoord))\r\n      return;\r\n    this._dblClickCoord = null;\r\n    if (!this._polyline) {\r\n      var opts = olleh.maps.mixin({\r\n        map: this.map,\r\n        path: new olleh.maps.Path([ coord ])\r\n      }, this._opts.polylineOpts);\r\n      this._polyline = new olleh.maps.vector.Polyline(opts);\r\n      opts = olleh.maps.mixin({\r\n        map: this.map,\r\n        path: new olleh.maps.Path([ coord, coord ])\r\n      }, this._opts.polylineOpts);\r\n      opts.strokeOpacity = .5;\r\n      this._inprogressLine = new olleh.maps.vector.Polyline(opts);\r\n      map.layerMgr.onEvent('mousemove', this._onMouseMove, this);\r\n    } else {\r\n      this._completePoint(coord);\r\n    }\r\n  },\r\n\r\n  _completePoint: function (coord) {\r\n    var path = this._polyline.getPath();\r\n    path.push(coord);\r\n    this._inprogressLine.setPath(new olleh.maps.Path([ coord, coord ]));\r\n  },\r\n\r\n  _onMouseMove: function (event, payload) {\r\n    var path = this._inprogressLine.getPath();\r\n    path.setAt(1, event.getCoord());\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this);\r\n    layerMgr.unsubscribeEvent('dblclick', this._onDblClick, this);\r\n    layerMgr.setEditMode(false);\r\n    this._finishDrawing();\r\n  },\r\n\r\n  _finishDrawing: function () {\r\n    if (this._polyline) {\r\n      this.map.layerMgr.unsubscribeEvent('mousemove', this._onMouseMove, this);\r\n      var vectorLayer = map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._polyline);\r\n      this._inprogressLine.setMap(null);\r\n      this._inprogressLine = null;\r\n      this._polyline = null;\r\n    }\r\n  }\r\n});/**\r\n * DrawRectangle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawRectangle').mixin(olleh.maps.Plugin).define({\r\n  serviceId: 'drawRectangle',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawRectangleOptions\r\n   * @property {olleh.masps.vector.RectangleOptions} rectangleOpts Rectangle  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawRectangleOptions} opts \r\n   * @private \r\n   */\r\n  DrawRectangle: function (opts) {\r\n    this._opts = olleh.maps.mixin({\r\n      rectangleOpts: {\r\n        fillColor: '#FFC408',\r\n        fillOpacity: .3,\r\n        strokeColor: '#FFC408',\r\n        strokeOpacity: .7,\r\n        strokePosition: 'center', // center, insdie, outside\r\n        strokeWeight: 5\r\n      }}, opts, 'remix');\r\n  },\r\n\r\n  setOptions: function (opts) {\r\n    this._opts = olleh.maps.mixin(this._opts, opts, 'remix');\r\n  },\r\n\r\n  doActivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor('crosshair');\r\n    layerMgr.onEvent('click', this._onClick, this, true);\r\n    layerMgr.onEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.onEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(true);\r\n  },\r\n\r\n  doDeactivate: function () {\r\n    var map = this.map;\r\n    var layerMgr = map.layerMgr;\r\n    map.setCursor(null);\r\n    layerMgr.unsubscribeEvent('click', this._onClick, this, true);\r\n    layerMgr.unsubscribeEvent('dragstart', this._onDragStart, this, true);\r\n    layerMgr.unsubscribeEvent('dragend', this._onDragEnd, this, true);\r\n    layerMgr.setEditMode(false);\r\n    this._complete();\r\n  },\r\n  \r\n  _complete: function() {\r\n    if(this._rectangle) {\r\n      var vectorLayer = map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n      vectorLayer.fireEvent('vector_created', this._rectangle);\r\n      this._rectangle = null;\r\n    }\r\n  },\r\n\r\n  _onClick: function (event, payload) {\r\n    if (!this._rectangle) {\r\n      this._rectangle = this._createRectangle(event.getCoord());\r\n      this.map.layerMgr.onEvent('mousemove', this._onDrag, this);\r\n    } else {\r\n      this.map.layerMgr.unsubscribeEvent('mousemove', this._onDrag, this);\r\n      this.deactivate();\r\n    }\r\n  },\r\n\r\n  _onDragStart: function (event, payload) {\r\n    event.preventDefault();\r\n    if (!this._rectangle) {\r\n      this._rectangle = this._createRectangle(event.getCoord());\r\n      this.map.layerMgr.onEvent('drag', this._onDrag, this);\r\n    }\r\n  },\r\n\r\n  _onDrag: function (event, payload) {\r\n    event.preventDefault();\r\n    var coord = event.getCoord();\r\n    var bounds = this._rectangle.getBounds();\r\n    \r\n    var left = Math.min(coord.x, this._startCoord.x);\r\n    var bottom = Math.min(coord.y, this._startCoord.y);\r\n    var right = Math.max(coord.x, this._startCoord.x);\r\n    var top = Math.max(coord.y, this._startCoord.y);\r\n    bounds = new olleh.maps.Bounds(new olleh.maps.UTMK(left,bottom), new olleh.maps.UTMK(right,top));\r\n    this._rectangle.setBounds(bounds);\r\n  },\r\n\r\n  _onDragEnd: function (event, payload) {\r\n    event.preventDefault();\r\n    this.map.layerMgr.unsubscribeEvent('drag', this._onDrag, this);\r\n    this._complete();\r\n  },\r\n  \r\n  _createRectangle: function (coord) {\r\n    this._startCoord = coord;\r\n    var opts = olleh.maps.mixin({\r\n      map: this.map,\r\n      bounds: new olleh.maps.Bounds(coord, coord)\r\n    }, this._opts.rectangleOpts, true);\r\n    var rect = new olleh.maps.vector.Rectangle(opts);\r\n    return rect;\r\n  }\r\n\r\n});\r\n/**\r\n * DrawingControl\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawingControl').extend(olleh.maps.control.Control).define({\r\n  \r\n  /**\r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawingControlOpts\r\n   * @property {String} position \r\n   * @property {String} direction \r\n   */\r\n  \r\n  /**\r\n   * Constructor\r\n   */\r\n  DrawingControl: function (opts) {\r\n    this.position = olleh.maps.control.Control.TOP_RIGHT;\r\n    this.direction = olleh.maps.control.Control.VERTICAL;\r\n    olleh.maps.mixin(this, opts, true);\r\n  },\r\n\r\n  attach: function () {\r\n    olleh.maps.plugin.drawing.DrawingControl.$super.attach.apply(this, arguments);\r\n    this.map.pluginRegistry.onEvent('plugin_state_changed', this._onStateChanged, this);\r\n  },\r\n\r\n  detach: function () {\r\n    this.map.pluginRegistry.unsubscribeEvent('plugin_state_changed', this._onStateChanged, this);\r\n    olleh.maps.plugin.drawing.DrawingControl.$super.detach.apply(this, arguments);\r\n  },\r\n\r\n  draw: function () {\r\n    var div = olleh.maps.Element.create('div');\r\n    div.setStyles({\r\n      position: 'relative',\r\n      width: '25px',\r\n      height: '125px',\r\n      margin: '6px',\r\n      backgroundColor: 'white'\r\n    });\r\n\r\n    // circle\r\n    var circleImg = this._circleImg = olleh.maps.Element.create('div');\r\n    circleImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_circle.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'black black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '0px',\r\n      left: '0px',\r\n      'border-radius': '5px 5px 0px 0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(circleImg.elem);\r\n    this.registerEventDom(circleImg.elem);\r\n\r\n    // rectangle\r\n    var rectangleImg = this._rectangleImg = olleh.maps.Element.create('div');\r\n    rectangleImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_rectangle.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '25px',\r\n      left: '0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(rectangleImg.elem);\r\n    this.registerEventDom(rectangleImg.elem);\r\n\r\n    // polyline\r\n    var polylineImg = this._polylineImg= olleh.maps.Element.create('div');\r\n    polylineImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_polyline.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '50px',\r\n      left: '0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(polylineImg.elem);\r\n    this.registerEventDom(polylineImg.elem);\r\n    \r\n    // polygon\r\n    var polygonImg = this._polygonImg = olleh.maps.Element.create('div');\r\n    polygonImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_polygon.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black #F6F6F6',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '75px',\r\n      left: '0px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(polygonImg.elem);\r\n    this.registerEventDom(polygonImg.elem);\r\n\r\n    // hand\r\n    var handImg = this._handImg = olleh.maps.Element.create('div');\r\n    handImg.setStyles({\r\n      backgroundImage: 'url(' + olleh.maps.env.RESOURCE_URL + 'img/draw_hand.png)',\r\n      backgroundRepeat: 'no-repeat',\r\n      backgroundPosition: 'center',\r\n      borderWidth: '1px',\r\n      borderStyle: 'solid',\r\n      borderColor: 'transparent black black black',\r\n      width: '25px',\r\n      height: '25px',\r\n      position: 'absolute',\r\n      top: '100px',\r\n      left: '0px',\r\n      'border-radius': '0px 0px 5px 5px',\r\n      cursor: 'pointer'\r\n    });\r\n    div.appendChild(handImg.elem);\r\n    this.registerEventDom(handImg.elem);\r\n\r\n    return div;\r\n  },\r\n\r\n  propagateEvent: function (event, payload) {\r\n    switch (event.getName()) {\r\n    case 'click':\r\n    case 'touchend':\r\n      this._click(event);\r\n      break;\r\n    }\r\n    event.stopPropagation();\r\n  },\r\n\r\n  _click: function (event, payload) {\r\n    var target = event.targetDOM;\r\n    var map = this.map;\r\n    if(target === this._polylineImg.elem) {\r\n      map.services.drawPolyline.activate();\r\n    } else if(target === this._polygonImg.elem) {\r\n      map.services.drawPolygon.activate();\r\n    } else if(target === this._rectangleImg.elem) {\r\n      map.services.drawRectangle.activate();\r\n    } else if(target === this._circleImg.elem) {\r\n      map.services.drawCircle.activate();\r\n    } else if(target === this._handImg.elem) {\r\n      map.services.drawPolyline.deactivate();\r\n      map.services.drawPolygon.deactivate();\r\n      map.services.drawRectangle.deactivate();\r\n      map.services.drawCircle.deactivate();\r\n    }\r\n  },\r\n\r\n  _onStateChanged: function (event, payload) {\r\n\r\n  }\r\n\r\n});/**\r\n * DrawingService\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.DrawingService').extend(olleh.maps.Adaptable).define({\r\n  \r\n  serviceId: 'drawingService', \r\n  \r\n  /**\r\n   * DrawingService   plugin   vector    .  \r\n   * @event olleh.maps.plugin.drawing.DrawingService#event:vector_created\r\n   * @param {olleh.maps.event.Event} event  \r\n   * @param {olleh.maps.vector.Vector} payload  Vector \r\n   */\r\n  \r\n  /**\r\n   * Drawing service \r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.DrawingServiceOptions\r\n   * @property {olleh.maps.vector.CircleOptions} circleOpts Circle   \r\n   * @property {olleh.maps.vector.RectangleOptions} rectangleOpts Rectangle  \r\n   * @property {olleh.maps.vector.PolylineOptions} polylineOpts Polyline  \r\n   * @property {olleh.maps.vector.PolygonOptions} polygonOpts Polygon  \r\n   * @property {olleh.maps.plugin.drawing.EditingPluginOptions} editOpts  \r\n   * @property {olleh.maps.plugin.drawing.DrawingControlOpts} controlOpts Control  \r\n   */\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.DrawingServiceOptions} opts \r\n   */\r\n  DrawingService: function (opts) {\r\n    this._opts = opts || {};\r\n  },\r\n\r\n  attach: function() {\r\n    this.drawCircle = new olleh.maps.plugin.drawing.DrawCircle(this._opts);\r\n    this.drawCircle.setMap(this.map);\r\n    this.drawPolyline = new olleh.maps.plugin.drawing.DrawPolyline(this._opts);\r\n    this.drawPolyline.setMap(this.map);\r\n    this.drawPolygon = new olleh.maps.plugin.drawing.DrawPolygon(this._opts);\r\n    this.drawPolygon.setMap(this.map);\r\n    this.drawRectangle = new olleh.maps.plugin.drawing.DrawRectangle(this._opts);\r\n    this.drawRectangle.setMap(this.map);\r\n    this.editingPlugin = new olleh.maps.plugin.drawing.EditingPlugin(this._opts);\r\n    this.editingPlugin.setMap(this.map);\r\n    if(this._opts.controlOpts) {\r\n      this.control = new olleh.maps.plugin.drawing.DrawingControl(this._opts.controlOpts);\r\n      this.control.setMap(this.map);\r\n    }\r\n  },\r\n  \r\n  detach: function() {\r\n    this.drawCircle.setMap(null);\r\n    this.drawPolyline.setMap(null);\r\n    this.drawPolygon.setMap(null);\r\n    this.drawRectangle.setMap(null);\r\n    this.editingPlugin.setMap(null);\r\n    this.control && this.control.setMap(null);\r\n  }\r\n\r\n});/**\r\n * EditingPlugin\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditingPlugin').extend(olleh.maps.Plugin).define({\r\n  \r\n  serviceId: 'editingPlugin',\r\n  pluginInfo: {\r\n    drawingTool: true\r\n  },\r\n\r\n  /**\r\n   *  \r\n   * @private\r\n   * @typedef olleh.maps.plugin.drawing.EditingPluginOptions\r\n   * @property {String} activation ['click'|'all'] 'click'         .\r\n   *            'all'         .\r\n   */\r\n  /**\r\n   * CONSTRUCTOR\r\n   * @param {olleh.maps.plugin.drawing.DrawingServiceOptions} opts  \r\n   */\r\n  EditingPlugin: function (opts) {\r\n    opts = opts || {};\r\n    this._opts = opts.editOpts || {};\r\n  },\r\n  \r\n  doActivate: function() {\r\n    if(this._opts.activation === 'click') {\r\n      this.map.onEvent('click',this._onclick,this);\r\n    } else {\r\n      this._activateAllVector();\r\n    }\r\n  },\r\n  \r\n  _activateAllVector: function() {\r\n    var vectorLayer = this.map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n    var vectors = vectorLayer.getVectors();\r\n    for(var i=0; i<vectors.length; i++) {\r\n      vectors[i].setEditable(true);\r\n    }\r\n  },\r\n  \r\n  _deactivateAllVector: function() {\r\n    var vectorLayer = this.map.getLayer(olleh.maps.vector.VectorLayer.prototype.name);\r\n    var vectors = vectorLayer.getVectors();\r\n    for(var i=0; i<vectors.length; i++) {\r\n      vectors[i].setEditable(false);\r\n    }\r\n  },\r\n  \r\n  doDeactivate: function() {\r\n    if(this._opts.activation === 'click') {\r\n      if(this._activeEditTarget) {\r\n        this._activeEditTarget.setEditable(false);\r\n        this._activeEditTarget = null;\r\n      }\r\n      this.map.unsubscribeEvent('click',this._onclick,this);\r\n    } else {\r\n      this._deactivateAllVector();\r\n    }\r\n  },\r\n  \r\n  _onclick: function(event, payload) {\r\n    var source = event.getSource();\r\n    if(!(source instanceof olleh.maps.vector.Vector))\r\n      return;\r\n    if(this._activeEditTarget && this._activeEditTarget === source) {\r\n      return;\r\n    }\r\n    source.setEditable(true);\r\n    this._activeEditTarget = source;\r\n  }\r\n\r\n});/**\r\n * EditPolyline\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditPolyline').extend(olleh.maps.vector.EditHandler).define({\r\n\r\n  activate: function () {\r\n    if (!this.target)\r\n      return;\r\n    this._draggableVertices = [];\r\n    this._draggableVertices2 = [];\r\n    this.refresh();\r\n  },\r\n\r\n  refresh: function () {\r\n    var paths = this._getPaths();\r\n    var k = 0;\r\n    for (var j = 0; j < paths.length; j++) {\r\n      var path = paths[j];\r\n      var coords = path.getCoords();\r\n      for (var i = 0; i < coords.length; i++) {\r\n        var existing = this._draggableVertices[k];\r\n        if (existing) {\r\n          existing.setOptions({\r\n            path: path,\r\n            index: i\r\n          });\r\n        } else {\r\n          var vertex = new olleh.maps.plugin.drawing.PathEditingHandle({\r\n            editHandler: this,\r\n            path: path,\r\n            index: i,\r\n            map: this.target.map\r\n          });\r\n          this._draggableVertices.push(vertex);\r\n        }\r\n        if (!this._onChanging && (i > 0 || this.target instanceof olleh.maps.vector.Polygon)) {\r\n          var existing2 = this._draggableVertices2[k];\r\n          if (existing2) {\r\n            existing2.setOptions({\r\n              path: path,\r\n              index: i\r\n            });\r\n          } else {\r\n            var vertex = new olleh.maps.plugin.drawing.AddVertexHandle({\r\n              editHandler: this,\r\n              path: path,\r\n              index: i,\r\n              map: this.target.map\r\n            });\r\n            this._draggableVertices2.push(vertex);\r\n          }\r\n        }\r\n        k++;\r\n      }\r\n    }\r\n    var length = this._draggableVertices.length;\r\n    while (k++ < length) {\r\n      var toRemove = this._draggableVertices.pop();\r\n      toRemove.setMap(null);\r\n      toRemove = this._draggableVertices2.pop();\r\n      toRemove && toRemove.setMap(null);\r\n    }\r\n    var center = this.target.getCenter();\r\n    if (center) {\r\n      if (this._centerHandle) {\r\n        this._centerHandle.setPosition(center);\r\n      } else {\r\n        this._centerHandle = new olleh.maps.plugin.drawing.EditingHandle({\r\n          map: this.target.map,\r\n          position: center\r\n        });\r\n        this._centerHandle.onEvent('drag', this._onCenterDrag, this);\r\n      }\r\n    }\r\n  },\r\n\r\n  _getPaths: function () {\r\n    var paths;\r\n    if (this.target.getPath) {\r\n      paths = [ this.target.getPath() ];\r\n    } else {\r\n      paths = this.target.getPaths();\r\n    }\r\n    return paths;\r\n  },\r\n\r\n  _onCenterDrag: function (event) {\r\n    var oldCenter = this._centerHandle.getPosition();\r\n    var coord = event.getCoord();\r\n    var dx = coord.x - oldCenter.x;\r\n    var dy = coord.y - oldCenter.y;\r\n    this._centerHandle.setPosition(coord);\r\n    var draggableVertices = this._draggableVertices;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      var vertex = draggableVertices[i];\r\n      var pos = vertex.getPosition().clone();\r\n      pos.x += dx;\r\n      pos.y += dy;\r\n      vertex.setPosition(pos);\r\n    }\r\n    draggableVertices = this._draggableVertices2;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      var vertex = draggableVertices[i];\r\n      var pos = vertex.getPosition().clone();\r\n      pos.x += dx;\r\n      pos.y += dy;\r\n      vertex.setPosition(pos);\r\n    }\r\n    var paths = this._getPaths();\r\n    for (var i = 0; i < paths.length; i++) {\r\n      var path = paths[i];\r\n      var coords = path.getCoords();\r\n      for (var j = 0; j < coords.length; j++) {\r\n        var a = coords[j].clone();\r\n        a.x += dx;\r\n        a.y += dy;\r\n        coords[j] = a;\r\n      }\r\n    }\r\n    this.target.draw();\r\n  },\r\n\r\n  deactivate: function () {\r\n    var draggableVertices = this._draggableVertices;\r\n    this._draggableVertices = null;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      draggableVertices[i].setMap(null);\r\n    }\r\n    draggableVertices = this._draggableVertices2;\r\n    this._draggableVertices2 = null;\r\n    for (var i = 0; i < draggableVertices.length; i++) {\r\n      draggableVertices[i].setMap(null);\r\n    }\r\n    this._centerHandle.setMap(null);\r\n    this._centerHandle = null;\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Polyline'] = olleh.maps.plugin.drawing.EditPolyline;/**\r\n * EditRectangle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditRectangle').extend(olleh.maps.vector.EditHandler).define({\r\n\r\n  activate: function () {\r\n    var rectangle = this.target;\r\n    if (!rectangle)\r\n      return;\r\n    var bounds = rectangle.getBounds();\r\n    var handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.getLeftTopCoord()\r\n    });\r\n    this._leftTopHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.rightTop\r\n    });\r\n    this._rightTopHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.getRightBottomCoord()\r\n    });\r\n    this._rightBottomHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.leftBottom\r\n    });\r\n    this._leftBottomHandle = handle;;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n    \r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: rectangle.map,\r\n      position: bounds.getCenter()\r\n    });\r\n    this._centerHandle = handle;\r\n    handle.onEvent('drag', this._onDrag, this);\r\n  },\r\n\r\n  _onDrag: function (event, payload) {\r\n    event.preventDefault();\r\n    var coord = event.getCoord();\r\n    var handle = event.getSource();\r\n    var oppositePoint;\r\n    var rightTop = this._rightTopHandle.getPosition().clone();\r\n    var leftBottom = this._leftBottomHandle.getPosition().clone();\r\n    var leftTop = this._leftTopHandle.getPosition().clone();\r\n    var rightBottom = this._rightBottomHandle.getPosition().clone();\r\n    if (handle === this._leftTopHandle) {\r\n      oppositePoint = this._rightBottomHandle.getPosition();\r\n      rightTop.y = coord.y;\r\n      leftBottom.x = coord.x;\r\n      leftTop = coord;\r\n    } else if (handle === this._rightTopHandle) {\r\n      oppositePoint = this._leftBottomHandle.getPosition();\r\n      leftTop.y = coord.y;\r\n      rightBottom.x = coord.x;\r\n      rightTop = coord;\r\n    } else if (handle === this._rightBottomHandle) {\r\n      oppositePoint = this._leftTopHandle.getPosition();\r\n      rightTop.x = coord.x;\r\n      leftBottom.y = coord.y;\r\n      rightBottom = coord;\r\n    } else if (handle === this._leftBottomHandle) {\r\n      oppositePoint = this._rightTopHandle.getPosition();\r\n      leftTop.x = coord.x;\r\n      rightBottom.y = coord.y;\r\n      leftBottom = coord;\r\n    } else if(handle === this._centerHandle) {\r\n      var center = this._centerHandle.getPosition();\r\n      var dx = event.getCoord().x - center.x;\r\n      var dy = event.getCoord().y - center.y;\r\n      rightTop.x += dx;\r\n      rightTop.y += dy;\r\n      leftBottom.x += dx;\r\n      leftBottom.y += dy;\r\n      leftTop.x += dx;\r\n      leftTop.y += dy;\r\n      rightBottom.x += dx;\r\n      rightBottom.y += dy;\r\n      coord = leftTop;\r\n      oppositePoint = rightBottom;\r\n    }\r\n    var left = Math.min(coord.x, oppositePoint.x);\r\n    var bottom = Math.min(coord.y, oppositePoint.y);\r\n    var right = Math.max(coord.x, oppositePoint.x);\r\n    var top = Math.max(coord.y, oppositePoint.y);\r\n    bounds = new olleh.maps.Bounds(new olleh.maps.UTMK(left,bottom), new olleh.maps.UTMK(right,top));\r\n    this.target.setBounds(bounds);\r\n    \r\n    this._rightTopHandle.setPosition(rightTop);\r\n    this._leftBottomHandle.setPosition(leftBottom);\r\n    this._leftTopHandle.setPosition(leftTop);\r\n    this._rightBottomHandle.setPosition(rightBottom);\r\n    this._centerHandle.setPosition(bounds.getCenter());\r\n  },\r\n  \r\n  refresh: function() {\r\n    var bounds = this.target.getBounds();\r\n    this._rightTopHandle.setPosition(bounds.rightTop);\r\n    this._leftBottomHandle.setPosition(bounds.leftBottom);\r\n    this._leftTopHandle.setPosition(bounds.getLeftTopCoord());\r\n    this._rightBottomHandle.setPosition(bounds.getRightBottomCoord());\r\n    this._centerHandle.setPosition(bounds.getCenter());\r\n  },\r\n\r\n  deactivate: function () {\r\n    this._rightTopHandle.setMap(null);\r\n    this._leftBottomHandle.setMap(null);\r\n    this._leftTopHandle.setMap(null);\r\n    this._rightBottomHandle.setMap(null);\r\n    this._centerHandle.setMap(null);\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Rectangle'] = olleh.maps.plugin.drawing.EditRectangle;/**\r\n * EditPolygon\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditPolygon').extend(olleh.maps.plugin.drawing.EditPolyline).define({\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Polygon'] = olleh.maps.plugin.drawing.EditPolygon;/**\r\n * EditCircle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditCircle').extend(olleh.maps.vector.EditHandler).define({\r\n\r\n  activate: function() {\r\n    var circle = this.target;\r\n    if(!circle)\r\n      return;\r\n    var handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: circle.map,\r\n      position: circle.getCenter()\r\n    });\r\n    handle.onEvent('drag', this._onCenterDrag, this);\r\n    this._centerHandle = handle;\r\n    \r\n    var threeClock = circle.getCenter().clone();\r\n    threeClock.x += circle.getRadius();\r\n    handle = new olleh.maps.plugin.drawing.EditingHandle({\r\n      map: circle.map,\r\n      position: threeClock\r\n    });\r\n    handle.onEvent('drag', this._onRadiusDrag, this);\r\n    this._radiusHandle = handle;\r\n  },\r\n  \r\n  refresh: function() {\r\n    var circle = this.target;\r\n    this._centerHandle.setPosition(circle.getCenter());\r\n    var threeClock = circle.getCenter().clone();\r\n    threeClock.x += circle.getRadius();\r\n    this._radiusHandle.setPosition(threeClock);\r\n  },\r\n  \r\n  _onCenterDrag: function(event, payload) {\r\n    var coord = event.getCoord();\r\n    var circle = this.target;\r\n    var dx = coord.x - circle.getCenter().x;\r\n    var dy = coord.y - circle.getCenter().y;\r\n    circle.setCenter(coord);\r\n    var threeClock = this._radiusHandle.getPosition();\r\n    threeClock.x += dx;\r\n    threeClock.y += dy;\r\n    this._radiusHandle.setPosition(threeClock.clone());\r\n  },\r\n  \r\n  _onRadiusDrag: function(event, payload) {\r\n    var r = this.target.getCenter().distanceTo(event.getCoord());\r\n    this.target.setRadius(r);\r\n  },\r\n  \r\n  deactivate: function() {\r\n    this._centerHandle.setMap(null);\r\n    this._radiusHandle.setMap(null);\r\n  }\r\n\r\n});\r\n\r\nolleh.maps.vector.Vector.prototype.editHandlerRegistry['olleh.maps.vector.Circle'] = olleh.maps.plugin.drawing.EditCircle;/**\r\n * EditingHandle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.EditingHandle').extend(olleh.maps.overlay.PointedOverlay).define({\r\n  \r\n  defaultStyles: {\r\n    width:  '11px',\r\n    height: '11px',\r\n    marginLeft: '-5px',\r\n    marginTop: '-5px'\r\n  },\r\n  \r\n  update: function() {\r\n    if(!this.div) {\r\n      this.div = new olleh.maps.SpritedImage();\r\n      this.div.setImage(\r\n          olleh.maps.env.RESOURCE_URL + 'img/controls.png',\r\n          new olleh.maps.Point(127,145)\r\n      );\r\n      this.div.setStyles(this.defaultStyles);\r\n      olleh.maps.util.dom.setStyle(this.div.elem, 'userSelect', 'none');\r\n      this.registerElement('upper_overlay_pane', this.div.elem);\r\n      this.registerEventDom(this.div.elem);\r\n    }\r\n    olleh.maps.plugin.drawing.EditingHandle.$super.update.apply(this, arguments);\r\n  },\r\n  \r\n  $capture_dragstart: function(event, payload) {\r\n    event.preventDefault();\r\n  },\r\n  \r\n  $capture_dragend: function(event, payload) {\r\n    event.preventDefault();\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this.setPosition(coord);\r\n  },\r\n\r\n  $capture_drag: function (event, payload) {\r\n    event.preventDefault();\r\n    this.move(payload.movementXY);\r\n  }\r\n});/**\r\n * PathEditingHandle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.PathEditingHandle').extend(olleh.maps.plugin.drawing.EditingHandle).define({\r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.plugin.drawing.EditHandler} opts.editHandler\r\n   * @param {olleh.maps.Path} opts.path\r\n   * @param {Number} opts.index\r\n   */\r\n  PathEditingHandle: function (opts) {\r\n    this._editHandler = opts.editHandler;\r\n    this._path = opts.path;\r\n    this._index = opts.index;\r\n    this.setPosition(this._path.getAt(this._index));\r\n  },\r\n  \r\n  setOptions: function(opts) {\r\n    if(opts.path && opts.index !== undefined) {\r\n      this._path = opts.path;\r\n      this._index = opts.index;\r\n      this.setPosition(this._path.getAt(this._index));\r\n    } \r\n    olleh.maps.plugin.drawing.PathEditingHandle.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  $capture_dragstart: function(event, payload) {\r\n    event.preventDefault();\r\n  },\r\n  \r\n  $capture_dragend: function(event, payload) {\r\n    event.preventDefault();\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this.setPosition(coord);\r\n  },\r\n\r\n  $capture_drag: function (event, payload) {\r\n    event.preventDefault();\r\n    this.move(payload.movementXY);\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this._path.setAt(this._index, coord);\r\n  }\r\n\r\n});/**\r\n * AddVertexHandle\r\n * @private\r\n */\r\n$class('olleh.maps.plugin.drawing.AddVertexHandle').extend(olleh.maps.plugin.drawing.EditingHandle).define({\r\n  \r\n  defaultStyles: {\r\n    width:  '11px',\r\n    height: '11px',\r\n    marginLeft: '-5px',\r\n    marginTop: '-5px',\r\n    opacity: '.5'\r\n  },\r\n  \r\n  /**\r\n   * Constructor\r\n   * @param {olleh.maps.Path} opts.path \r\n   * @param {Number} opts.index \r\n   */\r\n  AddVertexHandle: function (opts) {\r\n    this._editHandler = opts.editHandler;\r\n    this._setOptions(opts);\r\n  },\r\n  \r\n  _setOptions: function(opts) {\r\n    this._path = opts.path;\r\n    this._index = opts.index;\r\n    var coords = opts.path.getCoords();\r\n    var prevIndex = opts.index === 0 ? coords.length-1 : opts.index-1;\r\n    var point1 = coords[prevIndex];\r\n    var point2 = coords[opts.index];\r\n    var point = point1.clone();\r\n    point.x += (point2.x - point1.x) / 2;\r\n    point.y += (point2.y - point1.y) / 2;\r\n    this.setPosition(point);\r\n  },\r\n\r\n  setOptions: function (opts) {\r\n    if (opts.path && opts.index !== undefined) {\r\n      this._setOptions(opts);\r\n    }\r\n    olleh.maps.plugin.drawing.AddVertexHandle.$super.setOptions.apply(this, arguments);\r\n  },\r\n\r\n  $capture_dragstart: function (event, payload) {\r\n    event.preventDefault();\r\n    var newPoint = event.getCoord().clone();\r\n    this._editHandler._onChanging = true;\r\n    this._path.insertAt(this._index, newPoint);\r\n  },\r\n\r\n  $capture_dragend: function (event, payload) {\r\n    event.preventDefault();\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this.setPosition(coord);\r\n    this._editHandler._onChanging = false;\r\n    this._editHandler.target.draw();\r\n  },\r\n\r\n  $capture_drag: function (event, payload) {\r\n    event.preventDefault();\r\n    this.move(payload.movementXY);\r\n    var coord = this.getLayer().layerMgr.getCoordFromLayerPx(this._currentLayerPx);\r\n    this._path.setAt(this._index, coord);\r\n  }\r\n\r\n});","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('kt-map')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"kmap\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"kmap\"></div>\n</template>\n\n<script>\nimport test from \"@/map/ktmap-all-desktop\";\n\n/* global olleh */\n\nexport default {\n  data: () => ({}),\n  methods: {\n    initMap() {\n      const container = document.getElementById(\"kmap\");\n      const options = {\n        center: new olleh.maps.UTMK(958386.063532902, 1941447.5761742294),\n        zoom: 9,\n        mapTypeId: \"ROADMAP\",\n      };\n      console.log(options);\n      const map = new olleh.maps.Map(container, options);\n      console.log(map);\n      console.log(\"inti Map completed...\");\n    },\n  },\n  mounted() {\n    console.log(test);\n    console.log(olleh);\n    console.log(\"KtMap Component Mounted...\");\n\n    if (!window.olleh || !window.olleh.maps) {\n      console.log(this.map);\n      this.initMap();\n    } else {\n      this.initMap();\n    }\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KtMap.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KtMap.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./KtMap.vue?vue&type=template&id=6b304cb0&\"\nimport script from \"./KtMap.vue?vue&type=script&lang=js&\"\nexport * from \"./KtMap.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <kt-map />\n</template>\n<script>\nimport KtMap from \"@/components/maps/KtMap.vue\";\n\nexport default {\n  name: \"MapView\",\n  components: {\n    KtMap,\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MapAnalysisView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MapAnalysisView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapAnalysisView.vue?vue&type=template&id=22996c53&\"\nimport script from \"./MapAnalysisView.vue?vue&type=script&lang=js&\"\nexport * from \"./MapAnalysisView.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["$","createHTML","forcedStringHTMLMethod","target","proto","forced","sup","this","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","module","exports","__esModule","_typeof","Symbol","iterator","constructor","prototype","document","write","GLOBAL","Date","now","Function","bind","oThis","TypeError","aArgs","Array","slice","call","arguments","fToBind","fNOP","fBound","apply","concat","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","oRequestAnimationFrame","cancelAnimationFrame","cancelRequestAnimationFrame","webkitCancelAnimationFrame","webkitCancelRequestAnimationFrame","mozCancelAnimationFrame","mozCancelRequestAnimationFrame","msCancelAnimationFrame","msCancelRequestAnimationFrame","oCancelAnimationFrame","oCancelRequestAnimationFrame","callback","setTimeout","undefined","requestid","window","clearTimeout","indexOf","elem","i","len","length","_OBJ2TYPE","olleh","maps","typeOf","toString","isArray","relaxed","splice","propertyIsEnumerable","isBoolean","isDate","isRegExp","isElement","nodeType","isFragment","isFunction","isNamespace","ns","isString","test","isNumber","isFinite","isObject","isUndefined","isValue","t","curry","fn","ctx","args","SyntaxError","_fn","_args","arr","a","mixin","dest","src","override","filter","p","hasOwnProperty","namespace","attach","overwrite","parent","modified","parts","split","isFn","Error","join","TObject","$super","$classname","currentStack","that","current","callee","caller","cs","name","isMixinOf","cls","mixins","getClass","$class","dontEnumProperties","dontEnumBug","extend","define","superclass","m","mm","shortname","substring","lastIndexOf","ctor","stack","push","pop","$constructor","supClsProto","afterDefine","supCls","$afterDefine","$static","desc","dontEnumProps","$skeleton","PROTOCOL","location","protocol","PORT","VERSION","RESOURCE_URL","TILE_URL","BASE","AIR","HYBRID","ENG","TRAFFIC","HD_BASE","HD_HYBRID","TILE_COPYRIGHT","LANG","$LANG","LOG_LEVEL","MSG","msg","lang","l","env","console","warn","BROWSER_NAME","ie","firefox","safari","chrome","opera","chromeMobile","chromeForAndroid","chromeForIos","other","ENGINE_NAME","webkit","gecko","presto","trident","OS_NAME","ios","android","mac","win","linux","STYLE_DASH_PREFIX","STYLE_PREFIX","browserName","browserVer","engineName","engineVer","event","hasOrientationChange","hasTouch","navigator","userAgent","has3D","hasCanvas","createElement","getContext","hasPointerEvents","hasSVG","implementation","hasFeature","hasVML","namespaces","div","innerHTML","childNodes","isMobile","isTablet","osName","osVer","style","styleDashPrefix","stylePrefix","styleTranslateTmpl","vector","isStyleSupported","browser","bodyStyle","body","capitalize","prop","browsers","engine","os","documentElement","enginePrefix","browserPrefix","osPrefix","mobile","android_tablet","ipad","ics3DWhiteList","ics3DBlackList","str","charAt","toUpperCase","substr","testStyle","testPrefixedStyle","match","RegExp","transition","transform","transformOrigin","backgroundSize","opacity","userSelect","get","getAttribute","set","setAttribute","removeAttribute","transitionend","parseFloat","isHD","isHDTile","usePulseForZoom","use3DRootPane","hotfixAndroid","ver","majorVers","majorVer","styleScaleTmpl","log","level","opts","_class","_package","_tag","config","_level","LEVEL","$tag","util","DEBUG","getMilliseconds","INFO","WARN","ERROR","FATAL","NONE","isLevel","debug","info","error","fatal","DEFAULT_PRECISION","INCHES_PER_UNIT","meters_per_inch","inches_per_unit","DOTS_PER_INCH","_ID_SEED","getTime","genId","prefix","radToDeg","radian","Math","PI","degToRad","degree","toFloat","num","precision","toPrecision","getResolutionFromScale","scale","units","resolution","normScale","getScaleFromResolution","applyTemplate","tmpl","data","item","to","regexp","exec","replace","lastIndex","index","fromIndex","n","Number","Infinity","floor","abs","k","max","min","removeFromArray","toRemove","trim","string","end","ws","copyOpts","excludes","clone","object","source","startsWith","delay","milis","curried","defer","deferAF","CSS_UNITS","getStyle","getComputedStyle","dom","browserStyle","currentStyle","hyphenToCamelCase","defaultView","getPropertyValue","camelCaseToHyphen","setStyle","setStyles","styles","addClass","className","classList","add","hasClass","contains","elemClassName","removeClass","remove","replaceClass","oldC","newC","toggleClass","elementOf","id","getElementById","pushElement","children","insertBefore","appendChild","popElement","removeChild","removeElements","e","r","elems","removed","parentNode","unshift","extractValueFromStyle","result","isNaN","extractUnitFromStyle","unit","getTranslateString","x","y","use3D","getScaleString","getPositionStyles","useTransform","left","top","getPointFromStyle","parsed","parseStyleValue","loop","params","Point","getXY","webkitConvert","webkitConvertPointFromNodeToPage","point","WebKitPoint","rect","getBoundingClientRect","pageXOffset","pageYOffset","ie8","scrollLeft","scrollTop","_round","_cbHyphenToCamelCase","_","c","_cbCamelCaseToHyphen","toLowerCase","uv","getUnitAndValue","methodParams","methodName","parsedStyleToString","parsedStyle","j","s","methodResult","floatValue","isAttached","map","getMap","setMap","_unregisterService","detach","_registerService","serviceId","services","Adaptable","setPluginInfo","pluginInfo","pluginRegistry","deactivate","autoActivate","isStarted","activate","callActivate","unsubscribeEvent","onEvent","isActive","_active","drawingTool","drawingToolActivate","doActivate","setActive","active","fireEvent","plugin","doDeactivate","Initializable","init","Proj4js","defaultDatum","readyToUse","reportError","srsCode","datum","datum_type","common","PJD_3PARAM","PJD_7PARAM","datumCode","wgs84","WGS84","axis","adjust_axis","projName","D2R","to_meter","inverse","from_greenwich","datum_transform","R2D","forward","compare_datums","PJD_NODATUM","es","geodetic_to_geocentric","geocentric_to_wgs84","geocentric_from_wgs84","geocentric_to_geodetic","crs","denorm","v","xin","yin","zin","z","alert","destination","property","Class","initialize","extended","func","newArgs","scriptName","defsLookupService","libPath","getScriptLocation","scriptNameLen","scripts","getElementsByTagName","loadScript","url","onload","onfail","loadCheck","script","type","onerror","onreadystatechange","checkReadyState","readyState","Proj","title","x0","y0","localCS","queue","srsCodeInput","parseWKT","deriveConstants","loadProjCode","urn","srsAuth","srsProjNumber","loadProjDefinition","defs","defsLoaded","loadFromService","checkDefsLoaded","defsFailed","parseDefs","initTransforms","loadProjCodeSuccess","loadProjCodeFailure","checkCodeLoaded","dependsOn","shift","wktRE","wkt","wktMatch","wktName","wktObject","wktContent","wktTemp","wktArray","bkCount","token","geocsCode","wktProjections","datumName","ellps","rf","unitsPerMeter","k0","long0","lat0","datum_params","paramName","paramVal","defData","paramArray","nagrids","b","lat1","lat2","lat_ts","alpha","longc","R_A","zone","parseInt","utmSouth","PrimeMeridian","legalAxis","datumDef","Datum","towgs84","ellipse","Ellipsoid","EPSLN","sphere","a2","b2","sqrt","SIXTH","RA4","RA6","ep2","longlat","pt","identity","HALF_PI","TWO_PI","FORTPI","SEC_TO_RAD","MAX_ITER","COS_67P5","AD_C","PJD_UNKNOWN","PJD_GRIDSHIFT","PJD_WGS84","SRS_WGS84_SEMIMAJOR","RV4","RV6","msfnz","eccent","sinphi","cosphi","con","tsfnz","phi","com","pow","tan","phi2z","ts","dphi","eccnth","atan","sin","qsfnz","asinz","asin","e0fn","e1fn","e2fn","e3fn","mlfn","e0","e1","e2","e3","srat","esinp","exp","sign","adjust_lon","adjust_lat","latiso","NaN","POSITIVE_INFINITY","fL","L","invlatiso","Iphi","sinh","cosh","tanh","asinh","acosh","atanh","gN","temp","pj_enfn","en","C00","C02","C04","C06","C08","C22","C44","C46","C48","C66","C68","C88","pj_mlfn","sphi","cphi","pj_inv_mlfn","arg","cos","proj","X","Y","Z","Rn","Sin_Lat","Sin2_Lat","Cos_Lat","Longitude","Latitude","Height","Error_Code","P","RR","CT","ST","RX","RK","RN","CPHI0","SPHI0","CPHI","SPHI","SDPHI","iter","genau","genau2","maxiter","atan2","geocentric_to_geodetic_noniter","W","W2","T0","T1","S0","S1","Sin_B0","Sin3_B0","Cos_B0","Sin_p1","Cos_p1","Sum","At_Pole","Dx_BF","Dy_BF","Dz_BF","Rx_BF","Ry_BF","Rz_BF","M_BF","x_out","y_out","z_out","x_tmp","y_tmp","z_tmp","coords","toShortString","ellipseName","nadgrids","tmerc","ml0","lon","lat","delta_lon","sin_phi","cos_phi","acos","al","als","tq","ml","delta_phi","max_iter","f","g","h","tan_phi","d","ds","DEFAULT_EPSILON_IN_METER","Coord","equals","almostEquals","epsilonInMeter","distanceTo","utmkThis","asDefault","utmkOther","diff","xy","Type","PROJ","UTMK","valueOf","_projs","arg0","arg1","coord","LatLng","lng","Katech","Path","_coords","clear","_notifyListeners","getCoords","getAt","getLength","insertAt","last","removeAt","setAt","onChange","callbackFn","listener","_getEventListener","idx","ctxs","unsubscribeChange","_listeners","create","listeners","getFirst","getLast","getDistance","distance","getArea","area","coord1","coord2","getType","getCenteroid","sumX","sumY","center","getBounds","bottom","right","leftBottom","rightTop","Bounds","closedPath","dist","_distanceToSegment","x1","y1","x2","y2","segment","dx","dy","along","simplify","tolerance","firstPoint","lastPoint","pointIndexsToKeep","_douglasPeuckerReduction","returnPoints","sort","maxDistance","indexFarthest","_perpendicularDistance","point1","point2","height","getLeft","getBottom","getRight","getTop","getLeftTopCoord","getRightBottomCoord","getWidth","utmkBounds","getHeight","getCenter","intersects","_containsCoord","utmkCoord","intersection","union","_unionCoord","expand","width","zero","_zero","_add","subtract","_subtract","divideBy","_divideBy","multiplyBy","_multiplyBy","round","_floor","toCSSString","Size","full","_full","size","asPoint","tagName","element","Element","getProperty","setProperty","setProperties","properties","oldClassName","newClassName","forceReflow","clientWidth","addEventListener","attachEvent","removeEventListener","detachEvent","SpritedImage","position","backgroundColor","backgroundRepeat","_img","setImage","origin","scaledSize","backgroundImage","backgroundPosition","Timing","getCSSName","getBackwardCSSName","getFn","genFn","fx","timing","CubicBezier","f0","f1","f2","refinedT","refinedT2","refinedT3","slope","CubicBezierBasedTiming","_curve","Ease","EaseIn","EaseOut","EaseInOut","linear","Linear","ease","easeIn","easeOut","easeInOut","DEFAULT_DURATION","DEFAULT_TIMING","REPEAT_FOREVER","Animation","from","duration","repeat","comeback","pulse","newAnimator","Animator","NoAnimationAnimator","CSSAnimator","PulseAnimator","animate","start","animateSync","startSync","applyImmediately","Pulse","period","_jobs","initTime","stop","isPlaying","_af","startTime","_step","time","playTime","useAFTime","AnimatorBuffer","_animators","_timer","animator","flush","status","animatorBuffer","doInit","doCycle","doStop","doClean","stopRepeat","pause","doPause","resume","doResume","cancel","doCancel","abort","ignore","doIgnore","finishCycle","_styleName","_eventType","_bound_onTransitionend","_onTransitionend","_isForward","_listening","_clearEventFallback","_startTimestamp","_playedTimestamp","_receivedEvent","_startTransition","_pausedStyles","_styleCount","_eventFallback","_finish","stopPropagation","getPulse","_pulse","_lastStyle","setPulse","_attached","_bound_step","step","_from","_to","_detachPulse","_attachPulse","_applyStyle","RangeError","_lastTime","ll","fromOpt","toOpt","fromParam","toParam","percent","ceil","AnimationFrameQueue","_enabled","isEnabled","setEnabled","enabled","job","jobs","performance","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","DEFAULT_PHASE","Event","_name","_src","_stopPropagation","_stopImmediatePropagation","_defaultPrevented","eventPhase","pageXY","_point","_coord","_map","targetTouches","touches","changedTouches","originEvent","timeStamp","pageX","pageY","targetDOM","ownerDocument","doc","clientX","clientLeft","clientY","clientTop","getName","getSource","stopImmediatePropagation","preventDefault","getPoint","_getMap","rootXY","layerMgr","getViewportOffset","getCoord","viewportPx","getCoordFromViewportPx","hit","bubble","getBubble","Map","registerEvent","eventMgr","_getEventManager","registry","registerEventDom","registryDom","unregisterEventDom","unregistryDom","unregisterEvent","unregistry","getId","_id","payload","_handleFireEvent","lookupBubbles","results","eventName","capture","_findEventListener","$ctxs","propagateEvent","_getEventListeners","$fn","_eventListeners","_findEventListeners","phase","_eventMgr","defaultFn","path","_checkEvent","capturing","ex","$EVENTS","clazz","clazzPrototype","events","domEvent","cancelBubble","returnValue","isRightClick","which","button","checkEnabledKeyevent","activeElement","nodeName","EventManager","_root","_hitTargets","_recognizers","_desktopIE","_clicked","_layerMgr","_history","_addEventsListener","hackDOM","zIndex","_hackDOM","_mousewheel","_started","_removeEventsListener","delegator","findRecognizer","classname","addRecognizer","recognizer","Recognizer","removeRecognizer","names","handler","_ieHandler","handleEvent","domTarget","srcElement","_prevDomEvent","_domEvent","_prevActiveElement","_activeElement","domMousedownEvent","domMouseupEvent","domMousemoveEvent","domGenericEvent","domMouseoverEvent","domMouseoutEvent","domResizeEvent","parentElement","domKeyboardEvent","handleTouchEvent","hitTarget","relatedTarget","handleMapEvent","root","offsetWidth","clientHeight","offsetHeight","orientation","getSelection","empty","removeAllRanges","selection","focus","blur","prevEvent","_prevEvent","touch","prevDomEvent","_mousedown","identifier","setEnable","_opts","noevent","returnVal","noPointerEvents","noevents","layerMgrElem","_root_pane","_findAncestorNoEventDom","visibility","elementFromPoint","innerText","textContent","resultSrc","recognizeredEvent","resultEvent","handle","isMapClicked","_disabled","_EXCLUDES","handlerClass","EventDelegator","fnName","originHandleFn","backup","Corner","ctrls","vAlign","hAlign","horizontalArea","_createInnerDom","verticalArea","ControlManager","_ctrls","_corners","_defaultMargin","corner","corners","cornerClass","control","ctrlClass","Control","positions","TOP_LEFT","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_RIGHT","fragment","createDocumentFragment","getOptions","draw","_getCtrlClassName","ctrl","cn","mgr","option","setDrawn","_updatePosition","direction","cornerDOM","container","containerDOM","firstChild","_containerDOM","destroy","removeByClass","findByClass","removeAll","HORIZONTAL","VERTICAL","IMG_URL","padding","_isDrawn","initOptions","setPosition","setDirection","controlMgr","isDrawn","Plugin","layerType","Layer","_constructorOpts","label","group","setVisible","getPane","move","moveStart","moveEnd","mapStart","zoomStart","zoomEnd","oldZoom","newZoom","visible","isVisible","isVisibleForZoom","setActiveBaseLayer","getActiveBaseLayer","addLayer","removeLayer","getResolutionForZoom","zoom","defaultOpts","minZoom","maxZoom","maxExtent","panAnimDuration","zoomAnimDuration","useCSSTransform","LayerManager","_center","_zoom","_minZoom","_maxZoom","_mapElem","_viewportSize","_viewportOffset","_layerOffset","_pendingZoom","_pendingCenter","_isZooming","_baseLayers","_groundLayers","_activeBaseLayer","_overlayLayer","_transparent_pane","_layer_container","_panAnimTiming","_initPanes","layer_container","_createPane","transparent_pane","display","pane","layer","addBaseLayer","addGroundLayer","getLayer","layerName","getBaseLayers","getGroundLayers","getOverlayLayer","oldLayer","TileLayer","_hideLayerFn","minMaxZoomChanged","_updateMinMaxZoom","moveTo","setMinZoom","_updateZoomRange","setMaxZoom","mapMaxZoom","newMinZoom","newMaxZoom","getZoomForBounds","bounds","coordSize","_getCoordSizeForZoom","isValidCoord","_disableLoadingWhilePanning","getOption","_initialBounds","panAnimEaseLinearity1","panAnimEaseLinearity2","_zoomPulse","overlayLayer","panes","backgroundLayer","BackgroundLayer","_backgroundLayer","getResolution","getViewportSize","getViewportCenter","getLayerOffset","_getCoordOrigin","afterZoom","getPendingZoom","getPendingCenter","getViewportPxFromCoord","coordOrigin","getLayerPxFromCoord","getCoordFromLayerPx","layerPx","getLayerPxFromViewportPx","getViewportPxFromLayerPx","getZoom","getMinZoom","getMaxZoom","_getScaleForZoom","_getScaleForChanges","changeAmount","_getZoomForScale","LN2","setZoom","zoomIn","zoomOut","panToBounds","panTo","fitBounds","panBy","newCenter","calcNewCenter","_dx","_dy","animation","_moveRootPane","_getPositionStyles","_panRootPane","animationDuration","animationCallback","currentStyles","_rootPaneAnimator","_abortPanAnimationAndUpdateCenter","currentPosition","_moveLayers","_resetIdleTimer","setCenter","resize","horizontalRef","verticalRef","viewportSize","_viewportSizeChanged","_adjustCenter","restrictedExtent","centerBounds","_pinch_started","oldCenter","zoomChanged","centerChanged","forceDraw","useAnimation","panDuration","zoomDuration","_zoomEndReq","_setBounds","_drawLayers","_fireBoundsChangedEvent","_initialOriginLayerPx","_initialCenterLayerPx","initialCenterLayerPx","offsetPx","tempCoord","centerLayerPx","_zoomStartLayers","_triggerZoomEnd","_moveEndLayers","_moveStartLayers","_triggerZoomEnd2","_zoomTimer","_triggerZoomEnd3","_zoomEndLayers","_centerChanged","_zoomChanged","isZooming","_forEachLayers","_idle","fnString","setEditMode","editable","getMaxExtent","getRestrictedExtent","_idleTimer","__resetIdleTimer","_pane","_buffer","_onIdle","layerOffset","buffeSize","baseIndex","disableShadow","paneIds","OverlayLayer","paneId","_visible","_overlays","_displayedOverlays","_gridIndex","overlay","GridIndex","$current_bounds_changed","o","_updateSingleOverlayDisplayHint","$current_position_changed","getOverlays","overlayPanes","_toAddOverlaysAtZoomEnd","getPosition","erase","layerBoundsChanged","currentCenter","bufferBounds","_getBufferBounds","_onBoundsChanged","overlays","toAddOverlaysAtZoomEnd","isMapStart","_bounds","_updateAllOverlayDisplayHint","_getBufferSize","lm","buffer","overlaysAsArray","setDisplayHint","displayHint","cellSize","_cellSize","_grid","col","cell","range","_getCellRange","getIndexObject","minX","maxX","minY","maxY","xMax","yMax","oMax","gridX","gridY","PluginRegistry","_plugins","_drawingTools","getPlugins","getLabeledPluginsByGroup","plugins","pluginsByGroup","groupId","arrs","DEFAULT_MAX_EXTENT_LEFT","DEFAULT_MAX_EXTENT_BOTTOM","DEFAULT_MAX_EXTENT_RIGHT","DEFAULT_MAX_EXTENT_TOP","ROADMAP","SATELLITE","ENGMAP","DEFAULT_NORMAL_MAX_ZOOM","mapTypeId","trackWindowSize","disableDraggingCursor","draggingCursor","draggableCursor","disableLoadingWhilePanning","useEngMap","skeleton","_defaultOpts","_cursor","_cursors","_setUseEngMap","hasMobileStylesheet","_mapTypeRegistry","setMapTypeId","setCursor","_orientation","_useEngMap","getUseEngMap","registerMapType","mapTypePlugin","_mapTypeId","unregisterMapType","getMapTypeRegistry","oldMapTypePlugin","getMapTypeId","_warnZooming","_checkStart","cursor","resetCursor","checkDefaultControl","ctrlName","ctrlOpt","disableDefaultUI","defaultValue","mergeDefaultOptions","$default_resize","ref","getTooltip","_tooltip","Tooltip","Tile","setLayer","_animationPolicy","_loading","_layer","setEffectPolicy","animationPolicy","isLoading","_position","_getTileSize","normalMaxZoom","tileSize","tileSizeW","tileSizeH","getURL","_url","setPositionAndUrl","_update","img","tileAnimation","stopAnimator","cachedTileURLs","_animator","_fadedin","getElement","_bound_onload","_onload","_bound_onerror","_onerror","errorTileURL","isFinished","ERROR_TILE_URL","DEFAULT_TILE_SIZE","DEFAULT_MAX_WAIT_TIME","DEFAULT_UPDATE_INTERVAL","DEFAULT_BUFFER_NUM","DEFAULT_TILE_FADE_IN_DURATION","maxWaitTime","_tileQueue","_tiles","_movingBuffer","_createGridDiv","tileFadeInDuration","bufferNum","_updateInterval","getTileSize","_updateVisibility","_getLayerSize","gridNum","_gridNum","_getDisplayOffset","offset","_offset","_getTilePosition","_div","_removeTileFromArray","_getGridNum","_cleanup","dontCleanZoomingBuffer","_loadedTileNum","_unloadedTileNum","_stopUpdateTimer","_stopZoomAnimation","_cleanZoomingBufferDiv","_calculate","tileOrigin","tileCoordSize","coordOffset","tileLeftBottom","tile","tileInfo","tilePosition","tileUrl","oldTiles","tiles","later","unloadedTileNum","getTileURL","isMoving","_updateTimer","_shiftGrid","_cleanMovingBuffer","useBuffer","isUpdated","layerSize","bufferSize","displayOffset","_shiftCol","_shiftRow","tileCol","_shiftTile","oldTile","newTile","_appendTileLater","_zoomingScale","zoomingTiles","_stopCleanTimer","_zoomingTiles","_zoomingBufferDiv","_zoomWithTransform","_zoomWithoutTransform","zoomingBufferDiv","_zoomAnimator","_zoomAnimators","_cleanTimer","$capture_loaded","logoType","_OUT_OF_BOUND_TILE_URL","tileMaxBounds","OllehTileLayer","OUT_OF_BOUND_TILE_URL","_maxTileIndex","getMaxTileIndex","maxTileIndex","nomalMaxZoom","maxIndex","tileX","tileY","tileOpt","tileURLTmpl","_fillZero","useHD","oBase","copyright","DefaultComponents","setAirMap","setEngMap","setHybridMap","oHybrid","ollehHybridMapType","OllehHybridMapType","oAir","ollehAirMapType","OllehAirMapType","oEng","ollehEngMapType","OllehEngMapType","OllehTilesPlugin","SPEED_INFO","color","loadSpeed","TrafficInfoControl","tooltips","rdoms","speedInfos","imgDiv","_closeTrafficInfo","_openTrafficInfo","createTextNode","speedInfo","trafficBar","loadInfos","pointerEvents","tooltip","ul","loadInfo","li","infoElem","MobileTrafficInfoControl","trafficImg","_trafficImg","trafficLayer","trafficInfoControl","TrafficInfoPlugin","Overlay","_bubble","setOptions","isAdded","onAdd","onRemove","setBubble","MAX_ZINDEX","BaseOverlay","_drawn","_zIndex","_displayHint","elements","_moveAnimators","setZIndex","update","_updateZIndex","_display","forEachElement","getCurrentZIndex","_currentZIndex","getZIndex","_isFront","getAutoZIndex","bringToFront","resetZIndex","isRegistered","registerElement","appendElement","unregisterElement","removeElement","_currentStyles","appendElements","ready","cleanup","erased","_fadeInAnimation","getFadeInAnimation","_fadeInRequested","_fadeInFinished","_fadeInElement","_fadeOutAnimation","getFadeOutAnimation","_removeRequested","_removeFinished","_fadeOutElement","_onFadeInFinished","_onElementRemoved","stopAnimators","moveAnimators","updatePositioningStyles","animateTo","_finishedAnimation","_animationCallback","_animationCallbackCtx","_animationFinished","OverlayGroup","PointedOverlay","maxTopCoord","before","_currentLayerPx","getOriginalLayerPx","newPx","px","getCurrentLayerPx","$default_mouseover","$default_mouseout","DEFAULT_ICON","DEFAULT_MOBILE_ICON","DEFAULT_HD_ICON","DEFAULT_SHADOW","anchor","DEFAULT_MOBILE_SHADOW","DEFAULT_HD_SHADOW","DRAG_POINT","DRAG_FLOATING_PX","BOUNCE","DROP","bouncePulse","dropTiming","DropTiming","getBounceAnimator","isShadow","SQRT1_2","marginLeft","marginTop","Marker","getDropAnimator","_title","_flat","_draggable","_angle","icon","setIcon","angle","setAngle","shadow","setShadow","caption","setCaption","setTitle","draggable","setDraggable","flat","setFlat","setAnimation","_updateIcon","_updateAngle","_updateCursor","_updateShadow","_updateCaption","_updateAnimation","_infoWin","close","getIcon","_icon","_iconImg","iconDiv","_currentIcon","getAngle","getTitle","getCursor","getShadow","_shadowImg","_shadow","_shadowAnimator","_currentShadow","getCaption","_caption","span","_captionDiv","textAlign","fontSize","fontWeight","isFlat","isDraggable","isDragging","_isDragging","$capture_dragstart","dragImg","_dragImg","_float","_dragStart","$capture_drag","movementXY","_drag","$capture_dragend","_sink","_dragEnd","shadowD","_animation","getAnimation","stopAnimationImmediately","_iconAnimator","stopAnimation","setInfoWindow","infoWin","pos","setContent","setPixelOffset","open","ContentOverlay","_defaultCss","_defaultPadding","_body","_marginPx","_topleftPx","pixelOffset","_contentAttacted","contentSize","minWidth","minHeight","maxWidth","maxHeight","$default_detached","_eliminateElements","_setMaxWidth","_setPadding","content","_updateContent","contentElem","_updateElements","beforeContent","getContent","_updateMargin","_updateBounds","getPixelOffset","createBodyElem","createShadowElem","domutil","_checkContentSize","_topLeftPx","topLeftPoint","optsContent","rootElem","_appendEvent","oldBounds","topleft","s_topleft","s_leftBottom","s_rightTop","shadowBounds","bm","sm","pDiv","iDiv","contentPadding","dbContentPadding","margin","overflow","infopane","disableCloseButton","closeElem","AUTO_PAN_MARGIN","BaseInfoWindow","_anchor","_anchorOffset","$default_attached","disableAutoPan","_autoPan","$capture_click","$default_click","_optsPosition","markerIcon","markerShadow","_setPosition","bodyUpPoint","shadowUpPoint","_dragUpPoint","deltaPoint","BaseInfo","tPoint","centerPoint","viewSize","viewHalfOfWidth","viewHalfOfHeight","viewTopLeft","viewBottomRight","infoData","_calInfoData","infoPos","infoSize","infoTopLeft","topLeft","infoBottomRight","bottomRight","moveX","moveY","infoTopTypePoint","infoBottomTypePoint","isMoveX","isMoveY","checkInfoSize","isLongerThanView","isHigherThanView","checkInfoPos","isLeftOfCenter","isTopOfCenter","URL","SHADOW_URL","INFO_URL","CLOSE_URL","BORDER","TIP_POS_RATE","TIP_POS_MAXLEFT","TIP_HEIGHT","TIP_NOVIEW_HEIGHT","SHADOW_LEFT_HYPOTENUSE","SHADOW_RIGHT_HYPOTENUSE","SHADOW_LEFT_HYPOTENUSE_HEIGHT_WIDTH_GAP","SHADOW_IMG_TIP_GAP","SHADOW_IMG_TIP_WIDTH","SHADOW_IMG_TOP_HEIGHT","SHADOW_IMG_TOP_WIDTH","SHADOW_IMG_BOTTOM_HEIGHT","SHADOW_IMG_BOTTOM_WIDTH","SHADOW_IMG_LEFTTOP_WIDTH","SHADOW_IMG_RIGHTTOP_WIDTH","SHADOW_IMG_LEFTBOTTOM_WIDTH","SHADOW_IMG_RIGHTBOTTOM_WIDTH","SHADOW_IMG_LEFTBOTTOM_W_PADDING","INFO_TMPL","INFO_SHADOW_TMPL","InfoWindow","infoBodyWidth","infoBodyHeight","infoWidth","infoHeight","infoPosY","tipleftPos","infoleftofTip","infoPosX","infoTopofTip","infoDiv","closeUrl","infoUrl","contentMaxWidth","contentWidth","contentHeight","bodyWidth","bodyHeight","shadowHeight","shadowWidth","shadowInfoLeftofTip","shadowPosY","shadowPosX","infoShadowDiv","middleLeftHSize","topCenterWSize","bottomLeftTipWSize","bottomRightTipWSize","bottomLeftPoint","bottomLeftOfTipPoint","bottomLeftOfTipWidth","bottomTipPoint","bottomRightOfTipPoint","bottomRightOfTipRightWidth","bottomRightPoint","middleLeftWidth","middleLeftPoint","middleLeftSize","middleLeftImgLeftPx","middlePoint","middleSize","middleRightPoint","middleRightSize","middleRightImgLeftPx","topCenterPoint","topCenterWidth","topRightPoint","bottomLeftPointX","bottomLeftPointY","bottomRightPointX","bottomRightPointY","bottomTipPointX","bottomTipPointY","topCenterPointX","topCenterPointY","middleLeftPointX","middleLeftPointY","middleLeftHeight","middleRightPointX","middleRightPointY","middleRightWidth","middleRightHeight","bottomLeftOfTipPointX","bottomLeftOfTipPointY","bottomRightOfTipPointX","bottomRightOfTipPointY","middlePointX","middlePointY","middleWidth","middleHeight","TOOLTIP_TMPL","contentMaxHeight","_calTooltipPosition","viewBounds","radius","_calRadiusOfAnchor","mIcon","_isOpenOptions","_openOptions","options","ProjectedOverlay","_opacity","_fadeIn","_fadeOut","setBounds","setOpacity","fadeIn","setFadeIn","fadeOut","setFadeOut","_updateOpacity","_currentScale","getOriginalSize","getOpacity","isFadeIn","isFadeOut","originalSize","originalLayerPx","leftBottomPx","rightTopPx","getCurrentScale","setURL","GroundOverlay","_updateURL","$default_mousemove","rendererName","editHandlerRegistry","Vector","_editable","_element","_eventDom","_renderer","_getDefaultOptions","_updateVisiblity","createRenderer","getRendererFactory","_doDraw","getRootElement","getContainer","eventDom","getEventDom","_attachEditHandler","_detachEditHandler","setEditable","isEditable","_editHandler","refresh","editHandlerClass","editHandler","_convertPathToPoints","points","Polygon","paths","getPaths","setPaths","existingPaths","pointsArray","fillColor","fillOpacity","fillRule","strokeColor","strokeOpacity","strokeWeight","Polyline","setPath","getPath","icons","Rectangle","leftTopPx","widthPx","heightPx","strokePosition","Circle","getRadius","centerPx","radiusPx","setCenterAndRadius","setRadius","center_","prepareToDraw","ContainerRenderer","createContainer","PathRenderer","lineTo","circle","cx","cy","closePath","commit","PolylineRenderer","RectangleRenderer","leftTop","CircleRenderer","PolygonRenderer","BaseRenderer","createElementNS","tag","svg","Renderer","strokeDasharray","weight","strokeLinecap","strokeLinejoin","strokeStyle","_strokeDashArray","_initCommand","_command","_svgElem","use3d","curX","curY","polyline","preX","preY","unselectable","vml","_containerElem","stroked","_stroke","endcap","joinstyle","dashStyle","filled","_fill","_updateSize","_width","_height","coordsize","_translateX","_translateY","_union","command","_toCommandStr","startX","startY","_getPoints","rightBottom","weightFactor","canvas","canvasElem","_padding","lineCap","lineJoin","_updateStyle","save","fillStyle","globalAlpha","fill","lineWidth","stroke","restore","_updateCanvas","padding2","rootWidth","rootHeight","translate","beginPath","arc","createPolylineRenderer","createPolygonRenderer","createRectangleRenderer","createCircleRenderer","createContainerRenderer","_containerRenderer","createPathRenderer","VectorLayer","_vectors","_rendererFactory","RendererFactory","_zoomAnim","_isVisible","_ensureStopAnimation","drawAll","defaultType","_eraseAll","getVectors","_container","EditHandler","getTarget","VectorPlugin","Quickhull","getDistant","cpt","bl","findMostDistantPointFromBaseLine","baseLine","maxD","maxPt","newPoints","buildConvexHull","convexHullBaseLines","maxPoint","getConvexHull","minPt","MIN_VALUE","MAX_VALUE","DEFAULT_FONT_SIZE","DEFAULT_FONT_COLOR","DEFAULT_AREA_STYLE","DEFAULT_ICON_FN","MARKER_ANIMATE_DURATION","MarkerCluster","_clickToExpand","_clickToZoom","_displaySize","_fontSize","_fontColor","_displayArea","_areaStyle","_iconFn","_areaPath","_originMap","_area","_children","_size","isExpanded","resetPosition","setResetPosition","clickToZoom","setClickToZoom","clickToExpand","setClickToExpand","displaySize","setDisplaySize","setFontSize","fontColor","setFontColor","displayArea","setDisplayArea","areaStyle","setAreaStyle","iconFn","setIconFn","isVisibleAtZoom","isResetPosition","_resetPosition","isClickToZoom","isClickToExpand","isDisplaySize","_sizeDiv","getSize","getFontSize","getFontColor","isDisplayArea","hideArea","getAreaStyle","getIconFn","paddingTop","child","_invalidate","depth","areaAdded","showArea","markers","getAllMarkers","getChildren","getMarkers","expandToDepth","rootPx","_markerOnAdd","_clusterOnRemove","_onMapClick","expandToZoom","collapse","_markerOnRemove","_clusterOnAdd","markerCoords","pathCoords","convexHull","_clusterReady","MarkerClusterer","_clusterOpts","clusterOpts","_gap","gap","_getDistance","defaultGetDistance","_getThreshold","getThreshold","defaultGetThreshold","_afterCluster","afterCluster","_displayed","_bound_onClusterPositionChanged","_onClusterPositionChanged","_rootCluster","_index","marker","otherMarker","grandparent","sibling","_removeFromIndex","_addToIndex","cluster","closest","_getClosest","meter","threshold","minDistance","_getAdjustedZoom","_onboundschanged","_updateZoom","_expand","_collapse","oldMarkers","newMarkers","_recursevely","_hideNonDisplayedMarkers","childCnt","Drag","_startEvent","_isDragStart","_xy","mousedown","mouseup","_reset","mousemove","startEvent","prevXY","click","touchstart","touchmove","touchend","dragInertia","dragInertiaThreshold","dragInertiaDeceleration","_zeroPoint","$default_dragstart","_times","_points","$default_drag","$default_dragend","prevTime","momentum","_momentum","easeLinearity","inertiaDeceleration","speedVector","speed","deccelerationDuration","_calcZoomCenter","mousePx","viewportCenter","centerOffsetPx","newCenterPx","_checkZoomLevel","$default_req_zoomin","$default_req_zoomout","$default_dblclick","disableDoubleClickZoom","Zoom","$default_dblrightclick","HANDLERS","handlers","DefautlHandlers","DoubleClickZoom","DoubleClick","isDblclicked","clickThreshold","dblrightclick","clickDuration","prevClick","RightClick","ScrollWheelZoom","_timeStamp","mousewheel","delta","wheelDelta","detail","KeyboardZoom","keydown","keyCode","$capture_mousedown","$default_mousewheel","$default_keydown","moveSize","_keymoveX","_keymoveY","_moveTimeout","_keyboardMoveStart","_keyboardMove","$default_keyup","_ok","$current_dragstart","shiftKey","_boxZoomElem","_dragStartPosition","_boxZoomStart","divStyle","$current_drag","dragStartPx","$current_dragend","Desktop","BoxZoom","Keyboard","CONTENT","CopyrightControl","activeBaseLayer","LogoControl","_updateActiveBaseLayer","mode","ScaleControl","scaleImg","scaleStr","topOutUnits","topInUnits","res","topUnits","inches","maxSizeData","numTopMax","toFixed","SLIDE_FACTOR","PAN_INFO","PanControl","panBtns","btn","panInfos","pan","_pressTimeout","panupBtn","pandownBtn","panleftBtn","panrightBtn","_panMoveStart","_panMove","DEFAULT_MAP_TYPE","MapTypeControl","_btnList","_changeButtonState","_click","typeId","list","classKey","_onMapTypeIdChanged","DEFAULT","LARGE","SMALL","ZOOM_INFO","ZoomControl","_gradation","_drawSmallZoom","_drawBigZoom","_addZoomBtn","_btnY","_resetMinMaxZoom","_drawZoomInfo","_addAbsoluteImgBtn","_drawZoomBar","zoomoutBtn","_updateSlider","zoomslider","_hideZoomInfo","activeBar","_activeBar","deactiveBar","_deactiveBar","levels","_updateZoomInfo","zoomBarInfo","_setZoom","_updateZoomLevelInfo","sliderOffset","sliderPosition","_showZoomInfo","dragstart","drag","dragend","dragFlag","crTop","initPt","action","zoominBtn","_interval","setInterval","PluginControl","_redrawItems","_hideExpand","_drawExpandType","expandBtn","form","_drawItems","childs","groups","_drawList","_drawSeparator","$nogroup","separator","_drawChild","html","checked","_showExpand","_expanded","imgLoc","IMG_LOCATION","imgURLS","IMG_URLS","_dButtonList","akey","panControl","logoControl","scaleControl","mapTypeControl","zoomControl","DesktopControlsPlugin","measureControl","MeasureControl","measureDistancePlugin","measure","MeasureDistancePlugin","measureAreaPlugin","MeasureAreaPlugin","measureOverlay","_measureOverlays","measureDistance","measureArea","measureOverlays","MeasureService","deleteOrigin","pointOrigin","_onClick","_onRightClick","_measureOverlayGroup","inProgressPath","inProgressVector","pointIcon","_createPointIcon","pointInfo","MeasureOverlay","addPointIcon","addPointInfo","_createVector","detailInfo","_createInProgressVector","MeasureOverlayGroup","measureService","_onMove","setDistance","removeInProgressVector","finish","_createDeleteMarker","measureOverlayGroup","deleteMarker","setDeleteMarker","_onStateChanged","distanceImg","_distanceImg","areaImg","_areaImg","clearImg","_clearImg","pointInfos","pointIcons","boxShadow","_updateAreaInfo","_updatePointStart","_updatePointInfo","_updatePointDetail","imgUrl","_updateFinalAreaInfo","areaHtml","_getArea","distLabel","_distValue","walkLabel","_walkValue","bikeLabel","_bikeValue","_rightButtonToFinish","_updateFinalDistanceInfo","paddingBottom","valueHtml","_getTimeHtml","distOrArea","_getTime","DrawCircle","circleOpts","_onDragStart","_onDragEnd","_complete","_circle","vectorLayer","_onDrag","_createCircle","DrawPolygon","polygonOpts","_onDblClick","_prevCoord","_polygon","_completePoint","_onMouseMove","DrawPolyline","polylineOpts","_finishDrawing","_dblClickCoord","_polyline","_inprogressLine","DrawRectangle","rectangleOpts","_rectangle","_createRectangle","_startCoord","DrawingControl","drawing","circleImg","_circleImg","borderWidth","borderStyle","borderColor","rectangleImg","_rectangleImg","polylineImg","_polylineImg","polygonImg","_polygonImg","handImg","_handImg","drawPolyline","drawPolygon","drawRectangle","drawCircle","DrawingService","editingPlugin","EditingPlugin","controlOpts","editOpts","activation","_onclick","_activateAllVector","vectors","_deactivateAllVector","_activeEditTarget","_draggableVertices","_draggableVertices2","_getPaths","existing","vertex","PathEditingHandle","_onChanging","existing2","AddVertexHandle","_centerHandle","EditingHandle","_onCenterDrag","draggableVertices","EditPolyline","rectangle","_leftTopHandle","_rightTopHandle","_rightBottomHandle","_leftBottomHandle","oppositePoint","EditRectangle","EditPolygon","threeClock","_onRadiusDrag","_radiusHandle","EditCircle","defaultStyles","_path","_setOptions","prevIndex","newPoint","render","_vm","_h","$createElement","_c","_self","staticRenderFns","attrs","methods","initMap","mounted","component","components","KtMap"],"sourceRoot":""}